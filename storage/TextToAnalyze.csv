id,Number,sentiment,text
688,17355,0,"The Python __doc__ for each global op should be carried over from its source. ## üêõ Bug

 is missing for many global operators (, , ...).

## To Reproduce





## Expected behavior

Global ops should contain valid s.

## Environment

PyTorch version: 1.0.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: version 3.9.4

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: GeForce GTX TITAN Black
GPU 1: GeForce GTX TITAN Black
GPU 2: GeForce GTX TITAN Black
GPU 3: GeForce GTX TITAN Black

Nvidia driver version: 390.30
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.1
. ['python\r\nprint(torch.log_softmax.__doc__)\r\n# None\r\n', 'python\r\nprint(torch.nn.functional.log_softmax.__doc__)\r\n# Correctly prints documentation.\r\n']"
616,13787,0,"Dataloader Segmentation Fault when using MPI backend & single process per gpu. ## üêõ Bug

When using DistributedDataParallel with mpi backend and assigning each gpu a single process on the host, program crashes at the end of an epoch. Failure is not always consistent.




## To Reproduce
[https://github.com/pytorch/examples/blob/master/imagenet/main.py](https://github.com/pytorch/examples/blob/master/imagenet/main.py)

run


Modifications:



## Environment

## Additional context

Crash is less likely to occur if the  is decreased,  or the  is increased.

core dump generated


[pytorchsegfault](https://github.com/pytorch/pytorch/files/2572658/pytorchsegfault.txt)

. ['\r\n[82362] *** Process received signal ***\r\n[82362] Signal: Segmentation fault (11)\r\n[82362] Signal code: Address not mapped (1)\r\n[82362] Failing at address: 0x1d3fca368\r\n[82362] [ 0] [0x7fffa5f504d8]\r\n[82362] [ 1] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0x11c258)[0x7fffa5d8c258]\r\n[82362] [ 2] /lib64/libc.so.6(__libc_malloc+0x8c)[0x7fffa597945c]\r\n[82362] [ 3] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0xdabe0)[0x7fffa5d4abe0]\r\n[82362] [ 4] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(_PyObject_GenericSetAttrWithDict+0x11c)[0x7fffa5d5915c]\r\n[82362] [ 5] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_GenericSetAttr+0x1c)[0x7fffa5d5937c]\r\n[82362] [ 6] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_SetAttr+0xb0)[0x7fffa5d588a0]\r\n[82362] [ 7] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x698c)[0x7fffa5df989c]\r\n[82362] [ 8] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0xd18)[0x7fffa5dfea78]\r\n[82362] [ 9] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8150)[0x7fffa5dfb060]\r\n[82362] [10] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0xa68c)[0x7fffa5dfd59c]\r\n[82362] [11] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0xd18)[0x7fffa5dfea78]\r\n[82362] [12] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0xba5b4)[0x7fffa5d2a5b4]\r\n[82362] [13] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_Call+0x74)[0x7fffa5cd9754]\r\n[82362] [14] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_CallMethod+0xd0)[0x7fffa5cd9cc0]\r\n[82362] [15] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_ReInitThreads+0xa0)[0x7fffa5df17d0]\r\n[82362] [16] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyOS_AfterFork+0x68)[0x7fffa5e5fa08]\r\n[82362] [17] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0x1f63b4)[0x7fffa5e663b4]\r\n[82362] [18] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x823c)[0x7fffa5dfb14c]\r\n[82362] [19] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0xd18)[0x7fffa5dfea78]\r\n[82362] [20] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0xba5b4)[0x7fffa5d2a5b4]\r\n[82362] [21] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_Call+0x74)[0x7fffa5cd9754]\r\n[82362] [22] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0x812e0)[0x7fffa5cf12e0]\r\n[82362] [23] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_Call+0x74)[0x7fffa5cd9754]\r\n[82362] [24] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0x11c220)[0x7fffa5d8c220]\r\n[82362] [25] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(+0x1179a8)[0x7fffa5d879a8]\r\n[82362] [26] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyObject_Call+0x74)[0x7fffa5cd9754]\r\n[82362] [27] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1788)[0x7fffa5df4698]\r\n[82362] [28] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0xa68c)[0x7fffa5dfd59c]\r\n[82362] [29] /mnt/pai/home/yfeng/anaconda2/bin/../lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0xd18)[0x7fffa5dfea78]\r\n[82362] *** End of error message ***\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\n  File ""pytorch-examples/imagenet/main.py"", line 415, in <module>\r\n    main()\r\n  File ""pytorch-examples/imagenet/main.py"", line 242, in main\r\n    prec1 = validate(val_loader, model, criterion)\r\n  File ""pytorch-examples/imagenet/main.py"", line 332, in validate\r\n    for i, (input, target) in enumerate(val_loader):\r\n  File ""/opt/pytorch/lib/python2.7/site-packages/torch/utils/data/dataloader.py"", line 819, in __iter__\r\n    return _DataLoaderIter(self)\r\n  File ""/opt/pytorch/lib/python2.7/site-packages/torch/utils/data/dataloader.py"", line 584, in __init__\r\n    self._put_indices()\r\n  File ""/opt/pytorch/lib/python2.7/site-packages/torch/utils/data/dataloader.py"", line 646, in _put_indices\r\n    indices = next(self.sample_iter, None)\r\n  File ""/opt/pytorch/lib/python2.7/site-packages/torch/utils/data/sampler.py"", line 161, in __iter__\r\n    batch.append(idx)\r\n  File ""/opt/pytorch/lib/python2.7/site-packages/torch/utils/data/dataloader.py"", line 274, in handler\r\n    _error_if_any_worker_fails()\r\nRuntimeError: DataLoader worker (pid 82360) is killed by signal: Segmentation fault. \r\n', ""\r\n        local_rank = int(os.getenv('OMPI_COMM_WORLD_LOCAL_RANK'))\r\n        world_size = int(os.getenv('OMPI_COMM_WORLD_SIZE'))\r\n...\r\n        dist.init_process_group(backend=args.dist_backend, init_method=args.dist_url,\r\n                                world_size=world_size)\r\n...\r\n        torch.cuda.set_device(local_rank)\r\n        model = torch.nn.parallel.DistributedDataParallel(model,\r\n                                                          device_ids=[local_rank],\r\n                                                          output_device=local_rank)\r\n"", '\r\nCollecting environment information...\r\nPyTorch version: 1.0.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Red Hat Enterprise Linux Server 7.5 (Maipo)\r\nGCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-28)\r\nCMake version: Could not collect\r\n\r\nPython version: 2.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: \r\nGPU 0: Tesla V100-SXM2-32GB\r\nGPU 1: Tesla V100-SXM2-32GB\r\nGPU 2: Tesla V100-SXM2-32GB\r\nGPU 3: Tesla V100-SXM2-32GB\r\n\r\nNvidia driver version: 410.72\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-10.0/targets/ppc64le-linux/lib/libcudnn.so.7.3.0\r\n/usr/local/cuda-10.0/targets/ppc64le-linux/lib/libcudnn_static.a\r\n', '\r\n(gdb) bt\r\n#0  0x00007fffa24065e0 in _int_malloc () from /lib64/libc.so.6\r\n#1  0x00007fffa240945c in malloc () from /lib64/libc.so.6\r\n#2  0x00007fffa27c7490 in PyList_New () from /opt/anaconda2/bin/../lib/libpython2.7.so.1.0\r\n#3  0x00007fffa27c7948 in list_concat () from /opt/anaconda2/bin/../lib/libpython2.7.so.1.0\r\n#4  0x00007fffa275ebf0 in PyNumber_Add () from /opt/anaconda2/bin/../lib/libpython2.7.so.1.0\r\n#5  0x00007fffa2886e90 in PyEval_EvalFrameEx () from /opt/anaconda2/bin/../lib/libpython2.7.so.1.0\r\n']"
322,18998,0,"torch.from_PIL() Request ?. ## üöÄ Feature
A simple method for transforming a PIL images directly into torch tensor.

## Motivation
It's frustrating to use transforms for a simple conversion between a PIL image and torch tensors and in the same time it's very easy to get tensor from numpy through  

## Pitch

Giving it a PIL images of any type and it returns a torch tensor

## Alternatives
I have considered two:
1. Transforms
2. convert it first to numpy then to torch
. ['torch.from_numpy()']"
241,4302,0,"'torch.HalfTensor' object has no attribute 'mean'.  results into
 > 'torch.HalfTensor' object has no attribute 'mean'

 is 0.4.0a0+5f7c550. []"
647,367,0,Support dilation in Conv1d and Conv3d. []
701,3093,0,"better error messages on compiling with cudnn v5 (which is not supported anymore). Hi All --

I'm getting the following error when I try to build:



Seems like the  flags were added within the past couple of weeks, and I can't find anything Googling the errors.

I have CUDNNV5 and CUDA 8.0 on an Ubuntu16.04 box.  Can provide more details as needed.

Thanks
. ['\r\n   if (perfResults.status == CUDNN_STATUS_SUCCESS && !(deterministic && perfResults.determinism != CUDNN_DETERMINISTIC)) {\r\n                                                                                                ^\r\ntorch/csrc/cudnn/Conv.cpp: In instantiation of ‚Äòvoid torch::cudnn::{anonymous}::findAlgorithm(THCState*, cudnnHandle_t, const torch::cudnn::Convolution&, bool, bool, void*, void*, void*, algo_t*) [with algo_t = cudnnConvolutionBwdDataAlgo_t; THCState = THCState; cudnnHandle_t = cudnnContext*]‚Äô:\r\ntorch/csrc/cudnn/Conv.cpp:465:83:   required from ‚Äòtorch::cudnn::{anonymous}::Workspace torch::cudnn::{anonymous}::chooseAlgorithm(THCState*, cudnnHandle_t, const torch::cudnn::Convolution&, bool, bool, void*, void*, void*, algo_t*) [with algo_t = cudnnConvolutionBwdDataAlgo_t; THCState = THCState; cudnnHandle_t = cudnnContext*]‚Äô\r\ntorch/csrc/cudnn/Conv.cpp:726:18:   required from here\r\ntorch/csrc/cudnn/Conv.cpp:448:96: error: ‚Äòstruct cudnnConvolutionBwdDataAlgoPerf_t‚Äô has no member named ‚Äòdeterminism‚Äô\r\ntorch/csrc/cudnn/Conv.cpp: In instantiation of ‚Äòvoid torch::cudnn::{anonymous}::findAlgorithm(THCState*, cudnnHandle_t, const torch::cudnn::Convolution&, bool, bool, void*, void*, void*, algo_t*) [with algo_t = cudnnConvolutionBwdFilterAlgo_t; THCState = THCState; cudnnHandle_t = cudnnContext*]‚Äô:\r\ntorch/csrc/cudnn/Conv.cpp:465:83:   required from ‚Äòtorch::cudnn::{anonymous}::Workspace torch::cudnn::{anonymous}::chooseAlgorithm(THCState*, cudnnHandle_t, const torch::cudnn::Convolution&, bool, bool, void*, void*, void*, algo_t*) [with algo_t = cudnnConvolutionBwdFilterAlgo_t; THCState = THCState; cudnnHandle_t = cudnnContext*]‚Äô\r\ntorch/csrc/cudnn/Conv.cpp:766:20:   required from here\r\ntorch/csrc/cudnn/Conv.cpp:448:96: error: ‚Äòstruct cudnnConvolutionBwdFilterAlgoPerf_t‚Äô has no member named ‚Äòdeterminism‚Äô\r\n']"
57,23871,1,"Quantized conv is 6x slower than float on CPU. Repro:
 Run resnext101-32x8d with quantized conv instead of float conv and measure elapsed time.

Possible causes:
 Layout transform before and after quantized conv2d calls.. []"
350,15284,0,"index_add_ with scalar values instead of tensors. Hi, I was wondering whether we could update functions like  so that the third argument () can also be a scalar value?. []"
311,9983,0,"[feature request] Add matrix functions. Add matrix power as implemented by [numpy.linalg.matrix_power](https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.matrix_power.html), matrix exponential as implemented by [scipy.linalg.expm](https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.expm.html), and matrix logarithm as implemented by [scipy.linalg.logm](https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.logm.html).


- [x] matrix_power
- [x] matrix_exp
- [ ] matrix_log
- [ ] matrix_sqrt

cc @ezyang @gchanan @zou3519 @bdhirsh @jbschlosser @anjali411 @jianyuh @nikitaved @pearu @mruberry @heitorschueroff @walterddr @IvanYashchuk @xwang233 @Lezcano @rgommers. []"
277,9484,0,"WARNING:root:This caffe2 python run does not have GPU support. Will run in CPU only mode. WARNING:root:Debug message: libcurand.so.9.0: cannot open shared object file: No such file or directory Segmentation fault (core dumped). HI,
I have GPU and CUDA, CuDNN, and NCCL. My OS is Ubuntu 16.04, I followed this tutorial to install Coffe2 with GPU support (
conda install -c caffe2 caffe2-cuda9.0-cudnn7
) and the installation finished successfully but this command: python2 -c 'from caffe2.python import workspace; print(workspace.NumCudaDevices())'

returns: WARNING:root:This caffe2 python run does not have GPU support. Will run in CPU only mode.
WARNING:root:Debug message: libcurand.so.9.0: cannot open shared object file: No such file or directory
Segmentation fault (core dumped)
Any Idea how can I solve it??
TNX

$nvcc --version
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2018 NVIDIA Corporation
Built on Tue_Jun_12_23:07:04_CDT_2018
Cuda compilation tools, release 9.2, V9.2.148

$ conda -V
conda 4.5.8

 nvidia-smi
Tue Jul 17 01:58:01 2018       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 384.130                Driver Version: 384.130                   |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Quadro M520         Off  | 00000000:02:00.0 Off |                  N/A |
| N/A   41C    P0    N/A /  N/A |    298MiB /  2002MiB |      2%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0     21578      G   /usr/lib/xorg/Xorg                           234MiB |
|    0     22157      G   compiz                                        62MiB |
+-----------------------------------------------------------------------------+

. []"
430,3514,0,"Unable to use cat on torch.LongTensor. Hello again,

I'm trying to concatenate two tensor together using ¬†applied on a Tensor that I have created from a Numpy array. Here is the example:



Instead if you try with this it works:


What's wrong?

Cheers,
Alessandro. [""\r\nIn [1]: import torch\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: x = torch.LongTensor(np.random.randint(1, 20, (1, 1, 4)))\r\n\r\nIn [4]: torch.cat((x, torch.zeros(x.size())))\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-4-4ddca689077c> in <module>()\r\n----> 1 torch.cat((x, torch.zeros(x.size())))\r\n\r\nTypeError: cat received an invalid combination of arguments - got (tuple), but expected one of:\r\n * (sequence[torch.LongTensor] seq)\r\n      didn't match because some of the arguments have invalid types: (tuple)\r\n * (sequence[torch.LongTensor] seq, int dim)\r\n"", '\r\nIn [5]: a = torch.randn(1,1,4)\r\n\r\nIn [6]: a\r\nOut[6]:\r\n\r\n(0 ,.,.) =\r\n -1.1397  0.0766  1.3821 -0.4036\r\n[torch.FloatTensor of size 1x1x4]\r\n\r\nIn [7]: torch.cat((a, torch.zeros(a.size())))\r\nOut[7]:\r\n\r\n(0 ,.,.) =\r\n -1.1397  0.0766  1.3821 -0.4036\r\n\r\n(1 ,.,.) =\r\n  0.0000  0.0000  0.0000  0.0000\r\n[torch.FloatTensor of size 2x1x4]\r\n']"
329,26714,0,"spectral_norm used in RNN causes ""parameter types mismatch"" in GPU. ## Issue description
spectral_norm used in  is okay. But when it's used in ,there will be a 
model = network().cuda()
## Environment
 - PyTorch Version (e.g., 1.0): 1.1.0
 - Python version: 3.6.8
 - CUDA/cuDNN version:  cuda9.0


. ['\r\n\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n## Code\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n']"
693,219,0,"Conv2dTranspose needs cudnn integration. Right now, only Conv2d is wrapped to be so.. []"
413,5712,0,"Multiple versions of Dockerfiles fail to build. PyTorch GitHub Issues Guidelines
--------------------------------

- OS: Mac
- PyTorch version: master, v0.3.1, v0.3.0, v0.2.0, v0.1.12
- How you installed PyTorch (conda, pip, source):
- Python version: N/A
- CUDA/cuDNN version: N/A
- GPU models and configuration: N/A
- GCC version (if compiling from source): N/A

Version 0.3.1 below:

This produces this:

UPDATE:
Same goes for v0.3.0

UPDATE:
Running  fails with below

UPDATE:
Running 0.1.12 gives this, similar to latest versions but different package:

UPDATE:
Running  gives this:
. ['\r\ndocker build --build-arg HTTP_PROXY=XXXX --build-arg HTTPS_PROXY=XXXX --build-arg http_proxy=XXXX --build-arg https_proxy=XXXX -t test:XXXXX https://github.com/pytorch/pytorch.git#v0.3.1\r\n', ""\r\nWARNING: The following packages cannot be authenticated!\r\n  libnccl2 libnccl-dev\r\nE: There were unauthenticated packages and -y was used without --allow-unauthenticated\r\nThe command '/bin/sh -c apt-get update && apt-get install -y --no-install-recommends          build-essential          cmake          git          curl          vim          ca-certificates          libnccl2=2.0.5-2+cuda8.0          libnccl-dev=2.0.5-2+cuda8.0          libjpeg-dev          libpng-dev &&     rm -rf /var/lib/apt/lists/*' returned a non-zero code: 100\r\n"", '\r\n CMakeFiles/THC.dir/build.make:217: recipe for target \'CMakeFiles/THC.dir/THC_generated_THCTensorMode.cu.o\' failed\r\n    make[2]: *** [CMakeFiles/THC.dir/THC_generated_THCTensorMode.cu.o] Error 1\r\n    make[2]: *** Waiting for unfinished jobs....\r\n    CMakeFiles/Makefile2:67: recipe for target \'CMakeFiles/THC.dir/all\' failed\r\n    make[1]: *** [CMakeFiles/THC.dir/all] Error 2\r\n    Makefile:127: recipe for target \'all\' failed\r\n    make: *** [all] Error 2\r\n    Running setup.py install for torch: finished with status \'error\'\r\nCleaning up...\r\n  Removing source in /tmp/pip-nvl2npin-build\r\nCommand ""/opt/conda/envs/pytorch-py35/bin/python -u -c ""import setuptools, tokenize;__file__=\'/tmp/pip-nvl2npin-build/setup.py\';f=getattr(tokenize, \'open\', open)(__file__);code=f.read().replace(\'\\r\\n\', \'\\n\');f.close();exec(compile(code, __file__, \'exec\'))"" install --record /tmp/pip-k2bx1enk-record/install-record.txt --single-version-externally-managed --compile"" failed with error code 1 in /tmp/pip-nvl2npin-build/\r\nException information:\r\nTraceback (most recent call last):\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/basecommand.py"", line 215, in main\r\n    status = self.run(options, args)\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/commands/install.py"", line 342, in run\r\n    prefix=options.prefix_path,\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py"", line 784, in install\r\n    **kwargs\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_install.py"", line 878, in install\r\n    spinner=spinner,\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/utils/__init__.py"", line 707, in call_subprocess\r\n    % (command_desc, proc.returncode, cwd))\r\npip.exceptions.InstallationError: Command ""/opt/conda/envs/pytorch-py35/bin/python -u -c ""import setuptools, tokenize;__file__=\'/tmp/pip-nvl2npin-build/setup.py\';f=getattr(tokenize, \'open\', open)(__file__);code=f.read().replace(\'\\r\\n\', \'\\n\');f.close();exec(compile(code, __file__, \'exec\'))"" install --record /tmp/pip-k2bx1enk-record/install-record.txt --single-version-externally-managed --compile"" failed with error code 1 in /tmp/pip-nvl2npin-build/\r\nLooking up ""https://pypi.python.org/pypi/pip/json"" in the cache\r\nNo cache entry available\r\nStarting new HTTPS connection (1): pypi.python.org\r\n""GET /pypi/pip/json HTTP/1.1"" 200 72983\r\nUpdating cache with response from ""https://pypi.python.org/pypi/pip/json""\r\nCaching b/c date exists and max-age > 0\r\nThe command \'/bin/sh -c TORCH_CUDA_ARCH_LIST=""3.5 5.2 6.0 6.1+PTX"" TORCH_NVCC_FLAGS=""-Xfatbin -compress-all""     CMAKE_PREFIX_PATH=""$(dirname $(which conda))/../""     pip install -v .\' returned a non-zero code: 1\r\n', ""\r\nWARNING: The following packages cannot be authenticated!\r\n  libcudnn6 libcudnn6-dev\r\nE: There were unauthenticated packages and -y was used without --allow-unauthenticated\r\nThe command '/bin/sh -c apt-get update && apt-get install -y --no-install-recommends          build-essential          cmake          git          curl          ca-certificates          libjpeg-dev          libpng-dev          libcudnn6=$CUDNN_VERSION-1+cuda8.0          libcudnn6-dev=$CUDNN_VERSION-1+cuda8.0 &&      rm -rf /var/lib/apt/lists/*' returned a non-zero code: 100\r\n"", '\r\n[ 19%] Building NVCC (Device) object src/ATen/CMakeFiles/ATen.dir/__/THC/ATen_generated_THCTensorMode.cu.o\r\n    Killed\r\n    CMake Error at ATen_generated_THCTensorIndex.cu.o.cmake:267 (message):\r\n      Error generating file\r\n      /tmp/pip-fbuuiu10-build/torch/lib/build/aten/src/ATen/CMakeFiles/ATen.dir/__/THC/./ATen_generated_THCTensorIndex.cu.o\r\n\r\n\r\n    src/ATen/CMakeFiles/ATen.dir/build.make:154: recipe for target \'src/ATen/CMakeFiles/ATen.dir/__/THC/ATen_generated_THCTensorIndex.cu.o\' failed\r\n    make[2]: *** [src/ATen/CMakeFiles/ATen.dir/__/THC/ATen_generated_THCTensorIndex.cu.o] Error 1\r\n    make[2]: *** Waiting for unfinished jobs....\r\n    CMakeFiles/Makefile2:233: recipe for target \'src/ATen/CMakeFiles/ATen.dir/all\' failed\r\n    make[1]: *** [src/ATen/CMakeFiles/ATen.dir/all] Error 2\r\n    Makefile:127: recipe for target \'all\' failed\r\n    make: *** [all] Error 2\r\n    Running setup.py install for torch: finished with status \'error\'\r\nCleaning up...\r\n  Removing source in /tmp/pip-fbuuiu10-build\r\nCommand ""/opt/conda/bin/python -u -c ""import setuptools, tokenize;__file__=\'/tmp/pip-fbuuiu10-build/setup.py\';f=getattr(tokenize, \'open\', open)(__file__);code=f.read().replace(\'\\r\\n\', \'\\n\');f.close();exec(compile(code, __file__, \'exec\'))"" install --record /tmp/pip-giq0q4m5-record/install-record.txt --single-version-externally-managed --compile"" failed with error code 1 in /tmp/pip-fbuuiu10-build/\r\nException information:\r\nTraceback (most recent call last):\r\n  File ""/opt/conda/lib/python3.6/site-packages/pip/basecommand.py"", line 215, in main\r\n    status = self.run(options, args)\r\n  File ""/opt/conda/lib/python3.6/site-packages/pip/commands/install.py"", line 342, in run\r\n    prefix=options.prefix_path,\r\n  File ""/opt/conda/lib/python3.6/site-packages/pip/req/req_set.py"", line 784, in install\r\n    **kwargs\r\n  File ""/opt/conda/lib/python3.6/site-packages/pip/req/req_install.py"", line 878, in install\r\n    spinner=spinner,\r\n  File ""/opt/conda/lib/python3.6/site-packages/pip/utils/__init__.py"", line 707, in call_subprocess\r\n    % (command_desc, proc.returncode, cwd))\r\npip.exceptions.InstallationError: Command ""/opt/conda/bin/python -u -c ""import setuptools, tokenize;__file__=\'/tmp/pip-fbuuiu10-build/setup.py\';f=getattr(tokenize, \'open\', open)(__file__);code=f.read().replace(\'\\r\\n\', \'\\n\');f.close();exec(compile(code, __file__, \'exec\'))"" install --record /tmp/pip-giq0q4m5-record/install-record.txt --single-version-externally-managed --compile"" failed with error code 1 in /tmp/pip-fbuuiu10-build/\r\nLooking up ""https://pypi.python.org/pypi/pip/json"" in the cache\r\nNo cache entry available\r\nStarting new HTTPS connection (1): pypi.python.org\r\n""GET /pypi/pip/json HTTP/1.1"" 200 72983\r\nUpdating cache with response from ""https://pypi.python.org/pypi/pip/json""\r\nCaching b/c date exists and max-age > 0\r\nThe command \'/bin/sh -c TORCH_CUDA_ARCH_LIST=""3.5 5.2 6.0 6.1 7.0+PTX"" TORCH_NVCC_FLAGS=""-Xfatbin -compress-all""     CMAKE_PREFIX_PATH=""$(dirname $(which conda))/../""     pip install -v .\' returned a non-zero code: 1\r\n']"
274,2129,0,"[Feature request] truncated normal initializer(sampler). There has been a recent discussion on the discuss about truncated normal initializer [link](https://discuss.pytorch.org/t/implementing-truncated-normal-initializer/4778/15).
I have implemented one on my own, but the code is basically paraphrasing the tensorflow code, which I feel like may cause problem. If you feel good to add this, I can submit a PR once you tell me if it's ok to paraphrase or what's the alternative.. []"
500,22269,0,"Add user-facing Function, so we don't have to expose torch.jit._C.Function. Add user-facing Function, so we don't have to expose torch.jit._C.Function

More details:
https://github.com/pytorch/pytorch/pull/22090#discussion_r296443544. []"
569,16574,0,"Make it possible to use mypy to typecheck code that uses PyTorch. We generated a type stub for  module in , which is good enough to get autocomplete working in PyCharm. However, the type stub is not that well tested for actually, you know, accurately reflecting the types of our functions (we have light testing, but it's not enough) and it's unlikely that it's actually good enough to actually use mypy to typecheck PyTorch-using code. It seems like this is something that people might be interested in, so I'm creating this issue to track. Please emoji if this is something that you would use.

cc @ezyang @gchanan @zou3519. []"
214,6258,0,"[feature request] use mkl_vml.h for exp, log vectorization on CPU. @cpuhrsch #6192 disables imprecise vectorized function from avx_mathfunc.h
[vml](https://software.intel.com/en-us/mkl-developer-reference-c-vm-mathematical-functions) is a vector math library from MKL, both performance and precision is promised. As long as  and  is installed in conda, vml can be used in ATen.
@MlWoo was preparing the code previously, the job got interrupted since he is in hospital lately :(
Below is the performance comparison of avx_mathfunc and vml in exp. Though the performance improvement is not so much, the precision is guaranteed.
if this looks ok to you, we will continue the job, after @MlWoo finish his therapy anyway.
. ['\r\navx_mathfunc.h\r\nexp:            size: 10^2      elapsed avg: 0.00018437 variance: 0.00002326    type: torch.FloatTensor\r\nexp:            size: 10^3      elapsed avg: 0.00051801 variance: 0.00012947    type: torch.FloatTensor\r\nexp:            size: 10^4      elapsed avg: 0.00399129 variance: 0.00030216    type: torch.FloatTensor\r\nexp:            size: 10^5      elapsed avg: 0.05558920 variance: 0.00430511    type: torch.FloatTensor\r\n\r\nvml\r\nexp:            size: 10^2      elapsed avg: 0.00004063 variance: 0.00001652    type: torch.FloatTensor\r\nexp:            size: 10^3      elapsed avg: 0.00048499 variance: 0.00003081    type: torch.FloatTensor\r\nexp:            size: 10^4      elapsed avg: 0.00325508 variance: 0.00007704    type: torch.FloatTensor\r\nexp:            size: 10^5      elapsed avg: 0.04254997 variance: 0.00301427    type: torch.FloatTensor\r\n\r\n']"
653,16990,0,"Unsafe .data in fbgemm integration. https://github.com/pytorch/pytorch/blob/4292d13240e23a4a343b4ccb153214ab11c8d255/aten/src/ATen/native/QuantizedLinear.cpp#L39-L40

Here, e.g., if  isn't contiguous, the temporary tensor  can be freed and making the pointers invalid.

cc @jamesr66a . []"
504,17335,0,.circleci/regenerate.sh doesn't work when run from root directory. ['\r\n(/Users/ezyang/Dev/pytorch-tmp-env) macbook-pro-116:pytorch-tmp ezyang$ .circleci/regenerate.sh \r\n+ ./generate-config-yml.py\r\n.circleci/regenerate.sh: line 3: ./generate-config-yml.py: No such file or directory\r\n']
687,18862,0,"matmul uses too much memory in some batched cases. ## üêõ Bug

PyTorch . The GPU times reported are on a P100.

In this case matmul uses about 12 GB of memory when it shouldn't use more than ~3 MB. (i.e. it's using 4096x more memory than necessary)

#### A


Note that this is equivalent to the following memory efficient operation:


#### B


It's also equivalent to the following which is memory efficient and faster, but may require a copy of y and the output may be batched-column-major without some extra work:

#### C


On GPU, **A** takes ~125 ms and uses 12 GB of memory, **B** takes ~22 ms, and **C** takes ~1 ms.

Originally https://discuss.pytorch.org/t/unexpected-huge-memory-cost-of-matmul/41642/4

See also https://github.com/pytorch/pytorch/issues/13222 which may be related

----

I believe the problem is the unnecessary contiguous call here:

https://github.com/pytorch/pytorch/blob/15b318de840de61e2e789c013e34d23819715090/aten/src/ATen/native/LinearAlgebra.cpp#L460-L461

Instead of using  and  it may be possible to use . That might achieve performance of **B**.

. ['python\r\nx = torch.randn(4096, 4096)\r\ny = torch.randn(192, 4096, 1)\r\nz = torch.matmul(x, y)\r\n', '\r\nx = torch.randn(4096, 4096)\r\ny = torch.randn(192, 4096, 1)\r\nz = torch.bmm(x.unsqueeze(0).expand(192, *x.shape), y)\r\n', '\r\nx = torch.randn(4096, 4096)\r\ny = torch.randn(192, 4096, 1)\r\nz = torch.matmul(y.permute(0, 2, 1), x.t()).permute(0, 2, 1)\r\n']"
142,8716,0,"[JIT] Traced and Script modules are not properly inlined into script functions. [""\r\n+    @unittest.skip('TODO: Incorrect behavior')\r\n+    def test_call_traced_mod_from_script_fn(self):\r\n+        class TracedModule(torch.nn.Module):\r\n+            def __init__(self):\r\n+                super(TracedModule, self).__init__()\r\n+                self.param = torch.nn.Parameter(torch.rand(4, 3))\r\n+\r\n+            def forward(self, x):\r\n+                return torch.mm(x, self.param)\r\n+\r\n+        tm = torch.jit.trace(torch.rand(3, 4))(TracedModule())\r\n+\r\n+        @torch.jit.script\r\n+        def script_fn(x):\r\n+            return tm(x) + 1\r\n+\r\n+        # Note: At the time of writing this produces the following graph:\r\n+        # graph(%x : Dynamic) {\r\n+        #   %1 : Dynamic = ^<python_value>()(%x)\r\n+        #   %2 : Long() = prim::Constant[value={1}]()\r\n+        #   %3 : Dynamic = aten::add[alpha={1}](%1, %2)\r\n+        #   return (%3);\r\n+        # }\r\n+        # This seems incorrect. Similarly to calling a traced module from a\r\n+        # traced function, the behavior here should likely be that we inline\r\n+        # the parameter from the traced module as a Constant node and we inline\r\n+        # the ops into the graph of the script function. TODO: fix\r\n+        self.assertExpected(str(script_fn.graph))\r\n+\r\n+    def test_call_script_mod_from_script_fn(self):\r\n+        class ScriptMod(torch.jit.ScriptModule):\r\n+            def __init__(self):\r\n+                super(ScriptMod, self).__init__()\r\n+                self.param = torch.nn.Parameter(torch.rand(4, 3))\r\n+\r\n+            @torch.jit.script_method\r\n+            def forward(self, x):\r\n+                return torch.mm(x, self.param)\r\n+\r\n+        sm = ScriptMod()\r\n+\r\n+        @torch.jit.script\r\n+        def script_fn(x):\r\n+            return sm(x) + 1\r\n+\r\n+        # Note: At the time of writing this produces the following graph:\r\n+        # graph(%x : Dynamic) {\r\n+        #   %1 : Dynamic = ^<python_value>()(%x)\r\n+        #   %2 : Long() = prim::Constant[value={1}]()\r\n+        #   %3 : Dynamic = aten::add[alpha={1}](%1, %2)\r\n+        #   return (%3);\r\n+        # }\r\n+        # This seems incorrect. Similarly to calling a script module from a\r\n+        # traced function, the behavior here should likely be that we inline\r\n+        # the parameter from the traced module as a Constant node and we inline\r\n+        # the ops into the graph of the script function. TODO: fix\r\n+        self.assertExpected(str(script_fn.graph))\r\n""]"
411,3882,0," Leaking dataloader. I‚Äôve met a strange memory leak when I tried to implement ‚ÄúImproved Training of Wasserstein GANs‚Äù. I‚Äôm getting OOM in the middle of second epoch both on CPU and GPU. Memory usage seems to increase after each batch, the profiling of CPU version points on the for loop over dataloader. Here is the kinda minimal example:



From the discussion on https://discuss.pytorch.org/t/leaking-dataloader/10418 I've found out that the code runs fine on  torch 0.2.0_3, while I'm using https://github.com/pytorch/pytorch/tree/8ebf18b5b1d57ef16c24366649e720867f394a98 built from source, with CUDA 8 and cudnn7, so I supposed it should be some recently introduced bug. ['python\r\nfrom __future__ import print_function\r\n\r\nimport argparse\r\nimport os\r\nimport random\r\n\r\nimport torch\r\nimport torch.backends.cudnn as cudnn\r\nimport torch.nn.parallel\r\nimport torch.optim as optim\r\nimport torch.utils.data\r\nimport torchvision.datasets as dset\r\nimport torchvision.transforms as transforms\r\nfrom torch import autograd\r\nfrom torch import nn\r\nfrom torch.autograd import Variable\r\n\r\nparser = argparse.ArgumentParser()\r\nparser.add_argument(\'--dataroot\', required=True, help=\'path to dataset\')\r\nparser.add_argument(\'--workers\', type=int, help=\'number of data loading workers\', default=4)\r\nparser.add_argument(\'--batchSize\', type=int, default=128, help=\'input batch size\')\r\nparser.add_argument(\'--imageSize\', type=int, default=32, help=\'the height / width of the input image to network\')\r\nparser.add_argument(\'--nz\', type=int, default=128, help=\'size of the latent z vector\')\r\nparser.add_argument(\'--num_gen_filters\', type=int, default=32, help=\'# of gen filters in first conv layer\')  # 64\r\nparser.add_argument(\'--num_disc_filters\', type=int, default=32, help=\'# of discrim filters in first conv layer\')\r\nparser.add_argument(\'--niter\', type=int, default=25, help=\'number of epochs to train for\')\r\nparser.add_argument(\'--lr\', type=float, default=1e-4, help=\'learning rate, default=0.0002\')\r\nparser.add_argument(\'--beta1\', type=float, default=0.5, help=\'beta1 for adam. default=0.5\')\r\nparser.add_argument(\'--cuda\', action=\'store_true\', default=False, help=\'enables cuda\')\r\nparser.add_argument(\'--ngpu\', type=int, default=1, help=\'number of GPUs to use\')\r\nparser.add_argument(\'--netG\', default=\'\', help=""path to netG (to continue training)"")\r\nparser.add_argument(\'--netD\', default=\'\', help=""path to netD (to continue training)"")\r\nparser.add_argument(\'--outf\', default=\'./result\', help=\'folder to output images and model checkpoints\')\r\nparser.add_argument(\'--manualSeed\', type=int, default=1, help=\'manual seed\')\r\n\r\nopt = parser.parse_args()\r\ntorch.backends.cudnn.benchmark = True\r\n\r\n\r\nclass Generator(nn.Module):\r\n    def __init__(self, num_gen_filters, nz=128, num_channels=3):\r\n        super(Generator, self).__init__()\r\n        self.num_gen_filters = num_gen_filters\r\n        self.preprocess = nn.Sequential(\r\n            nn.Linear(nz, 4 * 4 * 4 * num_gen_filters),\r\n            nn.BatchNorm2d(4 * 4 * 4 * num_gen_filters),\r\n            nn.ReLU(True),\r\n        )\r\n        self.block1 = nn.Sequential(\r\n            nn.ConvTranspose2d(4 * num_gen_filters, 2 * num_gen_filters, 2, stride=2),\r\n            nn.BatchNorm2d(2 * num_gen_filters),\r\n            nn.ReLU(True),\r\n        )\r\n        self.block2 = nn.Sequential(\r\n            nn.ConvTranspose2d(2 * num_gen_filters, num_gen_filters, 2, stride=2),\r\n            nn.BatchNorm2d(num_gen_filters),\r\n            nn.ReLU(True),\r\n        )\r\n        self.deconv_out = nn.ConvTranspose2d(num_gen_filters, num_channels, 2, stride=2)\r\n        self.tanh = nn.Tanh()\r\n\r\n    def forward(self, input):\r\n        output = self.preprocess(input)\r\n        output = output.view(-1, 4 * self.num_gen_filters, 4, 4)\r\n        output = self.block1(output)\r\n        output = self.block2(output)\r\n        output = self.deconv_out(output)\r\n        output = self.tanh(output)\r\n        return output.view(-1, 3, 32, 32)\r\n\r\n\r\nclass Discriminator(nn.Module):\r\n    def __init__(self, num_disc_filters, num_channels=3):\r\n        super(Discriminator, self).__init__()\r\n        self.num_disc_filters = num_disc_filters\r\n        self.main = nn.Sequential(\r\n            nn.Conv2d(num_channels, num_disc_filters, 3, 2, padding=1),\r\n            nn.LeakyReLU(),\r\n            nn.Conv2d(num_disc_filters, 2 * num_disc_filters, 3, 2, padding=1),\r\n            nn.LeakyReLU(),\r\n            nn.Conv2d(2 * num_disc_filters, 4 * num_disc_filters, 3, 2, padding=1),\r\n            nn.LeakyReLU(),\r\n        )\r\n\r\n        self.linear = nn.Linear(4 * 4 * 4 * num_disc_filters, 1)\r\n\r\n    def forward(self, input):\r\n        output = self.main(input)\r\n        output = output.view(-1, 4 * 4 * 4 * self.num_disc_filters)\r\n        output = self.linear(output)\r\n        return output\r\n\r\n\r\ndef main():\r\n    print(opt)\r\n\r\n    nz = opt.nz\r\n\r\n    try:\r\n        os.makedirs(opt.outf)\r\n    except OSError:\r\n        pass\r\n\r\n    if opt.manualSeed is None:\r\n        opt.manualSeed = random.randint(1, 10000)\r\n    print(""Random Seed: "", opt.manualSeed)\r\n    random.seed(opt.manualSeed)\r\n    torch.manual_seed(opt.manualSeed)\r\n    if opt.cuda:\r\n        torch.cuda.manual_seed_all(opt.manualSeed)\r\n\r\n    cudnn.benchmark = True\r\n\r\n    if torch.cuda.is_available() and not opt.cuda:\r\n        print(""WARNING: You have a CUDA device, so you should probably run with --cuda"")\r\n\r\n    dataset = dset.CIFAR10(root=opt.dataroot, download=True, transform=transforms.Compose(\r\n        [transforms.Resize(opt.imageSize), transforms.ToTensor(),\r\n         transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5)), ]))\r\n    dataloader = torch.utils.data.DataLoader(dataset, batch_size=opt.batchSize,\r\n                                             shuffle=True, num_workers=int(opt.workers))\r\n\r\n    netG = Generator(opt.num_gen_filters, nz)\r\n    print(netG)\r\n\r\n    netD = Discriminator(opt.num_disc_filters)\r\n    print(netD)\r\n\r\n    noise = torch.FloatTensor(opt.batchSize, nz, 1, 1)\r\n    fixed_noise = torch.FloatTensor(opt.batchSize, nz).normal_(0, 1)\r\n\r\n    if opt.cuda:\r\n        netD.cuda()\r\n        netG.cuda()\r\n        noise, fixed_noise = noise.cuda(), fixed_noise.cuda()\r\n\r\n    # setup optimizer\r\n    optimizerD = optim.Adam(netD.parameters(), lr=opt.lr, betas=(opt.beta1, 0.9))\r\n\r\n    for epoch in range(opt.niter):\r\n        for _, data in enumerate(dataloader, 0):\r\n            for p in netG.parameters():  # reset requires_grad\r\n                p.requires_grad = False  # they are set to False below in netG update\r\n\r\n            # train with real\r\n            netD.zero_grad()\r\n            real_cpu, _ = data\r\n            batch_size = real_cpu.size(0)\r\n            if opt.cuda:\r\n                real_cpu = real_cpu.cuda()\r\n\r\n            noise.resize_(batch_size, nz).normal_(0, 1)\r\n            noisev = Variable(noise, volatile=True)\r\n            fake = Variable(netG(noisev).data)\r\n\r\n            interpolates = 0.5 * real_cpu + 0.5 * fake.data\r\n\r\n            if opt.cuda:\r\n                interpolates = interpolates.cuda()\r\n            interpolates = autograd.Variable(interpolates, requires_grad=True)\r\n\r\n            disc_interpolates = netD(interpolates)\r\n\r\n            gradients = autograd.grad(outputs=disc_interpolates, inputs=interpolates,\r\n                                      grad_outputs=torch.ones(\r\n                                          disc_interpolates.size()).cuda() if opt.cuda else torch.ones(\r\n                                          disc_interpolates.size()), create_graph=True, only_inputs=True)[0]\r\n\r\n            gradient_penalty = ((gradients.norm(2, dim=1) - 1) ** 2).mean() * 10\r\n\r\n            gradient_penalty.backward()\r\n            optimizerD.step()\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    main()\r\n']"
68,3958,1,"10% performance regression on CuDNN convolution dispatch path. This PR https://github.com/pytorch/pytorch/pull/3666 introduces a 10% performance regression on the CuDNN convolution dispatch path. There is no single smoking gun, but it needs to be as fast as the old CuDNN code was. I spent this morning trying to fix it to no avail, so this is to remind me to fix it before next release.

cc @csarofeen @ptrblck. []"
736,30375,0,"Distributed Using Gloo on Multiple Nodes Does not Work. ## üêõ Bug

I am trying to run a distributed deep learning workload on multiple nodes using Gloo. But unfortunately I receive the error below:



This is a two node environment with two VMs. Each of these VMs have 16 GB of RAM and 8 cores.
<!-- A clear and concise description of what the bug is. -->

## To Reproduce

The code is very similar to this link: https://pytorch.org/tutorials/intermediate/dist_tuto.html

The only difference is in the initiation phase:



<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

The expected behavior is not seeing the error code and the distributed training process kicking off.

## Environment

PyTorch version: 1.4.0.dev20191122+cpu
Is debug build: No
CUDA used to build PyTorch: None

OS: Ubuntu 18.04.3 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: Could not collect

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.17.4
[pip3] torch==1.4.0.dev20191122+cpu
[pip3] torchvision==0.5.0.dev20191122+cpu
[conda] Could not collect


cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. [""\r\nterminate called after throwing an instance of 'gloo::EnforceNotMet'\r\n  what():  [enforce fail at /pytorch/third_party/gloo/gloo/transport/tcp/device.cc:281] rv != -1. -1\r\n"", 'python\r\ndef init_process(rank, size, fn, backend=\'gloo\'):\r\n    """""" Initialize the distributed environment. """"""\r\n    os.environ[\'MASTER_ADDR\'] = \'10.11.13.39\'\r\n    os.environ[\'MASTER_PORT\'] = \'8888\'\r\n    os.environ[\'WORLD_SIZE\'] = \'4\'\r\n    dist.init_process_group(backend, rank=rank, world_size=4)\r\n    fn(rank, size)\r\n\r\nsize = 2\r\nworker_id = int(sys.argv[1])\r\nprocesses = []\r\nfor rank in range(size):\r\n    p = Process(target=init_process, args=(rank + worker_id, size, run))\r\n    p.start()\r\n    processes.append(p)\r\n\r\nfor p in processes:\r\n    p.join()\r\n']"
698,21761,0,"[JIT] Bad error message when instantiating a script class with no __init__. 

. ['\r\nimport torch\r\n\r\n@torch.jit.script\r\nclass Foo(object):\r\n    pass\r\n\r\n@torch.jit.script\r\ndef foo():\r\n    f = Foo()\r\n\r\nprint(foo.graph)\r\n', '\r\nTraceback (most recent call last):\r\n  File ""compile_class_members.py"", line 7, in <module>\r\n    @torch.jit.script\r\n  File ""/Users/jamesreed/pytorch/torch/jit/__init__.py"", line 1084, in script\r\n    fn = torch._C._jit_script_compile(ast, _rcb, get_default_args(obj))\r\nRuntimeError: method INTERNAL ASSERT FAILED at ../torch/csrc/jit/script/sugared_value.h:292, please report a bug to PyTorch.  (call at ../torch/csrc/jit/script/sugared_value.h:292)\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 64 (0x1147151b0 in libc10.dylib)\r\nframe #1: torch::jit::script::MethodValue::call(torch::jit::SourceRange const&, torch::jit::Function&, c10::ArrayRef<torch::jit::NamedValue>, c10::ArrayRef<torch::jit::NamedValue>, unsigned long) + 1520 (0x117fb1090 in libtorch.dylib)\r\nframe #2: torch::jit::script::ClassValue::call(torch::jit::SourceRange const&, torch::jit::Function&, c10::ArrayRef<torch::jit::NamedValue>, c10::ArrayRef<torch::jit::NamedValue>, unsigned long) + 326 (0x118006766 in libtorch.dylib)\r\nframe #3: torch::jit::script::to_ir::emitApplyExpr(torch::jit::script::Apply&, unsigned long) + 6600 (0x117fd25e8 in libtorch.dylib)\r\nframe #4: torch::jit::script::to_ir::emitSugaredExpr(torch::jit::script::Expr const&, unsigned long, std::__1::shared_ptr<c10::Type> const&) + 493 (0x117fa99dd in libtorch.dylib)\r\nframe #5: torch::jit::script::to_ir::emitAssignment(torch::jit::script::Assign const&) + 1785 (0x117fa8c69 in libtorch.dylib)\r\nframe #6: torch::jit::script::to_ir::emitStatements(torch::jit::script::ListIterator<torch::jit::script::Stmt>, torch::jit::script::ListIterator<torch::jit::script::Stmt>) + 1550 (0x117f9b1ee in libtorch.dylib)\r\nframe #7: torch::jit::script::to_ir::emitDef(torch::jit::script::Def const&, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (torch::jit::Value*)> const&, torch::jit::Block*) + 376 (0x117f98328 in libtorch.dylib)\r\nframe #8: torch::jit::script::to_ir::to_ir(torch::jit::script::Def const&, std::__1::shared_ptr<torch::jit::script::Resolver>, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (torch::jit::Value*)> const&, torch::jit::Function&) + 606 (0x117f9787e in libtorch.dylib)\r\nframe #9: std::__1::__function::__func<torch::jit::script::CompilationUnit::define(std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::shared_ptr<torch::jit::script::Resolver>, std::__1::allocator<std::__1::shared_ptr<torch::jit::script::Resolver> > > const&, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (torch::jit::Value*)> const&)::$_1, std::__1::allocator<torch::jit::script::CompilationUnit::define(std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::shared_ptr<torch::jit::script::Resolver>, std::__1::allocator<std::__1::shared_ptr<torch::jit::script::Resolver> > > const&, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (torch::jit::Value*)> const&)::$_1>, void (torch::jit::Function&)>::operator()(torch::jit::Function&) + 80 (0x117f97450 in libtorch.dylib)\r\nframe #10: torch::jit::Function::ensure_defined() + 196 (0x118063f64 in libtorch.dylib)\r\nframe #11: torch::jit::script::CompilationUnit::define(std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::shared_ptr<torch::jit::script::Resolver>, std::__1::allocator<std::__1::shared_ptr<torch::jit::script::Resolver> > > const&, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (torch::jit::Value*)> const&) + 2456 (0x117f94b08 in libtorch.dylib)\r\nframe #12: void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_32, std::__1::shared_ptr<torch::jit::Function>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, pybind11::object, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, pybind11::object> > >, pybind11::name, pybind11::scope, pybind11::sibling>(torch::jit::script::initJitScriptBindings(_object*)::$_32&&, std::__1::shared_ptr<torch::jit::Function> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, pybind11::object, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, pybind11::object> > >), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::\'lambda\'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) + 920 (0x11596d7c8 in libtorch_python.dylib)\r\nframe #13: pybind11::cpp_function::dispatcher(_object*, _object*, _object*) + 2865 (0x115580ae1 in libtorch_python.dylib)\r\n<omitting python frames>\r\nframe #26: start + 1 (0x7fff62cdd3d5 in libdyld.dylib)\r\n']"
389,347,0,"cudnn 3d and 1d modules. we only added bindings for 2d modules. finish up.
Assigning to Sam.. []"
451,30627,0,"Everything under /usr/local/include is copied.. ## Bug

When I  to a custom location for packaging (previously set by ), I got everything under my  copied to this custom place.

This only happens on Ubuntu 18.04, and CentOS 7 seems fine with the same build script.
And I've only started to see this recently.
Builds from 2 weeks ago was still fine.

![image](https://user-images.githubusercontent.com/5203025/69997152-5ba9d580-1508-11ea-98c2-fa155ffc8d4e.png)

## Environment

 - PyTorch Version (e.g., 1.0): master
 - OS (e.g., Linux): Ubuntu 18.04 docker
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): cmake+ninja
 - Python version: 3.6.9 (system default)
 - CUDA/cuDNN version: 10.2


cc @ezyang @gchanan @zou3519. []"
347,18645,0,"c++ Windows  compile error . visual studio2017  ÔºõReference directory  O:\pytorch\libtorch\include\torch\csrc\api\include  
  O:\pytorch\libtorch\include   library directory O:\pytorch\libtorch\lib .... 
At the 101 of document rnn.h. There's a mistake.have error :cast to function type is illegal
 pytorch is https://download.pytorch.org/libtorch/cu100/libtorch-win-shared-with-deps-latest.zip
cuda is 10.0
windwos 10
visual studio 2017
release x64
cl.exe 14.16.27023


I think this is a compiler error. To this, there are Windows installation tutorials, you can compare the difference. Select the compilation environment and version.
. []"
669,23649,0,Installation with non-root access. When I run  it need root access to install the final package. How can I install that in user home (I mean user packages for pip)?. []
273,9853,0,"TestSequenceOps.test_gather_padding failing. reference(*inputs)threshold

Sample: https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-cuda9.0-cudnn7-aten-ubuntu16.04-test/4954/consoleText. []"
630,18083,0,"A common class in Linear, Conv, LSTM, ... . Hi,

Is there any class that all  inherit from that? 
I want to create a general , which has , so that later I can fill  with any type of layer that I want, e.g.,  Is there such a capability in the current API? This can be done easily in python, though here we need declaration and this hinders the python's easiness. 

Thanks,
Afshin
. []"
301,7944,0,"Better error message in DataChannelTCP::_receive. ## Issue description

The following code will produce an error from the TCP distributed backend:



Error:



This is a bit misleading, since the sizes of the tensors are the same but the types are different. I think it would be better to give a message along the lines of:



I'd be happy to submit a PR for this if others agree that the original message should be changed.. [""python\r\nimport os\r\nimport torch\r\nimport torch.distributed as dist\r\nimport sys\r\n\r\nos.environ['MASTER_ADDR'] = '127.0.0.1'\r\nos.environ['MASTER_PORT'] = '29500'\r\ndist.init_process_group('tcp', rank=int(sys.argv[1]), world_size=2)\r\n\r\n\r\nif dist.get_rank() == 0:\r\n\tt = torch.arange(9)\r\n\tdist.send(tensor=t, dst=1)\r\nelse:\r\n\tt = torch.zeros(9)\r\n\tdist.recv(tensor=t, src=0)\r\n"", '\r\nTraceback (most recent call last):\r\n  File ""/Users/shendrickson/pytorch_dist.py"", line 19, in <module>\r\n    dist.recv(tensor=t, src=0)\r\n  File ""/Users/shendrickson/anaconda2/envs/torchdev/lib/python3.6/site-packages/torch/distributed/__init__.py"", line 230, in recv\r\n    return torch._C._dist_recv(tensor, src)\r\nRuntimeError: Tensor sizes do not match\r\n', '\r\nRuntimeError: Expected to receive 72 bytes, but got 36 bytes instead. Are tensors of same size and type?\r\n']"
594,3946,0,"Any Pytorch function can work as Keras's ""TimeDistributed""?. In keras,there is a timedistributed function (https://github.com/fchollet/keras/blob/master/keras/layers/wrappers.py)  which can apply a layer to each temporal slice, I hope the author can develop a function like that.. []"
608,1752,0,"dockerfile: directory '.' is not installable. file 'setup.py' not found. I am using the dockerfile, but the there is an error: directory '.' is not installable. file 'setup.py' not found.

I believe it's located at the line ""pip install -v ."" Anyone know how to fix it? Thanks!. []"
254,31317,0,"[feature request] [onnx] Export torch.stft as Conv1d till ONNX supports stft op. As far as I understand, for the time being STFT [isn't natively supported by ONNX](https://github.com/onnx/onnx/blob/master/docs/Operators.md)
 
STFT can be exported as a Conv1d op with precomputed (windowed) Fourier basis: https://github.com/NVIDIA/mellotron/blob/master/stft.py

This is useful for tracking/exporting speech recongition models.

I've done a pure PyTorch version in https://github.com/vadimkantorov/convasr/blob/master/models.py#L315-L334 and it seems to work

cc @houseroad @spandantiwari @lara-hdr @BowenBao @neginraoof. []"
187,24062,0,"[quant] use qconfig_dict in graph mode. ## üöÄ Feature

Extend the initial implementation to use qconfig_dict,
Need scoping support, cc @ZolotukhinM. []"
164,3657,0,"No link to the previous version doc in master doc. http://pytorch.org/docs/master/
The link to switch doc is dead.

http://pytorch.org/docs/0.2.0/
Old versions are still available and the link is ok there.. []"
287,6257,0,"[feature request] adding a nonzero element ""in-place"" in sparse tensor. First mentioned here, but turns out to be non-existent. 
https://github.com/pytorch/pytorch/pull/6225#pullrequestreview-108887248

This operation would simply add a new index and a new value to a sparse tensor. 

cc @vincentqb @aocsa @nikitaved @pearu @mruberry. []"
377,28329,0,"No in-place version of where(). ## üöÄ Feature
There is no way to perform the functionality of  in-place. This feature would either add a  method to  or an  parameter to the existing , or both.

## Motivation

All of the usual reasons for doing operations in-place.

## Pitch

As stated above, add a  method to  or an  parameter to the existing .

## Alternatives

One could use the out-of-place  for a less efficient alternative.

Note that the  method does not have the same functionality as an in-place .
. []"
705,20875,0,"BatchNorm2d implementation returns different results than expected. ## üêõ Bug

As per https://pytorch.org/docs/stable/nn.html#torch.nn.BatchNorm2d I expect the result of BatchNorm2d to be (x - mean) * scale / sqrt(var + eps) + bias.  However this is not the case.

Given an already loaded BatchNorm2d module as bn0, I have the following:


## Environment
condapip`, source): pip
 - Python version: 3.5
 - CUDA/cuDNN version: 9.2 / 7.1.3
 - GPU models and configuration: 
 - Any other relevant information:
. [""\r\nweights = torch.load(model_dir + '29.pt')\r\n\r\nmodel.load_state_dict(weights)\r\nmodel = model.cuda()\r\nmodel = model.eval()\r\nbase = model.base\r\n# pull out the first batch norm instance in my base feature extractor network.\r\nbn0 = list(list(base.children())[0].children())[1]\r\n\r\nbias = bn0.bias[1].item() -> 0.27559953927993774\r\nscale = bn0.weight[1].item() ->  0.4519329071044922\r\nvar = bn0.running_var[1].item() -> 2088.339599609375\r\nmean = bn0.running_mean[1].item() -> -4.2851715087890625\r\n\r\nn = torch.Tensor(1,32, 2,2)\r\nn[...] = 1.0\r\ny0 = bn0(n.cuda())\r\ny0 = y0[0,1,0,0].item() -> 0.275604248046875\r\ny1 = (1.0 - mean) * scale / math.sqrt(var + bn0.eps) + bias -> 0.32786713069418427\r\n""]"
245,20402,0,"Tensor and nn.Module Pruning. ## üöÄ Tensor and nn.Module Pruning
Tensor method and/or  util to sparsify tensors and/or model, according to various pruning techniques in the literature. 

## Motivation
State-of-the-art deep learning techniques rely on over-parametrized models that are hard to deploy. On the contrary, biological neural networks are known to use efficient sparse connectivity. It's important to identify best techniques to compress models by reducing the number of parameters in them, in order to reduce memory, battery, and hardware consumption without sacrificing accuracy, deploy lightweight models on device, and guarantee privacy with private on-device computation. On the research front, pruning is used to investigate the differences in learning dynamics of over-parametrized and under-parametrized networks, to study the role of lucky sparse subnetworks and initializations (""lottery tickets"" [[1]](https://arxiv.org/abs/1803.03635)), as a destructive neural architecture search technique, and others.
Goal of this feature: harmonizing pruning practices by providing a standard interface in PyTorch.
Target audience: researchers, engineering and product teams.

## Pitch
Minimalist API, with deeper flexibility for power-users. 

At the tensor level, this could look as follows:

A not-in-place  method will return a  of the same type and size as the one it acts on.
In-place pruning supported via .

At the model level, this will require a bit of thinking but should follow similar API patterns. This is important because not all pruning methods make sense on all parameters in a model (pruning conv kernels != pruning biases != pruning RNNs != pruning in the presence of batch norm, etc.). 
First, we should have a sensible, well-documented default behavior for the average-user's API, where a call to  defaults to pruning PyTorch ""prepackaged"" modules (such as linear, conv, and recurrent layers) in some sensible, expected way. 
Most power users though would probably want to prune custom layers, or prune different layer types or layers at different depths using different pruning methods or pruning method parameters. This could be specified via a dictionary, which maps parameter names (contained in ) to a pruning method and its parameters: 


Similar to the tensor operations, model-level pruning could return a copy of the model, or act on the model in place.

Pruning methods can be used during or post- training; this implementation will be training-loop-agnostic: the user will have to take care of writing their own training loop to decide when to prune and what to do with the pruned object (re-initialize and retrain, finetune, etc.).

## Alternatives
Depending on where this will live within the codebase,  could also look like:  or . I personally would prefer the first option because the kwargs are parameters of the pruning method itself, while  is the tensor it acts on (some pruning methods will also have to take in some data  or  when they're applied), but the last option is more in line with how, say,  is implemented. Perhaps, for Module-level application, following the [example of the  implementation](https://pytorch.org/docs/stable/_modules/torch/nn/utils/weight_norm.html) using hooks will make this more PyTorch-y, but I don't know if we want to sacrifice the ability to act directly on a tensor that is not part of a Module. Would that go into ? Open to suggestions here.


cc @albanD @mruberry @jbschlosser. [""python\r\nt = torch.randn(3, 2, 4)\r\n# e.g.: randomly mask 6 entries\r\npruned_t = t.prune(method='random', amount=6)\r\n# e.g.: prune bottom 80% of entries by absolute value\r\npruned_t = t.prune(method='L1', amount=0.8)\r\n# e.g.: prune 50% of channels along the last dimension by L1 norm\r\npruned_t = t.prune(method='L1Structured', amount=0.5)\r\n# e.g.: prune 2 channels along the 0th dimension by L2 norm\r\npruned_t = t.prune(method='L2Structured', amount=2, axis=0)\r\n# e.g.: prune 1 channel along the last dimension by L0 norm\r\npruned_t = t.prune(method='LnStructured', n=0, amount=1)\r\n"", ""python\r\n{\r\n    'features.0.weight' : L1PruningMethod(amount=0.8),\r\n    ...\r\n}\r\n""]"
90,8154,1,"Performance drop on small models trained on CPU between 0.3.1 and 0.4. ## Issue description

Updating from Pytorch 0.3.1 to 0.4 yields a significant performance drop on small feedforward networks, trained **on CPU**. This effect happens on Linux (in a virtual machine) and on Windows.

The attached code was executed on a Windows 10 machine with an Intel i7-7700HQ.
The Linux test was done in a virtual machine. The computer is equipped with an Intel i7-4702MQ.

The average runtime over 10 repetitions on Linux is 26.141655 s for Pytorch 0.3.1 and 32.092158 s on 0.4  (~23 % increase)
The average runtime over 10 repetitions on Windows is 12.577887 s for Pytorch 0.3.1 and 17.759720 s on 0.4  (~41 % increase)

Observations: 
- The time difference between 0.3.1 and 0.4 seems to be more or less constant on both Windows and Linux. 
- Also profiling suggests the DataLoader __next__ takes 8 s instead of 4 s previously, a major part of the increased time
- Weirdly, in different calls of the script, the early stopping if-clause activates sometimes despire setting the pytorch seed as to avoid effects due to randomness

## Code example

See my results and the data/script used here:
[PytorchSpeedTest.zip](https://github.com/pytorch/pytorch/files/2071136/PytorchSpeedTest.zip)

## System Info

(the collect_env is not yet adapted to Windows, therefore information is missing. I am using pip 10.x and the latest conda)

PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 9.1

OS: Microsoft Windows 10 Home
GCC version: Could not collect
CMake version: Could not collect

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.1.85
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect

- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): all conda (Windows 0.3.1. via conda install -c peterjc123 pytorch-cpu)
- OS: Windows 10 / Ubuntu 16.04 
- PyTorch version: 0.3.1 to 0.4
- Python version: 3.6

## Bottleneck Profiling
0.4


### cProfile
0.3.1

 . [""\r\n--------------------------------------------------------------------------------\r\n  cProfile output\r\n--------------------------------------------------------------------------------\r\n         12550526 function calls (12252338 primitive calls) in 21.593 seconds\r\n\r\n   Ordered by: internal time\r\n   List reduced from 334 to 15 due to restriction <15>\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    31780    4.498    0.000    4.498    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}\r\n    84840    2.774    0.000    2.774    0.000 {built-in method stack}\r\n  3049200    2.219    0.000    2.219    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\utils\\data\\dataset.py:40(<genexpr>)\r\n    31780    1.347    0.000    3.899    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\optim\\adam.py:48(step)\r\n   127260    1.217    0.000    1.217    0.000 {built-in method addmm}\r\n  1016400    0.866    0.000    3.085    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\utils\\data\\dataset.py:39(__getitem__)\r\n   190680    0.593    0.000    0.593    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}\r\n296940/84840    0.566    0.000    3.832    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py:485(__call__)\r\n   381360    0.557    0.000    0.557    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}\r\n    84840    0.553    0.000    0.553    0.000 {built-in method torch._C._nn.threshold}\r\n    42560    0.532    0.000    8.012    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py:261(__next__)\r\n        1    0.511    0.511   21.593   21.593 .\\pytorch.0.4.py:1(<module>)\r\n   381360    0.470    0.000    0.470    0.000 {method 'add_' of 'torch._C._TensorBase' objects}\r\n    42560    0.438    0.000    0.603    0.000 C:\\Users\\Jan\\Miniconda3\\lib\\site-packages\\torch\\utils\\data\\sampler.py:136(__iter__)\r\n   190680    0.421    0.000    0.421    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}\r\n\r\n\r\n--------------------------------------------------------------------------------\r\n  autograd profiler output (CPU mode)\r\n--------------------------------------------------------------------------------\r\n        top 15 events sorted by cpu_time_total\r\n\r\n----------------------  ---------------  ---------------  ---------------  ---------------  ---------------\r\nName                           CPU time        CUDA time            Calls        CPU total       CUDA total\r\n----------------------  ---------------  ---------------  ---------------  ---------------  ---------------\r\nstack                         475.169us          0.000us                1        475.169us          0.000us\r\nstack                         415.362us          0.000us                1        415.362us          0.000us\r\nstack                         388.741us          0.000us                1        388.741us          0.000us\r\nstack                         381.812us          0.000us                1        381.812us          0.000us\r\nstack                         378.531us          0.000us                1        378.531us          0.000us\r\nstack                         371.966us          0.000us                1        371.966us          0.000us\r\nThresholdBackward0            370.507us          0.000us                1        370.507us          0.000us\r\nthreshold_backward            369.049us          0.000us                1        369.049us          0.000us\r\nAddmmBackward                 358.473us          0.000us                1        358.473us          0.000us\r\nstack                         350.815us          0.000us                1        350.815us          0.000us\r\nmm                            347.169us          0.000us                1        347.169us          0.000us\r\nselect                        343.887us          0.000us                1        343.887us          0.000us\r\nadd_                          340.239us          0.000us                1        340.239us          0.000us\r\nunsqueeze                     339.511us          0.000us                1        339.511us          0.000us\r\naddmm                         335.864us          0.000us                1        335.864us          0.000us\r\n"", "" \r\n 12819090 function calls (12546756 primitive calls) in 14.661 seconds\r\n\r\n   Ordered by: internal time\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    28602    3.038    0.000    3.038    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}\r\n  1829520    1.041    0.000    1.041    0.000 {method 'unsqueeze' of 'torch._C.FloatTensorBase' objects}\r\n    28602    0.855    0.000    2.765    0.000 adam.py:31(step)\r\n   114534    0.854    0.000    0.854    0.000 {built-in method torch._C.addmm}\r\n   914760    0.616    0.000    0.616    0.000 dataset.py:42(__getitem__)\r\n   171612    0.504    0.000    0.504    0.000 {method 'sqrt' of 'torch._C.FloatTensorBase' objects}\r\n   171612    0.468    0.000    0.468    0.000 {method 'addcdiv_' of 'torch._C.FloatTensorBase' objects}\r\n    38304    0.466    0.000    0.917    0.000 sampler.py:117(__iter__)\r\n        1    0.454    0.454   14.661   14.661 pytorch.0.3.1.py:1(<module>)\r\n267246/76356    0.438    0.000    3.045    0.000 module.py:351(__call__)\r\n   343224    0.437    0.000    0.437    0.000 {method 'mul_' of 'torch._C.FloatTensorBase' objects}\r\n    76356    0.431    0.000    0.431    0.000 {built-in method torch._C._nn.threshold}\r\n114534/38178    0.421    0.000    2.340    0.000 dataloader.py:99(default_collate)\r\n    38304    0.272    0.000    4.413    0.000 dataloader.py:256(__next__)\r\n    76356    0.270    0.000    0.270    0.000 {built-in method torch._C.cat}\r\n""]"
591,11757,0,"Unable to build PyTorch from source without NumPy support. ## Issue description

So far, all the builds in the CI have had NumPy support, meaning that this issue has not been exposed in its entirety yet.

I tried to build PyTorch without NumPy support, and it wasn't possible at first. Editing  made sense to accomplish this, but then it seems that Caffe2 requires NumPy support.

This is the error I got after (almost) building PyTorch.


## Code example

This is what I did to the  file:

## System Info
- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): source
- Build command you used (if compiling from source): 
- OS: Ubuntu 18.04.1
- Python version: 3.7
- GCC version (if compiling from source): 7.3
- CMake version: 3.11.3
- Versions of any other relevant libraries: None
. ['bash\r\nIn file included from /media/vishwak/Official/Projects/pytorch/caffe2/python/pybind_state.cc:1:0:\r\n/media/vishwak/Official/Projects/pytorch/caffe2/python/pybind_state.h:24:10: fatal error: numpy/arrayobject.h: No such file or directory\r\n #include <numpy/arrayobject.h>\r\n          ^~~~~~~~~~~~~~~~~~~~~\r\ncompilation terminated.\r\n', 'diff\r\ndiff --git a/cmake/Dependencies.cmake b/cmake/Dependencies.cmake\r\nindex dbec0d07e..c8dafb23e 100644\r\n--- a/cmake/Dependencies.cmake\r\n+++ b/cmake/Dependencies.cmake\r\n@@ -397,9 +397,12 @@ if(BUILD_PYTHON)\r\n   set(Python_ADDITIONAL_VERSIONS 3.7 3.6 3.5 2.8 2.7 2.6)\r\n   find_package(PythonInterp 2.7)\r\n   find_package(PythonLibs 2.7)\r\n-  find_package(NumPy REQUIRED)\r\n-  if(PYTHONINTERP_FOUND AND PYTHONLIBS_FOUND AND NUMPY_FOUND)\r\n-    include_directories(SYSTEM ${PYTHON_INCLUDE_DIR} ${NUMPY_INCLUDE_DIR})\r\n+  find_package(NumPy)\r\n+  if(PYTHONINTERP_FOUND AND PYTHONLIBS_FOUND)\r\n+    include_directories(SYSTEM ${PYTHON_INCLUDE_DIR})\r\n+    if(NUMPY_FOUND)\r\n+      include_directories(SYSTEM ${NUMPY_INCLUDE_DIR})\r\n+    endif()\r\n     # Observers are required in the python build\r\n     caffe2_update_option(USE_OBSERVERS ON)\r\n   else()\r\n']"
426,16806,0,"storage_initialized() ASSERT FAILED when I execute tensor.resize_(-1). ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

When I execute , I get a run-time error message that tells me to report the bug: . Because  is not a valid argument to , it is reasonable that we get an error. However, the above error message seems to suggest that this error is not handled properly in the source code.  

## To Reproduce

Steps to reproduce the behavior:

1. 
2. 
3. 

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

A proper error message should have been issued. 

## Environment

 - PyTorch Version (e.g., 1.0): 1.0.0
 - OS (e.g., Linux): Windows 10
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source): N/A
 - Python version: 3.6.2
 - CUDA/cuDNN version: N/A
 - GPU models and configuration: N/A
 - Any other relevant information: N/A
. []"
191,25117,0,"Nvidia driver & cudatoolkit installed properly but check_driver fails. I have successfully installed NVIDIA driver & cudatoolkit via conda. However, I am not able to use cuda in pytorch (even though it installed successfully). 

Previously, I was using Pytorch with CUDA 8.0, and wanted to upgrade. I removed / purge all CUDA through:


 
Then I updated my Nvidia drivers to 4.10 via PPA (Ubuntu 16.04):



Everything worked smoothly. The output of :


The output of 


Since I wanted conda to manage my CUDA version, I installed the cudatoolkit through conda env (python 3.6):



again, everything installs perfectly. When I run:

but using cuda fails. I get the following error message




I restarted, removed all irrelevant environment variables which may have caused issues (LD_LIBRARY_PATH), removed conda, reinstalled, tried cuda 9.2, but nothing works. I am not sure what the issue could be. Any ideas?

I searched a bit, and found [this](https://discuss.pytorch.org/t/found-no-nvidia-driver-on-your-system-but-its-there/35063) pytorch thread. Since I completely removed CUDA from my system this shouldn't be the problem, but I think somehow it may be related. 

**EDIT:**
It isn't surprising given my error, but following [this issue](https://github.com/pytorch/pytorch/issues/4546), I checked:
. ['\r\nsudo apt-get --purge remove cuda\r\nsudo apt-get autoremove\r\ndpkg --list |grep ""^rc"" | cut -d "" "" -f 3 | xargs sudo dpkg --purge\r\n', '\r\nsudo add-apt-repository ppa:graphics-drivers/ppa\r\nsudo apt-get update\r\nsudo apt-get install nvidia-410\r\n', '\r\nFri Aug 23 22:29:48 2019       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 410.78       Driver Version: 410.78       CUDA Version: N/A      |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 108...  Off  | 00000000:01:00.0  On |                  N/A |\r\n| 25%   35C    P8    13W / 250W |    531MiB / 11177MiB |      1%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|===https://stackoverflow.com/questions/54264338/why-does-pytorch-not-find-my-nvdia-drivers-for-cuda-support==========================================================================|\r\n|    0      1445      G   /usr/lib/xorg/Xorg                           317MiB |\r\n|    0      2035      G   compiz                                       101MiB |\r\n|    0      3572      G   ...uest-channel-token=13099850080781834209   110MiB |\r\n+-----------------------------------------------------------------------------+\r\n', '\r\nNVRM version: NVIDIA UNIX x86_64 Kernel Module  410.78  Sat Nov 10 22:09:04 CST 2018\r\nGCC version:  gcc version 4.9.4 (Ubuntu 4.9.4-2ubuntu1~16.04)\r\n', '\r\nprint(torch.cuda.device_count()) # --> 0\r\nprint(torch.version.cuda) # --> 10.0.130\r\n', '\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/home/rana/anaconda3/envs/py36torch12cu10/lib/python3.6/site-packages/torch/cuda/__init__.py"", line 178, in _lazy_init\r\n    _check_driver()\r\n  File ""/home/rana/anaconda3/envs/py36torch12cu10/lib/python3.6/site-packages/torch/cuda/__init__.py"", line 99, in _check_driver\r\n    http://www.nvidia.com/Download/index.aspx"""""")\r\nAssertionError: \r\nFound no NVIDIA driver on your system. Please check that you\r\nhave an NVIDIA GPU and installed a driver from\r\nhttp://www.nvidia.com/Download/index.aspx\r\n']"
215,630,0,Add Peephole connections for LSTMs?. From this [paper](http://www.jmlr.org/papers/volume3/gers02a/gers02a.pdf). Peephole connections seem to help in learning precise timings of events.. []
433,27512,0,"[JIT] floordiv not bound to tensor. ## üêõ Bug

floordiv is only bound for int, not tensor, which results in an incorrectly inserted cast..


cc @suo. ['\r\ndef test(pos):\r\n    return pos // 2\r\n\r\ninput = torch.tensor(4)\r\nprint(test(input)\r\n# tensor(2)\r\nprint(torch.jit.script(test)(input))\r\n# 2\r\n']"
193,15866,0,"Casting to and from at::Half on CPU is not supported yet. Traceback (most recent call last):
  File ""/home/tcl/PycharmProjects/caffe2/mnist_caffe2.py"", line 278, in <module>
    workspace.CreateNet(train_model.net, overwrite=False)
  File ""/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py"", line 171, in CreateNet
    StringifyProto(net), overwrite,
  File ""/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py"", line 197, in CallWithExceptionIntercept
    return func(*args, **kwargs)
RuntimeError: [enforce fail at cast_op.cc:69] . Casting to and from at::Half on CPU is not supported yet
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, void const*) + 0x78 (0x7f234572e408 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libc10.so)
frame #1: <unknown function> + 0x1636612 (0x7f2346f74612 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #2: <unknown function> + 0x163e3c8 (0x7f2346f7c3c8 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #3: <unknown function> + 0x163e55e (0x7f2346f7c55e in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #4: std::_Function_handler<std::unique_ptr<caffe2::OperatorBase, std::default_delete<caffe2::OperatorBase> > (caffe2::OperatorDef const&, caffe2::Workspace*), std::unique_ptr<caffe2::OperatorBase, std::default_delete<caffe2::OperatorBase> > (*)(caffe2::OperatorDef const&, caffe2::Workspace*)>::_M_invoke(std::_Any_data const&, caffe2::OperatorDef const&, caffe2::Workspace*&&) + 0x23 (0x7f2348971803 in /usr/local/lib/python2.7/dist-packages/caffe2/python/caffe2_pybind11_state.so)
frame #5: <unknown function> + 0x13efc1c (0x7f2346d2dc1c in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #6: <unknown function> + 0x13f2aaa (0x7f2346d30aaa in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #7: caffe2::CreateOperator(caffe2::OperatorDef const&, caffe2::Workspace*, int) + 0x3b9 (0x7f2346d30f29 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #8: caffe2::SimpleNet::SimpleNet(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x295 (0x7f2346d27b75 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #9: <unknown function> + 0x13ebf2e (0x7f2346d29f2e in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #10: <unknown function> + 0x13ce563 (0x7f2346d0c563 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #11: caffe2::CreateNet(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x47d (0x7f2346cffc4d in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #12: caffe2::Workspace::CreateNet(std::shared_ptr<caffe2::NetDef const> const&, bool) + 0xfd (0x7f2346d6e1dd in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #13: caffe2::Workspace::CreateNet(caffe2::NetDef const&, bool) + 0x91 (0x7f2346d6f371 in /usr/local/lib/python2.7/dist-packages/caffe2/python/../../torch/lib/libcaffe2.so)
frame #14: <unknown function> + 0x4e616 (0x7f234896a616 in /usr/local/lib/python2.7/dist-packages/caffe2/python/caffe2_pybind11_state.so)
frame #15: <unknown function> + 0x4e8dc (0x7f234896a8dc in /usr/local/lib/python2.7/dist-packages/caffe2/python/caffe2_pybind11_state.so)
frame #16: <unknown function> + 0x86831 (0x7f23489a2831 in /usr/local/lib/python2.7/dist-packages/caffe2/python/caffe2_pybind11_state.so)
frame #17: PyEval_EvalFrameEx + 0x695b (0x55e76d2878db in /usr/bin/python2.7)
frame #18: PyEval_EvalCodeEx + 0x6da (0x55e76d27ed0a in /usr/bin/python2.7)
frame #19: PyEval_EvalFrameEx + 0x5cb8 (0x55e76d286c38 in /usr/bin/python2.7)
frame #20: PyEval_EvalCodeEx + 0x6da (0x55e76d27ed0a in /usr/bin/python2.7)
frame #21: PyEval_EvalFrameEx + 0x567e (0x55e76d2865fe in /usr/bin/python2.7)
frame #22: PyEval_EvalCodeEx + 0x6da (0x55e76d27ed0a in /usr/bin/python2.7)
frame #23: PyEval_EvalCode + 0x19 (0x55e76d27e629 in /usr/bin/python2.7)
frame #24: <unknown function> + 0x12461f (0x55e76d2af61f in /usr/bin/python2.7)
frame #25: PyRun_FileExFlags + 0x82 (0x55e76d2aa322 in /usr/bin/python2.7)
frame #26: PyRun_SimpleFileExFlags + 0x18d (0x55e76d2a967d in /usr/bin/python2.7)
frame #27: Py_Main + 0x68b (0x55e76d2581ab in /usr/bin/python2.7)
frame #28: __libc_start_main + 0xe7 (0x7f2367bf4b97 in /lib/x86_64-linux-gnu/libc.so.6)
frame #29: _start + 0x2a (0x55e76d257a2a in /usr/bin/python2.7). []"
360,11978,0,"[Caffe2] Attempting to install Caffe2 in Google Colab. ## Issue description

Hello, I'm trying to install Caffe2 in Google Colab so I can work with Detectron.
I've tried installing from Source however it takes too long (more than 2 hours) so it is impractical for Colab. Thus, I'm forced to install from binaries using Anaconda.

I install anaconda without much issues.



However, I'm trying to follow the [recommendation](https://caffe2.ai/docs/faq.html#why-is-caffe2-not-working-as-expected-in-anaconda) to install Caffe2 on a different environment than the base one.
I manage to create the environment just fine, however, trying to activate it does not work. In particular using:  seems to do nothing. So it seems that's out.

So, I go and install Caffe2 using the base anaconda environment. First, I have to add some code to add the anaconda binaries to the PATH, as it seems the usual way to assign environmental variables in Colab seem to not work.

Then installation as usual:


It installs without any issues. However, when trying to run the test code:

It returns:


I understand this is probably some PYTHONPATH [issue](https://github.com/facebookresearch/Detectron/blob/master/INSTALL.md#caffe2), however, I can't seem to find the ""build"" folder in caffe2.
If I search for caffe2 directory ()  after installing I only get the following results:

If I search in the directories of each result I get:

ls /root/anaconda2/pkgs/caffe2-cuda9.0-cudnn7-0.8.dev-py27_2018.08.26/lib/python2.7/site-packages/caffe2:

ls /root/anaconda2/pkgs/caffe2-cuda9.0-cudnn7-0.8.dev-py27_2018.08.26/include/caffe2:

ls /root/anaconda2/lib/python2.7/site-packages/caffe2:

ls /root/anaconda2/include/caffe2:

None of them has a build directory.

So finally I have some questions:

- **Was the Caffe2 installation successful?** I wonder given that I cannot find the 'build' directory.
- **Is this only a PYTHONPATH variable issue?** If so, to which folder should I point it?

I'm sorry if the question is noobish. But I'm a bit stuck. Thanks in advance!

### System Settings

- PyTorch or Caffe2: Caffe2
- How you installed PyTorch (conda, pip, source): conda
- Build command you used (if compiling from source):
- OS: Linux, whatever Colab's using.
- PyTorch version:
- Python version: 2.7
- CUDA/cuDNN version: 9.0 and 7.0
- GPU models and configuration:  Tesla K80
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. ['\r\nimport os\r\nos.environ[\'PATH\'] += "":/root/anaconda2/bin""\r\n', ""\r\n# To check if Caffe2 build was successful\r\npython2 -c 'from caffe2.python import core'\r\n\r\n"", '\r\nTraceback (most recent call last):\r\n  File ""<string>"", line 1, in <module>\r\nImportError: No module named caffe2.python\r\n', '\r\n/root/anaconda2/pkgs/caffe2-cuda9.0-cudnn7-0.8.dev-py27_2018.08.26/lib/python2.7/site-packages/caffe2\r\n/root/anaconda2/pkgs/caffe2-cuda9.0-cudnn7-0.8.dev-py27_2018.08.26/include/caffe2\r\n/root/anaconda2/lib/python2.7/site-packages/caffe2\r\n/root/anaconda2/include/caffe2\r\n', '\r\ncontrib  distributed  __init__.py   perfkernels  python\r\ncore\t experiments  __init__.pyc  proto\r\n', '\r\ncontrib   distributed  mkl\t  onnx\t       predictor  sgd\t      video\r\ncore\t  experiments  mobile\t  operators    proto\t  share\r\ncuda_rtc  ideep        mpi\t  opt\t       python\t  transforms\r\ndb\t  image        observers  perfkernels  queue\t  utils\r\n', '\r\ncontrib  distributed  __init__.py   perfkernels  python\r\ncore\t experiments  __init__.pyc  proto\r\n', '\r\ncontrib   distributed  mkl\t  onnx\t       predictor  sgd\t      video\r\ncore\t  experiments  mobile\t  operators    proto\t  share\r\ncuda_rtc  ideep        mpi\t  opt\t       python\t  transforms\r\ndb\t  image        observers  perfkernels  queue\t  utils\r\n']"
398,15764,0,"torch.argsort descends wrongly. ## üêõ Bug
given a large amount of numbers (say, a list containing 32768 numbers), I found that the argsort behaves wrongly when setting the descend=False.
## To Reproduce
I want to calculate the similarity of word embeddings, and I managed to achieve that by batched-similarity calculation. I expect the most similarity to an embedding should be itself, thus the highest rank should be 1,2... accordingly, and vice versa. 
now say we have torch.tensor object  (in shape batch_size * 32768), I want to extract top similarities along the last dimension.

the code gives the result of:

> get_top = torch.argsort(similarity, dim=1)
> [20485, 30807, 27706,  ...,   117,     6,     **1**],
>  [29628, 16835, 23989,  ...,  6773, 10377,     **2**],
>    ...,
>  [30120, 23853, 24914,  ...,   118,    50,    **47**],
>  [23528, 23663, 25283,  ...,    78,    77,    **48**],
>  [31738, 17062, 29731,  ...,  1240,    79,    **49**]

while:

> top8 = torch.argsort(similarity, dim=1, descending=True)
> tensor([[**21820**, 21822, 21816,  ..., 10909, 10910, 32725],
>         [**32497**, 28158, 20713,  ..., 14889, 12632, 16177],
>         [**17110**, 17460, 18861,  ..., 14628, 12113,    18],
>         ...,
>         [**22335**, 21440, 26360,  ..., 14870,  8292, 13842],
>         [**20379**, 16479, 28973,  ..., 11770, 11327, 13454],
>         [**23388**, 19492, 16577,  ...,  7874,  5219, 13230]])
the bold part implys the main problems. and I assume it's not simply because of the accuracy of float numebrs.
## Expected behavior
> top8 = torch.argsort(similarity, dim=1, descending=True)
> tensor([
>         [**1**,  blablabla ],
>         [**2**, blablabla],
>         ...,
>         [**47**, blablabla],
>         [**48**, blablabla],
>         [**49**, blablabla]])
<!-- A clear and concise description of what you expected to happen. -->

## Environment
 - PyTorch Version: 1.0 stable
 - OS (e.g., Linux): Linux
 - How you installed PyTorch (, , source): pip install
 - Python version: 3.6.3

. ['\r\nget_top = torch.argsort(similarity, dim=1)\r\nget_top = torch.argsort(similarity, dim=1, descending=True) \r\n']"
160,25515,0,"ONNX export failed on ATen operator upsample_bilinear2d. ## üêõ Bug

When I use torch.onnx.export , I met opset support problem:


## To Reproduce

Steps to reproduce the behavior:

1. pytorch inference file
2. change the output to onnx.export

## Environment

 - PyTorch Version (e.g., 1.0): 1.2
 - OS (e.g., Linux): Centos
 - How you installed PyTorch (, , source): Conda
 - Build command you used (if compiling from source): 
 - Python version: 3.7.3
 - CUDA/cuDNN version: 10/7.6
 - Any other relevant information: pytorch model is trained by pytorch 1.0.0
. ['\r\n/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py:562: UserWarning: ONNX export failed on ATen operator upsample_bilinear2d because torch.onnx.symbolic_opset9.upsample_bilinear2d does not exist\r\n  .format(op_name, opset_version, op_name))\r\nTraceback (most recent call last):\r\n  File ""convertPytorch2ONNX.py"", line 54, in <module>\r\n    torch_out = torch.onnx.export(senetModel, input_var, sys.argv[4], export_params=True, verbose=True, input_names=input_names, output_names=output_names)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/__init__.py"", line 132, in export\r\n    strip_doc_string, dynamic_axes)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 64, in export\r\n    example_outputs=example_outputs, strip_doc_string=strip_doc_string, dynamic_axes=dynamic_axes)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 329, in _export\r\n    _retain_param_name, do_constant_folding)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 225, in _model_to_graph\r\n    _disable_torch_constant_prop=_disable_torch_constant_prop)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 127, in _optimize_graph\r\n    graph = torch._C._jit_pass_onnx(graph, operator_export_type)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/__init__.py"", line 163, in _run_symbolic_function\r\n    return utils._run_symbolic_function(*args, **kwargs)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 563, in _run_symbolic_function\r\n    op_fn = sym_registry.get_registered_op(op_name, \'\', opset_version)\r\n  File ""/export/liuxiao/local/anaconda3/lib/python3.7/site-packages/torch/onnx/symbolic_registry.py"", line 91, in get_registered_op\r\n    return _registry[(domain, version)][opname]\r\nKeyError: \'upsample_bilinear2d\'\r\n']"
439,31248,0,"RuntimeError: cholesky_cuda: For batch 0: U(6,6) is zero, singular U.. ## üêõ Bug when using 
Hi, I always get this RuntimeError during my training process:

##  Reproduce
There is a KL-loss term in my loss function, and I assume the two distributions are multivariate normal distributions, so I calculated it as follows:

## Environment
Here is my package version:
 - PyTorch 1.3.1  
 - Ubuntu 18.04
 - CUDA 9.2.148 with cuDNN 7.6.3_0 

## Additional 
I find my KL-loss falls in the range from 1e-6 to 1e-5.

 Any ideas to solve this problem? thx
. ['\r\nFile ""train.py"", line 121, in train\r\n    loss_kl = kl_loss(mu, logvar, VAE_mu, VAE_logvar)\r\n  File ""/home/jessica/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py"", line 541, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/home/jessica/anomaly_detection/ours/loss/losses.py"", line 70, in forward\r\n    p = torch.distributions.MultivariateNormal(p_mu, p_var)\r\n  File ""/home/jessica/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/distributions/multivariate_normal.py"", line 149, in __init__\r\n    self._unbroadcasted_scale_tril = torch.cholesky(covariance_matrix)\r\nRuntimeError: cholesky_cuda: For batch 0: U(6,6) is zero, singular U.\r\n', '\r\nclass KL_Loss(nn.Module):\r\n\tdef __init__(self):\r\n\t\tsuper(KL_Loss, self).__init__()\r\n\r\n\tdef forward(self, p_mu, p_log_var, q_mu, q_log_var):\r\n\t\t# [batch_size,d]  d is the dimension of my multivariate gaussian distribution\r\n\t\tassert q_mu.size() == p_mu.size()\r\n\t\tassert q_log_var.size() == p_log_var.size()\r\n\r\n\t\t# suppose the Neural Network esitimate log_var \r\n\t\tq_var = torch.diag_embed(torch.exp(q_log_var))\r\n\t\tp_var = torch.diag_embed(torch.exp(p_log_var))\r\n\t\t\r\n\t\tp = torch.distributions.MultivariateNormal(p_mu, p_var)\r\n\t\tq = torch.distributions.MultivariateNormal(q_mu, q_var)\r\n\t\tkl_loss = torch.distributions.kl_divergence(p, q).mean()\r\n\r\n\t\treturn kl_loss\r\n']"
222,18701,0,"[MSVC] Caffe2-Debug Static Size Too Big LNK1248. ## üêõ Bug

pytorch-Debug-build\lib\Debug\caffe2-Debug.lib: fatal error LNK1248: image size (10007FE9E) exceeds maximum allowable size (FFFFFFFF)
## To Reproduce

Steps to reproduce the behavior:

1. Compile latest master on Windows as static

## Expected behavior

Links

## Environment

 - PyTorch Version (e.g., 1.0): master
 - OS (e.g., Linux): Windows
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): cmake -DUSE_CUDA=ON -DBUILD_SHARED_LIBS=OFF
 - Python version: 3.7
 - CUDA/cuDNN version: 10.1
 - GPU models and configuration: GTX 1060
 - Any other relevant information:

## Additional context

Did not have this issue in 1.0.1 but perhaps size has just gone over the threshold.

It appears MSVC has a 4GB code/data file size limit. I'm sure there's a workaround.
Although, Microsoft says to split up the library: https://developercommunity.visualstudio.com/content/problem/332991/static-lib-4gb-file-size-limit-lnk1248-image-size.html. []"
706,957,0,"Counter-intuitive behavior of expand and arithmetic op. I don't know if this is a bug (and it might have been reported already but I didn't find anything).
But it could at least be added to the documentation for the  operation on a tensor:

Even if you are aware that expand doesn't copy data, I believe most will find this result quite counter-intuitive. Of course, this can be fixed atm either by replacing  by  or  by , but that requires more memory. It would be awesome if the arithmetic ops like  had a special case when the tensor's  is 0 in some dimension

Edit: My torch version string is . ['python\r\nimport torch\r\nT = torch.Tensor([2]).expand(1,3)\r\nprint(T.mul_(2))  # expected a Tensor with [4 4 4] here, got [16, 16, 16]\r\n']"
435,1829,0,"cuda out of memory with size 1 tensor. Hi, I have just built pytorch on OS X with CUDA support.

I'm having some trouble using CUDA features as it seems to run out of memory even with a size 1 tensor.


My laptop is fairly old, with an NVIDIA GeForce GT 650M 1024 MB. CUDA version is 8.0. Torch version is . OS X is 10.12.4. I am using Python 3.5.3 with Anaconda.. [""\r\nipython --pylab\r\nPython 3.5.3 |Continuum Analytics, Inc.| (default, Mar  6 2017, 12:15:08)\r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 6.1.0 -- An enhanced Interactive Python. Type '?' for help.\r\nUsing matplotlib backend: MacOSX\r\n\r\nIn [1]: import torch\r\n\r\nIn [2]: torch.cuda.current_device()\r\nOut[2]: 0\r\n\r\nIn [3]: torch.cuda.device_count()\r\nOut[3]: 1\r\n\r\nIn [4]: torch.cuda.FloatTensor([1])\r\nTHCudaCheck FAIL file=/Users/scheibler/sandbox/pytorch/torch/lib/THC/generic/THCStorage.cu line=66 error=2 : out of memory\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-4-8352503114b9> in <module>()\r\n----> 1 torch.cuda.FloatTensor([1])\r\n\r\n~/anaconda/envs/python3/lib/python3.5/site-packages/torch/cuda/__init__.py in _lazy_new(cls, *args, **kwargs)\r\n    267     # We need this method only for lazy init, so we can remove it\r\n    268     del _CudaBase.__new__\r\n--> 269     return super(_CudaBase, cls).__new__(cls, *args, **kwargs)\r\n    270\r\n    271\r\n\r\nRuntimeError: cuda runtime error (2) : out of memory at /Users/scheibler/sandbox/pytorch/torch/lib/THC/generic/THCStorage.cu:66\r\n""]"
535,30400,0,"miniz is missing in .gitmodule. ## üêõ Bug

miniz is missing in .gitmodule but there is miniz in the third_party

Steps to reproduce the behavior:

1.sync the lastest PyTorch code;
1.run build
1.report 'caffe2/CMakeList.txt missing miniz'

It seems that .gitmodule does NOT match third_party completely?
. []"
568,24958,0,"In Sparse Adam, initialize state['exp_avg']  and state['exp_avg_sq'] during optimizer initialization, not after step. ## üöÄ Feature
In the Sparse Adam optimizer, [ https://github.com/pytorch/pytorch/blob/master/torch/optim/sparse_adam.py ]

The 'exp_avg' and 'exp_avg_sq' are only initialized after the first step is taken. And then after each step, there is a check of if the state hasn't been initialized. Compare this to adagrad https://github.com/pytorch/pytorch/blob/master/torch/optim/adagrad.py ], where 'sum' is initialized when the optimizer is initialized. Is there any reason for this? 

## Motivation

For those doing manipulations of 'exp_avg' and 'exp_avg_sq', the code would be clearer if they didn't have to run the first step before coding the manipulators. 

Also, unless I am missing something, the code would seem more cleaner if the state was initialized during the optimizer init, instead of checking if it's been initiated already during each step, though there's probably no performance reduction in the way it's currently coded. 

## Pitch

Move 


to the  __init__ method. 


## Additional context

Here's a full code sample




If there is agreement on this, I already created a pull request, here 

https://github.com/pytorch/pytorch/pull/24960

cc @vincentqb. [""\r\n\t                    state['step'] = 0\r\n                    # Exponential moving average of gradient values\r\n                    state['exp_avg'] = torch.zeros_like(p.data)\r\n                    # Exponential moving average of squared gradient values\r\n                    state['exp_avg_sq'] = torch.zeros_like(p.data)\r\n"", '\r\ndef __init__(self, params, lr=1e-3, betas=(0.9, 0.999), eps=1e-8):\r\n        if not 0.0 < lr:\r\n            raise ValueError(""Invalid learning rate: {}"".format(lr))\r\n        if not 0.0 < eps:\r\n            raise ValueError(""Invalid epsilon value: {}"".format(eps))\r\n        if not 0.0 <= betas[0] < 1.0:\r\n            raise ValueError(""Invalid beta parameter at index 0: {}"".format(betas[0]))\r\n        if not 0.0 <= betas[1] < 1.0:\r\n            raise ValueError(""Invalid beta parameter at index 1: {}"".format(betas[1]))\r\n        defaults = dict(lr=lr, betas=betas, eps=eps)\r\n        super(SparseAdam, self).__init__(params, defaults)\r\n\r\n\tfor group in self.param_groups:\r\n            for p in group[\'params\']:\r\n                state = self.state[p]\r\n                state[\'exp_avg\'] = torch.zeros_like(p.data)\r\n                    # Exponential moving average of squared gradient values\r\n                state[\'exp_avg_sq\'] = torch.zeros_like(p.data)\r\n\r\n    def step(self, closure=None):\r\n        """"""Performs a single optimization step.\r\n        Arguments:\r\n            closure (callable, optional): A closure that reevaluates the model\r\n                and returns the loss.\r\n        """"""\r\n        loss = None\r\n        if closure is not None:\r\n            loss = closure()\r\n\r\n        for group in self.param_groups:\r\n            for p in group[\'params\']:\r\n                if p.grad is None:\r\n                    continue\r\n                grad = p.grad.data\r\n                if not grad.is_sparse:\r\n                    raise RuntimeError(\'SparseAdam does not support dense gradients, please consider Adam instead\')\r\n\r\n                state[\'step\'] += 1\r\n\r\n                grad = grad.coalesce()  # the update is non-linear so indices must be unique\r\n                grad_indices = grad._indices()\r\n                grad_values = grad._values()\r\n                size = grad.size()\r\n\r\n']"
516,14967,0,"ONNX - Pytorch-1.0 with Cuda-10.0. ONNX Export core dumps on GPU machine. ## üêõ Bug

Pytorch-1.0-Cuda-10.0 with ONNX-1.2.1 and 1.3.0. Export onnx model core dumps on Ubuntu on GPU instance

## To Reproduce

 Steps to reproduce the behavior:
 
Spin up an Ubuntu with GPU instance like EC2 p2 or g3
 
1. install Cuda-10, cudnn-7.4.1, NCCL-2.3.7
2. anaconda
2. conda create -n pytorch_p27 python=2.7
3. conda install pytorch=1.0.0=py2.7_cuda10.0.130_cudnn7.4.1_1 torchvision=0.2.1 cuda100=1.0 -c pytorch
4. pip install -U onnx==1.2.1 or 1.3.0
 
example used to replicate:
https://github.com/onnx/tutorials/blob/master/tutorials/PytorchOnnxExport.ipynb
 
Error:
Illegal instruction (core dumped)



## Expected behavior

It should have exported a .onnx file with the model

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130
 
OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1
 
Python version: 2.7
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration:
GPU 0: Tesla M60
GPU 1: Tesla M60
GPU 2: Tesla M60
GPU 3: Tesla M60
 
Nvidia driver version: 410.79
cuDNN version: Probably one of the following:
/usr/local/cuda-10.0/lib64/libcudnn.so.7.4.1
/usr/local/cuda-10.0/lib64/libcudnn_static.a
/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21
/usr/local/cuda-8.0/lib64/libcudnn_static.a
/usr/local/cuda-9.0/lib64/libcudnn.so.7.3.1
/usr/local/cuda-9.0/lib64/libcudnn_static.a
/usr/local/cuda-9.2/lib64/libcudnn.so.7.3.1
/usr/local/cuda-9.2/lib64/libcudnn_static.a
 
Versions of relevant libraries:
[pip] Could not collect
[conda] blas                      1.0                         mkl 
[conda] cuda100                   1.0                           0    pytorch
[conda] mkl                       2018.0.3                      1 
[conda] mkl_fft                   1.0.6            py27h7dd41cf_0 
[conda] mkl_random                1.0.1            py27h4414c95_1 
[conda] pytorch                   1.0.0           py2.7_cuda10.0.130_cudnn7.4.1_1  [cuda100]  pytorch
[conda] torchvision               0.2.1                      py_2    pytorch

## Additional context

 complete list of packages
packages in environment:
 
Name                    Version                   Build  Channel
blas                      1.0                         mkl 
ca-certificates           2018.03.07                    0 
certifi                   2018.10.15               py27_0 
cffi                      1.11.5           py27he75722e_1 
cuda100                   1.0                           0    pytorch
freetype                  2.9.1                h8a8886c_1 
intel-openmp              2019.1                      144 
jpeg                      9b                   h024ee3a_2 
libedit                   3.1.20170329         h6b74fdf_2 
libffi                    3.2.1                hd88cf55_4 
libgcc-ng                 8.2.0                hdf63c60_1 
libgfortran-ng            7.3.0                hdf63c60_0 
libpng                    1.6.35               hbc83047_0 
libstdcxx-ng              8.2.0                hdf63c60_1 
libtiff                   4.0.9                he85c1e1_2 
mkl                       2018.0.3                      1 
mkl_fft                   1.0.6            py27h7dd41cf_0 
mkl_random                1.0.1            py27h4414c95_1 
ncurses                   6.1                  he6710b0_1 
ninja                     1.8.2            py27h6bb024c_1 
numpy                     1.15.4           py27h1d66e8a_0 
numpy-base                1.15.4           py27h81de0dd_0 
olefile                   0.46                     py27_0 
onnx                      1.3.0                     <pip>
openssl                   1.1.1a               h7b6447c_0 
pillow                    5.3.0            py27h34e0f95_0 
pip                       18.1                     py27_0 
protobuf                  3.6.1                     <pip>
pycparser                 2.19                     py27_0 
python                    2.7.15               h9bab390_4 
pytorch                   1.0.0           py2.7_cuda10.0.130_cudnn7.4.1_1  [cuda100]  pytorch
readline                  7.0                  h7b6447c_5 
setuptools                40.6.2                   py27_0 
six                       1.11.0                   py27_1 
sqlite                    3.25.3               h7b6447c_0 
tk                        8.6.8                hbc83047_0  
torchvision               0.2.1                      py_2    pytorch
typing                    3.6.6                     <pip>
typing-extensions         3.6.6                     <pip>
wheel                     0.32.3                   py27_0 
xz                        5.2.4                h14c3975_4 
zlib                      1.2.11               h7b6447c_3 

(opening this problem on behalf of a team member: @surajkota)
. []"
677,14078,0,"Build failing at torch/lib/c10d/ProcessGroupMPI.cpp. ## üêõ Bug

PyTorch fails to finish building, with a possible bug (see below).



## To Reproduce


## Environment


 - PyTorch Version (e.g., 1.0): Master branch (1.0) 
 - OS (e.g., Linux): Debian:Stretch
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): see above
 - Python version: 3.6
 - CUDA/cuDNN version: N/A
 - GPU models and configuration: N/A
 - Any other relevant information: N/A

## Additional context

<!-- Add any other context about the problem here. -->
. ['bash \r\nScanning dependencies of target caffe2_observers\r\n[ 92%] Building CXX object caffe2/torch/lib/THD/CMakeFiles/THD.dir/base/data_channels/DataChannelTCP.cpp.o\r\n[ 93%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/net_observer_reporter_print.cc.o\r\n\x1b[91m/opt/pytorch/torch/lib/c10d/ProcessGroupMPI.cpp: In destructor ‚Äòvirtual c10d::ProcessGroupMPI::AsyncWork::~AsyncWork()‚Äô:\r\n/opt/pytorch/torch/lib/c10d/ProcessGroupMPI.cpp:154:71: error: throw will always call terminate() [-Werror=terminate]\r\n         ""Attempted destruction of AsyncWork before work has completed"");\r\n                                                                       ^\r\n/opt/pytorch/torch/lib/c10d/ProcessGroupMPI.cpp:154:71: note: in C++11 destructors default to noexcept\r\n\x1b[0m[ 93%] Building CXX object caffe2/torch/CMakeFiles/torch.dir/csrc/autograd/function.cpp.o\r\n[ 93%] Building CXX object caffe2/torch/CMakeFiles/torch.dir/csrc/autograd/functions/accumulate_grad.cpp.o\r\n[ 93%] Building CXX object modules/detectron/CMakeFiles/caffe2_detectron_ops.dir/ps_roi_pool_op.cc.o\r\n[ 93%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o\r\n\x1b[91mcc1plus: all warnings being treated as errors\r\n\x1b[0m\x1b[91mmake[2]: *** [caffe2/torch/lib/c10d/CMakeFiles/c10d.dir/ProcessGroupMPI.cpp.o] Error 1\r\n\x1b[0m\x1b[91mmake[2]: *** Waiting for unfinished jobs....\r\n\x1b[0mcaffe2/torch/lib/c10d/CMakeFiles/c10d.dir/build.make:230: recipe for target \'caffe2/torch/lib/c10d/CMakeFiles/c10d.dir/ProcessGroupMPI.cpp.o\' failed\r\n[ 93%] Building CXX object caffe2/torch/CMakeFiles/torch.dir/csrc/autograd/functions/basic_ops.cpp.o\r\n[ 93%] Building CXX object caffe2/torch/lib/THD/CMakeFiles/THD.dir/base/init_methods/InitMethod.cpp.o\r\n[ 93%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o\r\n[ 93%] Building CXX object modules/detectron/CMakeFiles/caffe2_detectron_ops.dir/roi_pool_f_op.cc.o\r\n[ 93%] Building CXX object modules/detectron/CMakeFiles/caffe2_detectron_ops.dir/sample_as_op.cc.o\r\n[ 93%] Building CXX object caffe2/torch/lib/THD/CMakeFiles/THD.dir/base/init_methods/InitMethodEnv.cpp.o\r\n[ 93%] Building CXX object caffe2/torch/CMakeFiles/torch.dir/csrc/autograd/functions/comm.cpp.o\r\n[ 93%] Building CXX object modules/detectron/CMakeFiles/caffe2_detectron_ops.dir/select_smooth_l1_loss_op.cc.o\r\n[ 93%] Building CXX object caffe2/torch/CMakeFiles/torch.dir/csrc/autograd/functions/tensor.cpp.o\r\nCMakeFiles/Makefile2:7496: recipe for target \'caffe2/torch/lib/c10d/CMakeFiles/c10d.dir/all\' failed\r\n\x1b[91mmake[1]: *** [caffe2/torch/lib/c10d/CMakeFiles/c10d.dir/all] Error 2\r\n\x1b[0m\x1b[91mmake[1]: *** Waiting for unfinished jobs....\r\n...\r\n...\r\n...\r\n[ 99%] Linking CXX shared library ../../lib/libtorch.so\r\n[ 99%] Built target torch\r\nMakefile:138: recipe for target \'all\' failed\r\n\x1b[91mmake: *** [all] Error 2\r\n\x1b[0msetup.py::build_deps::run()\r\nFailed to run \'bash ../tools/build_pytorch_libs.sh --use-fbgemm --use-nnpack --use-mkldnn --use-qnnpack caffe2\'\r\n', 'bash \r\n cd /opt && git clone --recursive https://github.com/pytorch/pytorch \\\r\n    && cd pytorch && git submodule update --init && \\\r\n    cd /opt/pytorch/third_party/ideep/mkl-dnn && \\\r\n    git pull https://github.com/intel/mkl-dnn.git --no-commit  --rebase && \\\r\n    cd /opt/pytorch && \\\r\n    sed -i \'s/""Use MKLDNN"" OFF/""Use MKLDNN"" ON /g\' CMakeLists.txt && \\\r\n    sed -i \'s/""Use DISTRIBUTED"" OFF/""Use DISTRIBUTED"" ON /g\' CMakeLists.txt && \\\r\n    sed -i \'s/for parallel code"" OFF/for parallel code"" ON /g\' CMakeLists.txt && \\\r\n    PYTHON_EXECUTABLE=/opt/conda/bin/python \\\r\n    PYTHON_LIBRARY=/opt/conda/lib/libpython3.6m.so \\\r\n    PYTHON_INCLUDE_DIR=/opt/conda/include/python3.6m \\\r\n    FULL_CAFFE2=1 \\\r\n    USE_OPENMP=1 \\\r\n    USE_MKL=1 \\\r\n    USE_MKLDNN=1 \\\r\n    USE_MKLML=1 \\\r\n    USE_SYSTEM_EIGEN_INSTALL=1 \\\r\n    USE_ZMQ=1 \\\r\n    USE_DISTRIBUTED=1 \\\r\n    MKLDNN_LIBRARY=/usr/local/lib \\\r\n    MKLDNN_INCLUDE_DIR=/usr/local/include \\\r\n    MKLDNN_LIB_DIR=/usr/local/lib \\\r\n    python setup.py install && \\\r\n    cd /opt && rm -rf /opt/pytorch && \\\r\n    cd /usr/lib && sudo ldconfig\r\n']"
296,8837,0,"Inconsistency in implementation of _LRScheduler . I've noticed an odd behavior when attempting to write my own scheduler based on . 

If you write a custom get_lr() to work based on self.last_epoch, its impossible to differentiate the 
0th and the 1st epoch. 

Here is a minimal working example:



This results in the output



You can see the last epoch is asked to set the learning rate based on the last epoch being 0 twice. This LRScheduler class takes last_epoch as an argument, so it knows how to set the LR for the previous epoch. By default last_epoch=-1, because the first epoch is 0 and no epoch has run yet. On construction it then calls  with , which means the step function sets the learning rate for epoch 0. Then last_epoch is reset to -1 immediately after, so the next call to step also sets the learning rate for epoch 0. 

A fix would simply remove the + 1 from , but this might break existing implementations of  which wouldn't expect  being set to a negative number. 

I think a more intuitive implementation of this class might track the current epoch rather than the previous one. This would be a backwards incompatible change, but I think it would improve the overall quality of torch. I'm willing to give a re-implementation a shot if it sounds like a good idea to the maintainers. 

cc @ezyang @albanD @zou3519 @gqchen @pearu @nikitaved @soulitzer @mruberry @jbschlosser @vincentqb. [""python\r\n\r\ndef mwe():\r\n    # Assuming optimizer has two groups.\r\n    import torch.optim.lr_scheduler\r\n    import netharn as nh\r\n    model = nh.models.ToyNet2d()\r\n    optimizer = torch.optim.SGD(model.parameters(), lr=10)\r\n\r\n    class DummySchedule(torch.optim.lr_scheduler._LRScheduler):\r\n        def get_lr(self):\r\n            print('Set LR based on self.last_epoch = {!r}'.format(self.last_epoch))\r\n            self._current_lr = self.last_epoch\r\n            return [self.last_epoch]\r\n\r\n    # Initialize the optimizer with epoch 0's LR\r\n    # self = torch.optim.lr_scheduler.LambdaLR(optimizer, lambda x: x)\r\n    self = DummySchedule(optimizer)\r\n    for epoch in range(3):\r\n        print('------')\r\n        print('Run epoch = {!r}'.format(epoch))\r\n        # Pretend we run epoch 0\r\n        print('Training with self._current_lr = {!r}'.format(self._current_lr))\r\n        # Pretend epoch 0 has finished, so step the scheduler.\r\n        # self.step(epoch=epoch)\r\n        self.step()\r\n"", '\r\nSet LR based on self.last_epoch = 0\r\n------\r\nRun epoch = 0\r\nTraining with self._current_lr = 0\r\nSet LR based on self.last_epoch = 0\r\n------\r\nRun epoch = 1\r\nTraining with self._current_lr = 0\r\nSet LR based on self.last_epoch = 1\r\n------\r\nRun epoch = 2\r\nTraining with self._current_lr = 1\r\nSet LR based on self.last_epoch = 2\r\n']"
282,20704,0,Remove unpack() in torch/csrc/nn/type_checks.h and its caller functions in the codebase. The  function in torch/csrc/nn/type_checks.h is not used anymore because we had already killed torch.legacy.nn and all the normal NN ops go through ATen bindings right now. A proper removal of the  function would also involve removing all of its caller functions.. []
637,24452,0,"model deployment ÔºöMultiple serial modelsÔºåusing 3DconvÔºüÔºü. ## ‚ùì Questions and Help

I have about 4 to 10 models to execute seriallyÔºåevery model is 3D-convolutional modelÔºåI have tried TensorRT,but TensorRT only support 2 D conv,
what else can I try?

The needs are: stable and fast

. []"
441,12133,0,"How to initialize caffe2::Tensor. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)

I don't know how to initialize  Tensor(const vector<int64_t>& dims,const vector<T>& values, BaseContext* context), cause I dont't know how to init context.. []"
134,3124,0,"Does pytorch have Softmax3D Ôºü. I am doing a 3d project and I found that pytorch has conv3d, pooling3d and batchnorm3d, but I didn't find the softmax3d. 
Does anyone have softmax3d layer? . []"
443,5918,0,Lint of .gitmodules and aten/.gitmodules are synchronized. see https://github.com/pytorch/pytorch/pull/5911. []
95,25878,0,"Model weights silently fail to load when model is on different gpu than when it was saved. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
 silently fails when the model is saved and loaded on different gpu-devices. As a result, the model remains in its randomly-initialized state.

This does not occur in PyTorch 1.1 but does occur in PyTorch 1.2.
 
## To Reproduce

Steps to reproduce the behavior:

The following code demonstrates this bug:

1. Define functions for creating a simple model. For loading the model and asserting that its loaded weights reflect the weights in the checkpoint



2. Create a model, place on gpu-0 and save its state-dictionary


3. Demonstrate that the model loads as-expected on gpu-0


4. Demonstrate that the model loads as-expected on cpu


5. Demonstrate that the model **fails to load** on gpu-1, and retains its randomly-initialized weights.


## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.6 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: Tesla V100-PCIE-16GB
GPU 1: Tesla V100-PCIE-16GB
GPU 2: Tesla V100-PCIE-16GB
GPU 3: Tesla V100-PCIE-16GB
GPU 4: Tesla V100-PCIE-16GB
GPU 5: Tesla V100-PCIE-16GB
GPU 6: Tesla V100-PCIE-16GB
GPU 7: Tesla V100-PCIE-16GB

Nvidia driver version: 418.67
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.1

Versions of relevant libraries:
[pip] numpy==1.16.4
[pip] torch==1.2.0
[pip] torchvision==0.4.0a0+6b959ee
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.4                      243  
[conda] mkl-service               2.0.2            py37h7b6447c_0  
[conda] mkl_fft                   1.0.14           py37ha843d7b_0  
[conda] mkl_random                1.0.2            py37hd81dba3_0  
[conda] pytorch                   1.2.0           py3.7_cuda10.0.130_cudnn7.6.2_0    pytorch
[conda] torchvision               0.4.0                    pypi_0    pypi
:

## Additional context

<!-- Add any other context about the problem here. -->


cc @ezyang @gchanan @zou3519. ['python\r\nimport torch as tr\r\nimport torch.nn as nn\r\n\r\n\r\ndef make_model():\r\n    return nn.Conv2d(in_channels=1, out_channels=1, kernel_size=3)\r\n\r\n\r\ndef load_on_device_and_check(checkpoint, device, verbose=False):\r\n    model = make_model()\r\n    model.to(device)\r\n\r\n    saved_weight = checkpoint[""model_state_dict""][""weight""]\r\n    assert not tr.allclose(saved_weight.cpu(), model.weight.cpu())\r\n    \r\n    if verbose:\r\n        print(f""pre-load:\\n{model.weight.cpu()}"")\r\n        \r\n    model.load_state_dict(checkpoint[""model_state_dict""])\r\n    \r\n    if verbose:\r\n        print(f""post-load:\\n{model.weight.cpu()}"")\r\n    assert tr.allclose(saved_weight.cpu(), model.weight.cpu())\r\n', 'python\r\ndevice = tr.device(""cuda:0"")\r\nmodel = make_model()\r\nmodel.to(device)\r\ntr.save({""model_state_dict"": model.state_dict()}, ""dummy_model.p"")\r\n', 'python\r\n>>> checkpoint = tr.load(""dummy_model.p"")\r\n>>> load_on_device_and_check(checkpoint, tr.device(""cuda:0""))\r\n', 'python\r\n>>> checkpoint = tr.load(""dummy_model.p"")\r\n>>> load_on_device_and_check(checkpoint, tr.device(""cpu""), verbose=True)\r\npre-load:\r\ntensor([[[[-0.1033, -0.3067,  0.0443],\r\n          [-0.1475, -0.1446, -0.0476],\r\n          [ 0.1484,  0.0619, -0.3134]]]], grad_fn=<CopyBackwards>)\r\npost-load:\r\ntensor([[[[ 0.0477,  0.0031, -0.0045],\r\n          [-0.1170, -0.0351,  0.1652],\r\n          [ 0.1713, -0.1888,  0.2063]]]], grad_fn=<CopyBackwards>)\r\n', 'python\r\n>>> checkpoint = tr.load(""dummy_model.p"")\r\n>>> load_on_device_and_check(checkpoint, tr.device(""cuda:1""), verbose=True)\r\npre-load:\r\ntensor([[[[ 0.0328, -0.1487,  0.0571],\r\n          [ 0.0730, -0.1790, -0.1707],\r\n          [-0.1375,  0.2665,  0.2011]]]], grad_fn=<CopyBackwards>)\r\npost-load:\r\ntensor([[[[ 0.0328, -0.1487,  0.0571],\r\n          [ 0.0730, -0.1790, -0.1707],\r\n          [-0.1375,  0.2665,  0.2011]]]], grad_fn=<CopyBackwards>)\r\n\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-7-aa2957eac0e5> in <module>\r\n      1 checkpoint = tr.load(""dummy_model.p"")\r\n----> 2 load_on_device_and_check(checkpoint, tr.device(""cuda:1""), verbose=True)\r\n\r\n<ipython-input-6-eb34bf821c07> in load_on_device_and_check(checkpoint, device, verbose)\r\n     21     if verbose:\r\n     22         print(f""post-load:\\n{model.weight.cpu()}"")\r\n---> 23     assert tr.allclose(saved_weight.cpu(), model.weight.cpu())\r\n\r\nAssertionError: \r\n\r\n\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
35,1253,1,"Memory usage increasing after first batch (possibly not freeing some potentially free memory). This may be related to issue #1184 but I believe there is something else to it:
I am working on version , using micro batches: split mini-batches into smaller batches and calculate/backprop loss in each micro batch, accumulating it over the mini batch. I noticed multiple times that my code goes out of memory after several micro batches. This seems strange to me as each micro batch should require the same amount of memory. Maybe there is something I don't fully understand here, so if anyone can explain it to me, I'd be happy !

Anyway, I tried to look into it a bit and attached is the smallest code snippet I came up with demonstrating my problem (around 100 lines).
Essentially, I am training a network on images, using micro-batches to reduce memory. However, after the first (and sometimes second) micro-batch, the memory usage increases and then stays the same after further micro-batches.

When using a functional approach for the mini and micro batches, the memory usage does not increase the same way, so I don't believe that this has to do with the fact that there may be 'lazy' memory freeing involved (freeing only when necessary).

[torch_memory.zip](https://github.com/pytorch/pytorch/files/919384/torch_memory.zip). []"
496,16042,0,"grad_fn missing?. ## üêõ Bug

Hi, Sorry if this is not a bug I tried to post in forums but am getting no response :( 

## To Reproduce

import torch

x = torch.randn(1,1,1,1).requires_grad_(True)

y = torch.nn.Conv2d(1,1,1)(x).mean()**2
conv_grad,  = torch.autograd.grad(y, x, create_graph=True, retain_graph=True)
print(""Conv grad"",conv_grad)

y = torch.nn.Linear(1,1)(x).mean()**2
linear_grad,  = torch.autograd.grad(y, x, create_graph=True, retain_graph=True)
print(""Linear grad"",linear_grad)

## Expected behavior

I think both gradient variables should have an associated grad_fn, however only the linear version does. Isn't the math the same for both here, the 1x1 convolution vs the 1x1 linear layer? Or maybe I am missing something :(
. []"
50,17703,1,"Training hangs when using DistributedDataParallel in two pod on two nodes . <!-- A clear and concise description of what the bug is. -->
Training hangs when using DistributedDataParallel in two pod on nodes.
The problem **occasionally** happens  and can not be reproduced each time. 
The pods were started by k8s using flannel network. The physical nodes are connected by 10Ge ethernet.

Training started normally, but hanged in the middle of training process.
![image](https://user-images.githubusercontent.com/41627739/53853400-4860ec80-4000-11e9-9929-678b7547f630.png)
Then there was no output again. The training process did not exit for servel hours.
We found that the GPU utilization  was always 100% on both two nodes.
![image](https://user-images.githubusercontent.com/41627739/53852922-a096ef00-3ffe-11e9-828c-6d38e8d5dd68.png)
After we added NCCL_DEBUG=WARN before the training command, we found the WARN as follows.
On on pod:
_worker0-0d9gnb:15:91 [3] include/socket.h 398 NCCL WARN Call to **write** failed : Connection reset  by peer.
worker0-0d9gnb:15:91 [3] transport.cu:153 NCCL WARN transport.cu:153 ->2 [Proxy thread error]_
On the other pod:
_worker0-0d9gnb:15:91 [3] include/socket.h 398 NCCL WARN Call to **recv** failed : Connection reset  by peer.
worker0-0d9gnb:15:91 [3] transport.cu:153 NCCL WARN transport.cu:153 ->2 [Proxy thread error]_
<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Environment
Training code is pull from https://github.com/pytorch/examples/tree/master/imagenet.
Model is Resnet. We used 8 V100s to train (4 on each node).
Batch size was set 8, 32 or 128 per GPU.
The network rate is about 500 MB/s to synchronize the gradients.

 - PyTorch Version (e.g., 1.0): both 1.0 and 0.4.1
 - OS (e.g., Linux): Ubunut 16.04
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source): None
 - Python version: 3.6
 - CUDA/cuDNN version: CUDA 9.0/cuDNN 7.1.2
 - GPU models and configuration: V100 with NVLink
 - Any other relevant information:
. []"
682,5463,0,"ONNX export protobufs leak file paths from file system. This is bad for build reproducibility, since file paths may change between systems. The file paths come from SourceLocation which we started exporting in c7cb6a795e550ef2373d8127e120744db16b61cf

CC @jamesr66a . []"
100,19149,0,"Make operators like logsumexp and cumsum operate over dimension 0 by default (or at least for 1D arrays). It's pretty ridiculous that, for a 1D input like ,  still requires you to specify you're operating over dimension 0.

In particular  will error, saying that it needs a dim argument.  works.

My suggestion is that, at the very least for 1D inputs, the default dim you operate over is set to 0. This is a problem for  and , just to name two.

cc @jlin27 @mruberry @rgommers. []"
606,5486,0,"Tensors don't gracefully compare to NoneType. 
at . ['python\r\nimport torch\r\n[torch.Tensor(), None, None].count(None)\r\n\r\n#Traceback (most recent call last):\r\n#  File ""<stdin>"", line 1, in <module>\r\n#  File "".../lib/python2.7/site-packages/torch/tensor.py"", line 312, in __eq__\r\n#    return self.eq(other)\r\n#TypeError: eq received an invalid combination of arguments - got (NoneType), but expected one of:\r\n# * (float value)\r\n#      didn\'t match because some of the arguments have invalid types: (NoneType)\r\n# * (torch.FloatTensor other)\r\n#      didn\'t match because some of the arguments have invalid types: (NoneType)\r\n']"
652,4336,0,"Linking Error: ../libATen.so.1: undefined reference to functions from NNPACK and some other libs.... Hi, when I build the CPU version from source, I met the following issue. I am using Python 3.5, Ubuntu 16.04. Does anyone know how to fix it? Thanks a lot!

nnp_convolution_kernel_gradient'
> ../libATen.so.1: undefined reference to pthreadpool_create'
> ../libATen.so.1: undefined reference to nnp_convolution_inference'
> ../libATen.so.1: undefined reference to nnp_convolution_kernel_gradient'
> ../libATen.so.1: undefined reference to pthreadpool_create'
> ../libATen.so.1: undefined reference to nnp_convolution_inference'
> ../libATen.so.1: undefined reference to nnp_convolution_kernel_gradient'
> ../libATen.so.1: undefined reference to pthreadpool_create'
> ../libATen.so.1: undefined reference to nnp_convolution_inference'
> ../libATen.so.1: undefined reference to nnp_convolution_kernel_gradient'
> ../libATen.so.1: undefined reference to pthreadpool_create'
> ../libATen.so.1: undefined reference to nnp_convolution_inference'
> ../libATen.so.1: undefined reference to . []"
580,18873,0,Run shellcheck on OSS builds. []
170,19253,0,"torch.pow() in a script module produces an error. ## üêõ Bug

The backward of torch.pow() in a traced module produces an error when the input is on cuda.

> RuntimeError:
Expected tensor to have CUDA Backend, but got tensor with CPU Backend (while checking arguments for CUDA_tensor_apply4) (checkBackend at ../aten/src/ATen/TensorUtils.cpp:202)

The backward is defined in torch/csrc/jit/symbolic_script.cpp.
I think the reason is that the backend of the first argument of torch.where() is always CPU.



## To Reproduce

The following model is the one in
https://github.com/pytorch/examples/blob/master/mnist/main.py
but I just inserted torch.pow().



## Environment
PyTorch version: 1.1.0a0+7e73783
Is debug build: No
CUDA used to build PyTorch: 9.2.88

OS: CentOS Linux release 7.5.1804 (Core)
GCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-28)
CMake version: version 3.12.2

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 9.2.88
GPU models and configuration:
GPU 0: Tesla P100-PCIE-16GB
GPU 1: Tesla P100-PCIE-16GB

Nvidia driver version: 396.26
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.15.4
[pip] numpydoc==0.8.0
[pip] torch==1.1.0a0+7e73783
[pip] torchvision==0.2.2.post3
[conda] blas                      1.0                         mkl
[conda] magma-cuda90              2.5.0                         1    pytorch
[conda] magma-cuda92              2.5.0                         1    pytorch
[conda] mkl                       2019.1                      144
[conda] mkl-include               2019.3                      199
[conda] mkl-service               1.1.2            py37he904b0f_5
[conda] mkl_fft                   1.0.6            py37hd81dba3_0
[conda] mkl_random                1.0.2            py37hd81dba3_0
[conda] torch                     1.1.0a0+7e73783           dev_0    <develop>
[conda] torchvision               0.2.2.post3              pypi_0    pypi

. ['\r\ndef pow_0(self,\r\n          exponent: float):\r\n    def backward(grad_output):\r\n        grad_self = torch.where(torch.tensor(exponent == 0.0), torch.zeros_like(self), grad_output * exponent * torch.pow(self, exponent - 1))\r\n        return grad_self, None\r\n    return torch.pow(self, exponent), backward\r\n', '\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\n\r\nclass Net(nn.Module):\r\n    def __init__(self):\r\n        super(Net, self).__init__()\r\n        self.conv1 = nn.Conv2d(1, 20, 5, 1)\r\n        self.conv2 = nn.Conv2d(20, 50, 5, 1)\r\n        self.fc1 = nn.Linear(4*4*50, 500)\r\n        self.fc2 = nn.Linear(500, 10)\r\n\r\n    def forward(self, x):\r\n        x = F.relu(self.conv1(x))\r\n        x = F.max_pool2d(x, 2, 2)\r\n        x = F.relu(self.conv2(x))\r\n        x = F.max_pool2d(x, 2, 2)\r\n        x = x.view(64, 4*4*50)\r\n        x = self.fc1(x)\r\n        x = F.relu(x)\r\n        x = self.fc2(x)\r\n        x = torch.pow(x, 1.1)\r\n        x = F.log_softmax(x, dim=1)\r\n        return x\r\n\r\nm = Net().cuda()\r\nx = torch.randn(64, 1, 28, 28, requires_grad=True).cuda()\r\ntraced_net = torch.jit.trace(m, x)\r\ntraced_output = traced_net(x)\r\ntgt = torch.randn(traced_output.size()).cuda()\r\ntraced_output.backward(tgt)\r\n']"
175,5826,0,"UserWarning: tensor1/other is not broadcastable to self, but they have the same number of elements. Falling back to deprecated pointwise behavior. - OS: Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-1038-aws x86_64)
- PyTorch version:  0.4.0a0+7f864bb (Source), and 0.3.1 (Pip).

- How you installed PyTorch (conda, pip, source): Both Pip and Source
- Python version: Python2 and Python3
- CUDA/cuDNN version: Cuda 9, cuDNN v7
- GPU models and configuration: Tesla K80        
- GCC version (if compiling from source): gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.5)


When using the Pip version (Python2 & 3), I am getting these errors when using the  L-BFGS and Adam optimizers: 


Running optimization with ADAM:


 
Running optimization with L-BFGS:



This is my feval function: 



And this is how I run it: 




If I run the above code with the latest Github version, I get this error which happens in a completely different area: 




So I am not sure if the above error is still related to the Pip issues, if something got changed/broken, etc... . [""\r\n/usr/local/lib/python2.7/dist-packages/torch/legacy/optim/adam.py:65: UserWarning: tensor1 is not broadcastable to self, but they have the same number of elements.  Falling back to deprecated pointwise behavior.\r\n  x.addcdiv_(-stepSize, state['m'], state['denom'])\r\n"", ""\r\n('<optim.lbfgs>', 'creating recyclable direction/step/history buffers')\r\n/usr/local/lib/python2.7/dist-packages/torch/legacy/optim/lbfgs.py:197: UserWarning: other is not broadcastable to self, but they have the same number of elements.  Falling back to deprecated pointwise behavior.\r\n  x.add_(t, d)\r\n"", '\r\nnum_calls = [0]\r\ndef feval(x):\r\n  num_calls[0] += 1\r\n  net.updateOutput(x.cuda())\r\n  grad = net.updateGradInput(x.cuda(), dy.cuda())\r\n  loss = 0\r\n  for mod in content_losses:\r\n    loss = loss + mod.loss\r\n  for mod in style_losses:\r\n    loss = loss + mod.loss\r\n  return loss, grad.view(grad.nelement())\r\n', '\r\noptim_state = None\r\nif params.optimizer == \'lbfgs\':\r\n  optim_state = {\r\n    ""maxIter"": params.num_iterations,\r\n    ""verbose"": True,\r\n    ""tolX"": -1,\r\n    ""tolFun"": -1,\r\n  }\r\n  if params.lbfgs_num_correction > 0:\r\n    optim_state.nCorrection = params.lbfgs_num_correction\r\nelif params.optimizer == \'adam\':\r\n    optim_state = {\r\n      ""learningRate"": params.learning_rate,\r\n    }\r\n\r\n# Run optimization.\r\nif params.optimizer == \'lbfgs\':\r\n  print(""Running optimization with L-BFGS"")\r\n  x, losses = optim.lbfgs(feval, img, optim_state)\r\nelif params.optimizer == \'adam\':\r\n  print(""Running optimization with ADAM"")\r\n  for t in xrange(params.num_iterations):\r\n    x, losses = optim.adam(feval, img, optim_state)\r\n', '\r\nTraceback (most recent call last):\r\n  File ""test2.py"", line 124, in <module>\r\n    net.updateOutput(content_image_caffe)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py"", line 36, in updateOutput\r\n    currentOutput = module.updateOutput(currentOutput)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/SpatialConvolution.py"", line 84, in updateOutput\r\n    self._viewWeight()\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/SpatialConvolution.py"", line 75, in _viewWeight\r\n    self.gradWeight = self.gradWeight.view(self.nOutputPlane, self.nInputPlane * self.kH * self.kW)\r\nRuntimeError: invalid argument 2: size \'[64 x 27]\' is invalid for input with 0 elements at /home/ubuntu/pytorch/aten/src/TH/THStorage.c:41\r\n']"
386,10751,0,"[docs] Error in documentation for fft normalization. The primary fft equation in the documentation [here](https://github.com/pytorch/pytorch/blob/8013dac43d2acb592cab75317f17d4f9c5b9eb6a/torch/_torch_docs.py#L5303) is 

However, from experimentation it seems the  1/N factor  should not be there for the forward transform. 

Here is the relevant line:
https://github.com/pytorch/pytorch/blob/8013dac43d2acb592cab75317f17d4f9c5b9eb6a/torch/_torch_docs.py#L5303

The inverse transform equation (with the 1/N) is consistent with the behavior of the implementation.

Note, the documentation is accurate for , , but this only makes sense when if that 1/N factor isn't there in the main equation above. 

Note, the documentation for  is also accurate for , but again this only makes sense if the 1/N factor isn't there in the main equation above.

Lastly, the documentation for  is a mix of two problems. [This line](https://github.com/pytorch/pytorch/blob/8013dac43d2acb592cab75317f17d4f9c5b9eb6a/torch/_torch_docs.py#L5493) says 

This says ""multiply"" instead of ""divide"" (as in fft). This is consistent with the primary equation, but it is not consistent with the implementation. It should be . ['   X[\\omega_1, \\dots, \\omega_d] =\r\n        \\frac{1}{\\prod_{i=1}^d N_i} \\sum_{n_1=0}^{N_1} \\dots \\sum_{n_d=0}^{N_d} x[n_1, \\dots, n_d]\r\n         e^{-j\\ 2 \\pi \\sum_{i=0}^d \\frac{\\omega_i n_i}{N_i}},\r\n', 'If normalized is set to True, this normalizes the result by multiplying it with [sqrt(N)]']"
147,15916,0,"Where to download pytorch=0.2.0_4. I specifically need pytorch=0.2.0_4 to test a project built on this version (https://github.com/oawiles/X2Face) but can't find this anywhere on https://pytorch.org/get-started/previous-versions/, nor does  work. Is there any way I can install this specific version?. []"
515,23738,0,"Python 3.5 conda nightlies don't work. Reproducer in a Python 3.5 conda environment:

. [""\r\nconda install -c pytorch pytorch-nightly                      \r\nCollecting package metadata (current_repodata.json): done\r\nSolving environment: failed with current_repodata.json, will retry with next repodata source.\r\nInitial quick solve with frozen env failed.  Unfreezing env and trying again.                                                    \r\nSolving environment: failed with current_repodata.json, will retry with next repodata source.\r\nCollecting package metadata (repodata.json): done\r\nSolving environment: failed\r\nInitial quick solve with frozen env failed.  Unfreezing env and trying again.                                                    \r\nSolving environment: failed\r\n\r\nUnsatisfiableError: The following specifications were found\r\nto be incompatible with the existing python installation in your environment:                                                    \r\n\r\n  - pytorch-nightly -> python[version='>=2.7,<2.8.0a0,>=3.6,<3.7.0a0,>=3.7,<3.8.0a0']                                            \r\n\r\nIf python is on the left-most side of the chain, that's the version you've asked for.                                            \r\nWhen python appears to the right, that indicates that the thing on the left is somehow                                           \r\nnot available for the python version you are constrained to.  Your current python version                                        \r\nis (python=3.5).  Note that conda will not change your python version to a different minor version                               \r\nunless you explicitly specify that.\r\n\r\nThe following specifications were found to be incompatible with each other:                                                      \r\n\r\n\r\n\r\nPackage certifi conflicts for:\r\npytorch-nightly -> numpy[version='>=1.11'] -> mkl_random[version='>=1.0.2,<2.0a0'] -> numpy-base[version='>=1.0.2,<2.0a0'] -> python[version='>=2.7,<2.8.0a0,>=3.6,<3.7.0a0,>=3.7,<3.8.0a0'] -> pip -> wheel -> setuptools -> certifi[version='>=2016.09']         \r\npython=3.5 -> pip -> wheel -> setuptools -> certifi[version='>=2016.09']                                                         \r\nPackage pip conflicts for:\r\npython=3.5 -> pip\r\npytorch-nightly -> numpy[version='>=1.11'] -> mkl_random[version='>=1.0.2,<2.0a0'] -> numpy-base[version='>=1.0.2,<2.0a0'] -> python[version='>=2.7,<2.8.0a0,>=3.6,<3.7.0a0,>=3.7,<3.8.0a0'] -> pip\r\nPackage wheel conflicts for:\r\npython=3.5 -> pip -> wheel\r\npytorch-nightly -> numpy[version='>=1.11'] -> mkl_random[version='>=1.0.2,<2.0a0'] -> numpy-base[version='>=1.0.2,<2.0a0'] -> python[version='>=2.7,<2.8.0a0,>=3.6,<3.7.0a0,>=3.7,<3.8.0a0'] -> pip -> wheel                                                       \r\nPackage setuptools conflicts for:\r\npython=3.5 -> pip -> wheel -> setuptools\r\npytorch-nightly -> numpy[version='>=1.11'] -> mkl_random[version='>=1.0.2,<2.0a0'] -> numpy-base[version='>=1.0.2,<2.0a0'] -> python[version='>=2.7,<2.8.0a0,>=3.6,<3.7.0a0,>=3.7,<3.8.0a0'] -> pip -> wheel -> setuptools     \r\n""]"
509,9987,0,"eigen submodule not found. Could you fix this submodule not found problem of caffe2?

remote: Repository not found.
fatal: repository 'https://github.com/RLovelett/eigen.git/' not found
fatal: clone of 'https://github.com/RLovelett/eigen.git' into submodule path '/home/ly/workspace/git/pose/caffe2/third_party/eigen' failed
Failed to clone 'third_party/eigen' a second time, aborting. []"
75,12683,1,"CPU triangular solve is slow. It would be nice to have a GPU version of triangular solve. It's needed for preconditioned stochastic gradient optimizer ([paper](https://ieeexplore.ieee.org/document/7875097/)), and it's possibly the reason why TF implementation runs 3x faster than PyTorch version

Here's a microbenchmark in milliseconds of 8000x8000 triangular solve:
https://github.com/yaroslavvb/newton/blob/master/benchmark_triangular.py



cc @VitalyFedyunin @jianyuh @nikitaved @pearu @mruberry @heitorschueroff @walterddr @IvanYashchuk @xwang233 @ngimel. ['\r\nnumpy: Times: min: 127.86, median: 128.12, mean: 128.31\r\ntensorflow: Times: min: 1.20, median: 1.20, mean: 1.20\r\npytorch: Times: min: 162.65, median: 162.65, mean: 162.65\r\n']"
695,907,0,"Fix cudnnHandle_t in Handles.cpp. There are two problems with the way we manage cudnnHandles in [Handles.cpp](https://github.com/pytorch/pytorch/blob/master/torch/csrc/cudnn/Handles.cpp):

1. We sometimes see SIGSEGV on exit when the handles are destructed
2. They don't work on non-default streams

We tried making the handles table thread-local, but that causes slow downs and deadlocks because the handles can be destructed after every forward pass in a data parallel module.

We should figure out a better solution.. []"
711,4333,0,"Model behaves differently after saving and loading. Hi,

Recently I am working on a summarization project. During training, I saved the best model on the development set. However, loading the best model and testing again on the dev set gives me different ROUGE result (0.18218091939853281 -> 0.18217045231619222 ). Although the difference is small, it raises much concerns. And my colleagues told me that they have also encountered this issue (they observed about 2 points drop on their QA task). So I wrote a small [script](https://gist.github.com/magic282/94bdbb3b9ddef891d7aa40f0b0069a0f), and found that the parameters are identical, but the result is different after saving and loading.

And I also found this thread https://discuss.pytorch.org/t/saving-and-loading-a-model-in-pytorch/2610/21

The code on github gist runs on Windows (peterjc123‚Äôs 0.3.0 build). On linux (also 0.3.0 , I built a docker image myself by installing pytorch through conda) it raises an error that I don‚Äôt understand why:



The thread I posted https://discuss.pytorch.org/t/parameters-are-different-after-loading-model/11457. ['python\r\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1512386481460/work/torch/lib/THC/THCTensorCopy.cu line=204 error=59 : device-side assert triggered\r\nTraceback (most recent call last):\r\n  File ""test.py"", line 120, in <module>\r\n    main()\r\n  File ""test.py"", line 76, in main\r\n    hidden = hidden.transpose(0, 1).contiguous().view(hidden.size(1), -1)\r\n  File ""/opt/conda/envs/pytorch-py3.6/lib/python3.6/site-packages/torch/autograd/variable.py"", line 280, in contiguous\r\n    self.data = self.data.contiguous()\r\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1512386481460/work/torch/lib/THC/THCTensorCopy.cu:204\r\n']"
94,17914,1,"Incorrect behaviour of min() and argmin(). ## üêõ Bug

PyTorch's implementation of the argmin() function returns incorrect (maybe rather unexpected results) when using the argmin() and the min() function on tensors with dimensions where the minimal value appears multiple times. PyTorch picks the last(!) index with said value, whereas one would assume that the very first occurrence is reported. This is inconsistent with numpy's, Eigen's, C++ STL etc.

## To Reproduce

PyTorch



## Expected behavior

numpy



## Environment

PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Fedora release 27 (Twenty Seven)
GCC version: (GCC) 7.3.1 20180712 (Red Hat 7.3.1-6)
CMake version: version 3.11.2

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.14.6
[pip3] torch==1.0.0
[conda] Could not collect

## Additional context

See numpy's argmin() documentation: https://docs.scipy.org/doc/numpy/reference/generated/numpy.argmin.html
. ['\r\nIn [80]: a = torch.triu(torch.ones((5,5,)))\r\n\r\nIn [81]: a\r\nOut[81]: \r\ntensor([[1., 1., 1., 1., 1.],\r\n        [0., 1., 1., 1., 1.],\r\n        [0., 0., 1., 1., 1.],\r\n        [0., 0., 0., 1., 1.],\r\n        [0., 0., 0., 0., 1.]])\r\n\r\nIn [82]: a.min(dim=0)\r\nOut[82]: (tensor([0., 0., 0., 0., 1.]), tensor([4, 4, 4, 4, 4]))\r\n', '\r\nIn [83]: b = np.triu(np.ones((5,5,)))\r\n\r\nIn [84]: b\r\nOut[84]: \r\narray([[1., 1., 1., 1., 1.],\r\n       [0., 1., 1., 1., 1.],\r\n       [0., 0., 1., 1., 1.],\r\n       [0., 0., 0., 1., 1.],\r\n       [0., 0., 0., 0., 1.]])\r\n\r\nIn [85]: b.min(0), b.argmin(0)\r\nOut[85]: (array([0., 0., 0., 0., 1.]), array([1, 2, 3, 4, 0]))\r\n']"
36,5351,1,"Wrong automatic gradient for Linear-Layer (Autograd/gradcheck). Minimal Example:

Output:

My Environment:
. ['\r\nimport torch.utils.data\r\nimport torch.autograd\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nimport torch.optim as optim\r\nfrom torch.autograd import Variable\r\nfrom torch.autograd import gradcheck\r\n\r\ntorch.manual_seed(123)\r\ninput = Variable(torch.rand(1,2), requires_grad = True)\r\ntest = gradcheck(nn.Linear(2,1), (input,), eps=1e-6, atol=1e-3)\r\nprint(test)\r\n', '\r\n numerical:(\r\n-0.3576\r\n 0.2682\r\n[torch.FloatTensor of size 2x1]\r\n,)\r\nanalytical:(\r\n-0.3512\r\n 0.2667\r\n[torch.FloatTensor of size 2x1]\r\n,)\r\n\r\n', '\r\nPython: (3, 5, 4)\r\nCuDNN: 7005\r\nCUDA: 8.0.61\r\nTorch: 0.3.1.post2\r\nNumpy: 1.13.3\r\n\r\n\r\n']"
428,27255,0,"[JIT] list comprehensions over tensors does not work. ## üêõ Bug

Following fails to compile:



List comprehensions over other iterables works; just not tensors.


cc @suo. ['\r\n@torch.jit.script\r\ndef fn(x):\r\n     return [img.shape[-2:] for img in zip(x)]\r\n']"
424,16288,0,"[JIT] Unable to append a tuple of tensor to a list. ## üêõ Bug

JIT is unable to append a  to a 

## To Reproduce



. ['\r\nimport torch\r\nclass ListOfTupleOfTensor(torch.jit.ScriptModule):\r\n    def __init__(self):\r\n        super(ListOfTupleOfTensor, self).__init__()\r\n\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n\r\n        returns = []\r\n        for i in range(10):\r\n            returns.append((x, x))\r\n\r\n        return returns\r\n\r\n\r\nc = ListOfTupleOfTensor()\r\nprint c.graph\r\n', ""\r\nRuntimeError: \r\narguments for call are not valid:\r\n  \r\n  for operator aten::append(Tensor[] self, Tensor el) -> Tensor[]:\r\n  expected a value of type Tensor for argument 'el' but found (Tensor, Tensor)\r\n  @torch.jit.script_method\r\n  def forward(self, x):\r\n      # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n  \r\n      returns = []\r\n      for i in range(10):\r\n          returns.append((x, x))\r\n                          ~~~~ <--- HERE\r\n  \r\n      return returns\r\n  \r\n  for operator aten::append(int[] self, int el) -> int[]:\r\n  expected a value of type int[] for argument 'self' but found Tensor[]\r\n  @torch.jit.script_method\r\n  def forward(self, x):\r\n      # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n  \r\n      returns = []\r\n      for i in range(10):\r\n          returns.append((x, x))\r\n          ~~~~~~~~~~~~~~ <--- HERE\r\n  \r\n      return returns\r\n  \r\n  for operator aten::append(float[] self, float el) -> float[]:\r\n  expected a value of type float[] for argument 'self' but found Tensor[]\r\n  @torch.jit.script_method\r\n  def forward(self, x):\r\n      # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n  \r\n      returns = []\r\n      for i in range(10):\r\n          returns.append((x, x))\r\n          ~~~~~~~~~~~~~~ <--- HERE\r\n  \r\n      return returns\r\n  \r\n  for operator aten::append(t[] self, t el) -> t[]:\r\n  could not match type (Tensor, Tensor) to t in argument 'el': type variable 't' previously matched to type Tensor is matched to type (Tensor, Tensor)\r\n  @torch.jit.script_method\r\n  def forward(self, x):\r\n      # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n  \r\n      returns = []\r\n      for i in range(10):\r\n          returns.append((x, x))\r\n                          ~~~~ <--- HERE\r\n  \r\n      return returns\r\n  \r\n  for operator aten::append(bool[] self, bool el) -> bool[]:\r\n  expected a value of type bool[] for argument 'self' but found Tensor[]\r\n  @torch.jit.script_method\r\n  def forward(self, x):\r\n      # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n  \r\n      returns = []\r\n      for i in range(10):\r\n          returns.append((x, x))\r\n          ~~~~~~~~~~~~~~ <--- HERE\r\n  \r\n      return returns\r\nfor call at:\r\n@torch.jit.script_method\r\ndef forward(self, x):\r\n    # type: (Tensor) -> List[Tuple[Tensor, Tensor]]\r\n\r\n    returns = []\r\n    for i in range(10):\r\n        returns.append((x, x))\r\n        ~~~~~~~~~~~~~~ <--- HERE\r\n\r\n    return returns\r\n\r\n""]"
474,6472,0,"Advanced indexing doesn't validate negative indexes (regression). Minimum example:

    torch.zeros(10)[torch.LongTensor([-11])] # returns bogus result on 0.4, error on 0.3.1

These all fail as they should:

    torch.zeros(10)[10]
    torch.zeros(10)[-11]
    torch.zeros(10)[torch.LongTensor([10])]

Works correctly on 0.3.1.post2.
Doesn't work on 0.4.0a0+df039e2.

Compiled with:
. [""\r\n‚ü´ gcc-5 -v\r\nUsing built-in specs.\r\nCOLLECT_GCC=gcc-5\r\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\r\nTarget: x86_64-linux-gnu\r\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.5.0-8ubuntu1' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\r\nThread model: posix\r\ngcc version 5.5.0 20171010 (Ubuntu 5.5.0-8ubuntu1) \r\n\r\n""]"
162,3981,0," Errors when computing second order gradients on gpu. Here is a piece of test code:



If the following conditions meet, the second order gradient cannot be computed:

1. you want to compute second order grad (not first order grad)
2. you network contains convolution (fc layer functions normally)
3. Computation on gpu (on cpu, everything was fine)

And the error is:

Add    won't fix anything.. [""\r\nimport math\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nfrom torch.autograd import Variable\r\nfrom torch.nn.parameter import Parameter\r\n\r\nclass ConvNet(nn.Module):\r\n    def __init__(self):\r\n        super(ConvNet, self).__init__()\r\n        self.conv1_weight = Parameter(torch.randn(10,1,3,3))\r\n        self.conv1_bias = Parameter(torch.randn(10))\r\n\r\n    def forward(self, x):\r\n        out = x\r\n        out = F.conv2d(out, self.conv1_weight, bias=self.conv1_bias)\r\n        return out\r\n\r\nif __name__ == '__main__':\r\n    from torch.autograd import grad\r\n    model = ConvNet()\r\n    model.cuda()\r\n    x = Variable(torch.randn(1,1,28,28)).cuda()\r\n    print(x.size())\r\n    y = model(x)\r\n    print(y.size())\r\n    loss = torch.mean(y.pow(2))\r\n    g = grad(loss, model.parameters(), create_graph=True, retain_graph=True)[0]\r\n    gg = grad(g[0,0,0,0], model.parameters(), retain_graph=True)[0] ## bug\r\n"", '\r\nRuntimeError: CUDNN_STATUS_NOT_SUPPORTED. This error may appear if you passed in a non-contiguous input.\r\n']"
417,20579,0,"Exception when adding custom scalars in tensorboard. ## üêõ Exception when adding custom scalars in tensorboard

An exception is raised when adding custom scalars using 



## To Reproduce
Minimal code to reproduce:


Running this results in:


## Environment

Please copy and paste the output from our


## Additional context

The exception message is quite clear, the required type is  but we have a , this happens [here](https://github.com/pytorch/pytorch/blob/09f22d10a695bfba8ffb3327b9920fd3358c00ee/torch/utils/tensorboard/summary.py#L381):


Should be enough to remove the surrounding square brackets, PR is coming.. [""python\r\nfrom torch.utils.tensorboard import SummaryWriter\r\n\r\nwith SummaryWriter() as writer:\r\n    writer.add_custom_scalars({'Stuff': {\r\n        'Losses': ['MultiLine', ['loss/(one|two)']],\r\n        'Metrics': ['MultiLine', ['metric/(three|four)']],\r\n    }})\r\n"", '\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 3, in <module>\r\n  File ""/some/path/python3.7/site-packages/torch/utils/tensorboard/writer.py"", line 733, in add_custom_scalars\r\n    self._get_file_writer().add_summary(custom_scalars(layout))\r\n  File ""/some/path/python3.7/site-packages/torch/utils/tensorboard/summary.py"", line 383, in custom_scalars\r\n    smd = SummaryMetadata(plugin_data=PluginData)\r\nTypeError: Parameter to MergeFrom() must be instance of same class: expected tensorboard.SummaryMetadata.PluginData got list.\r\n', '\r\nPyTorch version: 1.1.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration: GPU 0: GeForce GTX 1050 Ti with Max-Q Design\r\nNvidia driver version: 418.43\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.16.3\r\n[pip] torch==1.1.0\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.3                      199  \r\n[conda] mkl_fft                   1.0.12           py37ha843d7b_0  \r\n[conda] mkl_random                1.0.2            py37hd81dba3_0  \r\n[conda] pytorch                   1.1.0           py3.7_cuda10.0.130_cudnn7.5.1_0    pytorch\r\n', ""python\r\n    PluginData = [SummaryMetadata.PluginData(plugin_name='custom_scalars')]  # <--\r\n    smd = SummaryMetadata(plugin_data=PluginData)\r\n""]"
184,7857,0,"Feature Request: Logistic Distribution. Could we have logistic distribution in PyTorch?

https://github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/contrib/distributions/python/ops/logistic.py

cc @fritzo @neerajprad @alicanb @nikitaved @brianjo @mruberry. []"
203,6932,0,"Exception NameError: ""global name 'FileNotFoundError' is not defined"". 

This error is coming while implementing pytorch faster-rcnn repository. Any solutions please??. []"
319,24915,0,"Shared Dataset Functionality. ## üöÄ Feature

We want to build a unified data pipeline interface that offers building blocks for others to build on with the following objectives:
* Standardize datasets across domains.
* Offer flexible building blocks that can be combine to obtain other datasets.
* Enable datasets that do not fit in memory.
* Share code among domains.
* Facilitate parallel loading and processing of data.
* Decouple data loading and preprocessing/transformation.
* Offer static typing for datasets

## Motivation

* The Domains currently each have their own non-standard dataset structure that may also download the data. This duplicate efforts and adds complexity to the user.
* A common bottleneck when generating datasets is reading the data. We want to offer an interface that enables reading the data and running initial preprocessing while maximizing available computing resources utilization.
* We may want to leverage specialize libraries such as NVIDIA DALI.

## Additional Information

* [torch.utils.data](https://github.com/pytorch/pytorch/blob/master/torch/utils/data/)
* [tf.data](https://www.tensorflow.org/beta/guide/data) (e.g. uses dictionary for data point iteration)
* fast.ai's [basic_data](https://docs.fast.ai/basic_data.html) and [data_block](https://docs.fast.ai/data_block.html)
* [tnt](https://github.com/pytorch/tnt/blob/master/torchnet/dataset/dataset.py)
* [torchnet](https://github.com/torchnet/torchnet/tree/master/dataset)
* [~~torchdata~~](https://pypi.org/project/torchdata/)

Datasets:
* pytorch/text#624 pytorch/text#610 pytorch/audio#303 new datasets in domains
* pytorch/vision#1193 wants to select which metadata to return
* Internal: [overview](https://fb.quip.com/vlWwA35cmq0t) [torchtext](https://fb.quip.com/LncwAsC1cUZt) [core](https://fb.quip.com/B0PeACndlZEE) [torchvision](https://fb.quip.com/WGsUApsce6xN)
* [safe datasets](https://github.com/msamogh/nonechucks)

Dataloader:
* [torchaudio background iterator](https://github.com/pytorch/audio/blob/master/torchaudio/datasets/utils.py#L314)
* #24915 wants to re-use worker processes
* [FastDataLoader](https://github.com/pytorch/pytorch/issues/15849#issuecomment-573921048)
* [python 3.8 shared memory](https://docs.python.org/3/library/multiprocessing.shared_memory.html)
* Internal: [torchdata](https://fb.quip.com/ekJJAsYqMG7X) [gil](https://docs.google.com/document/d/1InJP79dWTIYj-xGVU65Y2r-K2HeL6t2l1xGDfKTU4Rw/edit#) [experiment](https://fb.quip.com/imVLAOdyJfAI) [DataLoader+Iterable](https://fb.workplace.com/groups/2162019300778793/permalink/3398854433474998/)

Features:
* #12672 wants to move collate_fn functionality to datasets
* #26547 wants distributed random sampling
* #28743 for sampler for iterable datasets
* pytorch/vision#1315 wants to apply an instance of random transform sequence to many images

cc @SsnL @fmassa @zhangguanheng66 @vincentqb @mrshenli . []"
211,6164,0,"feature requests and future roadmap. PyTorch Feature Requests and Future RoadMap
--------------------------------
Hello everyone and thank your for this great project. I would like to point to some things that I find important for the future growth of pytorch. 

1. Easy name conventions throughout the library. I believe that some things should be renamed so that it resonates and are easier to remember. This will also lower the entry bar for new people exposed to pytorch.

Example:


The  or  doesn't mean anything to me and as soon as I use them my brain has already forgotten about it. A more sane naming good be  that seems to be a universal convention pretty much since other major libraries are using it.

I would also love to see something like ,  , , , , etc.

2. Model dissection. 
More often we find ourselves in a scenario where we would like to get the output of a complex model at different levels.

Example:


3. Dataset preprocessing and transformation pipeline switch between cpu/gpu
Many times we find ourselves the need to do the data preprocessing on the gpu especially in the scenario where there is an abundance. But the choice at the moment is inexistent. There should be a flag for the user to easily switch between cpu and gpu upon request in order to chose where the data preprocessing should take place.

4. Addition of negative indexing in Tensors.

5. Integration and applicability with already pre-existing tools.
Some tools that already pre-exist and are nice to have an out of the box support and integration with them. For instance tensorboard is great but at the moment we need to rely on third party developed plugins for this to work. Instead it would be better if pytorch had the ability to dump logs that can be consumed by tensorboard directly. 

5. Serving models is completely inexistent at the moment of writing.

For anyone else please feel free to add anything else you might think is important for future directions.
Basically I just watched the whole tf dev summit and the one advantage that pytorch might had against tf was the dynamic models but now that's gonna with eager mode. And since folks at tf have faster release cycles they can fail and iterate faster on concepts and ideas. A lot of people where nagging about the language choices which where horrific but since then they have iterated over a lot and brought it up to a sane level .

These things make me wonder about the future directions and where pytorch is heading?


Thank you!
. [""\r\nimport torch\r\nimport torchvision\r\nimport torchvision.models as models\r\nmodel = models.densenet201()\r\n\r\nto iterate over the layers I'll have to do the following\r\n\r\nfor idx, m in enumerate(model.named_modules):\r\n"", ""\r\nlet's say we have the model = models.densenet201()\r\nto get the output at different levels we would have to do something like this\r\nmodel1 = nn.Sequential(*list(model.children())[:4])\r\nmodel2 = nn.Sequential(*list(model.children())[:7])\r\n\r\nWhich feels more of a hack to me TBH.\r\n\r\nI would much  rather prefer to do the following:\r\n\r\nmodel1 = model.layers.layer_name or model.layers[4].output\r\n""]"
572,15138,0,"Build simple c++ example-cpp using Libtorch fails on arm with undefined reference to c10::Error::Error. ## üêõ Bug

<!-- After building PyTorch from source, to generate libs required to run https://pytorch.org/cppdocs/installing.html on arm, building example-cpp fails with following error. -->

## To Reproduce

Steps to reproduce the behavior:

1.Build PyTorch from source.

2.Replace libs folder in Libtorch (https://download.pytorch.org/libtorch/nightly/cu90/libtorch-shared-with-deps-latest.zip) with the pytorch/build/lib (lib folder created on arm after building pytorch).

3.build the example-cpp 

## Error Message

>  nvidia@tegra-ubuntu:~/uvaidya/LibTorch/example-app/build$ make
> [ 50%] Linking CXX executable example-app
> CMakeFiles/example-app.dir/example-app.cpp.o: In function c10::Error::Error(c10::SourceLocation, std::string const&)'
> example-app.cpp:(.text._ZN3c106DeviceC2ENS_10DeviceTypeEs[_ZN3c106DeviceC5ENS_10DeviceTypeEs]+0x1bc): undefined reference to at::TensorOptions::device() const':
> example-app.cpp:(.text._ZNK2at13TensorOptions6deviceEv[_ZNK2at13TensorOptions6deviceEv]+0x30): undefined reference to at::TensorOptions::requires_grad() const':
> example-app.cpp:(.text._ZNK2at13TensorOptions13requires_gradEv[_ZNK2at13TensorOptions13requires_gradEv]+0x38): undefined reference to c10::impl::getDeviceGuardImpl(c10::DeviceType)':
> example-app.cpp:(.text._ZN3c104impl18getDeviceGuardImplENS_10DeviceTypeE[_ZN3c104impl18getDeviceGuardImplENS_10DeviceTypeE]+0x11c): undefined reference to torch::autograd::make_variable(at::Tensor, bool)':
> example-app.cpp:(.text._ZN5torch8autograd13make_variableEN2at6TensorEb[_ZN5torch8autograd13make_variableEN2at6TensorEb]+0xbc): undefined reference to torch::jit::SourceRange::highlight(std::ostream&) const':
> example-app.cpp:(.text._ZNK5torch3jit11SourceRange9highlightERSo[_ZNK5torch3jit11SourceRange9highlightERSo]+0x1c0): undefined reference to c10::Error::Error(c10::SourceLocation, std::string const&)'
> example-app.cpp:(.text._ZNK5torch3jit11SourceRange9highlightERSo[_ZNK5torch3jit11SourceRange9highlightERSo]+0x41c): undefined reference to c10::Error::Error(c10::SourceLocation, std::string const&)' follow
> CMakeFiles/example-app.dir/example-app.cpp.o: In function c10::Symbol::fromQualString(std::string const&)'
> CMakeFiles/example-app.dir/example-app.cpp.o: In function c10::Error::Error(c10::SourceLocation, std::string const&)'
> collect2: error: ld returned 1 exit status
> CMakeFiles/example-app.dir/build.make:99: recipe for target 'example-app' failed
> make[2]: *** [example-app] Error 1
> CMakeFiles/Makefile2:72: recipe for target 'CMakeFiles/example-app.dir/all' failed
> make[1]: *** [CMakeFiles/example-app.dir/all] Error 2
> Makefile:83: recipe for target 'all' failed
> make: *** [all] Error 2


## Environment

Collecting environment information...
PyTorch version: 1.0.0a0+db5d313
Is debug build: No
CUDA used to build PyTorch: 9.2.78

OS: Ubuntu 16.04 LTS
GCC version: (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.12.3

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: Probably one of the following:
/usr/lib/aarch64-linux-gnu/libcudnn.so.7.1.2
/usr/lib/aarch64-linux-gnu/libcudnn_static_v7.a

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect



. []"
721,3798,0,"Can't Install from source if path contains a space. Hi everyone,

silly ""gotcha"" installing the latest master from source (on ubuntu 16)- if there is a space in the path you install from, it fails to compile the ""compiler simple test"", and throws some fairly obscure error messages about cc being an unrecognised compiler.

Perhaps just needs a line in the instructions, as it took digging through the compiler logs to find the issue (unless i missed something!).

Apologies if duplicated, but couldn't find a relevant issue in a quick search. Happy to contribute fix to docs etc if required.. []"
477,16045,0,"Bug: fail to throw error when computing loss between tensors with shapes [n, 1] and [n]. ## Issue description
When computing the loss between  and  with shapes such as  and , an error should be thrown.  Indeed, my colleagues tell me this was the case in version 0.4, but lost in version 1.0.

## Code example

If you leave y.reshape commented out, the correct estimates of this straightforward linear regression problem are not found and the loss fails to decrease into a region near the global optimum of this convex problem.  Yet, no error is raised.

If you uncomment y.reshape, the correct estimates are found and the loss decreases in the anticipated way.


## System Info
Collecting environment information...
PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: None

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: Could not collect

Python version: 3.5
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] Could not collect
[conda] blas                      1.0                         mkl  
[conda] mkl                       2017.0.3                      0  
[conda] torch                     1.0.0                     <pip>
[conda] torchvision               0.2.1                     <pip>
. ['predicted', 'target', 'target.shape = [100]', 'predicted.shape = [100, 1]', '\r\n# Version 1.0\r\n# Set up straightforward linear regression problem.\r\nimport torch\r\nimport torch.nn as nn\r\nsample_size = 100\r\nx = torch.randn((sample_size,2))\r\neps = torch.randn(sample_size )\r\ny = 10 + 9*x[:,0] - 2*x[:, 1] +  eps\r\n#y = y.reshape(sample_size, 1)\r\nmodel = nn.Linear(2, 1)\r\n\r\noptimizer = torch.optim.SGD(model.parameters(), lr=.1)\r\nloss_func = nn.MSELoss()\r\nfor epoch in range(30):\r\n   optimizer.zero_grad()\r\n   yhat = model(x)\r\n   loss_val = loss_func(yhat, y)\r\n   loss_val.backward()\r\n   optimizer.step()\r\n   print(loss_val.item())\r\n\r\nprint(model.weight.data)\r\nprint(model.bias.data)\r\n\r\n']"
741,6384,0,"[Caffe2] [PyTorch] PyTorch to Caffe2 and Mobile using ONNX Tutorial: Segmentation Fault. Hello, 

I am trying to run [Transfering a model from PyTorch to Caffe2 and Mobile using ONNX](https://github.com/onnx/tutorials/blob/master/tutorials/PytorchCaffe2SuperResolution.ipynb) tutorial. However, I get segmentation fault error.

I think the segmentation error is triggered by the second part of the tutorial where loading ONNX model into Caffe2. While searching for what might cause this error I noticed that this tutorial has 2 different versions: one in Onnx Github Tutorial and the other in [PyTorch](http://pytorch.org/tutorials/advanced/super_resolution_with_caffe2.html) website. The onnx to caffe2 import for the two tutorials were different for the second part along with the implementation. One uses : import caffe2.python.onnx.backend and other import onnx_caffe2.backend. I tried with both tutorial but I get the same segmentation fault in both. Also, when I comment the onnx to caffe2 tutorial and the related import lines, the first part Pytorch to ONNX seems to work without any error.

Below, I will describe how I create my virtual env and the results from gdb after getting the Segmentation Fault:

Dependencies:
cuda/8.0 
cudnn/v6.0
opencv/3.4.1
nccl/2.0.5
caffe2/2018-03-02 


To run the code I used the following command (with 6GB RAM, 1 GPU with 6GB): 


Also, I upgraded the numpy and pyyaml versioons with:


Otherwise, I get:


After upgrading the numpy version, when I run the code I get the Segmentation Fault:


I tried to run the code in gdb as well to see where exactly the fault occurs:




In both tutorial, the segmantation fault occurs in the same place. I don't know how to fix this error. I didn't change anything in the code. I am not sure why I am getting this error. 

I really appreciate if you can help me to fix it.


**Note: I already opened an [issue ](https://github.com/onnx/tutorials/issues/29) on onnx repo but I want to cross-reference the issue since I noticed that I get the same error in [PyTorch Tutorial](http://pytorch.org/tutorials/advanced/super_resolution_with_caffe2.html) as well.** 





. ['\r\n#Virtual env creation:\r\n--mem 6G virtualenv --system-site-packages ~/workspace/p_c2_onnx/pc2_onnx \r\n source ~/workspace/p_c2_onnx/pc2_onnx/bin/activate\r\n\r\n#install and check caffe2\r\npip install -r /usr/local/opt/caffe2-2018-03-02/requirements.txt \r\nsrun --mem 2G --gres=gpu:1 python -c \'from caffe2.python import core\'\r\n\r\n#install pytorch and  torchvision\r\npip install http://download.pytorch.org/whl/cu80/torch-0.3.1-cp27-cp27mu-linux_x86_64.whl \r\npip install torchvision \r\n\r\n#install onnx and check\r\n--mem 6G pip install onnx\r\n--mem 6G --gres=gpu:1 python -c ""import onnx""\r\n\r\n#(The below is used only for the tutorial given in PyTorch)\r\n#install onnx-caffe2\r\npip install onnx-caffe2\r\n', '--mem 6GB --gres=gpu:1,gmem:6G python SuperResolution.py', '\r\npip install numpy --upgrade\r\npip install pyyaml --upgrade\r\n', 'error: RuntimeError: module compiled against API version 0xa but this version of numpy is 0x9', '\r\nExported model has been executed on Caffe2 backend, and the result looks good!\r\nsrun: error: c6: task 0: Segmentation fault\r\n', '\r\n(gdb) run SuperResolution_onnxgit.py \r\nStarting program: /imatge/gcamli/workspace/p_c2_onnx/onnx_2/bin/python SuperResolution_onnxgit.py\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library ""/lib/x86_64-linux-gnu/libthread_db.so.1"".\r\n[New Thread 0x7ffff4033700 (LWP 32594)]\r\n[New Thread 0x7ffff3832700 (LWP 32595)]\r\n[New Thread 0x7ffff1031700 (LWP 32596)]\r\n[New Thread 0x7fffee830700 (LWP 32597)]\r\n[New Thread 0x7fffec02f700 (LWP 32598)]\r\n[New Thread 0x7fffeb82e700 (LWP 32599)]\r\n[New Thread 0x7fffeb02d700 (LWP 32600)]\r\n[New Thread 0x7fffea82c700 (LWP 32601)]\r\n[New Thread 0x7fffe802b700 (LWP 32602)]\r\n[New Thread 0x7fffe382a700 (LWP 32603)]\r\n[New Thread 0x7fffe1029700 (LWP 32604)]\r\n[New Thread 0x7fffde828700 (LWP 32605)]\r\n[New Thread 0x7fffdc027700 (LWP 32606)]\r\n[New Thread 0x7fffd9826700 (LWP 32607)]\r\n[New Thread 0x7fffd7025700 (LWP 32608)]\r\n[New Thread 0x7fffd0824700 (LWP 32611)]\r\n[New Thread 0x7fffce023700 (LWP 32614)]\r\n[New Thread 0x7fffcb822700 (LWP 32617)]\r\n[New Thread 0x7fffc9021700 (LWP 32618)]\r\n[New Thread 0x7fffc6820700 (LWP 32621)]\r\n[New Thread 0x7fffc401f700 (LWP 32623)]\r\n[New Thread 0x7fffc181e700 (LWP 32624)]\r\n[New Thread 0x7fffbf01d700 (LWP 32625)]\r\n[New Thread 0x7fffbc81c700 (LWP 32626)]\r\n[New Thread 0x7fffba01b700 (LWP 32627)]\r\n[New Thread 0x7fffb781a700 (LWP 32628)]\r\n[New Thread 0x7fffb5019700 (LWP 32629)]\r\n[New Thread 0x7fffb2818700 (LWP 32630)]\r\n[New Thread 0x7fffb0017700 (LWP 32631)]\r\n[New Thread 0x7fffad816700 (LWP 32632)]\r\n[New Thread 0x7fffab015700 (LWP 32633)]\r\n[Thread 0x7ffff4033700 (LWP 32594) exited]\r\n[Thread 0x7ffff3832700 (LWP 32595) exited]\r\n[Thread 0x7ffff1031700 (LWP 32596) exited]\r\n[Thread 0x7fffee830700 (LWP 32597) exited]\r\n[Thread 0x7fffec02f700 (LWP 32598) exited]\r\n[Thread 0x7fffeb82e700 (LWP 32599) exited]\r\n[Thread 0x7fffeb02d700 (LWP 32600) exited]\r\n[Thread 0x7fffea82c700 (LWP 32601) exited]\r\n[Thread 0x7fffe802b700 (LWP 32602) exited]\r\n[Thread 0x7fffe382a700 (LWP 32603) exited]\r\n[Thread 0x7fffe1029700 (LWP 32604) exited]\r\n[Thread 0x7fffde828700 (LWP 32605) exited]\r\n[Thread 0x7fffdc027700 (LWP 32606) exited]\r\n[Thread 0x7fffd9826700 (LWP 32607) exited]\r\n[Thread 0x7fffd7025700 (LWP 32608) exited]\r\n[Thread 0x7fffd0824700 (LWP 32611) exited]\r\n[Thread 0x7fffce023700 (LWP 32614) exited]\r\n[Thread 0x7fffcb822700 (LWP 32617) exited]\r\n[Thread 0x7fffc9021700 (LWP 32618) exited]\r\n[Thread 0x7fffc6820700 (LWP 32621) exited]\r\n[Thread 0x7fffc401f700 (LWP 32623) exited]\r\n[Thread 0x7fffc181e700 (LWP 32624) exited]\r\n[Thread 0x7fffbf01d700 (LWP 32625) exited]\r\n[Thread 0x7fffbc81c700 (LWP 32626) exited]\r\n[Thread 0x7fffba01b700 (LWP 32627) exited]\r\n[Thread 0x7fffb781a700 (LWP 32628) exited]\r\n[Thread 0x7fffb5019700 (LWP 32629) exited]\r\n[Thread 0x7fffb2818700 (LWP 32630) exited]\r\n[Thread 0x7fffab015700 (LWP 32633) exited]\r\n[Thread 0x7fffb0017700 (LWP 32631) exited]\r\n[Thread 0x7fffad816700 (LWP 32632) exited]\r\n[New Thread 0x7fffab015700 (LWP 32668)]\r\n[New Thread 0x7fffad816700 (LWP 32671)]\r\n[New Thread 0x7fffb0017700 (LWP 32672)]\r\n[New Thread 0x7fffb2818700 (LWP 32682)]\r\nExported model has been executed on Caffe2 backend, and the result looks good!\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00000000004a6fb0 in ?? ()\r\n', '\r\n(gdb) where\r\n#0  0x00000000004a6fb0 in ?? ()\r\n#1  0x000000000041a703 in ?? ()\r\n#2  0x00000000004a6047 in ?? ()\r\n#3  0x0000000000515d00 in PyGC_Collect ()\r\n#4  0x0000000000513c1f in Py_Finalize ()\r\n#5  0x0000000000498099 in Py_Main ()\r\n#6  0x00007ffff6f12b45 in __libc_start_main (main=0x497c60 <main>, \r\n    argc=2, argv=0x7fffffffc258, init=<optimized out>, \r\n    fini=<optimized out>, rtld_fini=<optimized out>, \r\n    stack_end=0x7fffffffc248) at libc-start.c:287\r\n#7  0x0000000000497b8b in _start ()\r\n(gdb) \r\n']"
497,23823,0,"pytorch cannot be installed under Windows 10 if Python 3.7 was installed from Microsoft Store. ## Issue description

pytorch 1.1.0 cannot be installed under Windows 10 if Python 3.7 was installed from Microsoft Store.

The reason is a combination of
a) long Python installation path used by Microsoft Store installer
b) long filename path used within pytorch for collect_and_distribute_fpn_rpn_proposals_op_test.test_collect_and_dist.zip
c) by default, Windows 10 still refuses paths longer than 256 characters

## Code example


fails with an error message:

> 

The error is caused by the 256 character limit on Windows paths. With a file and pathname so long, no matter how short <username> is the path is 257 characters or longer.

## System Info
PyTorch version: 1.1.0
OS: Microsoft Windows 10 Pro, Version 1903 
Python version: 3.7

Versions of relevant libraries:
[pip3] numpy==1.17.0
[pip3] torch==1.1.0
[pip3] torchvision==0.3.0
. []"
189,25512,0,"Can't import torch after installing with Conda on Ubuntu. ## üêõ Bug

I installed CUDA and CUDNN via the following tutorial: (https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html), then,
I installed pytorch on Ubuntu 18.04 according to the pytorch website, selecting stable (1.2), Linux, Conda, Python3.7, CUDA10.0, using a virtualenv.  Then, when I go to import:

>>> import torch
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
ModuleNotFoundError: No module named 'torch'

I rebooted, made sure my PATH variable included anaconda:
 /home/dan/anaconda3/bin:/home/dan/anaconda3/envs/torch_1-2-0/bin:/home/dan/anaconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/cuda-10.1/bin:/usr/local/cuda-10.1/bin

I'm sure that it is pointing to the correct Python: alias python='/home/dan/anaconda3/bin/python'

Upon seeing some advice in a different ticket to ""conda upgrade cudatoolkit"", I did that, and didn't work.

I then decided maybe since my CUDA version is 10.1, I would alter the install command (conda install pytorch torchvision cudatoolkit=10.0 -c pytorch) to say cudatoolkit10.1.  That rolled pytorch back to 1.0, CUDA to 9.0, and generally didn't work, so I put everything back after that.

 - PyTorch Version (e.g., 1.0): 1.2
 - OS (e.g., Linux): Ubuntu 18.04
 - How you installed PyTorch (, , source): conda install pytorch torchvision cudatoolkit=10.0 -c pytorch (from the correct virtualenv)
 - Python version: 3.7.3, Conda version 4.6.11
 - CUDA/cuDNN version: 10.1 / 7.6.3
 - GPU models and configuration: NVIDIA 2080 TI RTX
 - Any other relevant information:  conda list:
# Name                    Version                   Build  Channel
cudatoolkit               10.1.168                      0  
pytorch                   1.2.0           cpu_py37h00be3c6_0  
torchvision               0.4.0           cuda100py37hecfc37a_0

Any help would be greatly appreciated.. []"
420,22135,0,[dataloader] type annotation is broken. In #19228 I did not update the type annotations. We should fix this.. []
317,4181,0,"Fused RNN refactor plan. This ticket is to track our plan to refactor the fused RNN API (which makes use of the CuDNN implementation of RNNs).

**Why is this difficult?** There are a number of factors which make fused RNNs unusual, compared to most of the other differentiable operations in PyTorch

* It requires an unusually large, structured series of weights. Most differentiable operators have a fixed number of weights, but an RNN for an entire sequence must have weights for every layer of the RNN. To make matters worse, each layer needs not one but two tensors; the weight and the bias. No other operator in PyTorch behaves like this.

* CuDNN requires these weights and inputs to be packed in a particular way.  The required packing operations are frequently reported by users as an extremely confusing aspect of PyTorch.

* Not only do the weights vary depending on the type of RNN, so do the hidden tensors. If you are an LSTM, you have both hx and cx; for other RNNs, only hx is needed.

* RNN with dropout is a stateful API, which requires dropout descriptors to be passed between invocations to handle randomness.

**What do we want to do?** Here are the desired goals of the RNN refactor:

* Make CuDNN RNN available from ATen

**Design ideas.**

* The ATen API will take two tensors,  and , with  being undefined tensor for non-LSTM networks.

cc @csarofeen @ptrblck. []"
239,9356,0,"RuntimeError: cuda runtime error (8) : invalid device function at /opt/conda/conda-bld/pytorch_1518243271935/work/torch/lib/THCUNN/generic/Threshold.cu:34. [forums](https://discuss.pytorch.org/).

If you are submitting a bug report, please fill in the following details.
I am using linux machine with ubuntu in it . 
Ubuntu Version 16.04 lts
NVIDIA  930mx
Nvidia driver version :  384.184

## Issue description
RuntimeError: cuda runtime error (8) : invalid device function at /opt/conda/conda-bld/pytorch_1518243271935/work/torch/lib/THCUNN/generic/Threshold.cu:34
Provide a short description.

## Code example
 This code is is for the segnet , for detection of Vessel in retina.

Please try to provide a minimal example to repro the bug.
Error messages and stack traces are also helpful.

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


- PyTorch or Caffe2:
- How you installed PyTorch (conda, pip, source): conda
- Build command you used (if compiling from source):
- OS:  Ubuntu 16.04
- PyTorch version: 0.3.1u
- Python version: 3.6
- CUDA/cuDNN version:7.5
![issue_pytorch](https://user-images.githubusercontent.com/24300927/42598377-a3d0db30-8579-11e8-9db3-886d6a9e498c.png)

- GPU models and configuration:
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. [""\r\niterations = 100\r\ntrainLoss = []\r\ntestLoss = []\r\nstart = time.time()\r\n\r\nfor epoch in range(iterations):\r\n    epochStart = time.time()\r\n    runningLoss = 0   \r\n    net.train(True) # For training\r\n    for data in trainLoader:\r\n        inputs,labels = data\r\n        # Wrap them in Variable\r\n        if use_gpu:\r\n            inputs, labels = Variable(inputs.cuda()), \\\r\n                Variable(labels.long().cuda())\r\n        else:\r\n            inputs, labels = Variable(inputs), Variable(labels.long())      \r\n \r\n        \r\n        # Feed-forward input data through the network\r\n        outputs = net(inputs)\r\n        # Compute loss/error\r\n        loss = criterion(F.log_softmax(outputs), labels)      \r\n        # Initialize gradients to zero\r\n        optimizer.zero_grad()                  \r\n        # Backpropagate loss and compute gradients\r\n        loss.backward()\r\n        # Update the network parameters\r\n        optimizer.step()\r\n        # Accumulate loss per batch\r\n        runningLoss += loss.data[0]          \r\n    avgTrainLoss = runningLoss/600.0    \r\n    trainLoss.append(avgTrainLoss)\r\n  \r\n    \r\n    # Evaluating performance on test set for each epoch\r\n    net.train(False) # For testing\r\n    test_runningLoss = 0    \r\n    for data in testLoader:\r\n        inputs,labels = data\r\n        # Wrap them in Variable\r\n        if use_gpu:\r\n            inputs, labels = Variable(inputs.cuda()), \\\r\n                Variable(labels.long().cuda())\r\n        else:\r\n            inputs, labels = Variable(inputs), Variable(labels.long())         \r\n        outputs = net(inputs)       \r\n         # Compute loss/error\r\n        loss = criterion(F.log_softmax(outputs), labels)      \r\n        # Accumulate loss per batch\r\n        test_runningLoss += loss.data[0] \r\n        \r\n    avgTestLoss = test_runningLoss/20.0    \r\n    testLoss.append(avgTestLoss)\r\n        \r\n    # Plotting Loss vs Epochs\r\n    fig1 = plt.figure(1)        \r\n    plt.plot(range(epoch+1),trainLoss,'r--',label='train')        \r\n    plt.plot(range(epoch+1),testLoss,'g--',label='test')        \r\n    if epoch==0:\r\n        plt.legend(loc='upper left')\r\n        plt.xlabel('Epochs')\r\n        plt.ylabel('Loss')   \r\n      \r\n    \r\n    epochEnd = time.time()-epochStart\r\n    print('At Iteration: {:.0f} /{:.0f}  ;  Training Loss: {:.6f}; Time consumed: {:.0f}m {:.0f}s '\\\r\n          .format(epoch + 1,iterations,avgTrainLoss,epochEnd//60,epochEnd%60))\r\n    print('At Iteration: {:.0f} /{:.0f}  ;  Testing Loss: {:.6f} ; Time consumed: {:.0f}m {:.0f}s '\\\r\n          .format(epoch + 1,iterations,avgTestLoss,epochEnd//60,epochEnd%60))\r\nend = time.time()-start\r\nprint('Training completed in {:.0f}m {:.0f}s'.format(end//60,end%60))\r\n"", '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
47,3869,1,"Why the Dropout2d and BatchNorm2d's model.eval() result is poor. Recent I'm doing a project using the elegant tool,pytorch. I use the dropout2d and batchnorm2d in my network.The trained model performance well in the test phase if I didn't using the model.eval(). However,when I use the model.eval(), the result is very pool. I really feel  confused.I sincerely hope the developer can help me solving this confusion. Thank you very much!. []"
165,4403,0,Pytorch docsÔºöRNN weight_ih_l[k]  shape error. In pytorch docsÔºåtorch.nn.RNN parts show that variable **weight_ih_l[k]**  has shape of input_size x hidden_sizeÔºåhowever it should be hidden_size x input_size.. []
8,31295,1,"nll_loss with weights: reduction 'mean' gives wrong result . ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:




1. on cpu


2. on gpu

tensor([1, 0, 4], device='cuda:0')

>>> reduction = ['none', 'sum', 'mean']
>>> for r in reduction:
...        m = F.log_softmax(i, dim=1)
...        loss = F.nll_loss(m, target, w, reduction=r)

none :  tensor([-0.0455,  0.1291,  0.8693], device='cuda:0', grad_fn=<NllLossBackward>)
sum :  tensor(0.9530, device='cuda:0', grad_fn=<NllLossBackward>)
mean :  tensor(2.3681, device='cuda:0', grad_fn=<NllLossBackward>)
>> loss = F.nll_loss(m, target, w, reduction='none')>> loss.mean()mean :  tensor(0.8193, grad_fn=<MeanBackward0>)`

<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: 1.3.1
Is debug build: No
CUDA used to build PyTorch: 10.1.243

OS: Ubuntu 18.04.3 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: version 3.0.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.1.243
GPU models and configuration: 
GPU 0: TITAN X (Pascal)
GPU 1: TITAN X (Pascal)

Nvidia driver version: 430.50
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.5

Versions of relevant libraries:
[pip3] numpy==1.13.3
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.4                      243  
[conda] mkl-service               2.3.0            py36he904b0f_0  
[conda] mkl_fft                   1.0.14           py36ha843d7b_0  
[conda] mkl_random                1.1.0            py36hd6b4f25_0  
[conda] pytorch                   1.3.1           py3.6_cuda10.1.243_cudnn7.6.3_0    pytorch
[conda] torchvision               0.4.2                py36_cu101    pytorch


cc @ezyang @gchanan @zou3519. [""\r\n>>> i = torch.randn(3, 5, requires_grad=True, device='cpu')\r\ntensor([[ 0.3367,  0.1288,  0.2345,  0.2303, -1.1229],\r\n        [-0.1863,  2.2082, -0.6380,  0.4617,  0.2674],\r\n        [ 0.5349,  0.8094,  1.1103, -1.6898, -0.9890]], requires_grad=True)\r\n\r\n>>> w = torch.randn(5, device='cpu')\r\ntensor([ 0.9580,  1.3221,  0.8172, -0.7658, -0.7506])\r\n\r\n>>> target = torch.tensor([1, 0, 4], device='cpu')\r\ntensor([1, 0, 4])\r\n\r\n>>> reduction = ['none', 'sum', 'mean']\r\n>>> for r in reduction:\r\n...        m = F.log_softmax(i, dim=1)\r\n...        loss = F.nll_loss(m, target, w, reduction=r)\r\n\r\nnone :  tensor([ 2.0560,  2.6612, -2.2593], grad_fn=<NllLossBackward>)\r\nsum :  tensor(2.4579, grad_fn=<NllLossBackward>)\r\nmean :  tensor(1.6070, grad_fn=<NllLossBackward>)\r\n""]"
357,20117,0,"[FR] [RFC] add Sequential.append & .extend. A common pattern people use in  of a  is to build a  first and then feed it into  because  doesn't support many handy methods existing on . E.g., 



This is totally unnecessary if we can just provide  and  on .. ['py\r\ndef __init__(self, logres):\r\n    super().__init__():\r\n    layers = [\r\n          nn.Conv2d(3, 64, kernel_size=11, stride=4, padding=2),\r\n          nn.ReLU(inplace=True),\r\n          nn.MaxPool2d(kernel_size=3, stride=2),\r\n    ]\r\n\r\n    for _ in range(logres):\r\n         layers.extend([\r\n              nn.Conv2d(3, 64, kernel_size=11, stride=4, padding=2),\r\n              nn.ReLU(inplace=True),\r\n              nn.MaxPool2d(kernel_size=3, stride=2),\r\n        ])\r\n    self.layers = nn.Sequential(*layers)\r\n']"
708,7722,0,"Error in backprop when using frozen LSTM layers (new with 0.4.0). ## Issue description

The general situation is that we have a pretrained Language Model, and during a first phase we only want to train the new embedding layer we added before fine-tuning the whole thing. This worked fine in 0.3 but now sends an error message during back propagation. Minimal reproduction is to just create a simple model with a linear layer and an LSTM, freeze this second layer (by applying require_grads=False to its parameters) and try to compute a back-propagation.

## Code example

See [here](https://github.com/sgugger/Deep-Learning/blob/master/Bug%20with%20frozen%20LSTM%20layer.ipynb)

## System Info
PyTorch version: 0.4.0                                                                                                  
Is debug build: No                                                                                                      
CUDA used to build PyTorch: 9.0                                                                                                                                                                                                                 OS: Microsoft Windows 10 Home                                                                                           
GCC version: Could not collect                                                                                         
CMake version: Could not collect                                                                                                                                                                                                                Python version: 3.6                                                                                                     
Is CUDA available: Yes                                                                                                  
CUDA runtime version: 9.1.85                                                                                            
GPU models and configuration: Could not collect                                                                         
Nvidia driver version: Could not collect                                                                                
cuDNN version: Could not collect                                                                                                                                                                                                                Versions of relevant libraries:                                                                                         
[pip] Could not collect                                                                                                 
[conda] Could not collect

Pytorch was installed with conda, the bug also appears on my linux instances.

Thanks for your help!. []"
86,12238,1,"Caffe2 is compiled without optimization passes.. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

Hi , I've compiled caffe2 for cpu inference on python 3, but I get the following warning  : 


so my question is how can I compile caffe2 with optimization passes ? 

~I've also noticed that during inference the model uses only one core of my cpu for inference , but I've compiled caffe2 with NNPACK enabled wich should make it use multi core~ (my bad i didn't set the correct engine to use for the convolution ops , that's why NNPACK wasn't used) 

The model used is faster-rcnn-FPN-101 converted to .pb from detectron, inference time reported on  cpu  for image of size 800x800 is 5.8 seconds 

thanks :)
. []"
503,8867,0,"[JIT] Normalize representation of traced and scripted functions/modules . Currently we have a mix of actual types when we script/trace a function/module:






This causes issues, for example, since we can only inline a  into a ScriptModule if it's an instance of GraphExecutor(https://github.com/pytorch/pytorch/blob/2b926aafb09575dd83ebf4fe2a76cbe239596f0b/torch/csrc/jit/script/init.cpp#L82). This causes problems in the case of calling Script/Traced modules from script functions -- they show up as s.

Let's make it so that all of {script,traced} {function,module} produce a Module, and re-work the inlining logic to merge modules in all cases. This will greatly simplify the logic and make things easier to understand and maintain. [""\r\nimport torch\r\n\r\n@torch.jit.script\r\ndef script_fn(x):\r\n    return x\r\n\r\nprint('*****Script function*****')\r\nprint(type(script_fn))\r\nprint(isinstance(script_fn, torch._C.GraphExecutor))\r\n\r\n@torch.jit.trace(torch.zeros(3, 3))\r\ndef trace_fn(x):\r\n    return x\r\n\r\nprint('*****Traced function*****')\r\nprint(type(trace_fn))\r\nprint(isinstance(trace_fn, torch._C.GraphExecutor))\r\n\r\nclass ScriptModule(torch.jit.ScriptModule):\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        return x\r\nsm = ScriptModule()\r\n\r\nprint('*****Script module*****')\r\nprint(type(sm))\r\nprint(isinstance(sm, torch._C.GraphExecutor))\r\n\r\nclass TracedModule(torch.nn.Module):\r\n    def forward(self, x):\r\n        return x\r\ntm = torch.jit.trace(torch.zeros(3, 3))(TracedModule())\r\n\r\nprint('*****Traced module*****')\r\nprint(type(tm))\r\nprint(isinstance(tm, torch._C.GraphExecutor))\r\n\r\n"", ""\r\n*****Script function*****\r\n<class 'torch._C.GraphExecutor'>\r\nTrue\r\n*****Traced function*****\r\n<class 'torch._C.GraphExecutor'>\r\nTrue\r\n*****Script module*****\r\n<class '__main__.ScriptModule'>\r\nFalse\r\n*****Traced module*****\r\n<class 'torch.jit.TopLevelTracedModule'>\r\nFalse\r\n""]"
129,3131,0,"cuda() methods on Module and Tensor/Variable are inconsistent. On , the keyword argument is named , but on Tensor/Variable, the keyword argument is just .. []"
249,16437,0,"cuDNN error when using half precision convolution. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

When using half precision convolution on PyTorch nightly (20190125), with torch.backends.cudnn.deterministic = True, CUDNN_STATUS_BAD_PARAM runtime error occurs

I found that when using latest PyTorch 1.0, or using fp32, or use torch.backends.cudnn.deterministic = False then this script runs without problem.

## To Reproduce

Steps to reproduce the behavior:





<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

Run without error
<!-- A clear and concise description of what you expected to happen. -->

## Environment

`

PyTorch version: 1.0.0.dev20190125
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration: GPU 0: Tesla V100-PCIE-32GB
Nvidia driver version: 410.79
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.4.1
/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect. [""python\r\nimport torch\r\nfrom torch import nn\r\n\r\ntorch.backends.cudnn.deterministic = True\r\n\r\nx = torch.randn(1, 1, 16, 16).to('cuda').half()\r\nconv = nn.Conv2d(1, 1, 3, bias=False).to('cuda').half()\r\n\r\nprint(conv(x).shape)\r\n"", 'python\r\nTraceback (most recent call last):\r\n  File ""main.py"", line 9, in <module>\r\n    print(conv(x).shape)\r\n  File ""/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py"", line 492, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py"", line 320, in forward\r\n    self.padding, self.dilation, self.groups)\r\nRuntimeError: cuDNN error: CUDNN_STATUS_BAD_PARAM\r\n']"
171,13574,0,"dist.all_reduce([tensor]) throws confusing error message. 

It seems internally the input is wrapped in another list, but this error is confusing.. ['\r\nTypeError: allreduce(): incompatible function arguments. The following argument types are supported:\r\n1. (self: torch.distributed.ProcessGroup, arg0: List[at::Tensor], arg1: torch.distributed.AllreduceOptions) -> c10d::ProcessGroup::Work\r\n2. (self: torch.distributed.ProcessGroup, tensor: at::Tensor, op: torch.distributed.ReduceOp = ReduceOp.SUM) -> c10d::ProcessGroup::Work\r\n']"
196,17882,0,"ProcessGroupNCCL error/timeout handling. As of NCCL 2.4 there are functions to detect I/O errors and abort running kernels. This is required to implement timeouts and force workers to raise an error or terminate when other workers fail.

See https://docs.nvidia.com/deeplearning/sdk/nccl-developer-guide/docs/api/comms.html and  and  and https://devblogs.nvidia.com/massively-scale-deep-learning-training-nccl-2-4/ for an example.. []"
749,15920,0,"How to let Batchnorm to use global mean in both training and inferance?. ## ‚ùì Questions and Help
**Observation:** 
(1) If I use the default bn layer and use model.eval() before infence.  Test result has a significant discrepancy between test and other test.
(2) If a set momentum to 0.0 and 0.1 in different tests. The results are also different. Is this discrepancy designed to be True? It doesn't make sense.
**Guess:** 
I guess this is because bn layer uses different mean and var in different tests. And model is senstive to these mean/var changes?
**Question:** 
(1) Is My guesses correct? If correct, I can I always use global mean and global var so that the result is same in both training and eval? 
(2) Is these bn parameters designed to changes with time? So different inference sequence causes diffferent result?
**Tried:**
 I tried set momentum to 0 or track_running_stats=False after load the model. Both doesn't work.
. []"
113,17632,0,"Caffe2 C++ script for classification/object_detection with CMakeLists.txt . ## ‚ùì Questions and Help

I was looking for caffe2 c++ script that supports latest version. But I couldn't find any good resource. Can anyone provide caffe2 c++ example script for classification. 

Thanks. . []"
452,11076,0,"[caffe2] testing, please ignore. If you have a question or would like help and support, please ask at our
[forums](https://discuss.pytorch.org/).

If you are submitting a feature request, please preface the title with [feature request].
If you are submitting a bug report, please fill in the following details.

## Issue description

Provide a short description.

## Code example

Please try to provide a minimal example to repro the bug.
Error messages and stack traces are also helpful.

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


- PyTorch or Caffe2:
- How you installed PyTorch (conda, pip, source):
- Build command you used (if compiling from source):
- OS:
- PyTorch version:
- Python version:
- CUDA/cuDNN version:
- GPU models and configuration:
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
46,4893,1,"GPU Softmax over last dimension of 3D tensor is slow. Recently I profiled one of my models with  and was surprised to find that the softmax layers for an attention mechanism were the most expensive entries in the  column.

My original code looked something like this:


After some experimentation, I tried adding some transposes to the code:



This increased my overall model speed by around 10%, and now matrix multiplication is at the top of  (which is what I would expect).

Could this be considered a performance bug? I wonder if there is some way for the softmax cuda code to have comparable speed regardless of the softmax dimension.

(Sorry I don't have sample code at the moment; my actual code is deeply embedded in the current project I'm doing.)

System info
- OS: Linux
- PyTorch version: 0.3.0
- How you installed PyTorch (conda, pip, source): conda
- Python version: 3.6
- CUDA/cuDNN version: CUDA 9
- GPU models and configuration: K80. ['\r\nself.softmax = nn.Softmax(dim=-1)\r\n# ...\r\n# attn is a 3D tensor (batch_size x length x length). Length is in the 30-200 range\r\nattn = self.softmax(attn)\r\n', '\r\nself.softmax = nn.Softmax(dim=1)\r\nattn = self.softmax(attn.transpose(1, 2)).transpose(1, 2)\r\n']"
530,17531,0,"JIT graph to ONNX Loop cond variable should be tensor(bool). ## üêõ Bug

ONNX Loop produced by  and  does not conform to ONNX loop spec: The second input to ONNX loop--the conditional variable --should be , but I got . 

## To Reproduce

Run the following script (environment details below):



produces the following ONNX program:



 is tensor of type  (see the program print out). However,  is the second input to , which is required to be  by the [ONNX spec](https://github.com/onnx/onnx/blob/master/docs/Operators.md#Loop). 

## Environment
PyTorch version: 1.0.1.post2
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.14.1
GCC version: Could not collect
CMake version: version 3.13.4

Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.16.1
[pip3] torch==1.0.1.post2
[conda] Could not collect

. ['\r\nfrom __future__ import print_function\r\nimport torch\r\nimport onnx\r\nfrom onnx.onnx_pb2 import TensorProto\r\n\r\nclass SimpleModel(torch.jit.ScriptModule):\r\n    def __init__(self):\r\n        super(SimpleModel, self).__init__()\r\n        #self.xx = torch.zeros(2, 2)\r\n\r\n    @torch.jit.script_method\r\n    def forward(self, num_iter : int):\r\n        x = torch.ones([2, 2], dtype=torch.float32)\r\n        y = torch.ones(2, 2, dtype=torch.float32)\r\n        v = torch.ones(2, 1, dtype=torch.float32)\r\n        for i in range(num_iter):\r\n            v = x * v\r\n        return x, v\r\n\r\nmodel = SimpleModel()\r\n\r\nmodel_onnx = torch.onnx._export(model, torch.tensor(5), ""simple_loop.onnx"",\r\n        verbose=True,\r\n        operator_export_type=torch.onnx.OperatorExportTypes.ONNX,\r\n        example_outputs=(torch.zeros(2,2), torch.zeros(2,1)))\r\n\r\nprog = onnx.load(""simple_loop.onnx"")\r\nprint(""%1 tensor type is int64? "", prog.graph.node[0].attribute[0].t.data_type\r\n        == TensorProto.INT64)\r\n', '\r\ngraph(%num_iter : Long()) {\r\n  %1 : Long() = onnx::Constant[value={1}]()\r\n  %2 : Float(2, 2) = onnx::Constant[value= 1  1  1  1 [ CPUFloatType{2,2} ]]()\r\n  %3 : Float(2, 1) = onnx::Constant[value= 1  1 [ CPUFloatType{2,1} ]]()\r\n  %4 : Tensor = onnx::Loop(%num_iter, %1, %3)\r\n    block0(%i : int, %cond : Tensor, %7 : Tensor) {\r\n      %8 : Tensor = onnx::Mul(%2, %7)\r\n      -> (%1, %8)\r\n    }\r\n  return (%2, %4);\r\n}\r\n']"
135,12510,0,"[feature request] fix Windows cmake scripts to deal with \backlashes in paths . ## Issue description

Getting a bunch of Invalid escape sequence \N while compiling from source.
Coming from paths with unescaped backslashes in them.
Trying to resolve by myself in the meantime but its a real pain

## Code example

Invalid escape sequence \N                                                                                                                                                                                                                                                                                                                                                                                    Policy CMP0010 is not set: Bad variable reference syntax is an error.  Run                                                                                                                             ""cmake --help-policy CMP0010"" for policy details.  Use the cmake_policy                                                                                                                                command to set the policy and suppress this warning.                                                                                                                                                 This warning is for project developers.  Use -Wno-dev to suppress it.                                                                                                                                                                                                                                                                                                                                         CMake Warning (dev) at caffe2_gpu_generated_THCStorageCopy.cu.obj.Release.cmake:178 (execute_process):                                                                                                   Syntax error in cmake code at                                                                                                                                                                                                                                                                                                                                                                                   C:/Users/user/pytorchrc1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.obj.Release.cmake:178                                                                                                                                                                                                                                                      when parsing string                                                                                                                                                                                                                                                                                                                                                                                             C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.0/bin/nvcc.exe;-M;-D__CUDACC__;C:/Users/user/pytorchrc1/pytorch/aten/src/THC/THCStorageCopy.cu;-o;C:/Users/user/pytorchrc1/pytorch/bui   ld/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.obj.NVCC-depend;-ccbin;C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.11.   25503/bin/Hostx64/x64;-m64;-Dcaffe2_gpu_EXPORTS;-DCAFFE2_BUILD_MAIN_LIB;-DNOMINMAX;-D_CRT_SECURE_NO_DEPRECATE=1;-DUSE_MSC_ATOMICS=1;-DTH_BLAS_MKL;-D_OPENMP_NOFORCE_MANIFEST;-Xcompiler;,""/wd4267"",""   /wd4251"",""/wd4522"",""/wd4522"",""/wd4838"",""/wd4305"",""/wd4244"",""/wd4190"",""/wd4101"",""/wd4996"",""/wd4275"",""/EHa"",""-DONNX_NAMESPACE=onnx_torch"",""-openmp"",""/MP"",""/bigobj"",""-DHAVE_AVX_CPU_DEFINITION"",""-DHAV   E_AVX2_CPU_DEFINITION"",""/MD"",""/O2"",""/Ob2"",""/MP"",""/bigobj"";-DONNX_NAMESPACE=onnx_torch;-gencode;arch=compute_30,code=sm_30;-Xcudafe;--diag_suppress=cc_clobber_ignored;-Xcudafe;--diag_suppress=integ   er_sign_change;-Xcudafe;--diag_suppress=useless_using_declaration;-Xcudafe;--diag_suppress=set_but_not_used;-Xcompiler;-MD;--expt-relaxed-constexpr;--expt-extended-lambda;-Xcompiler;/wd4819;-Xcomp   iler;/wd4503;-Xcompiler;/wd4190;-Xcompiler;/wd4244;-Xcompiler;/wd4251;-Xcompiler;/wd4275;-Xcompiler;/wd4522;-Wno-deprecated-gpu-targets;--expt-extended-lambda;-gencode;arch=compute_30,code=sm_30;-   DCUDA_HAS_FP16=1;-D__CUDA_NO_HALF_OPERATORS__;-D__CUDA_NO_HALF_CONVERSIONS__;-D__CUDA_NO_HALF2_OPERATORS__;-DNVCC;-IC:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.0/include;-IC:/Users/yacin   e/pytorchrc1/pytorch/aten/src;-IC:/Users/user/pytorchrc1/pytorch/build;-IC:/Users/user/pytorchrc1/pytorch;-IC:/Users/user/pytorchrc1/pytorch/third_party/protobuf/src;-IC:/Program Files (x86)   /IntelSWTools/compilers_and_libraries/windows/mkl/include;-IC:/Users/user/pytorchrc1/pytorch/cmake/../third_party/eigen;-IC:/Users/user/pytorchrc1/pytorch/cmake/../third_party/pybind11/include   ;-IC:/Users/user/pytorchrc1/pytorch/cmake/../third_party/cub;-IC:/Users/user/pytorchrc1/pytorch/third_party/onnx;-IC:/Users/user/pytorchrc1/pytorch/build/third_party/onnx;-IC:/Users/user/p   ytorchrc1/pytorch/build/caffe2/aten/src/TH;-IC:/Users/user/pytorchrc1/pytorch/aten/src/TH;-IC:/Users/user/pytorchrc1/pytorch/aten/src/THC;-IC:/Users/user/pytorchrc1/pytorch/build/caffe2/aten   /src/THC;-IC:/Users/user/pytorchrc1/pytorch/aten/src/THCUNN;-IC:/Users/user/pytorchrc1/pytorch/aten/src/ATen/cuda;-IC:/Users/user/pytorchrc1/pytorch/build/caffe2/aten/src;-IC:/Users/user/p   ytorchrc1/pytorch/build/aten/src;-IC:/Users/user/pytorchrc1/pytorch/aten/src/THNN;-IC:/Users/user/pytorchrc1/pytorch/aten/../third_party/catch/single_include;-IC:/Users/user/pytorchrc1/pytor   ch/build/caffe2/aten/src/ATen;-IC:/Users/user/pytorchrc1/pytorch/aten/src/ATen/..;-IC:\NVIDIA\CUDA\9.0\cudnn-v7.3\include                                                                                                                                                                                                                                                                                     Invalid escape sequence \N                                                                                                                                                                                                                                                                                                                                                                                    Policy CMP0010 is not set: Bad variable reference syntax is an error.  Run                                                                                                                             ""cmake --help-policy CMP0010"" for policy details.  Use the cmake_policy                                                                                                                                command to set the policy and suppress this warning.                                                                                                                                                 Call Stack (most recent call first):                                                                                                                                                                     caffe2_gpu_generated_THCStorageCopy.cu.obj.Release.cmake:203 (cuda_execute_process)                                                                                                                  This warning is for project developers.  Use -Wno-dev to suppress it.                                                  

## System Info

- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): source
- Build command you used (if compiling from source): python setup.py build -f
- OS: Microsoft Windows 10 Pro x64 Version	10.0.17134 Build 17134
- PyTorch version: 
- Python version: 3.6.5
- CUDA/cuDNN version: 9.0patch4/7.3
- GPU models and configuration: Nvidia Quadro K2100M
- GCC version (if compiling from source): N/A
- CMake version: the one from VS as described in compilation instruction
- Versions of any other relevant libraries:
. []"
584,3567,0,"undefined symbol: cudnnSetConvolutionGroupCount while running with cuDNN 7.0.3 and CUDA 9. Installed from source, tried various branches _(master, v0.3.0, soumith-patch-1)_, but still getting this error.
Full uninstall and reinstall didn't help either. 
Calling  (form torchvision module) works fine, creating variables on the device doesn't seem to provoke this error either.
I've also just ran  and got this [log](https://gist.github.com/VladislavZavadskyy/8b1a5abffe6298fe2908fe0e3bd6cbf9), which suggests that it searches for cudnn 6, but I have no idea why or how to fix it.. []"
202,17560,0,"Please test and add the AdaBound optimizer into the next stable release. Now we have another powerful general purpose optimizer called AdaBound that trains as fast as Adam and as good as SGD, see [https://github.com/Luolc/AdaBound](https://github.com/Luolc/AdaBound).

It appears to work better than Adam in several tasks including NLP and CV, with slightly higher accuracy and smoothier learning curve.

![image](https://user-images.githubusercontent.com/10172392/53534724-08e75b80-3b3b-11e9-87b7-debe21b3908e.png)

I think this would be a great and useful addition, thanks!. []"
180,14373,0,[c10d] Barrier to synchronize with previously kicked off work in ProcessGroupGloo. In #14294 there is a failing test for this behavior (and it is therefore skipped). The stack that that PR is a part of removes deprecated code and does a few simplifications. It is easier to change the behavior to synchronize more strongly after the stack of #14294 is merged.. []
267,20591,0,"@ignore annotation for user defined type. ## üöÄ Feature
In user defined type, it would be nice to have a @ignore annotation similar to https://github.com/pytorch/pytorch/pull/16055

This allows the user to write python only methods that are only used in training / debugging (like )

cc @suo. []"
34,19163,1,"LayerNorm is very slow (almost frozen) in CPU of multiprocessing. The context of the use case is doing ES over small network in multiprocessing. 

It turns out that with  it becomes extremely slow on CPU.

To reproduce the effect, the code is attached below:


The benchmark is:

- **:**

- **:**

**Completely frozen after waiting a few minutes, and  shows all 80 cores CPU are 100% busy**


- **:**


- **:**



. [""python\r\nimport os\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nfrom torch.nn.utils import vector_to_parameters\r\nfrom concurrent.futures import ProcessPoolExecutor\r\nimport time\r\nimport numpy as np\r\n\r\n\r\nglobal use_ln\r\nuse_ln = True\r\nglobal device\r\ndevice = 'cpu'\r\n\r\nclass Model(nn.Module):\r\n    def __init__(self, use_ln):\r\n        super().__init__()\r\n        \r\n        self.use_ln = use_ln\r\n        \r\n        self.fc1 = nn.Linear(17, 64)\r\n        if use_ln:\r\n            self.ln1 = nn.LayerNorm(64)\r\n        self.fc2 = nn.Linear(64, 64)\r\n        if use_ln:\r\n            self.ln2 = nn.LayerNorm(64)\r\n        self.out = nn.Linear(64, 6)\r\n    \r\n    def forward(self, x):\r\n        if self.use_ln:\r\n            x = self.ln1(F.relu(self.fc1(x)))\r\n            x = self.ln2(F.relu(self.fc2(x)))\r\n        else:\r\n            x = F.relu(self.fc1(x))\r\n            x = F.relu(self.fc2(x))\r\n        x = torch.tanh(self.out(x))\r\n        return x\r\n\r\n\r\ndef initializer():\r\n    print(f'Initializing, PID: {os.getpid()}')\r\n    t = time.perf_counter()\r\n    global model\r\n    model = Model(use_ln).to(device)\r\n    print(f'Finish initializing, PID: {os.getpid()}, taken {time.perf_counter() - t} s')\r\n    \r\ndef fitness(solution):\r\n    vector_to_parameters(solution.to(device), model.parameters())\r\n    for i in range(10):\r\n        for t in range(1000):\r\n            observation = np.random.randn(1, 17)\r\n            action = model(torch.from_numpy(observation).float().unsqueeze(0).to(device))\r\n    print(f'PID: {os.getpid()}, finished')\r\n        \r\n        \r\nwith ProcessPoolExecutor(max_workers=16, initializer=initializer) as executor:\r\n    t = time.perf_counter()\r\n    num_param = sum([param.numel() for param in Model(use_ln).parameters() if param.requires_grad])\r\n    solutions = [torch.randn(num_param) for _ in range(16)]\r\n    list(executor.map(fitness, solutions))\r\n    print(f'Total time: {time.perf_counter() - t}')\r\n"", '\r\nInitializing, PID: 2009192\r\nFinish initializing, PID: 2009192, taken 0.001776786521077156 s\r\nInitializing, PID: 2009194\r\nInitializing, PID: 2009196\r\nFinish initializing, PID: 2009194, taken 0.001952311024069786 s\r\nFinish initializing, PID: 2009196, taken 0.0018356721848249435 s\r\nInitializing, PID: 2009203\r\nFinish initializing, PID: 2009203, taken 0.0015176795423030853 s\r\nInitializing, PID: 2009210\r\nFinish initializing, PID: 2009210, taken 0.0021672528237104416 s\r\nInitializing, PID: 2009216\r\nInitializing, PID: 2009226\r\nFinish initializing, PID: 2009216, taken 0.0018634404987096786 s\r\nFinish initializing, PID: 2009226, taken 0.001307731494307518 s\r\nInitializing, PID: 2009232\r\nInitializing, PID: 2009237\r\nFinish initializing, PID: 2009232, taken 0.0021293386816978455 s\r\nFinish initializing, PID: 2009237, taken 0.0014764349907636642 s\r\nInitializing, PID: 2009242\r\nFinish initializing, PID: 2009242, taken 0.0015203002840280533 s\r\nInitializing, PID: 2009253\r\nFinish initializing, PID: 2009253, taken 0.0014950130134820938 s\r\nInitializing, PID: 2009259\r\nInitializing, PID: 2009262\r\nFinish initializing, PID: 2009259, taken 0.002156071364879608 s\r\nInitializing, PID: 2009269\r\nFinish initializing, PID: 2009272, taken 0.0021638404577970505 s\r\nFinish initializing, PID: 2009262, taken 0.0012727994471788406 s\r\nFinish initializing, PID: 2009269, taken 0.0021071340888738632 s\r\nInitializing, PID: 2009272\r\nInitializing, PID: 2009280\r\nFinish initializing, PID: 2009280, taken 0.0012570079416036606 s\r\nPID: 2009259, finished\r\nPID: 2009232, finished\r\nPID: 2009192, finished\r\nPID: 2009242, finished\r\nPID: 2009216, finished\r\nPID: 2009196, finished\r\nPID: 2009280, finished\r\nPID: 2009203, finished\r\nPID: 2009210, finished\r\nPID: 2009262, finished\r\nPID: 2009226, finished\r\nPID: 2009253, finished\r\nPID: 2009272, finished\r\nPID: 2009237, finished\r\nPID: 2009194, finished\r\nPID: 2009269, finished\r\nTotal time: 3.3697756361216307\r\n', '\r\nInitializing, PID: 2013343\r\nInitializing, PID: 2013346\r\nFinish initializing, PID: 2013343, taken 0.002532508224248886 s\r\nInitializing, PID: 2013354\r\nInitializing, PID: 2013359\r\nFinish initializing, PID: 2013346, taken 0.001596800982952118 s\r\nFinish initializing, PID: 2013354, taken 0.002076219767332077 s\r\nFinish initializing, PID: 2013359, taken 0.0015829745680093765 s\r\nInitializing, PID: 2013364\r\nFinish initializing, PID: 2013364, taken 0.0018675383180379868 s\r\nInitializing, PID: 2013369\r\nInitializing, PID: 2013372\r\nFinish initializing, PID: 2013369, taken 0.00201280415058136 s\r\nFinish initializing, PID: 2013372, taken 0.0018042325973510742 s\r\nInitializing, PID: 2013379\r\nFinish initializing, PID: 2013379, taken 0.0017306245863437653 s\r\nInitializing, PID: 2013384\r\nFinish initializing, PID: 2013384, taken 0.0018676463514566422 s\r\nInitializing, PID: 2013389\r\nInitializing, PID: 2013392\r\nFinish initializing, PID: 2013389, taken 0.0027825143188238144 s\r\nFinish initializing, PID: 2013392, taken 0.0016419757157564163 s\r\nInitializing, PID: 2013397\r\nFinish initializing, PID: 2013397, taken 0.0018332768231630325 s\r\nInitializing, PID: 2013402\r\nFinish initializing, PID: 2013402, taken 0.0018747877329587936 s\r\nInitializing, PID: 2013409\r\nFinish initializing, PID: 2013409, taken 0.0016566626727581024 s\r\nInitializing, PID: 2013414\r\nFinish initializing, PID: 2013414, taken 0.0016422048211097717 s\r\nInitializing, PID: 2013419\r\nFinish initializing, PID: 2013419, taken 0.0017681997269392014 s\r\n\r\n...\r\n', '\r\nInitializing, PID: 2010102\r\nInitializing, PID: 2010103\r\nInitializing, PID: 2010108\r\nInitializing, PID: 2010111\r\nInitializing, PID: 2010114\r\nInitializing, PID: 2010117\r\nInitializing, PID: 2010119\r\nInitializing, PID: 2010122\r\nInitializing, PID: 2010126\r\nInitializing, PID: 2010129\r\nInitializing, PID: 2010132\r\nInitializing, PID: 2010135\r\nInitializing, PID: 2010138\r\nInitializing, PID: 2010141\r\nInitializing, PID: 2010144\r\nInitializing, PID: 2010147\r\nFinish initializing, PID: 2010111, taken 17.613565219566226 s\r\nFinish initializing, PID: 2010102, taken 17.802420677617192 s\r\nFinish initializing, PID: 2010114, taken 17.798802657052875 s\r\nFinish initializing, PID: 2010103, taken 17.81860247440636 s\r\nFinish initializing, PID: 2010117, taken 17.89303245767951 s\r\nFinish initializing, PID: 2010108, taken 17.97427663579583 s\r\nFinish initializing, PID: 2010132, taken 18.15790667384863 s\r\nFinish initializing, PID: 2010126, taken 18.16597461514175 s\r\nFinish initializing, PID: 2010141, taken 18.14934244006872 s\r\nFinish initializing, PID: 2010122, taken 18.205005967989564 s\r\nFinish initializing, PID: 2010119, taken 18.209256762638688 s\r\nFinish initializing, PID: 2010129, taken 18.243990190327168 s\r\nFinish initializing, PID: 2010147, taken 18.25442030467093 s\r\nFinish initializing, PID: 2010135, taken 18.283051615580916 s\r\nFinish initializing, PID: 2010138, taken 18.324560744687915 s\r\nFinish initializing, PID: 2010144, taken 18.545221898704767 s\r\nPID: 2010111, finished\r\nPID: 2010114, finished\r\nPID: 2010102, finished\r\nPID: 2010103, finished\r\nPID: 2010117, finished\r\nPID: 2010108, finished\r\nPID: 2010126, finished\r\nPID: 2010122, finished\r\nPID: 2010141, finished\r\nPID: 2010119, finished\r\nPID: 2010132, finished\r\nPID: 2010147, finished\r\nPID: 2010129, finished\r\nPID: 2010135, finished\r\nPID: 2010138, finished\r\nPID: 2010144, finished\r\nTotal time: 35.38426893763244\r\n', '\r\nInitializing, PID: 2010657\r\nInitializing, PID: 2010658\r\nInitializing, PID: 2010663\r\nInitializing, PID: 2010666\r\nInitializing, PID: 2010669\r\nInitializing, PID: 2010670\r\nInitializing, PID: 2010675\r\nInitializing, PID: 2010678\r\nInitializing, PID: 2010679\r\nInitializing, PID: 2010684\r\nInitializing, PID: 2010685\r\nInitializing, PID: 2010690\r\nInitializing, PID: 2010693\r\nInitializing, PID: 2010694\r\nInitializing, PID: 2010698\r\nInitializing, PID: 2010702\r\nFinish initializing, PID: 2010657, taken 16.785767970606685 s\r\nFinish initializing, PID: 2010658, taken 17.48567765392363 s\r\nFinish initializing, PID: 2010663, taken 17.629254495725036 s\r\nFinish initializing, PID: 2010679, taken 17.669835798442364 s\r\nFinish initializing, PID: 2010684, taken 17.806519005447626 s\r\nFinish initializing, PID: 2010666, taken 17.94813333079219 s\r\nFinish initializing, PID: 2010678, taken 17.9285822045058 s\r\nFinish initializing, PID: 2010675, taken 17.933384394273162 s\r\nFinish initializing, PID: 2010685, taken 17.93839507550001 s\r\nFinish initializing, PID: 2010669, taken 17.989747492596507 s\r\nFinish initializing, PID: 2010670, taken 18.010178688913584 s\r\nFinish initializing, PID: 2010690, taken 18.07465230114758 s\r\nFinish initializing, PID: 2010698, taken 18.061042606830597 s\r\nFinish initializing, PID: 2010693, taken 18.082385893911123 s\r\nFinish initializing, PID: 2010702, taken 18.17208438925445 s\r\nFinish initializing, PID: 2010694, taken 18.283266445621848 s\r\nPID: 2010657, finished\r\nPID: 2010658, finished\r\nPID: 2010663, finished\r\nPID: 2010679, finished\r\nPID: 2010684, finished\r\nPID: 2010678, finished\r\nPID: 2010675, finished\r\nPID: 2010685, finished\r\nPID: 2010670, finished\r\nPID: 2010669, finished\r\nPID: 2010666, finished\r\nPID: 2010693, finished\r\nPID: 2010698, finished\r\nPID: 2010690, finished\r\nPID: 2010702, finished\r\nPID: 2010694, finished\r\nTotal time: 39.30256709083915\r\n', '\r\n - PyTorch Version: 1.0.0.dev20190323\r\n - OS: Ubuntu 18.04\r\n - How you installed PyTorch: pip\r\n - Python version: 3.7\r\n']"
614,7276,0,"[feature request] Caffe2 model to PyTorch model. Do you think about converting Caffe2 model to PyTorch model for continue changing model, e.g fine-tuning, transfer-learning?

According to new feature of PyTorch 1.0, it seems possible, isn't it?. []"
188,27295,0,Documentation of which torch.tensor operations work on QTensors. Create a table listing which methods work on the quantized tensors (only a subset of the tensor methods work). . []
604,2281,0,"Error installing branch v0.2.0 from source . I'm on ubuntu 16.04 with titan X. I am trying to install v0.2.0 branch from source.

I created new conda env  and followed the instructions on Readme.md.

python setup.py install fails with error which look like this:


I'm attaching complete log file: [log_file.txt](https://github.com/pytorch/pytorch/files/1196589/log_file.txt)


Sasank.. ['\r\n... /pytorch/torch/lib/THCUNN/generic/SpatialFullConvolution.cu(18): error: identifier ""THNN_CudaHalfSpatialFullDilatedConvolution_updateOutput"" is undefined\r\n\r\n...\r\n\r\n ... /pytorch/torch/lib/THCUNN/generic/SpatialFullConvolution.cu(55): error: identifier ""THNN_CudaHalfSpatialFullDilatedConvolution_accGradParameters"" is undefined\r\n']"
230,2351,0,"The Performance of v0.2.0 is 20X slower than v0.1.12. Hi, i use pytroch to train  all-cnn model on cifar-10 by [Entropy-SGD](https://github.com/ucla-vision/entropy-sgd/tree/master/python). 

The log of v0.1.12_2 is 
Train: [ 1] 0.9442 33.32% [13.62s]
Train: [ 2] 0.8139 28.38% [14.39s]
Train: [ 3] 0.7006 24.22% [13.76s]
Train: [ 4] 0.6254 21.68% [13.71s]
Train: [ 5] 0.5720 19.96% [13.63s]

and the log of v0.2.0_1 is
Train: [ 1] 0.2238 7.84% [294.03s]
Train: [ 2] 0.1349 4.66% [291.71s]
Train: [ 3] 0.0950 3.26% [291.67s]
Train: [ 4] 0.0715 2.41% [290.50s]
Train: [ 5] 0.0558 1.89% [295.84s]

All code is same but the only difference is the version of pytroch. Why the performance of the two has the gap?

P.S. Can you re-generate the pip resource for v.0.1.12 ?. []"
265,28884,0,"Why attn_mask is not 3D tensor in nn.MultiheadAttention?. ## üöÄ Feature
I think shoud add 3D attn_mask.
## Motivation

For example, if in a translation task,  I want to let every word in the target sentence focus different words in source sentence, "" attn_mask"" should  in shape (tgt_len, scr_len) , ok! That's fine, that's exactly what it is now. But in different sentencesÔºåthe target word in same position may focus different source words, so the ""broadcast"" is unsuitable in this case and "" attn_mask"" should  in shape (batch_size, tgt_len, scr_len) . The same question is also in nn.Transfomers.
So I think it's necessary to fix.

cc @albanD @mruberry @jbschlosser @zhangguanheng66. []"
661,24612,0,"Migrate `polygamma` and `polygamma_` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
746,15958,0,"stable 1.0 with cuda 10 successfully, but cannot pip3 install torchvision!. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
I installed pytorch stable 1.0, linux, pip, python 3.6, successfully. However, when I pip3 install torchvision, it began downloading pytorch for cpu.
So I cancelled the installing torchvision!

Waiting for help!. []"
110,20009,0,"issue while exporting torch model to onnx format. ## üêõ Bug

i am getting error while converting my saved torch model to onnx format

torch.onnx.export(trained_model, dummy_input, ""sentiment.onnx"")
TypeError: forward() missing 1 required positional argument: 'hidden' 

torch version - '1.0.1.post2'

## To Reproduce

Steps to reproduce the behavior:
from torch.autograd import Variable
import torch.onnx
# Load the trained model from file
net_save = SentimentRNN(vocab_size, output_size, embedding_dim, hidden_dim, n_layers)
trained_model = net_save
trained_model.load_state_dict(torch.load('sentiment.pth'))

# Export the trained model to ONNX
dummy_input = Variable(torch.randn(1, 1, 28, 28)) # one black and white 28 x 28 picture will be the input to the model
torch.onnx.export(trained_model, dummy_input, ""sentiment.onnx"")

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

i should get the onnx format of my model but getting error

. []"
623,24856,0,"[jit] schema matching incorrectly types a call to append with an argument of type Scalar. Minimal Repro:



cc @suo. [""\r\nimport torch\r\n\r\n@torch.jit.script\r\ndef foo(x):\r\n    a = torch.jit.annotate(List[float], [])\r\n    a.append(x.item())\r\n    # this works\r\n    # a.append(float(x.item()))\r\n    return a\r\n\r\n\r\nprint(foo.graph)\r\n# note: it derives the type Scalar[] for the result of append\r\n# when it should but 'a' is a float[]\r\n\r\nfoo(torch.rand([]))\r\n\r\n""]"
414,18689,0,"distributed.all_gather function stuck when using NCCL backend . ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
I am trying to use distributed.all_gather to gather gradients in multi nodes. but I found the all_gather function stuck and no error throw
## To Reproduce

Steps to reproduce the behavior:

1. set up env variable  , save the following code as 

2. run the code with  and 

btw, when I execute this code manually in , I found the all_gather quickly go through, but it stuck when trying to print tensor

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

process will print a list of tensor
<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:

PyTorch version: 1.0.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.10.2

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration:
GPU 0: Tesla K80
GPU 1: Tesla K80
GPU 2: Tesla K80
GPU 3: Tesla K80
GPU 4: Tesla K80
GPU 5: Tesla K80
GPU 6: Tesla K80
GPU 7: Tesla K80

Nvidia driver version: 384.145
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.1

Versions of relevant libraries:
[pip3] numpy==1.15.3
[pip3] torch==1.0.1.post2
[pip3] torchvision==0.2.1
[conda] Could not collect

## Additional context

<!-- Add any other context about the problem here. -->
. ['python\r\nimport torch.distributed as dist\r\nimport torch as t\r\n\r\nimport argparse\r\n\r\ndef main():\r\n    parser = argparse.ArgumentParser()\r\n    parser.add_argument(\r\n            ""--rank"",\r\n            type=int,\r\n            help=""the rank of proc""\r\n            )\r\n    args = parser.parse_args()\r\n    dist.init_process_group(""nccl"", rank=args.rank, world_size=2)\r\n    tmp = [t.randn(5).cuda()] * 2\r\n    tensor = t.ones(5).cuda()\r\n    dist.all_gather(tmp, tensor)\r\n    print(tmp)\r\n\r\nif __name__ == ""__main__"":\r\n    main()\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
620,4031,0,"NVIDIA memory not deallocated after interupt. When I interrupt my Pytorch script using Ctrl-C occasionally GPU memory is not deallocated. Also threads related to my script may or may not still be running. If they are running I kill them using ""kill -9 PID"". However this does not deallocate memory on the GPU. 

> Tue Dec  5 14:12:11 2017       
> +-----------------------------------------------------------------------------+
> | NVIDIA-SMI 384.98                 Driver Version: 384.98                    |
> |-------------------------------+----------------------+----------------------+
> | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
> | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
> |===============================+======================+======================|
> |   0  TITAN X (Pascal)    Off  | 00000000:02:00.0  On |                  N/A |
> | 31%   54C    P2    58W / 250W |   7829MiB / 12189MiB |      3%      Default |
> +-------------------------------+----------------------+----------------------+
>                                                                                
> +-----------------------------------------------------------------------------+
> | Processes:                                                       GPU Memory |
> |  GPU       PID   Type   Process name                             Usage      |
> |=============================================================================|
> |    0      1213      G   /usr/lib/xorg/Xorg                           166MiB |
> |    0      2355      G   compiz                                       249MiB |
> |    0     32412      G   ...-token=00DF6CCAB2487BD6F9AE70914F3A9358     8MiB |
> +-----------------------------------------------------------------------------+. []"
343,31557,0,"[docs] F.ctc_loss docs to warn clearly about invalid inf-causing inputs; zero_infinity to become enabled by default. **UPD** summary of all the long discussion for further discoverability:
1. F.ctc_loss will produce inf loss if presented with invalid unalignable examples
2. Such invalid examples may be generated by official usage code example if one is extremely unlucky or if one twists the dimension sizes a little bit
3. When presented with invalid examples, sum and mean reduction modes by default cause the whole batch loss to be **inf**

Proposals:
1. Have docs warn clearly about conditions on valid examples
2. Have docs warn clearly that the official usage example may produce invalid examples / fix the official code example
3. Enable zero_infinity = True by default or at least in reduction modes sum/mean

**BELOW IS THE ORIGINAL ISSUE DESCRIPTION**



Docs specify that targets can't be blank. If same consecutive labels are not supported, I think it should be explicitly mentioned in docs. And maybe docs should specify some workaround to encode consecutive same-valued targets (given that blank to separate them isn't allowed by docs).

Current docs: . ['python\r\nimport torch\r\nimport torch.nn.functional as F\r\n\r\ndef test_ctc(C, B = 1, T = 2, full = False):\r\n    log_probs = torch.randn(B, C, T).log_softmax(dim = 1)\r\n    input_lengths = torch.full((B,), T, dtype=torch.long)\r\n\r\n    target_lengths = torch.full((B,), T, dtype = torch.long)\r\n    if full:\r\n        targets = torch.full((B, T), C - 1, dtype = torch.long)\r\n    else:\r\n        targets = torch.randint(1, C, (B, T), dtype=torch.long)\r\n\r\n    loss = F.ctc_loss(log_probs.permute(2, 0, 1), targets, input_lengths, target_lengths)\r\n    print(float(loss))\r\n\r\ntest_ctc(C = 64, full = False)\r\n# 4.894557952880859\r\n\r\ntest_ctc(C = 2, full = False)\r\n# inf\r\n\r\ntest_ctc(C = 64, full = True)\r\n# inf\r\n']"
681,27450,0,"formatting issue in dynamic quantization function. <img width=""798"" alt=""formatting-issue-either-or"" src=""https://user-images.githubusercontent.com/45861273/66273196-95bb6b80-e826-11e9-8cd8-8fcb2a2759dd.png"">


cc @jerryzh168 @jianyuh @dzhulgakov @raghuramank100. []"
675,14057,0,"Unable to pickle torch dtype objects in Python 3.5. ## üêõ Bug

When pickling a  object, Python 3.5 reports an obscure error ""can't pickle int objects"".

## To Reproduce

Steps to reproduce the behavior:



## Expected behavior

In Python 3.6 one can pickle torch dtypes successfully.

## Environment

. ['python\r\nIn [1]: import torch\r\n\r\nIn [2]: import pickle\r\n\r\nIn [3]: with open(\'/tmp/a\', \'wb\') as f:\r\n   ...:     pickle.dump(torch.float32, f)\r\n   ...:     \r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-3-769b4901f38c> in <module>()\r\n      1 with open(\'/tmp/a\', \'wb\') as f:\r\n----> 2     pickle.dump(torch.float32, f)\r\n      3 \r\n\r\n~/anaconda3/envs/tmp/lib/python3.5/copyreg.py in _reduce_ex(self, proto)\r\n     63     else:\r\n     64         if base is self.__class__:\r\n---> 65             raise TypeError(""can\'t pickle %s objects"" % base.__name__)\r\n     66         state = base(self)\r\n     67     args = (self.__class__, base, state)\r\n\r\nTypeError: can\'t pickle int objects\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 0.4.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Fedora release 29 (Twenty Nine)\r\nGCC version: (GCC) 8.2.1 20181011 (Red Hat 8.2.1-4)\r\nCMake version: version 3.12.1\r\n\r\nPython version: 3.5\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.2.148\r\nGPU models and configuration: GPU 0: GeForce GTX 1070\r\nNvidia driver version: 410.73\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.15.2)\r\n[pip] torch (0.4.1.post2)\r\n[conda] pytorch                   0.4.1           py35_py27__9.0.176_7.1.2_2    pytorch\r\n']"
461,19601,0,"TestJit.test_cpp broken on master. ## üêõ Bug


https://circleci.com/gh/pytorch/pytorch/1423249?utm_campaign=vcs-integration-link&utm_medium=referral&utm_source=github-build-link/console. ['\r\nApr 23 05:09:48 ======================================================================\r\nApr 23 05:09:48 ERROR: test_cpp (__main__.TestJit)\r\nApr 23 05:09:48 ----------------------------------------------------------------------\r\nApr 23 05:09:48 Traceback (most recent call last):\r\nApr 23 05:09:48   File ""/var/lib/jenkins/workspace/test/common_utils.py"", line 129, in wrapper\r\nApr 23 05:09:48     fn(*args, **kwargs)\r\nApr 23 05:09:48   File ""test_jit.py"", line 1727, in test_cpp\r\nApr 23 05:09:48     torch._C._jit_run_cpp_tests(run_cuda=False)\r\nApr 23 05:09:48 RuntimeError: \r\nApr 23 05:09:48 Schema not found for node. File a bug report.\r\nApr 23 05:09:48 Node: %3 : Tensor = aten::tensor(%2, %1, %0)\r\nApr 23 05:09:48 \r\nApr 23 05:09:48 Input types:float, int?, Device?\r\nApr 23 05:09:48 candidates were:\r\nApr 23 05:09:48   aten::tensor(float t, *, int? dtype=<default>, Device? device=<default>, bool requires_grad=<default>) -> Tensor\r\nApr 23 05:09:48   aten::tensor(int t, *, int? dtype=<default>, Device? device=<default>, bool requires_grad=<default>) -> Tensor\r\nApr 23 05:09:48   aten::tensor(bool t, *, int? dtype=<default>, Device? device=<default>, bool requires_grad=<default>) -> Tensor\r\nApr 23 05:09:48   aten::tensor(t[] data, *, int? dtype=<default>, Device? device=<default>, bool requires_grad=<default>) -> Tensor\r\nApr 23 05:09:48 graph():\r\nApr 23 05:09:48   %0 : Device? = prim::Constant()\r\nApr 23 05:09:48   %1 : int? = prim::Constant()\r\nApr 23 05:09:48   %2 : float = prim::Constant[value=1]()\r\nApr 23 05:09:48   %3 : Tensor = aten::tensor(%2, %1, %0)\r\nApr 23 05:09:48   %4 : Tensor[] = prim::ListConstruct(%3)\r\nApr 23 05:09:48   %5 : Tensor = aten::tensor(%2, %1, %0)\r\nApr 23 05:09:48   %6 : Tensor[] = prim::ListConstruct(%5)\r\nApr 23 05:09:48   %7 : (Tensor[], Tensor[]) = prim::TupleConstruct(%4, %6)\r\nApr 23 05:09:48   return (%7)\r\n']"
547,22171,0,"[jit] Compile only the relevant branch for `isinstance`. Similar to our thing where we only compile if a submodule is not None (#14533), we could skip compiling the non-taken branch for  checks (since their result is constant) to support use cases like this:




cc @suo. ['python\r\nclass M(torch.jit.ScriptModule):\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        return x + 2\r\n\r\nclass N(torch.jit.ScriptModule):\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        return x + 10, x + 100\r\n\r\nclass Mod(torch.jit.ScriptModule):\r\n    def __init__(self, x):\r\n        super(Mod, self).__init__()\r\n        self.submodule = x\r\n\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        res = self.submodule(x)\r\n\r\n        if isinstance(res, tuple):\r\n            b = res[1]\r\n        else:\r\n            b = res\r\n\r\n        return b\r\n']"
79,2973,1,"broadcasting inconsistency?. when we multiply (or any binary operator) two tensor variables, i've noticed the weird behaviour depending on the shapes of those variables:

(a) when x.size()=(1,10) and y.size()=(10), (x\*y).size()=(1,10) (expected)
(b) when x.size()=(10) and y.size()=(1,10), (x\*y).size()=(1,10) (expected)
(c) when x.size()=(10,1) and y.size()=(10), (x\*y).size()=(10,10) (**unexpected**)
(d) when x.size()=(10) and y.size()=(10,1), (x\*y).size()=(10,10) (**unexpected**)
(e) when x.size()=(10,1) and y.size()=(1,10), (x\*y).size()=(10,10) (expected)

the cases (c) and (d) really easily throw off many (or perhaps only me) from debugging, when such cases happen in a loss function that reduces the output into a single scalar. 

my expectation is that broadcasting should first find a matching axis, and i wonder if the current implementation/behaviour is expected and was designed with a certain goal in mind.

. []"
710,30446,0,"Is there any plan for Adafactor optimizer?. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->
official Adafactor optimizer
## Motivation
an efficient optimizer Adafactor is currently widely used in some big models, it saves a lot of memory due to its sub-linear running average of the gradient, sometimes result in a sigificant memory footprint reduce and larger batch size.
<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->

## Pitch

<!-- A clear and concise description of what you want to happen. -->

## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->

## Additional context

<!-- Add any other context or screenshots about the feature request here. -->


cc @vincentqb. []"
252,473,0,"Autograd IndexCopy is broken. This happens when the index tensor contains duplicate elements. If this is not allowed index_copy_ should raise an exception when this happens and we should fix the test. Otherwise we need to fix the autograd op.

Here's an example:





cc @ezyang @SsnL @albanD. ['python\r\nimport torch\r\nfrom torch.autograd import *\r\nx = Variable(torch.zeros(5, 5), requires_grad=True)\r\nprint(x)\r\ny = Variable(torch.range(1, 25).view(5, 5), requires_grad=True)\r\nprint(y)\r\nidx = Variable(torch.LongTensor([0, 0, 0, 0, 0]))\r\nz = x.index_copy(0, idx, y)\r\nprint(z)  # Note only the last row of y is copied to the first row of z. No other rows of y are used.\r\nz.backward(torch.ones(5, 5))\r\nprint(y.grad)  # Incorrectly all ones. Only the last row of y.grad should be non-zero.\r\n']"
381,10746,0,"[Caffe2] Failed to build dispatch_test. Error LNK2001: unresolved external symbol. ## Issue description

Getting LNK2001 on Windows for .


## System Info
- PyTorch or Caffe2: C2
- How you installed PyTorch (conda, pip, source): src
- Build command you used (if compiling from source): cmake
- OS: Win10
- PyTorch version: master
- VS version (if compiling from source): 2017
- CMake version: 3.12. ['\r\npytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj"" (default target) (56) ->\r\n(Link target) -> \r\n  KernelRegistration.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  OpSchema.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  OpSchemaRegistration.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  OpSchema_test.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  Dispatcher.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  DispatchKey.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  DispatchTable.obj : error LNK2001: unresolved external symbol ""__declspec(dllimport) private: __cdecl caffe2::TypeIdentifier::TypeIdentifier(unsigned short)"" (__imp_??0TypeIdentifier@caffe2@@AEAA@G@Z) [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n  pytorch\\build\\bin\\RelWithDebInfo\\dispatch_test.exe : fatal error LNK1120: 1 unresolved externals [pytorch\\build\\caffe2\\core\\dispatch\\dispatch_test.vcxproj]\r\n\r\n']"
714,16198,0,"ppc64le CI build failure (possibly due to #16006. ## üêõ Bug

ppc64le CI build fails with psutil not found.

Running test_dataloader ... [2019-01-20 15:16:53.873206]
Traceback (most recent call last):
  File ""test_dataloader.py"", line 24, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'


pytorch version : pull from master for last 3 days.
here is the CI log:
https://powerci.osuosl.org/user/avmgithub/my-views/view/PyTorch/job/pytorch-linux-cuda92-cudnn7-py3-mpi-build-test-gpu/269/console

CC:  @SsnL 
. []"
117,1434,0,"no member named 'shared_ptr' in namespace 'std'. When building from source, I got this error. My system is OSX 10.12.4, conda, CUDA 8.0. Any thoughts? Thanks!

. [""\r\ntorch/csrc/serialization.cpp:2:10: fatal error: 'system_error' file not found\r\n#include <system_error>\r\n         ^\r\nIn file included from torch/csrc/autograd/engine.cpp:1:\r\n"", ""\r\npytorch/torch/csrc/autograd/function_hook.h:11:40: error: no member named 'shared_ptr' in namespace 'std'\r\nusing variable_list = std::vector<std::shared_ptr<Variable>>;\r\n                                  ~~~~~^\r\n/Users/hangzhang/pytorch/torch/csrc/autograd/function_hook.h:11:51: error: 'Variable' does not refer to a value\r\nusing variable_list = std::vector<std::shared_ptr<Variable>>;\r\n""]"
575,6462,0,"How to set batch_size when using DataParallel mode in pytorch?. I can't find document about the batch_size setting and DataParallel mode.
so How to set batch_size when using DataParallel mode in pytorch? Is it similiar with Keras?
Thanks

In Keras, the parallel_model( like DataParallel mode in pytorch), which document is very clear I think:
-------------------------------------------Keras document beginging------------------------------------------
E.g. if your batch_size is 64 and you use gpus=2, then we will divide the input into 2 sub-batches of 32 samples, process each sub-batch on one GPU, then return the full batch of 64 processed samples

This  call will be distributed on 8 GPUs.
 Since the batch size is 256, each GPU will process 32 samples.

parallel_model.fit(x, y, epochs=20, batch_size=256)
-------------------------------------------Keras document ended------------------------------------------. []"
185,28902,0,"C++ `torch::tensor` by default gives a double tensor, which is different from Python `torch.tensor` behavior. Example:
In C++:


In Python:


cc @yf225. ['cpp\r\ntorch::tensor({1., 2., 3.}).dtype() -> double\r\n', 'python\r\n>>> torch.tensor([1., 2., 3.]).dtype\r\ntorch.float32\r\n']"
204,23366,0,"[PyTorch][Feature Request]Lookahead Optimizer. ## üöÄ Lookahead Optimizer
https://arxiv.org/pdf/1907.08610.pdf

In this paper they show new Optimizer can save time, improve accuracy than SGD and work both on CV/NLP.
I think it may worth to try.
. []"
197,1280,0,"Multi-GPU forward pass fails if first GPU id is not 0. I can specify multiple GPU IDs and train a network using them just fine. However, when it comes time to run a validation dataset through the trained network, pytorch throws an error when using a list of GPU IDs unless the GPU ID list starts with id 0.

Here's a sample function that will cause an error:



If I train the network using  the function above executes with no problem.  However, if I train the network using  it will throw an error.. ['\r\ndef visualize_model(model=None, num_images=5, use_gpu=False, gpu_ids=[0]):\r\n    print(""Using GPU: "" + str(gpu_ids[0]))\r\n    for i, data in enumerate(dset_loaders[\'val\']):\r\n        inputs, labels = data\r\n        if use_gpu:\r\n            inputs, labels = Variable(inputs.cuda(device=gpu_ids[0])), Variable(labels.cuda(device=gpu_ids[0]))\r\n        else:\r\n            inputs, labels = Variable(inputs), Variable(labels)\r\n\r\n        outputs = model(inputs)      # ERROR HERE!\r\n        _, preds = torch.max(outputs.data, 1)\r\n\r\n        plt.figure()\r\n        imshow(inputs.cpu().data[0])\r\n        plt.title(\'pred: {}\'.format(dset_classes[labels.data[0]]))\r\n        plt.show()\r\n\r\n        if i == num_images - 1:\r\n            break\r\n ']"
449,7634,0,"cuda out of memory err:   when my gpu memory still has 4G left .  

## Issue description

i was running a trained model  from github ,i watched the gpu memory, found that the script exited when the memory usage got 2G.
my gpu is 1060 with 6G memory ,how did that come?


PS: torch might has the 2G limit,but i haven't install that 


 

## System Info
RuntimeError: cuda runtime err(2): out of memory at /opt/conda/conda-bld/pytorch_1501953625411/work/pytorch-0.1.12/torch/libTHC/THCstorage.cu:66

 

- PyTorch or Caffe2:
- How you installed PyTorch (conda, pip, source):
- Build command you used (if compiling from source):
- OS: Ubuntu 14.04
- PyTorch version: pytorch 0.1.10
- Python version:  2.7
- CUDA/cuDNN version: 8.0/5.1 
- GCC version (if compiling from source): 4.9
 
 
. []"
276,14844,0,"Negative indexing for nn.Embedding inputs. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->

Negative indexing for nn.Embedding inputs

## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->

I found both
- 
- 

allow negative indexing for padding.

How about we allow negative indexing for  inputs as well?

## Example



cc @albanD @mruberry. ['python\r\nfrom torch import nn\r\nfrom torch.nn.utils.rnn import pad_sequence\r\nimport torch\r\n\r\ninput = [torch.LongTensor([1,2,3]),\r\n         torch.LongTensor([1,4]),\r\n         torch.LongTensor([2])]\r\n\r\npadded_input = pad_sequence(input, batch_first=True, padding_value=-1)\r\n# tensor([[ 1,  2,  3],\r\n#         [ 1,  4, -1],\r\n#         [ 2, -1, -1]])\r\n\r\nembedding = nn.Embedding(5, 10, padding_idx=-1)\r\n\r\nembedded = embedding(padded_input)\r\n# RuntimeError: index out of range at /Users/soumith/code/builder/wheel/pytorch-src/aten/src/TH/generic/THTensorMath.cpp:352\r\n']"
231,12013,0,"[Feature Request] Make nn layers accept empty batch size. Now that we have support for tensors with zero in its size, I believe it would be very handy to have support for accepting batches of size 0 in  functions.

A (non-exhaustive) list of functions that would be good supporting:
- [x] 
- [x] 
- [x] 
- [x] 

Handling the losses is a bit trickier, because it generally involves computing a , which results in  due to 0 / 0 division. I'd expect having a 0 loss for empty batches to make sense, but that's debatable so might be worth postponing this decision.

cc @ezyang @gchanan @zou3519 @albanD @mruberry. []"
192,27352,0,"torch quant docs all showing up in the index.html. When I checkout the [ branch](https://github.com/gottbrath/pytorch/tree/quantization_1_3_doc/docs), run make html from /docs, and look at the index.html, all the old quantization docs show up even though the [index.rst ](https://github.com/gottbrath/pytorch/blob/quantization_1_3_doc/docs/source/index.rst)lists quantization.rst. 

Did some testing and research and it looks like it's because in quantization.rst there are multiple H1 headers. We would need to decrease all the headers except the first by one level. 

![image](https://user-images.githubusercontent.com/8042156/66173258-1b130600-e604-11e9-914c-7f3e2b874aa7.png)
. []"
621,23236,0,"AttributeError: module 'torchvision.models' has no attribute 'detection'. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

Detection module is not present in torchvision.models

## To Reproduce

Steps to reproduce the behavior:

1. import detection from torchvision,models in a python script

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0):
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
733,24869,0,"Dictionary in C++. ## üöÄ Feature
Implement a dictionary ops in C++

## Motivation

The dictionary ops will replace the current vocab class in torchtext (or serve as a new class for the same purpose). It could also be applied for transforming audio script. I think a dictionary ops in pytorch core library makes it easier to maintain.

## Pitch

Some baselines should be included:
+ findWord()
+ addWord()
+ count_nwords()
+ count_ntokens()
+ count_nlables()
+ getWord()
+ readFromSequence()
+ readFromFile()
. []"
351,14659,0,"error: module multiprocessing.util' has no attribute '_flush_std_streams. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1. I followed the tutorial code: https://pytorch.org/tutorials/beginner/data_loading_tutorial.html
1. run without change anything, but error comes out. even I download the official code, error still exist.
1. seems like cannot enumerate trainloader. once do enumerate(trainloader), error appears: ""module multiprocessing.util' has no attribute '_flush_std_streams""

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 8.0.61

OS: Ubuntu 16.04 LTS
GCC version: (Ubuntu 4.9.3-13ubuntu2) 4.9.3
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: Tesla P100-PCIE-16GB
GPU 1: Tesla P100-PCIE-16GB
GPU 2: Tesla P100-PCIE-16GB
GPU 3: Tesla P100-PCIE-16GB
GPU 4: Tesla P100-PCIE-16GB
GPU 5: Tesla P100-PCIE-16GB
GPU 6: Tesla P100-PCIE-16GB
GPU 7: Tesla P100-PCIE-16GB

Nvidia driver version: 384.90
cuDNN version: Probably one of the following:
/usr/local/MATLAB/R2016b/bin/glnxa64/libcudnn.so.4.0.7

Versions of relevant libraries:
[pip] numpy (1.15.4)
[pip] torch (0.4.1)
[pip] torchvision (0.2.1)
[conda] cuda80                    1.0                  h205658b_0    pytorch
[conda] pytorch                   0.4.1           py36_cuda8.0.61_cudnn7.1.2_1  [cuda80]  pytorch
[conda] torchvision               0.2.1                    py36_1    pytorch

## Additional context

<!-- Add any other context about the problem here. -->
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-12-a647eac09f6e> in <module>
     21         plt.title('Batch from dataloader')
     22 
---> 23 for i_batch, sample_batched in enumerate(dataloader):
     24     print(i_batch, sample_batched['image'].size(),
     25           sample_batched['landmarks'].size())

~/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py in __iter__(self)
    499 
    500     def __iter__(self):
--> 501         return _DataLoaderIter(self)
    502 
    503     def __len__(self):

~/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py in __init__(self, loader)
    287             for w in self.workers:
    288                 w.daemon = True  # ensure that the worker exits on process exit
--> 289                 w.start()
    290 
    291             _update_worker_pids(id(self), tuple(w.pid for w in self.workers))

~/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py in start(self)
    103                'daemonic processes are not allowed to have children'
    104         _cleanup()
--> 105         self._popen = self._Popen(self)
    106         self._sentinel = self._popen.sentinel
    107         # Avoid a refcycle if the target function holds an indirect

~/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py in _Popen(process_obj)
    221     @staticmethod
    222     def _Popen(process_obj):
--> 223         return _default_context.get_context().Process._Popen(process_obj)
    224 
    225 class DefaultContext(BaseContext):

~/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py in _Popen(process_obj)
    275         def _Popen(process_obj):
    276             from .popen_fork import Popen
--> 277             return Popen(process_obj)
    278 
    279     class SpawnProcess(process.BaseProcess):

~/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py in __init__(self, process_obj)
     15 
     16     def __init__(self, process_obj):
---> 17         util._flush_std_streams()
     18         self.returncode = None
     19         self._launch(process_obj)

AttributeError: module 'multiprocessing.util' has no attribute '_flush_std_streams'

===================================================================
I test the code on windows, still got the error: [Errno 32] Broken pipe. []"
470,9990,0,"Build fails in caffe2 git master with OpenCL ON. I'm getting the following compile error when trying to build caffe2 git master:


- Cmake command and output: [https://bpaste.net/show/f14fd917039e](https://bpaste.net/show/f14fd917039e)

- Caffe2 from pytorch stable release v0.4.1 builds fine with the same cmake options as above (OpenCL ON).

- Caffe2 git master builds fine when using the same cmake options as above and switching OpenCL to .

- The error seems be **not** related to the gcc version used. The same error occurs with gcc8, gcc7 and gcc5.4.

**System Information:**
**OS:** Arch Linux x86_64
**Compiler:** gcc 8.1.1 (as mentioned, the same error also occurs with gcc7 and gcc5.4)
**Caffe2:** git master
**OpenCL headers:** 2.2.20170516. ['\r\n[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o\r\nIn file included from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/registry.h:21,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/flags.h:23,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/logging.h:10,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/allocator.h:6,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/context.h:9,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.h:4,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:1:\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:18: error: ‚Äòcaffe2::Tensor‚Äô is not a template\r\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\r\n                  ^~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:28: note: in definition of macro ‚ÄòCAFFE_KNOWN_TYPE‚Äô\r\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\r\n                            ^\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:15: error: redefinition of ‚Äòstatic caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]‚Äô\r\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\r\n               ^~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:1: note: in expansion of macro ‚ÄòCAFFE_KNOWN_TYPE‚Äô\r\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\r\n ^~~~~~~~~~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:425:22: note: ‚Äòstatic caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]‚Äô previously declared here\r\n   inline CaffeTypeId TypeMeta::Id<T>() {  \\\r\n                      ^~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:446:1: note: in expansion of macro ‚ÄòCAFFE_DECLARE_KNOWN_TYPE‚Äô\r\n CAFFE_DECLARE_KNOWN_TYPE(1, Tensor);\r\n ^~~~~~~~~~~~~~~~~~~~~~~~\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2.dir/build.make:362: caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o] Error 1\r\nmake[1]: *** [CMakeFiles/Makefile2:1737: caffe2/CMakeFiles/caffe2.dir/all] Error 2\r\nmake: *** [Makefile:141: all] Error 2\r\n']"
82,10681,1,"nn.DataParallel hangs with Pytorch 0.4.1 and CUDA 9.1.85 on TITAN V. Hi guys,
I tested a simple example with nn.DataParallel() to use multiple GPUs, but got a hang.


It hangs when I try to forward the data to the model. nvidia-smi gives


I have tried the solution in [this](https://github.com/pytorch/pytorch/issues/1637#issuecomment-338268158), but it didn‚Äôt work.

I use

- CUDA 9.1.85
- Pytorch 0.4.1 (installed by pip)
- Python 2.7.13
- Debian 4.9.110-3+deb9u1 (2018-08-03) x86_64 GNU/Linux
- TITAN V cards

Any ideas to solve this issue? Or I should let NVIDIA‚Äôs folks see this issue?. ['\r\nepochs  = 2000\r\nlr = 1e-3\r\nmomentum = 0\r\nw_decay = 1e-5\r\n\r\ntrain_data = torch.randn(288,2)\r\ntrain_label = torch.zeros([288], dtype=torch.long)\r\n\r\nnum_gpu = list(range(torch.cuda.device_count()))\r\nmodel = nn.DataParallel(MyNet().cuda(0), device_ids = num_gpu)#.cuda()\r\ncriterion = nn.CrossEntropyLoss()\r\noptimizer = optim.Adam(model.parameters(), lr = lr, weight_decay = w_decay)\r\n\r\nprint ""Starting training""\r\n\r\nmodel.train()\r\nfor epoch in range(epochs):\r\n\toptimizer.zero_grad()\r\n\tinputs = Variable(train_data.cuda(0))\r\n\tlabels = Variable(train_label.cuda(0))\r\n\toutputs = model(inputs)\r\n\tloss = criterion(outputs, labels)\r\n\tloss.backward()\r\n\toptimizer.step()\r\n\tprint(""epoch{}, loss: {}"".format(epoch, loss.data.item()))\r\n', '\r\nThu Aug 16 09:56:56 2018       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.67                 Driver Version: 390.67                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  TITAN V             Off  | 00000000:1B:00.0 Off |                  N/A |\r\n| 28%   39C    P8    25W / 250W |   1087MiB / 12066MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  TITAN V             Off  | 00000000:1C:00.0 Off |                  N/A |\r\n| 28%   41C    P2    39W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  TITAN V             Off  | 00000000:1D:00.0 Off |                  N/A |\r\n| 31%   45C    P2    41W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  TITAN V             Off  | 00000000:1E:00.0 Off |                  N/A |\r\n| 31%   45C    P2    40W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   4  TITAN V             Off  | 00000000:3D:00.0 Off |                  N/A |\r\n| 28%   39C    P2    38W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   5  TITAN V             Off  | 00000000:3E:00.0 Off |                  N/A |\r\n| 28%   41C    P2    40W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   6  TITAN V             Off  | 00000000:3F:00.0 Off |                  N/A |\r\n| 28%   40C    P2    38W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   7  TITAN V             Off  | 00000000:40:00.0 Off |                  N/A |\r\n| 31%   45C    P2    40W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   8  TITAN V             Off  | 00000000:41:00.0 Off |                  N/A |\r\n| 29%   43C    P2    41W / 250W |   1087MiB / 12066MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0    131331      C   python                                      1076MiB |\r\n|    1    131331      C   python                                      1076MiB |\r\n|    2    131331      C   python                                      1076MiB |\r\n|    3    131331      C   python                                      1076MiB |\r\n|    4    131331      C   python                                      1076MiB |\r\n|    5    131331      C   python                                      1076MiB |\r\n|    6    131331      C   python                                      1076MiB |\r\n|    7    131331      C   python                                      1076MiB |\r\n|    8    131331      C   python                                      1076MiB |\r\n+-----------------------------------------------------------------------------+\r\n\r\n']"
140,23641,0,"Hi, could you please tell me the different about deconvtranspose between pytorch and caffe?. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
. []"
600,12901,0,"torch.nn.L1Loss works incorrectly in certain situations. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
torch.nn.L1Loss()'s parameter *reduction* doesn't work if b = net(a).



## To Reproduce

Steps to reproduce the behavior:




<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Outputs



<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.2.148

OS: Debian GNU/Linux 9.5 (stretch)
GCC version: (Debian 6.3.0-18+deb9u1) 6.3.0 20170516
CMake version: Could not collect

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: Tesla K80
Nvidia driver version: 396.44
cuDNN version: Probably one of the following:
/usr/local/cuda-9.2/lib64/libcudnn.so.7.2.1
/usr/local/cuda-9.2/lib64/libcudnn_static.a

Versions of relevant libraries:
[pip] intel-numpy (1.15.1)
[pip] numpy (1.15.1)
[pip] torch (0.4.1)
[pip] torchvision (0.2.1)
[conda] Could not collect


## Additional context
I have checked the source. In  F.l1_loss(), it use 

to convert reduction to an integer. However, it calls _pointwise_loss(), 
which assumes that reduction is still a str.

That's the reason of this bug.
<!-- Add any other context about the problem here. -->
. [""\r\nb = net(a)\r\nl = torch.nn.L1Loss(reduction='elementwise_mean')\r\nl(a, b) # wrong, it's summation \r\n\r\n"", ""\r\nimport torch\r\nimport torch.nn as nn\r\n\r\ndatadim = 33\r\n\r\n\r\nclass BugNet(nn.Module):\r\n    def __init__(self):\r\n        super(BugNet, self).__init__()\r\n        self.output = nn.Linear(datadim, datadim)\r\n\r\n    def forward(self, x):\r\n        return self.output(x)\r\n\r\n\r\na = torch.ones((4, 33))\r\nbug = BugNet()\r\nb = bug(a)\r\n\r\nloss_fn1 = nn.L1Loss(reduction='sum')\r\nloss_fn2 = nn.L1Loss(reduction='elementwise_mean')\r\nelementwise_mean_loss = lambda x, x_out: torch.mean(torch.abs(x-x_out.view_as(x)))\r\n\r\nprint(loss_fn1(a, b))  # 127.6617, True\r\nprint(loss_fn2(a, b))  # 127.6617, False\r\nprint(loss_fn2(b, a))  # 0.9671, True\r\nprint(elementwise_mean_loss(a, b))  # 0.9671, True\r\n"", '\r\ntensor(127.6617, grad_fn=<SumBackward0>)\r\ntensor(127.6617, grad_fn=<SumBackward0>)\r\ntensor(0.9671, grad_fn=<L1LossBackward>)\r\ntensor(0.9671, grad_fn=<MeanBackward1>)\r\n']"
619,11901,0,"[feature request] ability to nest ParameterList. In some cases, it is more convenient to arrange some parameters as 2d or 3d arrays rather than 1D list. One could solve it by computing a Nd to 1D offset array, but this could be avoided if the  objects could be nested

Example:


. ['\r\nclass someModule(nn.Module):\r\n  def __init__(self, x, y):\r\n     params = []\r\n     for ix in range(x):\r\n       param_row = []\r\n       for iy in range(y):\r\n         param_row.append( nn.Parameter(torch.randn(1)))\r\n       params.append( nn.ParameterList(param_row))\r\n    param_array = nn.ParameterList(params)\r\n']"
145,3195,0,"PyTorch throws an exception on import when denormals are flushed to zero. This happens, for example, when you import DyNet before importing PyTorch. The code from #3113 tries to take the log(0) which throws an exception.

My guess is that DyNet is setting FTZ or DAZ (or both). See:
https://software.intel.com/en-us/node/523328. []"
662,13,0,"Infinite recursion when indexing Variable. 


. [' python\nimport torch\nfrom torch.autograd import Variable\nv = Variable(torch.ones(5, 5))\nv[0]\n', '\n...\nRecursionError: maximum recursion depth exceeded\n']"
354,31591,0,"when i try to export a pytorch model to ONNX, got RuntimeError: output of traced region did not have observable data dependence with trace inputs; this probably indicates your program cannot be understood by the tracer.. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

/Users/duke/opt/anaconda3/bin/python /Volumes/Êó†ÊûÅÂ±±/project/code/pytorch2ONNX.py
/Volumes/Êó†ÊûÅÂ±±/project/code/models/anchors.py:24: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  image_shape = np.array(image_shape)
/Volumes/Êó†ÊûÅÂ±±/project/code/models/anchors.py:35: TracerWarning: torch.from_numpy results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  return torch.from_numpy(all_anchors.astype(np.float32))
Traceback (most recent call last):
  File ""/Volumes/Êó†ÊûÅÂ±±/project/code/pytorch2ONNX.py"", line 39, in <module>
    save2ONNX(args)
  File ""/Volumes/Êó†ÊûÅÂ±±/project/code/pytorch2ONNX.py"", line 27, in save2ONNX
    torch.onnx.export(model, x, export_ONNX_file)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/onnx/__init__.py"", line 143, in export
    strip_doc_string, dynamic_axes, keep_initializers_as_inputs)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 66, in export
    dynamic_axes=dynamic_axes, keep_initializers_as_inputs=keep_initializers_as_inputs)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 382, in _export
    fixed_batch_size=fixed_batch_size)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 249, in _model_to_graph
    graph, torch_out = _trace_and_get_graph_from_model(model, args, training)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/onnx/utils.py"", line 206, in _trace_and_get_graph_from_model
    trace, torch_out, inputs_states = torch.jit.get_trace_graph(model, args, _force_outplace=True, _return_inputs_states=True)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/jit/__init__.py"", line 275, in get_trace_graph
    return LegacyTracedModule(f, _force_outplace, return_inputs, _return_inputs_states)(*args, **kwargs)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py"", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File ""/Users/duke/opt/anaconda3/lib/python3.7/site-packages/torch/jit/__init__.py"", line 356, in forward
    torch._C._tracer_exit(tuple(out_vars))
RuntimeError: output of traced region did not have observable data dependence with trace inputs; this probably indicates your program cannot be understood by the tracer.

Process finished with exit code 1


<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->
##Here is the code
import torch
import torch.onnx
from torch.autograd import Variable
from models.retinanet import resnet34, resnet50
from build_network import build_network
input_model = '../user_data/model_data/model_at_epoch_1.dat'
output_dir = 'torch_onnx_model.onnx'
dummy_input = torch.randn(2, 3, 800, 800)
checkpoint = torch.load(input_model)
model, _ = build_network(snapshot=None, backend='retinanet')
model.load_state_dict(checkpoint['state_dict'])
torch.onnx.export(model, dummy_input, output_dir)
print('Done')



## Expected behavior

The ONNX should be exported successfully.

## Environment
Python 3.7.4
pytorch '1.3.1'
macos 10.15




cc @suo. []"
524,19697,0,"torch.transpose doesn't shares it‚Äôs underlying storage with the original tensor. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
This concerns the method:
torch.transpose(input, dim0, dim1) ‚Üí Tensor

According to the documentation, https://pytorch.org/docs/stable/torch.html :
> The resulting out tensor shares it‚Äôs underlying storage with the input tensor, so changing the content of one would change the content of the other.

However, transposed versions of the original tensor are not changed when the original tensor's data is changed via ""set_"" method (specifically).

## To Reproduce


>  t is: 
> tensor([[-1.,  2.]])
>  ttr is: 
> tensor([[-1.],
>         [ 2.]])
> --------------------
>  t is: 
> tensor([[5., 2.]])
>  ttr is: 
> tensor([[5.],
>         [2.]])
> The transposed versions were updated, as expected
> --------------------
>  t is: 
> tensor([[10., 20.]])
>  ttr is: 
> tensor([[10.],
>         [20.]])
> The transposed versions were updated, as expected
> --------------------
>  t is: 
> tensor([[12., 22.]])
>  ttr is: 
> tensor([[12.],
>         [22.]])
> The transposed versions were updated, as expected
> --------------------
>  t is: 
> tensor([[-1., -2.]])
>  ttr is: 
> tensor([[12.],
>         [22.]])

## Expected behavior
I expect that ""changing the content of one (via set_) would change the content of the other."", as per the documentation.

## Environment

PyTorch version: 1.0.1.post2
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.14.3
GCC version: Could not collect
CMake version: version 3.13.4

Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.14.5
[pip3] torch==1.0.1.post2
[pip3] torchvision==0.2.2.post3
[conda] Could not collect


## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nimport torch\r\nfrom torch import Tensor\r\nt = Tensor([[-1,2]])\r\nttr = t.transpose(0,1)\r\nprint(f"" t is: \\n{t}"")\r\nprint(f"" ttr is: \\n{ttr}"")\r\nprint(""-""*20)\r\n\r\nt[0,0] = 5\r\nprint(f"" t is: \\n{t}"")\r\nprint(f"" ttr is: \\n{ttr}"")\r\nprint(f""The transposed version was updated, as expected"")\r\nprint(""-""*20)\r\n\r\nt[:,:] = Tensor([[10,20]])\r\nprint(f"" t is: \\n{t}"")\r\nprint(f"" ttr is: \\n{ttr}"")\r\nprint(f""The transposed version was updated, as expected"")\r\nprint(""-""*20)\r\n\r\nt.add_(Tensor([[2,2]]))\r\nprint(f"" t is: \\n{t}"")\r\nprint(f"" ttr is: \\n{ttr}"")\r\nprint(f""The transposed version was updated, as expected"")\r\nprint(""-""*20)\r\n\r\nt.set_(Tensor([[-1,-2]]))\r\nprint(f"" t is: \\n{t}"")\r\nprint(f"" ttr is: \\n{ttr}"")\r\nprint(f""Note that the transposed version was not updated!"")\r\n']"
570,17569,0,"Is it possible to integrate jax into pytorch ?. # What is jax (just in case for other reader)
[jax](https://github.com/google/jax) is full numpy acceleration and autodiff with functional neural networks, and is essentially autograd 2.0. (from [Italian Association for Machine Learning)](https://iaml.it/blog/jax-intro-english)

# Feature Request
Is it possible to incorporate jax into implementation of Pytorch? It looks so promising to speed up machine learning.  
I would like to know if there is any plan about jax. Thanks.. []"
236,23756,0,"[feature request] Core API for invertible and flow-like ops. Inplace BatchNorm seems to be developed by Mapillary here: https://github.com/mapillary/inplace_abn

This would be a very nice addition to core PyTorch (for memory savings).

cc @vincentqb @fritzo @neerajprad @alicanb @vishwakftw @SsnL. []"
1,8710,1,"Incorrect calculation for torch.nn.MSELoss. ## Issue description
torch.nn.MSELoss seems to get inaccurate calculation when size_average=True and reduce=True

## Code example

For tensors of 0.1's and 0's, the desired output should be 0.01. (0.1 - 0)^2 = 0.01.
I can get correct result by code below:


However, if I do something like below, I get inaccurate results:


But when I turned off size_average and reduce and calculate mean manually, I get desired output:

Or:



I kind of know that you cannot get exactly number when you using float datatype, but 0.01 and 0.00983 seems to be too off for me.
I am not quite sure if it is intended to be like that or I am not using it correctly.

## System Info
PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 2.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti
GPU 2: GeForce GTX 1080 Ti

Nvidia driver version: 387.34
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.2
/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so.7
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so.7.1.4
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn_static.a

Versions of relevant libraries:
[pip] numpy (1.14.5)
[pip] torch (0.4.0)
[pip] torchvision (0.2.1)
[conda] Could not collect
. ['\r\nIn [10]: preds = torch.ones(5, 68, 64, 64) / 10\r\nIn [11]: res = torch.pow((preds - labels), 2)\r\nIn [12]: torch.mean(res)\r\nOut[12]: \r\ntensor(1.00000e-02 *\r\n       1.0000)\r\n', '\r\nIn [16]: criterion = torch.nn.MSELoss()\r\nIn [17]: criterion(labels, preds)\r\nOut[17]: \r\ntensor(1.00000e-03 *\r\n       9.8371)\r\n', '\r\nIn [21]: criterion = torch.nn.MSELoss(False, False)\r\nIn [22]: torch.sum(criterion(labels, preds)) / (5*68*64*64)\r\nOut[22]: \r\ntensor(1.00000e-02 *\r\n       1.0000)\r\n', '\r\nIn [23]: torch.mean(criterion(labels, preds))\r\nOut[23]: \r\ntensor(1.00000e-02 *\r\n       1.0000)\r\n']"
654,6287,0,"No .toDevice for ATen Tensors. As title says, might be nice to be able to put ATen Tensors on other GPUs easily in C++.. []"
458,3225,0,"Subtracting ByteTensor doesn't work in this case.. This snippet used to work, but now throws an error:

. [""\r\nIn [1]: import torch\r\n\r\nIn [2]: torch.__version__\r\nOut[2]: '0.2.0_4'\r\n\r\nIn [3]: from torch.autograd import Variable\r\n\r\nIn [4]: 1 - Variable(torch.cuda.ByteTensor(2).fill_(1))\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-3-d11efaae512d> in <module>()\r\n----> 1 1 - Variable(torch.cuda.ByteTensor(2).fill_(1))\r\n\r\n/home/dexter/anaconda2/lib/python2.7/site-packages/torch/autograd/variable.pyc in __rsub__(self, other)\r\n    824\r\n    825     def __rsub__(self, other):\r\n--> 826         return SubConstant.apply(other, self)\r\n    827\r\n    828     def __mul__(self, other):\r\n\r\n/home/dexter/anaconda2/lib/python2.7/site-packages/torch/autograd/_functions/basic_ops.pyc in forward(ctx, a, b, inplace)\r\n    128                 return tensor.neg_().add_(constant)\r\n    129             else:\r\n--> 130                 return tensor.neg().add_(constant)\r\n    131\r\n    132     @staticmethod\r\n\r\nAttributeError: 'torch.cuda.ByteTensor' object has no attribute 'neg'\r\n""]"
674,13806,0,"OMP: Error about doubly-linked OpenMP when loading CIFAR10 dataset. I compile PyTorch from source (1.0.0a0+54e8623).
and when I attempt to load data I get this:


The crash occurs when I do this:


I'm using the CIFAR10 dataset here, the problem does not occur with MNIST.


The system is macOS 10.12.6. What could the problem be here?. ['\r\nOMP: Error #15: Initializing libomp.dylib, but found libiomp5.dylib already initialized.\r\nOMP: Hint This means that multiple copies of the OpenMP runtime have been linked into the program. That is dangerous, since it can degrade performance or cause incorrect results. The best thing to do is to ensure that only a single OpenMP runtime is linked into the process, e.g. by avoiding static linking of the OpenMP runtime in any library. As an unsafe, unsupported, undocumented workaround you can set the environment variable KMP_DUPLICATE_LIB_OK=TRUE to allow the program to continue to execute, but that may cause crashes or silently produce incorrect results. For more information, please see http://openmp.llvm.org/\r\nAbort trap: 6\r\n', '\r\ndataloader = DataLoader(self._dataset, batch_size=self._batch_size, pin_memory=True, shuffle=True, drop_last=True)\r\nnext(dataloader)\r\n']"
615,871,0,"GPU torch.multinomial produces an out-of-bounds index.  on the GPU can produce indices that are out of bounds.

Consider the following code:



Here's output from an example run:



Here, the sampled indices should be between 0 to 5, but one of the values is  .

The iteration at which this happens is random.

The following code uses probabilities closer to actual probabilities



but it has the same problem (the problem occurs much later on average though). Example output snippet:

. [""\r\nfrom __future__ import print_function\r\nimport torch\r\n\r\ni = 0\r\nwhile True:\r\n    logdist = torch.zeros(6, 6).cuda()  # no problem without .cuda()\r\n    # the following is not logically correct, but is the fastest way I've found to reproduce the bug\r\n    logdist.log_normal_(mean=0.0, std=2.5)\r\n    prob = torch.exp(logdist)\r\n    sampled = torch.multinomial(prob, 1)  # multinomial is supposed to reweight to get probabilities\r\n    if ((sampled > 5).sum()):\r\n        print('\\niter', i)\r\n        print('\\nprob:', prob)\r\n        print('sampled:', sampled)\r\n        break\r\n    if i % 5000 == 0:\r\n        print('iter', i)\r\n    i += 1\r\n"", '\r\niter 0\r\niter 5000\r\n\r\niter 6491\r\n\r\nprob: \r\n 3.0595e+38  1.2861e+00  5.2613e+37  1.3855e+00  2.9041e+00  1.2441e+01\r\n 1.0531e+01  1.0103e+00  2.0693e+00  1.8121e+00  1.6328e+00  6.0454e+10\r\n 1.5679e+03  1.5869e+00  1.5553e+03  5.1932e+03  5.0801e+01  1.3416e+00\r\n 2.2532e+00  1.5512e+00  3.1946e+01  1.5208e+00  8.8690e+00  1.5255e+00\r\n 1.6197e+02  1.0395e+00  1.1355e+38  3.9969e+00  8.2150e+00  1.5104e+05\r\n 1.1240e+00  1.1315e+00  7.9896e+00  6.8996e+00  2.1447e+00  1.3858e+00\r\n[torch.cuda.FloatTensor of size 6x6 (GPU 0)]\r\n\r\nsampled: \r\n 9.0078e+18\r\n 5.0000e+00\r\n 3.0000e+00\r\n 3.0000e+00\r\n 2.0000e+00\r\n 1.0000e+00\r\n[torch.cuda.LongTensor of size 6x1 (GPU 0)]\r\n', ""\r\nfrom __future__ import print_function\r\n\r\nimport torch\r\nfrom torch.autograd import Variable\r\nimport torch.nn.functional as F\r\n\r\ni = 0\r\nwhile True:\r\n    data = torch.zeros(6, 6).cuda()  # no problem without .cuda()\r\n    data.normal_(mean=0.0, std=2.5)\r\n    logdist = F.log_softmax(Variable(data)).data\r\n    prob = torch.exp(logdist)  # prob.sum(1) are 1s.\r\n    sampled = torch.multinomial(prob, 1)\r\n    if ((sampled > 5).sum()):\r\n        print('\\niter', i)\r\n        print('\\nprob:', prob)\r\n        print('sampled:', sampled)\r\n        break\r\n    if i % 10000 == 0:\r\n        print('iter', i)\r\n    i += 1\r\n"", '\r\n...\r\niter 27310000\r\niter 27320000\r\niter 27330000\r\niter 27340000\r\n\r\niter 27346838\r\n\r\nprob: \r\n 0.0017  0.8274  0.1657  0.0004  0.0017  0.0031\r\n 0.0123  0.0157  0.0001  0.0020  0.0015  0.9683\r\n 0.0067  0.1369  0.8092  0.0422  0.0030  0.0021\r\n 0.1306  0.0887  0.7521  0.0024  0.0005  0.0258\r\n 0.0425  0.5981  0.0140  0.0565  0.1005  0.1885\r\n 0.0006  0.0017  0.9819  0.0114  0.0038  0.0007\r\n[torch.cuda.FloatTensor of size 6x6 (GPU 0)]\r\n\r\nsampled: \r\n 1.0000e+00\r\n 4.1752e+18\r\n 1.0000e+00\r\n 2.0000e+00\r\n 1.0000e+00\r\n 2.0000e+00\r\n[torch.cuda.LongTensor of size 6x1 (GPU 0)]\r\n']"
55,23862,1,"nn.functional.conv2d is a factor 5 slower when using specific weight tensor on CPU.. ## üêõ Bug

When using the torch conv2d I have a huge slowdown in speed using a specific weight tensor coming from a pretrained state_dict. By adding 1 and subsequently subtracting 1 from the tensor from the state_dict I get a huge improvement (factor 5 on my machine). 

In the code example below I compare the pretrained weight with itself after adding and subtracting 1. 

I also observed this problem in 1.0.1


generates the problematic tensor (There are many tensors like this in my pretrained state_dict, so it is not unique) 

## To Reproduce

To reproduce run the following code and read the printouts in the console.



## Expected behavior

I would expect the speed of conv2d to be identical whether using w1 or w2. 

## Environment

 - PyTorch Version: 1.1
 - OS: Ubuntu 18.04.2 LTS
 - How you installed PyTorch: 

Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
certifi    2019.6.16
numpy      1.17.0   
pip        19.1.1   
setuptools 41.0.1   
torch      1.1.0    
wheel      0.33.4   . ['create_w()', ' python\r\nimport torch\r\nfrom timeit import timeit\r\n\r\n\r\ndef timing_test():\r\n    from torch.nn.functional import conv2d\r\n\r\n    test_img = torch.ones(10, 12, 100, 100)\r\n    w1 = create_w()\r\n    w2 = (w1 + 1) - 1\r\n\r\n    print(""Torch equal:"", torch.equal(w1, w2))\r\n\r\n    n = 100\r\n    with torch.no_grad():\r\n        t1 = timeit(""conv2d(test_img, w1)"", globals=locals(), number=n) / n\r\n        t2 = timeit(""conv2d(test_img, w2)"", globals=locals(), number=n) / n\r\n\r\n    print(""Time w1:"", t1)\r\n    print(""Time w2:"", t2)\r\n    print(""Factor:"", t1 / t2)\r\n\r\n    print()\r\n    print(""w1 norm:"", w1.norm())\r\n    print(""w2 norm:"", w2.norm())\r\n\r\n    print()\r\n    print(""w1 dtype:"", w1.dtype)\r\n    print(""w2 dtype:"", w2.dtype)\r\n\r\n    print()\r\n    print(""w1 device:"", w1.device)\r\n    print(""w2 device:"", w2.device)\r\n\r\n    print()\r\n    print(""w1 shape:"", w1.shape)\r\n    print(""w2 shape:"", w2.shape)\r\n\r\n\r\ndef create_w():\r\n    return torch.tensor(\r\n        [\r\n            [\r\n                [[2.0536e-03]],\r\n                [[-6.5152e-02]],\r\n                [[7.5900e-02]],\r\n                [[1.9581e-02]],\r\n                [[6.0192e-02]],\r\n                [[1.1083e-01]],\r\n                [[3.5546e-02]],\r\n                [[1.0338e-01]],\r\n                [[7.4448e-02]],\r\n                [[3.8988e-02]],\r\n                [[-1.3289e-02]],\r\n                [[3.5973e-02]],\r\n            ],\r\n            [\r\n                [[-1.8130e-03]],\r\n                [[4.5211e-02]],\r\n                [[-6.3141e-03]],\r\n                [[-2.2000e-02]],\r\n                [[5.5847e-02]],\r\n                [[3.5140e-02]],\r\n                [[5.5567e-02]],\r\n                [[2.0592e-02]],\r\n                [[2.9450e-02]],\r\n                [[2.5826e-02]],\r\n                [[2.6045e-03]],\r\n                [[1.1359e-01]],\r\n            ],\r\n            [\r\n                [[-3.5669e-04]],\r\n                [[-2.0352e-02]],\r\n                [[-1.0962e-02]],\r\n                [[1.2939e-02]],\r\n                [[2.0176e-03]],\r\n                [[4.1796e-02]],\r\n                [[7.6029e-02]],\r\n                [[4.8062e-03]],\r\n                [[2.0193e-02]],\r\n                [[2.5245e-02]],\r\n                [[6.2719e-02]],\r\n                [[1.0437e-01]],\r\n            ],\r\n            [\r\n                [[2.9016e-02]],\r\n                [[3.6604e-02]],\r\n                [[-2.4739e-03]],\r\n                [[1.7465e-02]],\r\n                [[4.5465e-02]],\r\n                [[-2.0248e-02]],\r\n                [[-1.0559e-03]],\r\n                [[-3.3110e-02]],\r\n                [[-2.6498e-02]],\r\n                [[-1.1671e-02]],\r\n                [[2.6471e-02]],\r\n                [[1.4671e-02]],\r\n            ],\r\n            [\r\n                [[3.1644e-02]],\r\n                [[-7.5824e-02]],\r\n                [[-3.2397e-02]],\r\n                [[2.7205e-02]],\r\n                [[-8.0184e-03]],\r\n                [[3.5684e-02]],\r\n                [[-4.3505e-04]],\r\n                [[2.6388e-02]],\r\n                [[4.5333e-04]],\r\n                [[5.5965e-02]],\r\n                [[4.2574e-02]],\r\n                [[1.7094e-02]],\r\n            ],\r\n            [\r\n                [[-1.7368e-02]],\r\n                [[5.3762e-02]],\r\n                [[-4.4826e-02]],\r\n                [[-3.7706e-02]],\r\n                [[1.9211e-03]],\r\n                [[-4.3316e-02]],\r\n                [[6.2763e-02]],\r\n                [[1.0589e-02]],\r\n                [[3.9296e-02]],\r\n                [[-3.6488e-02]],\r\n                [[6.7191e-02]],\r\n                [[2.0684e-02]],\r\n            ],\r\n            [\r\n                [[-4.8351e-02]],\r\n                [[-1.3839e-02]],\r\n                [[5.5983e-02]],\r\n                [[-3.6999e-02]],\r\n                [[-2.1908e-02]],\r\n                [[-1.0006e-02]],\r\n                [[-1.6682e-02]],\r\n                [[6.8055e-02]],\r\n                [[2.5191e-02]],\r\n                [[3.9925e-02]],\r\n                [[-1.5595e-02]],\r\n                [[-3.6358e-02]],\r\n            ],\r\n            [\r\n                [[-3.3860e-41]],\r\n                [[1.3748e-41]],\r\n                [[1.1227e-41]],\r\n                [[5.3964e-42]],\r\n                [[-1.8262e-41]],\r\n                [[3.0524e-41]],\r\n                [[2.0291e-42]],\r\n                [[7.2924e-42]],\r\n                [[-2.7940e-41]],\r\n                [[-1.1212e-41]],\r\n                [[-3.2091e-41]],\r\n                [[-2.9832e-41]],\r\n            ],\r\n            [\r\n                [[-5.4249e-03]],\r\n                [[7.7659e-02]],\r\n                [[4.2960e-02]],\r\n                [[-1.2729e-01]],\r\n                [[-6.1029e-02]],\r\n                [[3.7938e-02]],\r\n                [[7.4308e-03]],\r\n                [[-1.8296e-02]],\r\n                [[4.6577e-02]],\r\n                [[3.3428e-02]],\r\n                [[3.5875e-03]],\r\n                [[1.0800e-02]],\r\n            ],\r\n            [\r\n                [[-3.9751e-02]],\r\n                [[-1.2280e-01]],\r\n                [[4.4217e-02]],\r\n                [[-2.8147e-02]],\r\n                [[9.7940e-03]],\r\n                [[1.0163e-03]],\r\n                [[-5.6101e-02]],\r\n                [[1.6846e-03]],\r\n                [[-3.0928e-02]],\r\n                [[-6.3853e-02]],\r\n                [[-2.0385e-02]],\r\n                [[-4.3640e-02]],\r\n            ],\r\n            [\r\n                [[-5.4244e-02]],\r\n                [[3.3747e-02]],\r\n                [[-2.6432e-02]],\r\n                [[-2.0302e-02]],\r\n                [[3.0961e-02]],\r\n                [[3.0394e-02]],\r\n                [[5.0516e-02]],\r\n                [[-3.3158e-03]],\r\n                [[7.7341e-03]],\r\n                [[-2.7420e-02]],\r\n                [[9.3604e-02]],\r\n                [[-3.1954e-02]],\r\n            ],\r\n            [\r\n                [[-6.5509e-02]],\r\n                [[9.1255e-02]],\r\n                [[-5.3223e-02]],\r\n                [[-9.5710e-03]],\r\n                [[2.3625e-02]],\r\n                [[6.9223e-03]],\r\n                [[2.6769e-03]],\r\n                [[2.8905e-02]],\r\n                [[-7.6544e-03]],\r\n                [[-1.5755e-01]],\r\n                [[2.0315e-02]],\r\n                [[3.1298e-02]],\r\n            ],\r\n            [\r\n                [[-3.9999e-02]],\r\n                [[-6.3408e-02]],\r\n                [[-4.7921e-02]],\r\n                [[5.0635e-02]],\r\n                [[-8.8498e-02]],\r\n                [[3.3315e-02]],\r\n                [[7.9214e-02]],\r\n                [[5.8254e-03]],\r\n                [[-5.9077e-02]],\r\n                [[6.2304e-02]],\r\n                [[5.5565e-02]],\r\n                [[4.1595e-02]],\r\n            ],\r\n            [\r\n                [[3.9259e-02]],\r\n                [[8.9200e-02]],\r\n                [[-4.5643e-03]],\r\n                [[5.1565e-02]],\r\n                [[-1.5232e-02]],\r\n                [[-1.9123e-02]],\r\n                [[-3.0002e-02]],\r\n                [[1.7376e-02]],\r\n                [[5.7346e-02]],\r\n                [[3.7609e-02]],\r\n                [[5.2436e-03]],\r\n                [[-4.0633e-02]],\r\n            ],\r\n            [\r\n                [[1.4893e-02]],\r\n                [[2.9597e-02]],\r\n                [[2.0239e-02]],\r\n                [[-9.2896e-02]],\r\n                [[1.9449e-02]],\r\n                [[-8.1253e-02]],\r\n                [[-4.0866e-02]],\r\n                [[-1.1120e-02]],\r\n                [[-4.7219e-02]],\r\n                [[-3.5702e-02]],\r\n                [[-2.1840e-02]],\r\n                [[6.9138e-02]],\r\n            ],\r\n        ]\r\n    )\r\n\r\n\r\ntiming_test()\r\n', '\r\n~/misc$ conda create -n torch_test python==3.7\r\n~/misc$ conda activate torch_test\r\n~/misc$ pip install torch\r\n']"
440,24686,0,"Migrate `clamp` and `clamp_` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
7,13886,1,"Get wrong with Pytorch derivative of division. I'm trying to compute the gradient of 1/x without using Pytorch's autograd. I use the formula grad(1/x, x) = -1/(x**2) but when I compare my result with the gradient given by Pytorch's autograd, they're different.
Here is my code

The output is

Can anyone explain why ?. ['\r\na = torch.tensor(np.random.randn(), dtype=dtype, requires_grad=True)\r\nloss = 1/a\r\nloss.backward()\r\nprint(a.grad - (-1/(a**2)))\r\n', '\r\ntensor(5.9605e-08, grad_fn=<ThAddBackward>)\r\n']"
598,768,0,"Feature Request: Bitwise Operations. it seems that there is SOME support for bitwise operations in NumPy:
https://docs.scipy.org/doc/numpy/reference/generated/numpy.bitwise_xor.html
Bitwise operations are also supported by CUDA:
https://docs.nvidia.com/cuda/cuda-c-programming-guide/#warp-shuffle-functions
yet, the implementation of binary operation  in  is 

which takes two ByteTensor. My undertsanding is that this is inefficient, because only one Bit within every Byte of this tensor is actually encoding something. Please correct me if I'm wrong!!

for the record neither TensorFlow has bitwise operations
. []"
0,15872,1,"GPU memory usage is very high at the beginning of training.. ## üêõ Bug

At the beginning of the training, the GPU memory usage is high, i.e. about 9GB. After some iterations, the consumption is stable at 1.4 GB. 

So I can't set a larger batch size.

## To Reproduce
Change crop size to  on  https://github.com/pytorch/examples/blob/0.4/imagenet/main.py#L122 can reproduce the problem to some extent, i.e. 7.5GB at beginning and 4.5GB at stable.

My training scripts only has a more complicated dataset process.

## Environment
. ['\r\nCollecting environment information...\r\nPyTorch version: 0.4.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 2.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration:\r\nGPU 0: TITAN Xp\r\nGPU 1: TITAN Xp\r\nGPU 2: TITAN Xp\r\nGPU 3: TITAN Xp\r\n\r\nNvidia driver version: 384.66\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] Could not collect\r\n']"
26,30365,1,"TorchScript Performance: 150x gap between TorchScript and Native Python. ## üêõ Bug

There's a 150x gap in performance for TorchScript ops versus straight Python / C++.
Looping over 100K numbers takes 2+ seconds instead of 18ms or better. 
Please see the benchmarks here: https://github.com/divyekapoor/ml-op-benchmarks

## To Reproduce
https://github.com/divyekapoor/ml-op-benchmarks

Steps to reproduce the behavior:
1. Clone the repo
1. make torchbench

See related TensorFlow issue for context:
https://github.com/tensorflow/tensorflow/issues/34500

## Expected behavior

FizzBuzz Iteration Counts | 100000 | ¬† | ¬† | ¬†
-- | -- | -- | -- | --
¬† | Raw Latency (ms) | Per Run Latency (usec) | Python Multiplier | C++ Multiplier
PyTorch Python | 4007 | 40.07 | 222.61 | 23851
PyTorch TorchScript Python (from Loaded TorchScript) | 2830 | 28.3 | **157.22** | 16845
PyTorch TorchScript C++ (Native) | 255 | 2.55 | **14.17** | 1518
PyTorch TorchScript C++ (Native + ATen Tensors) | 252 | 2.52 | **14.00** | 1500
Raw Python | 18 | 0.18 | 1.00 | 107
Raw C++ | 0.168 | 0.00168 | 0.01 | 1

Performance similar to raw Python is the expected behavior.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:




 - PyTorch Version (e.g., 1.0): 1.3
 - OS (e.g., Linux): Mac OS X
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source): NA
 - Python version: 3.7
 - CUDA/cuDNN version: NA
 - GPU models and configuration: NA
 - Any other relevant information: See performance tables and github repo.

## Additional context

Code: 



cc @suo. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n', '\r\n$ python3 /tmp/collect_env.py\r\nCollecting environment information...\r\nPyTorch version: 1.3.0.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: None\r\n\r\nOS: Mac OSX 10.14.6\r\nGCC version: Could not collect\r\nCMake version: version 3.15.5\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.17.4\r\n[pip3] torch==1.3.0.post2\r\n[conda] Could not collect\r\n', 'python\r\nclass TorchFizzBuzz(torch.nn.Module):\r\n    def __init__(self):\r\n        super(TorchFizzBuzz, self).__init__()\r\n        self.fizz = torch.tensor(0, requires_grad=False)\r\n        self.buzz = torch.tensor(0, requires_grad=False)\r\n        self.fizzbuzz = torch.tensor(0, requires_grad=False)\r\n\r\n    def forward(self, n: torch.Tensor):\r\n        i = torch.tensor(0, dtype=torch.int32, requires_grad=False)\r\n        self.fizz = torch.zeros(1)\r\n        self.buzz = torch.zeros(1)\r\n        self.fizzbuzz = torch.zeros(1)\r\n        while i < n:\r\n            if i % 6 == 0:\r\n                self.fizzbuzz += 1\r\n            elif i % 3 == 0:\r\n                self.buzz += 1\r\n            elif i % 2 == 0:\r\n                self.fizz += 1\r\n            i += 1\r\n        return torch.stack([self.fizz, self.buzz, self.fizzbuzz])\r\n']"
49,18722,1,"pytorch can't be as good as keras. I use the same data„ÄÅ same data iter and same vgg16 network, but the pytorch's loss beame 12.3 while the keras's loss became 4.2:
pytorch loss log:
train Loss: 15.2963 val Loss: 8.0108
train Loss: 12.4626 val Loss: 9.5972
train Loss: 12.4143 val Loss: 6.9568
train Loss: 12.3993  val Loss: 8.3055
train Loss: 12.3956 val Loss: 6.8054

keras loss:
Epoch 1/20
402/402 [==============================] - 183s 455ms/step - loss: 11.6960 
Epoch 2/20
402/402 [==============================] - 181s 449ms/step - loss: 6.6525
Epoch 3/20
402/402 [==============================] - 181s 450ms/step - loss: 5.4451
Epoch 4/20
402/402 [==============================] - 186s 463ms/step - loss: 4.9515 
Epoch 5/20
402/402 [==============================] - 186s 462ms/step - loss: 4.6679 
Epoch 6/20
402/402 [==============================] - 186s 462ms/step - loss: 4.4298 

 The main code is as fallows:
pytorch:
model = nn.Sequential(*list(make_model('vgg16', num_classes=1, pretrained=True, input_size=INPUT_SIZE).children())[0][:],\
                      nn.AdaptiveAvgPool2d(1), 
                      Flatten(),nn.Sequential(nn.Linear(512, 1024, bias=True),nn.ReLU(), nn.Linear(1024, 1, bias=True))).cuda()
dataloaders = {'train':train_dl, 'val':valid_dl}
train_model(model, dataloaders, nn.L1Loss(), optim.Adam(model.parameters(),lr=0.001), 21)

keras:
base_model = VGG16(weights='imagenet', include_top=False, input_shape=(input_shape[1], input_shape[0], 3))
    model = GlobalAveragePooling2D()(base_model.output)
    model = Dense(1024, activation='relu')(model)
    model = Dense(1, activation='linear')(model)

    model = Model(inputs=base_model.input, outputs=model)
    # model = base_model

    keras.callbacks.EarlyStopping(
    monitor='val_loss', 
    patience=0, 
    verbose=0, 
    mode='auto')
    model.compile(keras.optimizers.Adam(0.001), 'mape', metrics=['acc', 'mae', 'mse'])
model.fit_generator(train_iter, len_train//BS-1, 20,validation_data=valid_iter, validation_steps=len_valid//BS, callbacks=[early_stop])   . []"
307,934,0,"dataloader parallels over elements vs over batches. With current design of , if we set , 8 batches of data will be prepared in advance, each worker works on one batch. This is not very efficient especially when one batch is large/expensive to process; and normally we only need 1-2 batches ahead of time . Why didn't we go with the design where all workers work on one batch at a time? 

cc @SsnL. []"
153,598,0,"Problem with backward hook function. Hi,

there is something strange in the  step (or maybe something I don't understand). If I define a Module that takes 3 inputs, the  has to be of size 3, right ? But this is not the case here (from the backward_hook point of view):



In that case, when I print grad_input throught the hook function, it is just composed of two elements... Could you tell me where am I wrong ? But  seem correctly computed

cc @ezyang @gchanan @zou3519 @SsnL @albanD @gqchen. ['import torch\r\nfrom torch.autograd import Variable\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\n\r\ndef bh(m,go,gi):\r\n    print(""Grad Input"")\r\n    print(go)\r\n    print(""Grad Output"")\r\n    print(gi)\r\n\r\nclass M(nn.Module):\r\n    def __init__(self):\r\n        super(M,self).__init__()\r\n        self.register_backward_hook(bh)\r\n\r\n\r\n    def forward(self,x,y,z):\r\n        return (x+y+z)\r\n\r\nx=Variable(torch.randn(1,5),requires_grad=True)\r\ny=Variable(torch.randn(1,5),requires_grad=True)\r\nz=Variable(torch.randn(1,5),requires_grad=True)\r\n\r\ncriterion=nn.MSELoss()\r\nmod=M()\r\nout=mod(x,y,z)\r\nloss=criterion(out,Variable(torch.randn(1,5)))\r\nloss.backward()']"
406,24718,0,"Migrate `l1_loss_backward` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
324,24770,0,"Migrate `sort` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
513,25320,0,"Compilation Error on Windows. 
#### ~~How to reproduce~~




## Configuration Log
<details><summary>Expand for detail</summary>
<p>



</p>
</details>

## First Error
<details><summary>Expand for detail</summary>
<p>



</p>
</details>

## Second Error
<details><summary>Expand for detail</summary>
<p>



</p>
</details>

## Third Error

The third one is same to the second one, but happens to target 

cc @peterjc123. ['powershell\r\n# conda env setup...\r\n# Visual Studio env setup\r\n# pytorch build env variable setup\r\n> python .\\setup.py build_ext\r\n', '\r\nBuilding wheel torch-1.3.0a0+6c9410f\r\n-- Building version 1.3.0a0+6c9410f\r\ncmake -GNinja -DATEN_THREADING=TBB -DBUILD_CAFFE2_OPS=0 -DBUILD_PYTHON=True -DBUILD_TEST=False -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_INSTALL_PREFIX=D:\\test\\pytorch\\torch -DCMAKE_PREFIX_PATH=C:\\Users\\cloud\\Miniconda3\\Lib\\site-packages -DNUMPY_INCLUDE_DIR=C:\\Users\\cloud\\Miniconda3\\lib\\site-packages\\numpy\\core\\include -DPYTHON_EXECUTABLE=C:\\Users\\cloud\\Miniconda3\\python.exe -DPYTHON_INCLUDE_DIR=C:\\Users\\cloud\\Miniconda3\\include -DPYTHON_LIBRARY=C:\\Users\\cloud\\Miniconda3/libs/python37.lib -DTORCH_BUILD_VERSION=1.3.0a0+6c9410f -DUSE_CUDA=True -DUSE_DISTRIBUTED=False -DUSE_FBGEMM=0 -DUSE_FFMPEG=0 -DUSE_LEVELDB=0 -DUSE_LMDB=0 -DUSE_NUMPY=True -DUSE_OPENCV=0 -DUSE_OPENMP=0 -DUSE_TBB=1 -DUSE_ZSTD=0 D:\\test\\pytorch  -- The CXX compiler identification is MSVC 19.22.27905.0\r\n-- The C compiler identification is MSVC 19.22.27905.0\r\n-- Check for working CXX compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n-- Check for working CXX compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Not forcing any particular BLAS to be found\r\n-- Performing Test COMPILER_WORKS\r\n-- Performing Test COMPILER_WORKS - Success\r\n-- Performing Test SUPPORT_GLIBCXX_USE_C99\r\n-- Performing Test SUPPORT_GLIBCXX_USE_C99 - Success\r\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED\r\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED - Success\r\n-- std::exception_ptr is supported.\r\n-- NUMA is disabled\r\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING\r\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING - Failed\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS - Success\r\n-- Current compiler supports avx2 extension. Will build perfkernels.\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX512_EXTENSIONS\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX512_EXTENSIONS - Success\r\n-- Current compiler supports avx512f extension. Will build fbgemm.\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY - Failed\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY - Failed\r\n-- Performing Test COMPILER_SUPPORTS_RDYNAMIC\r\n-- Performing Test COMPILER_SUPPORTS_RDYNAMIC - Failed\r\n-- Building using own protobuf under third_party per request.\r\n-- Use custom protobuf build.\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - not found\r\n-- Found Threads: TRUE\r\n-- Caffe2 protobuf include directory: $<BUILD_INTERFACE:D:/test/pytorch/third_party/protobuf/src>$<INSTALL_INTERFACE:include>\r\n-- Compiling TBB from source\r\n-- The ASM_MASM compiler identification is MSVC\r\n-- Found assembler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/ml64.exe\r\n-- Performing Test SUPPORTS_VOLATILE_FLAG\r\n-- Performing Test SUPPORTS_VOLATILE_FLAG - Success\r\n-- Trying to find preferred BLAS backend of choice: MKL\r\n-- MKL_THREADING = OMP\r\n-- Looking for sys/types.h\r\n-- Looking for sys/types.h - found\r\n-- Looking for stdint.h\r\n-- Looking for stdint.h - found\r\n-- Looking for stddef.h\r\n-- Looking for stddef.h - found\r\n-- Check size of void*\r\n-- Check size of void* - done\r\n-- Looking for cblas_sgemm\r\n-- Looking for cblas_sgemm - found\r\n-- MKL libraries: C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/mkl/lib/intel64_win/mkl_intel_lp64.lib;C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/mkl/lib/intel64_win/mkl_intel_thread.lib;C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/mkl/lib/intel64_win/mkl_core.lib;C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/compiler/lib/intel64_win/libiomp5md.lib\r\n-- MKL include directory: C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/mkl/include\r\n-- MKL OpenMP type: Intel\r\n-- MKL OpenMP library: C:/Program Files (x86)/IntelSWTools/compilers_and_libraries/windows/compiler/lib/intel64_win/libiomp5md.lib\r\nCMake Warning at cmake/Dependencies.cmake:211 (message):\r\n  Target platform ""Windows"" is not supported in QNNPACK.  Supported platforms\r\n  are Android, iOS, Linux, and macOS.  Turn this warning off by\r\n  USE_QNNPACK=OFF.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:311 (include)\r\n\r\n\r\nCMake Warning at cmake/External/nnpack.cmake:21 (message):\r\n  NNPACK not supported on MSVC yet.  Turn this warning off by USE_NNPACK=OFF.\r\nCall Stack (most recent call first):\r\n  cmake/Dependencies.cmake:279 (include)\r\n  CMakeLists.txt:311 (include)\r\n\r\n\r\nCMake Warning at cmake/Dependencies.cmake:289 (message):\r\n  Not compiling with NNPACK.  Suppress this warning with -DUSE_NNPACK=OFF\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:311 (include)\r\n\r\n\r\n-- Downloading PSimd to D:/test/pytorch/build/confu-srcs/psimd (define PSIMD_SOURCE_DIR to avoid it)\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: D:/test/pytorch/build/confu-deps/psimd-download\r\n[1/9] Creating directories for \'psimd\'\r\n[2/9] Performing download step (git clone) for \'psimd\'\r\nCloning into \'psimd\'...\r\nYour branch is up to date with \'origin/master\'.\r\nAlready on \'master\'\r\n[3/9] No patch step for \'psimd\'\r\n[4/9] Performing update step for \'psimd\'\r\nCurrent branch master is up to date.\r\n[5/9] No configure step for \'psimd\'\r\n[6/9] No build step for \'psimd\'\r\n[7/9] No install step for \'psimd\'\r\n[8/9] No test step for \'psimd\'\r\n[9/9] Completed \'psimd\'\r\n-- Using third party subdirectory Eigen.\r\nPython 3.7.3\r\n-- Found PythonInterp: C:/Users/cloud/Miniconda3/python.exe (found suitable version ""3.7.3"", minimum required is ""2.7"")\r\n-- Found PythonLibs: C:/Users/cloud/Miniconda3/libs/python37.lib (found suitable version ""3.7.3"", minimum required is ""2.7"")\r\n-- Could NOT find pybind11 (missing: pybind11_DIR)\r\n-- Could NOT find pybind11 (missing: pybind11_INCLUDE_DIR)\r\n-- Using third_party/pybind11.\r\n-- Found CUDA: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1 (found version ""10.1"")\r\n-- Caffe2: CUDA detected: 10.1\r\n-- Caffe2: CUDA nvcc is: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/bin/nvcc.exe\r\n-- Caffe2: CUDA toolkit directory: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1\r\n-- Caffe2: Header version is: 10.1\r\n-- Found CUDNN: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cudnn.lib\r\n-- Found cuDNN: v7.6.2  (include: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/include, library: C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cudnn.lib)\r\nCMake Warning at cmake/public/utils.cmake:172 (message):\r\n  In the future we will require one to explicitly pass TORCH_CUDA_ARCH_LIST\r\n  to cmake instead of implicitly setting it as an env variable.  This will\r\n  become a FATAL_ERROR in future version of pytorch.\r\nCall Stack (most recent call first):\r\n  cmake/public/cuda.cmake:369 (torch_cuda_get_nvcc_gencode_flag)\r\n  cmake/Dependencies.cmake:808 (include)\r\n  CMakeLists.txt:311 (include)\r\n\r\n\r\n-- Added CUDA NVCC flags for: -gencode;arch=compute_61,code=sm_61\r\n-- Could NOT find CUB (missing: CUB_INCLUDE_DIR)\r\nCMake Warning at cmake/Dependencies.cmake:1012 (message):\r\n  Metal is only used in ios builds.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:311 (include)\r\n\r\n\r\n--\r\n-- ******** Summary ********\r\n--   CMake version         : 3.14.4\r\n--   CMake command         : C:/Program Files/CMake/bin/cmake.exe\r\n--   System                : Windows\r\n--   C++ compiler          : C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n--   C++ compiler version  : 19.22.27905.0\r\n--   CXX flags             : /DWIN32 /D_WINDOWS /W3 /GR /EHsc /EHa\r\n--   Build type            : RelWithDebInfo\r\n--   Compile definitions   : TH_BLAS_MKL;_OPENMP_NOFORCE_MANIFEST;ONNX_ML=1\r\n--   CMAKE_PREFIX_PATH     : C:\\Users\\cloud\\Miniconda3\\Lib\\site-packages;C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1\r\n--   CMAKE_INSTALL_PREFIX  : D:/test/pytorch/torch\r\n--   CMAKE_MODULE_PATH     : D:/test/pytorch/cmake/Modules;D:/test/pytorch/cmake/public/../Modules_CUDA_fix\r\n--\r\n--   ONNX version          : 1.5.0\r\n--   ONNX NAMESPACE        : onnx_torch\r\n--   ONNX_BUILD_TESTS      : OFF\r\n--   ONNX_BUILD_BENCHMARKS : OFF\r\n--   ONNX_USE_LITE_PROTO   : OFF\r\n--   ONNXIFI_DUMMY_BACKEND : OFF\r\n--   ONNXIFI_ENABLE_EXT    : OFF\r\n--\r\n--   Protobuf compiler     :\r\n--   Protobuf includes     :\r\n--   Protobuf libraries    :\r\n--   BUILD_ONNX_PYTHON     : OFF\r\n--\r\n-- ******** Summary ********\r\n--   CMake version         : 3.14.4\r\n--   CMake command         : C:/Program Files/CMake/bin/cmake.exe\r\n--   System                : Windows\r\n--   C++ compiler          : C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n--   C++ compiler version  : 19.22.27905.0\r\n--   CXX flags             : /DWIN32 /D_WINDOWS /W3 /GR /EHsc /EHa\r\n--   Build type            : RelWithDebInfo\r\n--   Compile definitions   : TH_BLAS_MKL;_OPENMP_NOFORCE_MANIFEST;ONNX_ML=1\r\n--   CMAKE_PREFIX_PATH     : C:\\Users\\cloud\\Miniconda3\\Lib\\site-packages;C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1\r\n--   CMAKE_INSTALL_PREFIX  : D:/test/pytorch/torch\r\n--   CMAKE_MODULE_PATH     : D:/test/pytorch/cmake/Modules;D:/test/pytorch/cmake/public/../Modules_CUDA_fix\r\n--\r\n--   ONNX version          : 1.4.1\r\n--   ONNX NAMESPACE        : onnx_torch\r\n--   ONNX_BUILD_TESTS      : OFF\r\n--   ONNX_BUILD_BENCHMARKS : OFF\r\n--   ONNX_USE_LITE_PROTO   : OFF\r\n--   ONNXIFI_DUMMY_BACKEND : OFF\r\n--\r\n--   Protobuf compiler     :\r\n--   Protobuf includes     :\r\n--   Protobuf libraries    :\r\n--   BUILD_ONNX_PYTHON     : OFF\r\n-- Found CUDA with FP16 support, compiling with torch.cuda.HalfTensor\r\n-- Removing -DNDEBUG from compile flags\r\n-- MAGMA not found. Compiling without MAGMA support\r\n-- Could not find hardware support for NEON on this machine.\r\n-- No OMAP3 processor on this machine.\r\n-- No OMAP4 processor on this machine.\r\n-- Looking for cpuid.h\r\n-- Looking for cpuid.h - not found\r\n-- Performing Test NO_GCC_EBX_FPIC_BUG\r\n-- Performing Test NO_GCC_EBX_FPIC_BUG - Failed\r\n-- Performing Test C_HAS_AVX_1\r\n-- Performing Test C_HAS_AVX_1 - Success\r\n-- Performing Test C_HAS_AVX2_1\r\n-- Performing Test C_HAS_AVX2_1 - Success\r\n-- Performing Test CXX_HAS_AVX_1\r\n-- Performing Test CXX_HAS_AVX_1 - Success\r\n-- Performing Test CXX_HAS_AVX2_1\r\n-- Performing Test CXX_HAS_AVX2_1 - Success\r\n-- AVX compiler support found\r\n-- AVX2 compiler support found\r\n-- Performing Test BLAS_F2C_DOUBLE_WORKS\r\n-- Performing Test BLAS_F2C_DOUBLE_WORKS - Failed\r\n-- Performing Test BLAS_F2C_FLOAT_WORKS\r\n-- Performing Test BLAS_F2C_FLOAT_WORKS - Success\r\n-- Performing Test BLAS_USE_CBLAS_DOT\r\n-- Performing Test BLAS_USE_CBLAS_DOT - Success\r\n-- Found a library with BLAS API (mkl).\r\n-- Found a library with LAPACK API (mkl).\r\ndisabling ROCM because NOT USE_ROCM is set\r\n-- MIOpen not found. Compiling without MIOpen support\r\ndisabling MKLDNN because USE_MKLDNN is not set\r\n-- Performing Test C_HAS_THREAD\r\n-- Performing Test C_HAS_THREAD - Success\r\n-- don\'t use NUMA\r\n-- Performing Test COMPILER_SUPPORTS_NO_AVX256_SPLIT\r\n-- Performing Test COMPILER_SUPPORTS_NO_AVX256_SPLIT - Failed\r\nATen is compiled with TBB (D:/test/pytorch/third_party/tbb)\r\n-- NCCL operators skipped due to no CUDA support\r\n-- Excluding ideep operators as we are not using ideep\r\n-- Excluding image processing operators due to no opencv\r\n-- Excluding video processing operators due to no opencv\r\n-- MPI operators skipped due to no MPI support\r\n-- Include Observer library\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/AffineGridGenerator.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/BatchNorm.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/Conv.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/GridSampler.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/LossCTC.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cudnn/RNN.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/miopen/BatchNorm_miopen.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/miopen/Conv_miopen.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/miopen/RNN_miopen.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/sparse/cuda/SparseCUDATensor.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cuda/CUDABlas.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cuda/CUDAContext.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cuda/CUDAGenerator.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cuda/PinnedMemoryAllocator.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cuda/detail/CUDAHooks.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/CUDAUnaryOps.cpp\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp\r\n--   D:/test/pytorch/build/aten/src/ATen/CUDAType.cpp\r\n--   D:/test/pytorch/build/aten/src/ATen/CUDAType.h\r\n--   D:/test/pytorch/build/aten/src/ATen/LegacyTHFunctionsCUDA.cpp\r\n--   D:/test/pytorch/build/aten/src/ATen/LegacyTHFunctionsCUDA.h\r\n--   D:/test/pytorch/build/aten/src/ATen/SparseCUDAType.cpp\r\n--   D:/test/pytorch/build/aten/src/ATen/SparseCUDAType.h\r\n--   D:/test/pytorch/aten/src/THC/THCCachingHostAllocator.cpp\r\n--   D:/test/pytorch/aten/src/THC/THCGeneral.cpp\r\n--   D:/test/pytorch/aten/src/THC/THCStorageCopy.cpp\r\n--   D:/test/pytorch/aten/src/THC/THCTensor.cpp\r\n--   D:/test/pytorch/aten/src/THC/THCReduceApplyUtils.cu\r\n--   D:/test/pytorch/aten/src/THC/THCBlas.cu\r\n--   D:/test/pytorch/aten/src/THC/THCSleep.cu\r\n--   D:/test/pytorch/aten/src/THC/THCStorage.cu\r\n--   D:/test/pytorch/aten/src/THC/THCStorageCopy.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensor.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorCopy.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMath.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMathBlas.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMathMagma.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMathPairwise.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMathReduce.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMathScan.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorIndex.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorRandom.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorScatterGather.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorTopK.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorSort.cu\r\n--   D:/test/pytorch/aten/src/THC/THCSortUtils.cu\r\n--   D:/test/pytorch/aten/src/THC/THCTensorMode.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedByte.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedChar.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedShort.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedInt.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedLong.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedHalf.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedFloat.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorSortDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedDouble.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareTBool.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathCompareBool.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathReduceBool.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMaskedBool.cu\r\n--   D:/test/pytorch/aten/src/THC/generated/THCTensorMathPointwiseBool.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/AbsCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/Abs.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/BCECriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/ClassNLLCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/DistKLDivCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/ELU.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/FeatureLPPooling.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/GatedLinearUnit.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/HardTanh.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/IndexLinear.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/L1Cost.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/LeakyReLU.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/LogSigmoid.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/LookupTableBag.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/LookupTable.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/MarginCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/MSECriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/MultiLabelMarginCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/MultiMarginCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/RReLU.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/Sigmoid.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SmoothL1Criterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SoftMarginCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SoftPlus.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SoftShrink.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialClassNLLCriterion.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialConvolutionLocal.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialConvolutionMM.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialCrossMapLRN.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialDepthwiseConvolution.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/SpatialSubSampling.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/Sqrt.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/Square.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/Tanh.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/TemporalConvolution.cu\r\n--   D:/test/pytorch/aten/src/THCUNN/TemporalMaxPooling.cu\r\n--   D:/test/pytorch/aten/src/ATen/cuda/detail/IndexUtils.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Activation.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AdaptiveAveragePooling.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AdaptiveAveragePooling3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AdaptiveMaxPooling2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AdaptiveMaxPooling3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AveragePool2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/AveragePool3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/BatchLinearAlgebra.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/BinaryOpsKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/CUDAScalar.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Col2Im.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Copy.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/CrossKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/DilatedMaxPool2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/DilatedMaxPool3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/DistanceKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Distributions.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Dropout.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Embedding.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/EmbeddingBackwardKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/EmbeddingBag.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/FillKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/FractionalMaxPool2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/FractionalMaxPool3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/GridSampler.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Im2Col.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/IndexKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Indexing.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Lerp.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/LinearAlgebra.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Loss.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/LossCTC.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/MaxUnpooling.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/NaiveConvolutionTranspose2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/NaiveConvolutionTranspose3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/NaiveDilatedConvolution.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Normalization.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/PointwiseOpsKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/RNN.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/RangeFactories.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Reduce.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/ReduceOpsKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/ReflectionPad.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Repeat.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/ReplicationPadding.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Resize.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/SoftMax.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/SortingKthValue.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/SparseMM.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/SpectralOps.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/SummaryOps.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/TensorCompare.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/TensorFactories.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/TensorTransformations.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UnaryOpsKernel.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/Unique.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleBicubic2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleBilinear2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleLinear1d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleNearest1d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleNearest2d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleNearest3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/UpSampleTrilinear3d.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/cuda/WeightNorm.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/sparse/cuda/SparseCUDABlas.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/sparse/cuda/SparseCUDATensor.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/sparse/cuda/SparseCUDATensorMath.cu\r\n--   D:/test/pytorch/aten/src/ATen/native/quantized/cuda/fake_quantize_per_tensor_affine.cu\r\n--   D:/test/pytorch/aten/src/ATen/cudnn/Descriptors.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cudnn/Handle.cpp\r\n--   D:/test/pytorch/aten/src/ATen/cudnn/Types.cpp\r\n--   D:/test/pytorch/caffe2/core/common_cudnn.cc\r\n--   D:/test/pytorch/caffe2/core/blob_serialization_gpu.cc\r\n--   D:/test/pytorch/caffe2/core/common_gpu.cc\r\n--   D:/test/pytorch/caffe2/core/event_gpu.cc\r\n--   D:/test/pytorch/caffe2/core/context_gpu.cu\r\n--   utils/math/broadcast.cu\r\n--   utils/math/elementwise.cu\r\n--   utils/math/reduce.cu\r\n--   utils/math/transpose.cu\r\n--   utils/math_gpu.cu\r\n--   D:/test/pytorch/caffe2/db/create_db_op_gpu.cc\r\n--   D:/test/pytorch/caffe2/distributed/file_store_handler_op_gpu.cc\r\n--   D:/test/pytorch/caffe2/queue/queue_ops_gpu.cc\r\n--   D:/test/pytorch/caffe2/sgd/iter_op_gpu.cc\r\n--   D:/test/pytorch/caffe2/sgd/learning_rate_op_gpu.cc\r\n--   D:/test/pytorch/caffe2/sgd/adadelta_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/adagrad_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/adam_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/fp16_momentum_sgd_op.cu\r\n--   D:/test/pytorch/caffe2/sgd/fp32_momentum_sgd_op.cu\r\n--   D:/test/pytorch/caffe2/sgd/lars_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/momentum_sgd_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/rmsprop_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/sgd/yellowfin_op_gpu.cu\r\n--   D:/test/pytorch/caffe2/../torch/csrc/jit/fuser/cuda/fused_kernel.cpp\r\n--   D:/test/pytorch/caffe2/../torch/csrc/autograd/profiler_cuda.cpp\r\n--   D:/test/pytorch/caffe2/../torch/csrc/autograd/functions/comm.cpp\r\n--   D:/test/pytorch/caffe2/../torch/csrc/cuda/comm.cpp\r\n-- Using ATen parallel backend: TBB\r\n-- Using Lib/site-packages as python relative installation path\r\nCMake Warning at CMakeLists.txt:533 (message):\r\n  Generated cmake files are only fully tested if one builds with system glog,\r\n  gflags, and protobuf.  Other settings may generate files that are not well\r\n  tested.\r\n\r\n\r\n--\r\n-- ******** Summary ********\r\n-- General:\r\n--   CMake version         : 3.14.4\r\n--   CMake command         : C:/Program Files/CMake/bin/cmake.exe\r\n--   System                : Windows\r\n--   C++ compiler          : C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n--   C++ compiler id       : MSVC\r\n--   C++ compiler version  : 19.22.27905.0\r\n--   BLAS                  : MKL\r\n--   CXX flags             : /DWIN32 /D_WINDOWS /W3 /GR /EHsc /EHa /MP /bigobj\r\n--   Build type            : RelWithDebInfo\r\n--   Compile definitions   : TH_BLAS_MKL;_OPENMP_NOFORCE_MANIFEST;ONNX_ML=1;ONNX_NAMESPACE=onnx_torch;_CRT_SECURE_NO_DEPRECATE=1\r\n--   CMAKE_PREFIX_PATH     : C:\\Users\\cloud\\Miniconda3\\Lib\\site-packages;C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1\r\n--   CMAKE_INSTALL_PREFIX  : D:/test/pytorch/torch\r\n--\r\n--   TORCH_VERSION         : 1.3.0\r\n--   CAFFE2_VERSION        : 1.3.0\r\n--   BUILD_CAFFE2_MOBILE   : ON\r\n--   USE_STATIC_DISPATCH   : OFF\r\n--   BUILD_ATEN_ONLY       : OFF\r\n--   BUILD_BINARY          : OFF\r\n--   BUILD_CUSTOM_PROTOBUF : ON\r\n--     Link local protobuf : ON\r\n--   BUILD_DOCS            : OFF\r\n--   BUILD_PYTHON          : True\r\n--     Python version      : 3.7.3\r\n--     Python executable   : C:/Users/cloud/Miniconda3/python.exe\r\n--     Pythonlibs version  : 3.7.3\r\n--     Python library      : C:/Users/cloud/Miniconda3/libs/python37.lib\r\n--     Python includes     : C:/Users/cloud/Miniconda3/include\r\n--     Python site-packages: Lib/site-packages\r\n--   BUILD_CAFFE2_OPS      : 0\r\n--   BUILD_SHARED_LIBS     : ON\r\n--   BUILD_TEST            : False\r\n--   INTERN_BUILD_MOBILE   :\r\n--   USE_ASAN              : OFF\r\n--   USE_CUDA              : True\r\n--     CUDA static link    : OFF\r\n--     USE_CUDNN           : ON\r\n--     CUDA version        : 10.1\r\n--     cuDNN version       : 7.6.2\r\n--     CUDA root directory : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1\r\n--     CUDA library        : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cuda.lib\r\n--     cudart library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cudart_static.lib\r\n--     cublas library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cublas.lib\r\n--     cufft library       : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cufft.lib\r\n--     curand library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/curand.lib\r\n--     cuDNN library       : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/cudnn.lib\r\n--     nvrtc               : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/lib/x64/nvrtc.lib\r\n--     CUDA include path   : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/include\r\n--     NVCC executable     : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1/bin/nvcc.exe\r\n--     CUDA host compiler  : C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.22.27905/bin/Hostx64/x64/cl.exe\r\n--     USE_TENSORRT        : OFF\r\n--   USE_ROCM              : OFF\r\n--   USE_EIGEN_FOR_BLAS    :\r\n--   USE_FBGEMM            : OFF\r\n--   USE_FFMPEG            : 0\r\n--   USE_GFLAGS            : OFF\r\n--   USE_GLOG              : OFF\r\n--   USE_LEVELDB           : 0\r\n--   USE_LITE_PROTO        : OFF\r\n--   USE_LMDB              : 0\r\n--   USE_METAL             : OFF\r\n--   USE_MKL               : ON\r\n--   USE_MKLDNN            : OFF\r\n--   USE_NCCL              : OFF\r\n--   USE_NNPACK            : OFF\r\n--   USE_NUMPY             : ON\r\n--   USE_OBSERVERS         : ON\r\n--   USE_OPENCL            : OFF\r\n--   USE_OPENCV            : 0\r\n--   USE_OPENMP            : 0\r\n--   USE_TBB               : 1\r\n--   USE_PROF              : OFF\r\n--   USE_QNNPACK           : OFF\r\n--   USE_REDIS             : OFF\r\n--   USE_ROCKSDB           : OFF\r\n--   USE_ZMQ               : OFF\r\n--   USE_DISTRIBUTED       : OFF\r\n--   BUILD_NAMEDTENSOR   : OFF\r\n--   Public Dependencies  : Threads::Threads;caffe2::mkl\r\n--   Private Dependencies : cpuinfo;fp16;foxi_loader\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: D:/test/pytorch/build\r\ncmake --build . --target install --config RelWithDebInfo -- -j 6\r\n', ""\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(15): error C2143: syntax error: missing '}' before '='    D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(15): error C2513: 'c10::AliasAnalysisKind': no variable declared before '='\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(16): error C2143: syntax error: missing ';' before '}'    D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(18): error C2065: 'AliasAnalysisKind': undeclared identifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(18): error C2146: syntax error: missing ')' before identifier 'aliasAnalysisKind'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(18): error C2143: syntax error: missing ';' before '{'    D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(18): error C2447: '{': missing function header (old-style formal list?)\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(32): error C3646: 'aliasAnalysis': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(32): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(32): error C2334: unexpected token(s) preceding '{'; skipping apparent function body\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(36): error C2061: syntax error: identifier 'AliasAnalysisKind'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(49): error C3646: 'aliasAnalysisKind_': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(49): error C2059: syntax error: '='\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(49): error C2653: 'AliasAnalysisKind': is not a class or namespace name\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(49): error C2238: unexpected token(s) preceding ';'       D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(37): error C2065: 'aliasAnalysisKind_': undeclared identifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(37): error C2065: 'v': undeclared identifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(41): error C2039: 'aliasAnalysisKind_': is not a member of 'OperatorOptions'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(30): note: see declaration of 'OperatorOptions'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(52): error C2059: syntax error: '}'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorOptions.h(52): error C2143: syntax error: missing ';' before '}'    D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/RegistrationHandleRAII.h(5): error C2143: syntax error: missing ';' before '{'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/RegistrationHandleRAII.h(5): error C2447: '{': missing function header (old-style formal list?)\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(102): error C3646: 'registerKernel': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(102): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(102): error C2238: unexpected token(s) preceding ';'        D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(103): error C3646: 'registerCatchallKernel': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(103): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(103): error C2238: unexpected token(s) preceding ';'        D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(105): error C3646: 'registerUnboxedAutogradKernel': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(105): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/OperatorEntry.h(105): error C2238: unexpected token(s) preceding ';'        D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(81): error C3646: 'registerKernel': unknown override specifier D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(81): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(81): error C2238: unexpected token(s) preceding ';'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(91): error C3646: 'registerCatchallKernel': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(91): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(91): error C2238: unexpected token(s) preceding ';'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(93): error C3646: 'registerUnboxedAutogradKernel': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(93): error C2059: syntax error: '('\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(93): error C2238: unexpected token(s) preceding ';'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(169): error C2061: syntax error: identifier 'RegistrationHandleRAII'\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(173): error C3646: 'registrationHandle_': unknown override specifier\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(173): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\r\nD:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(170): error C2065: 'registrationHandle': undeclared identifier D:\\test\\pytorch\\aten\\src\\ATen/core/dispatch/Dispatcher.h(170): error C2614: 'c10::SchemaRegistrationHandleRAII': illegal member initialization: 'registrationHandle_' is not a base or member\r\n"", '\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: invalid combination of type specifiers\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=c10::Half]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=c10::Half]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(382): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=c10::Half]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(383): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=c10::Half]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(384): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=c10::Half]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: invalid combination of type specifiers\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=float]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=float]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(382): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=float]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(383): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=float]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(384): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=float]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: invalid combination of type specifiers\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=double]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(379): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=double]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(382): error: expected an identifier\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=double]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(383): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=double]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n\r\nD:\\test\\pytorch\\aten\\src\\THC/THCTensorRandom.cuh(384): error: type name is not allowed\r\n          detected during instantiation of ""void aliasMultinomialSetup(int64_t *, T *, int64_t, int64_t *, int64_t *, int, int) [with T=double]""\r\nD:\\test\\pytorch\\aten\\src\\THC/generic/THCTensorRandom.cu(262): here\r\n']"
416,14179,0,"Failed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn --use-qnnpack caffe2'. ## üêõ Bug
-- Build files have been written to: /home/feng/pytorch/build
+ make install -j12
Scanning dependencies of target js_embed
Scanning dependencies of target benchmark
Scanning dependencies of target nccl_external
Scanning dependencies of target pthreadpool
Scanning dependencies of target clog
Scanning dependencies of target gtest
Scanning dependencies of target gloo
Scanning dependencies of target onnxifi_dummy
Scanning dependencies of target onnxifi_loader
Scanning dependencies of target libprotobuf-lite
Scanning dependencies of target libprotobuf
[  0%] Creating directories for 'nccl_external'
Scanning dependencies of target mkldnn
[  1%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/json_reporter.cc.o
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/js_embed.dir/__/src/google/protobuf/compiler/js/embed.cc.o
[  1%] Building C object confu-deps/clog/CMakeFiles/clog.dir/src/clog.c.o
[  1%] No download step for 'nccl_external'
[  1%] No patch step for 'nccl_external'
[  1%] No update step for 'nccl_external'
[  1%] No configure step for 'nccl_external'
[  1%] Performing build step for 'nccl_external'
[  1%] Building C object third_party/onnx/CMakeFiles/onnxifi_loader.dir/onnx/onnxifi_loader.c.o
[  1%] Building C object third_party/onnx/CMakeFiles/onnxifi_dummy.dir/onnx/onnxifi_dummy.c.o
[  1%] Building C object confu-deps/pthreadpool/CMakeFiles/pthreadpool.dir/src/threadpool-pthreads.c.o
make[3]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c: In function ‚Äòclog_vlog_fatal‚Äô:
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c:120:4: warning: ignoring return value of ‚Äòwrite‚Äô, declared with attribute warn_unused_result [-Wunused-result]
    write(STDERR_FILENO, out_buffer, prefix_chars + format_chars + CLOG_SUFFIX_LENGTH);
    ^
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c: In function ‚Äòclog_vlog_error‚Äô:
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c:196:4: warning: ignoring return value of ‚Äòwrite‚Äô, declared with attribute warn_unused_result [-Wunused-result]
    write(STDERR_FILENO, out_buffer, prefix_chars + format_chars + CLOG_SUFFIX_LENGTH);
    ^
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c: In function ‚Äòclog_vlog_warning‚Äô:
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c:272:4: warning: ignoring return value of ‚Äòwrite‚Äô, declared with attribute warn_unused_result [-Wunused-result]
    write(STDERR_FILENO, out_buffer, prefix_chars + format_chars + CLOG_SUFFIX_LENGTH);
    ^
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c: In function ‚Äòclog_vlog_info‚Äô:
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c:348:4: warning: ignoring return value of ‚Äòwrite‚Äô, declared with attribute warn_unused_result [-Wunused-result]
    write(STDOUT_FILENO, out_buffer, prefix_chars + format_chars + CLOG_SUFFIX_LENGTH);
    ^
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c: In function ‚Äòclog_vlog_debug‚Äô:
/home/feng/pytorch/third_party/QNNPACK/deps/clog/src/clog.c:424:4: warning: ignoring return value of ‚Äòwrite‚Äô, declared with attribute warn_unused_result [-Wunused-result]
    write(STDOUT_FILENO, out_buffer, prefix_chars + format_chars + CLOG_SUFFIX_LENGTH);
    ^
[  1%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/algorithm.cc.o
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/arena.cc.o
Generating nccl.h.in                           > /home/feng/pytorch/build/nccl/include/nccl.h
Compiling  init.cu                             > /home/feng/pytorch/build/nccl/obj/init.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  1%] Building CXX object third_party/googletest/googletest/CMakeFiles/gtest.dir/src/gtest-all.cc.o
[  1%] Linking CXX executable ../../../bin/js_embed
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/arenastring.cc.o
[  1%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/string_util.cc.o
[  1%] Linking C shared library ../../lib/libonnxifi_dummy.so
[  1%] Linking C static library ../../lib/libpthreadpool.a
[  1%] Linking C static library ../../lib/libclog.a
[  1%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/allgather.cc.o
[  1%] Linking C static library ../../lib/libonnxifi_loader.a
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/primitive.cpp.o
[  1%] Built target onnxifi_dummy
[  1%] Built target js_embed
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/pooling.cpp.o
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/extension_set.cc.o
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/arena.cc.o
[  1%] Built target onnxifi_loader
[  1%] Built target pthreadpool
[  1%] Built target clog
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/arenastring.cc.o
Scanning dependencies of target python_copy_files
Scanning dependencies of target c10
[  1%] Building CXX object c10/CMakeFiles/c10.dir/DeviceType.cpp.o
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/engine.cpp.o
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/query.cpp.o
[  1%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/generated_message_table_driven_lite.cc.o
[  1%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/allreduce.cc.o
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/softmax.cpp.o
[  1%] Building CXX object c10/CMakeFiles/c10.dir/Half.cpp.o
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/mkldnn_debug.cpp.o
[  1%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o
[  2%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/extension_set.cc.o
[  2%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/scratchpad.cpp.o
[  2%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/commandlineflags.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/primitive_attr.cpp.o
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/generated_message_table_driven_lite.cc.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/Device.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/verbose.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/eltwise.cpp.o
[  3%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/sleep.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/memory_desc_wrapper.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/primitive_iterator.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/lrn.cpp.o
[  3%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/allreduce_local.cc.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/Stream.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/memory.cpp.o
[  3%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/statistics.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/inner_product.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/OpSchema.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/KernelRegistration.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/DeviceId.cpp.o
[  3%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/broadcast.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/stream.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/generated_message_util.cc.o
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/io/coded_stream.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/rnn.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/reorder.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/DispatchKey.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/generated_message_util.cc.o
[  3%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/context.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o
[  3%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/benchmark.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/primitive_desc.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/Dispatcher.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/OpSchemaRegistration.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/deconvolution.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/utils.cpp.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_sse42_conv_kernel_f32.cpp.o
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/io/zero_copy_stream.cc.o
[  3%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/gather.cc.o
[  3%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_batch_normalization_utils.cpp.o
init.cu:52:1: warning: ‚ÄòncclNet‚Äô initialized and declared ‚Äòextern‚Äô
 ncclNet_t* ncclNet = NULL;
 ^
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/DispatchTable.cpp.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/core/dispatch/LayoutId.cpp.o
[  3%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/reduce.cc.o
[  3%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/io/zero_copy_stream_impl_lite.cc.o
[  3%] Building CXX object c10/CMakeFiles/c10.dir/impl/DeviceGuardImplInterface.cpp.o
[  4%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/message_lite.cc.o
[  4%] Building CXX object c10/CMakeFiles/c10.dir/util/Type.cpp.o
[  4%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/coded_stream.cc.o
[  4%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/repeated_field.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  4%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_lrn.cpp.o
[  4%] Building CXX object c10/CMakeFiles/c10.dir/util/Backtrace.cpp.o
[  4%] Building CXX object c10/CMakeFiles/c10.dir/util/Optional.cpp.o
[  4%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/scatter.cc.o
[  4%] Building CXX object c10/CMakeFiles/c10.dir/util/C++17.cpp.o
Compiling  ring.cu                             > /home/feng/pytorch/build/nccl/obj/ring.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  5%] Building CXX object c10/CMakeFiles/c10.dir/util/SmallVector.cpp.o
[  5%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/csv_reporter.cc.o
[  5%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/atomicops_internals_x86_gcc.cc.o
[  5%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/atomicops_internals_x86_msvc.cc.o
[  5%] Building CXX object c10/CMakeFiles/c10.dir/util/LeftRight.cpp.o
[  5%] Building CXX object c10/CMakeFiles/c10.dir/util/flags_use_gflags.cpp.o
[  5%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/zero_copy_stream.cc.o
[  5%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_1x1_conv_kernel.cpp.o
[  5%] Linking CXX static library ../../../lib/libgtest.a
[  5%] Built target gtest
Scanning dependencies of target ATEN_CPU_FILES_GEN_TARGET
[  5%] Generating ../aten/src/ATen/CPUByteType.cpp, ../aten/src/ATen/CPUByteType.h, ../aten/src/ATen/CPUCharType.cpp, ../aten/src/ATen/CPUCharType.h, ../aten/src/ATen/CPUCopy.cpp, ../aten/src/ATen/CPUDoubleType.cpp, ../aten/src/ATen/CPUDoubleType.h, ../aten/src/ATen/CPUFloatType.cpp, ../aten/src/ATen/CPUFloatType.h, ../aten/src/ATen/CPUGenerator.h, ../aten/src/ATen/CPUHalfType.cpp, ../aten/src/ATen/CPUHalfType.h, ../aten/src/ATen/CPUIntType.cpp, ../aten/src/ATen/CPUIntType.h, ../aten/src/ATen/CPULongType.cpp, ../aten/src/ATen/CPULongType.h, ../aten/src/ATen/CPUShortType.cpp, ../aten/src/ATen/CPUShortType.h, ../aten/src/ATen/Declarations.yaml, ../aten/src/ATen/Functions.h, ../aten/src/ATen/NativeFunctions.h, ../aten/src/ATen/RegisterCPU.cpp, ../aten/src/ATen/RegisterCPU.h, ../aten/src/ATen/SparseCPUByteType.cpp, ../aten/src/ATen/SparseCPUByteType.h, ../aten/src/ATen/SparseCPUCharType.cpp, ../aten/src/ATen/SparseCPUCharType.h, ../aten/src/ATen/SparseCPUDoubleType.cpp, ../aten/src/ATen/SparseCPUDoubleType.h, ../aten/src/ATen/SparseCPUFloatType.cpp, ../aten/src/ATen/SparseCPUFloatType.h, ../aten/src/ATen/SparseCPUIntType.cpp, ../aten/src/ATen/SparseCPUIntType.h, ../aten/src/ATen/SparseCPULongType.cpp, ../aten/src/ATen/SparseCPULongType.h, ../aten/src/ATen/SparseCPUShortType.cpp, ../aten/src/ATen/SparseCPUShortType.h, ../aten/src/ATen/TypeDefault.cpp, ../aten/src/ATen/TypeDefault.h, ../aten/src/ATen/TypeExtendedInterface.h, ../aten/src/ATen/CUDAByteType.cpp, ../aten/src/ATen/CUDAByteType.h, ../aten/src/ATen/CUDACharType.cpp, ../aten/src/ATen/CUDACharType.h, ../aten/src/ATen/CUDACopy.cpp, ../aten/src/ATen/CUDADoubleType.cpp, ../aten/src/ATen/CUDADoubleType.h, ../aten/src/ATen/CUDAFloatType.cpp, ../aten/src/ATen/CUDAFloatType.h, ../aten/src/ATen/CUDAGenerator.h, ../aten/src/ATen/CUDAHalfType.cpp, ../aten/src/ATen/CUDAHalfType.h, ../aten/src/ATen/CUDAIntType.cpp, ../aten/src/ATen/CUDAIntType.h, ../aten/src/ATen/CUDALongType.cpp, ../aten/src/ATen/CUDALongType.h, ../aten/src/ATen/CUDAShortType.cpp, ../aten/src/ATen/CUDAShortType.h, ../aten/src/ATen/RegisterCUDA.cpp, ../aten/src/ATen/RegisterCUDA.h, ../aten/src/ATen/SparseCUDAByteType.cpp, ../aten/src/ATen/SparseCUDAByteType.h, ../aten/src/ATen/SparseCUDACharType.cpp, ../aten/src/ATen/SparseCUDACharType.h, ../aten/src/ATen/SparseCUDADoubleType.cpp, ../aten/src/ATen/SparseCUDADoubleType.h, ../aten/src/ATen/SparseCUDAFloatType.cpp, ../aten/src/ATen/SparseCUDAFloatType.h, ../aten/src/ATen/SparseCUDAIntType.cpp, ../aten/src/ATen/SparseCUDAIntType.h, ../aten/src/ATen/SparseCUDALongType.cpp, ../aten/src/ATen/SparseCUDALongType.h, ../aten/src/ATen/SparseCUDAShortType.cpp, ../aten/src/ATen/SparseCUDAShortType.h
[  6%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/types.cc.o
[  6%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_deconvolution.cpp.o
[  7%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_sse42_1x1_conv_kernel_f32.cpp.o
[  7%] Built target python_copy_files
Scanning dependencies of target common
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/bytestream.cc.o
[  7%] Building C object sleef/src/common/CMakeFiles/common.dir/common.c.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/common.cc.o
[  7%] Built target common
Scanning dependencies of target mkrename
[  7%] Building C object sleef/src/libm/CMakeFiles/mkrename.dir/mkrename.c.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/common/linux.cc.o
[  7%] Linking C executable ../../bin/mkrename
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/reporter.cc.o
[  7%] Built target mkrename
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/complexity.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/zero_copy_stream_impl_lite.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/Array.cpp.o
[  7%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_sum.cpp.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/Logging.cpp.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/int128.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/counter.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/message_lite.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/io_win32.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/once.cc.o
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/sysinfo.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/status.cc.o
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/colorprint.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/statusor.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/common/logging.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/mpi/context.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/Exception.cpp.o
Compiling  bootstrap.cu                        > /home/feng/pytorch/build/nccl/obj/bootstrap.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/repeated_field.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/stringpiece.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/stringprintf.cc.o
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/timers.cc.o
[  7%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_convolution.cpp.o
[  7%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_conv_winograd_kernel_f32.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/rendezvous/context.cc.o
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/benchmark_register.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/atomicops_internals_x86_gcc.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/TypeList.cpp.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/structurally_valid.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/strutil.cc.o
[  7%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark.dir/console_reporter.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/typeid.cpp.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/atomicops_internals_x86_msvc.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/rendezvous/file_store.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/rendezvous/hash_store.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/stubs/time.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf-lite.dir/__/src/google/protobuf/wire_format_lite.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/bytestream.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/TensorTypeId.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/rendezvous/prefix_store.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/Metaprogramming.cpp.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/TypeTraits.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/rendezvous/store.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/address.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/buffer.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/StringUtil.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/context.cc.o
[  7%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/common.cc.o
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/TensorTypeIdRegistration.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/device.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/pair.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  7%] Building CXX object c10/CMakeFiles/c10.dir/util/flags_use_no_gflags.cpp.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/unbound_buffer.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/address.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/buffer.cc.o
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/context.cc.o
[  7%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/gemm_inner_product.cpp.o
Compiling  transport.cu                        > /home/feng/pytorch/build/nccl/obj/transport.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[  7%] Linking CXX static library ../../../lib/libprotobuf-lite.a
[  7%] Built target libprotobuf-lite
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/device.cc.o
Scanning dependencies of target mkdisp
[  7%] Building C object sleef/src/libm/CMakeFiles/mkdisp.dir/mkdisp.c.o
[  7%] Linking C executable ../../bin/mkdisp
[  7%] Built target mkdisp
Scanning dependencies of target renamedsp256.h_generated
[  7%] Generating renamedsp256.h
[  7%] Built target renamedsp256.h_generated
Scanning dependencies of target dispavx.c_generated
[  7%] Generating dispavx.c
[  7%] Built target dispavx.c_generated
Scanning dependencies of target renameSSE2.h_generated
[  7%] Generating include/renamesse2.h
[  7%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/pair.cc.o
Generating renamesse2.h: mkrename 2 4 sse2
[  7%] Built target renameSSE2.h_generated
Scanning dependencies of target renameFMA4.h_generated
[  7%] Generating include/renamefma4.h
Generating renamefma4.h: mkrename 4 8 fma4
[  7%] Built target renameFMA4.h_generated
Scanning dependencies of target renameAVX2.h_generated
[  7%] Generating include/renameavx2.h
Generating renameavx2.h: mkrename 4 8 avx2
[  7%] Built target renameAVX2.h_generated
Scanning dependencies of target renameAVX2128.h_generated
[  7%] Generating include/renameavx2128.h
Generating renameavx2128.h: mkrename 2 4 avx2128
[  7%] Built target renameAVX2128.h_generated
Scanning dependencies of target renameSSE4.h_generated
[  8%] Generating include/renamesse4.h
Generating renamesse4.h: mkrename 2 4 sse4
[  8%] Built target renameSSE4.h_generated
Scanning dependencies of target ATEN_CUDA_FILES_GEN_TARGET
[  8%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/int128.cc.o
[  8%] Generating ../aten/src/ATen/CPUByteType.cpp, ../aten/src/ATen/CPUByteType.h, ../aten/src/ATen/CPUCharType.cpp, ../aten/src/ATen/CPUCharType.h, ../aten/src/ATen/CPUCopy.cpp, ../aten/src/ATen/CPUDoubleType.cpp, ../aten/src/ATen/CPUDoubleType.h, ../aten/src/ATen/CPUFloatType.cpp, ../aten/src/ATen/CPUFloatType.h, ../aten/src/ATen/CPUGenerator.h, ../aten/src/ATen/CPUHalfType.cpp, ../aten/src/ATen/CPUHalfType.h, ../aten/src/ATen/CPUIntType.cpp, ../aten/src/ATen/CPUIntType.h, ../aten/src/ATen/CPULongType.cpp, ../aten/src/ATen/CPULongType.h, ../aten/src/ATen/CPUShortType.cpp, ../aten/src/ATen/CPUShortType.h, ../aten/src/ATen/Declarations.yaml, ../aten/src/ATen/Functions.h, ../aten/src/ATen/NativeFunctions.h, ../aten/src/ATen/RegisterCPU.cpp, ../aten/src/ATen/RegisterCPU.h, ../aten/src/ATen/SparseCPUByteType.cpp, ../aten/src/ATen/SparseCPUByteType.h, ../aten/src/ATen/SparseCPUCharType.cpp, ../aten/src/ATen/SparseCPUCharType.h, ../aten/src/ATen/SparseCPUDoubleType.cpp, ../aten/src/ATen/SparseCPUDoubleType.h, ../aten/src/ATen/SparseCPUFloatType.cpp, ../aten/src/ATen/SparseCPUFloatType.h, ../aten/src/ATen/SparseCPUIntType.cpp, ../aten/src/ATen/SparseCPUIntType.h, ../aten/src/ATen/SparseCPULongType.cpp, ../aten/src/ATen/SparseCPULongType.h, ../aten/src/ATen/SparseCPUShortType.cpp, ../aten/src/ATen/SparseCPUShortType.h, ../aten/src/ATen/TypeDefault.cpp, ../aten/src/ATen/TypeDefault.h, ../aten/src/ATen/TypeExtendedInterface.h, ../aten/src/ATen/CUDAByteType.cpp, ../aten/src/ATen/CUDAByteType.h, ../aten/src/ATen/CUDACharType.cpp, ../aten/src/ATen/CUDACharType.h, ../aten/src/ATen/CUDACopy.cpp, ../aten/src/ATen/CUDADoubleType.cpp, ../aten/src/ATen/CUDADoubleType.h, ../aten/src/ATen/CUDAFloatType.cpp, ../aten/src/ATen/CUDAFloatType.h, ../aten/src/ATen/CUDAGenerator.h, ../aten/src/ATen/CUDAHalfType.cpp, ../aten/src/ATen/CUDAHalfType.h, ../aten/src/ATen/CUDAIntType.cpp, ../aten/src/ATen/CUDAIntType.h, ../aten/src/ATen/CUDALongType.cpp, ../aten/src/ATen/CUDALongType.h, ../aten/src/ATen/CUDAShortType.cpp, ../aten/src/ATen/CUDAShortType.h, ../aten/src/ATen/RegisterCUDA.cpp, ../aten/src/ATen/RegisterCUDA.h, ../aten/src/ATen/SparseCUDAByteType.cpp, ../aten/src/ATen/SparseCUDAByteType.h, ../aten/src/ATen/SparseCUDACharType.cpp, ../aten/src/ATen/SparseCUDACharType.h, ../aten/src/ATen/SparseCUDADoubleType.cpp, ../aten/src/ATen/SparseCUDADoubleType.h, ../aten/src/ATen/SparseCUDAFloatType.cpp, ../aten/src/ATen/SparseCUDAFloatType.h, ../aten/src/ATen/SparseCUDAIntType.cpp, ../aten/src/ATen/SparseCUDAIntType.h, ../aten/src/ATen/SparseCUDALongType.cpp, ../aten/src/ATen/SparseCUDALongType.h, ../aten/src/ATen/SparseCUDAShortType.cpp, ../aten/src/ATen/SparseCUDAShortType.h
[  8%] Building CXX object third_party/gloo/gloo/CMakeFiles/gloo.dir/transport/tcp/unbound_buffer.cc.o
[  8%] Linking CXX shared library ../lib/libc10.so
[  8%] Built target c10
Scanning dependencies of target mkrename_gnuabi
[  8%] Building C object sleef/src/libm/CMakeFiles/mkrename_gnuabi.dir/mkrename_gnuabi.c.o
[  8%] Linking C executable ../../bin/mkrename_gnuabi
[  8%] Built target mkrename_gnuabi
Scanning dependencies of target mkmasked_gnuabi
[  8%] Building C object sleef/src/libm/CMakeFiles/mkmasked_gnuabi.dir/mkmasked_gnuabi.c.o
[  8%] Linking C executable ../../bin/mkmasked_gnuabi
[  8%] Built target mkmasked_gnuabi
Scanning dependencies of target mkalias
[  8%] Building C object sleef/src/libm/CMakeFiles/mkalias.dir/mkalias.c.o
Scanning dependencies of target arraymap
[  8%] Building C object sleef/src/common/CMakeFiles/arraymap.dir/arraymap.c.o
[  8%] Linking C executable ../../bin/mkalias
[  8%] Built target mkalias
[  8%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/io_win32.cc.o
Scanning dependencies of target torch_shm_manager
[  8%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/once.cc.o
[  8%] Building CXX object caffe2/torch/lib/libshm/CMakeFiles/torch_shm_manager.dir/manager.cpp.o
[  8%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/status.cc.o
[  8%] Built target arraymap
Scanning dependencies of target c10_utils_gpu
[  9%] Building CXX object caffe2/utils/CMakeFiles/c10_utils_gpu.dir/dummy.cpp.o
[  9%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_barrier.cpp.o
[  9%] Built target c10_utils_gpu
Scanning dependencies of target c10_utils_hip
[  9%] Building CXX object caffe2/utils/CMakeFiles/c10_utils_hip.dir/dummy.cpp.o
[  9%] Built target c10_utils_hip
Scanning dependencies of target c10_utils_cpu
[  9%] Building CXX object caffe2/utils/CMakeFiles/c10_utils_cpu.dir/dummy.cpp.o
[  9%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/simple_sum.cpp.o
[  9%] Built target c10_utils_cpu
Scanning dependencies of target cpuinfo
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/init.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/api.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/init.c.o
[  9%] Linking CXX static library ../../../lib/libbenchmark.a
[  9%] Built target benchmark
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/info.c.o
Scanning dependencies of target nnpack_reference_layers
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/convolution-output.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/vendor.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/uarch.c.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/convolution-input-gradient.c.o
[  9%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ncsp_batch_normalization.cpp.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/name.c.o
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/convolution-kernel.c.o
[  9%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/statusor.cc.o
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/fully-connected-output.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/topology.c.o
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/max-pooling-output.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/isa.c.o
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/softmax-output.c.o
[  9%] Built target ATEN_CPU_FILES_GEN_TARGET
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/relu-output.c.o
[  9%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_inner_product.cpp.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/cache/descriptor.c.o
[  9%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack_reference_layers.dir/src/ref/relu-input-gradient.c.o
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/cache/init.c.o
[  9%] Linking C static library ../../lib/libnnpack_reference_layers.a
[  9%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/cache/deterministic.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/linux/init.c.o
[ 10%] Built target nnpack_reference_layers
Scanning dependencies of target gtest_main
[ 10%] Building CXX object third_party/googletest/googletest/CMakeFiles/gtest_main.dir/src/gtest_main.cc.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/x86/linux/cpuinfo.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/linux/smallfile.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/linux/multiline.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/linux/current.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/linux/cpulist.c.o
[ 10%] Building C object confu-deps/cpuinfo/CMakeFiles/cpuinfo.dir/src/linux/processors.c.o
Scanning dependencies of target benchmark_main
[ 10%] Building CXX object third_party/benchmark/src/CMakeFiles/benchmark_main.dir/benchmark_main.cc.o
[ 10%] Linking C static library ../../lib/libcpuinfo.a
[ 10%] Built target cpuinfo
Scanning dependencies of target onnxifi_wrapper
[ 10%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/stringpiece.cc.o
[ 10%] Building C object third_party/onnx/CMakeFiles/onnxifi_wrapper.dir/onnx/onnxifi_wrapper.c.o
[ 10%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/simple_concat.cpp.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 10%] Linking CXX executable ../../../../bin/torch_shm_manager
[ 10%] Linking C shared module ../../lib/libonnxifi.so
[ 10%] Built target onnxifi_wrapper
Scanning dependencies of target __aten_op_header_gen
[ 10%] Generating contrib/aten/aten_op.h
[ 10%] Built target torch_shm_manager
Scanning dependencies of target renameAVX.h_generated
[ 10%] Generating include/renameavx.h
Generating renameavx.h: mkrename 4 8 avx
[ 10%] Built target renameAVX.h_generated
[ 11%] Linking CXX static library ../../../lib/libgloo.a
Scanning dependencies of target renamedsp128.h_generated
[ 11%] Generating renamedsp128.h
[ 11%] Built target renamedsp128.h_generated
Scanning dependencies of target headers
[ 12%] Generating ../../../include/sleef.h
[ 12%] Built target gloo
Scanning dependencies of target dispsse.c_generated
[ 12%] Generating dispsse.c
Generating sleef.h: mkrename 2 4 __m128d __m128 __m128i __m128i __SSE2__
Generating sleef.h: mkrename 2 4 __m128d __m128 __m128i __m128i __SSE2__ sse2
Generating sleef.h: mkrename 2 4 __m128d __m128 __m128i __m128i __SSE2__ sse4
Generating sleef.h: mkrename 4 8 __m256d __m256 __m128i struct\ {\ __m128i\ x,\ y;\ } __AVX__
Generating sleef.h: mkrename 4 8 __m256d __m256 __m128i struct\ {\ __m128i\ x,\ y;\ } __AVX__ avx
Generating sleef.h: mkrename 4 8 __m256d __m256 __m128i struct\ {\ __m128i\ x,\ y;\ } __AVX__ fma4
Generating sleef.h: mkrename 4 8 __m256d __m256 __m128i __m256i __AVX__ avx2
Generating sleef.h: mkrename 2 4 __m128d __m128 __m128i __m128i __SSE2__ avx2128
Generating sleef.h: mkrename 8 16 __m512d __m512 __m256i __m512i __AVX512F__
Generating sleef.h: mkrename 8 16 __m512d __m512 __m256i __m512i __AVX512F__ avx512f
[ 12%] Built target dispsse.c_generated
[ 12%] Built target headers
Scanning dependencies of target sleefsse2
Scanning dependencies of target sleeffma4
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefsse2.dir/sleefsimdsp.c.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleeffma4.dir/sleefsimdsp.c.o
Compiling  misc/group.cu                       > /home/feng/pytorch/build/nccl/obj/misc/group.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 12%] Linking CXX static library ../../../lib/libbenchmark_main.a
[ 12%] Linking CXX static library ../../../lib/libgtest_main.a
[ 12%] Built target benchmark_main
Scanning dependencies of target sleefavx2
[ 12%] Built target gtest_main
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefavx2.dir/sleefsimdsp.c.o
Scanning dependencies of target sleefavx2128
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefavx2128.dir/sleefsimdsp.c.o
[ 12%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/stringprintf.cc.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleeffma4.dir/sleefsimddp.c.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefavx2128.dir/sleefsimddp.c.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefavx2.dir/sleefsimddp.c.o
[ 12%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/structurally_valid.cc.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefsse2.dir/sleefsimddp.c.o
[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_u8s8s32x_conv_kernel.cpp.o
[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/gemm_convolution.cpp.o
[ 12%] Built target sleeffma4
Scanning dependencies of target sleefsse4
[ 12%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/strutil.cc.o
[ 12%] Built target sleefavx2128
Scanning dependencies of target c10_utils_gpu_test
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefsse4.dir/sleefsimdsp.c.o
[ 12%] Linking CXX executable ../../bin/c10_utils_gpu_test
[ 12%] Built target sleefavx2
Scanning dependencies of target c10_utils_hip_test
[ 12%] Building CXX object caffe2/utils/CMakeFiles/c10_utils_hip_test.dir/dummy.cpp.o
[ 12%] Linking CXX executable ../../bin/c10_utils_hip_test
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 12%] Built target c10_utils_gpu_test
Scanning dependencies of target c10_utils_cpu_test
[ 12%] Linking CXX executable ../../bin/c10_utils_cpu_test
[ 12%] Built target c10_utils_hip_test
Scanning dependencies of target qnnpack
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefsse4.dir/sleefsimddp.c.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/init.c.o
[ 12%] Built target c10_utils_cpu_test
[ 12%] Generating src/x86_64-fma/2d-fourier-8x8.py.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/convolution.c.o
[ 12%] Built target sleefsse2
Scanning dependencies of target c10_registry_test
[ 12%] Building CXX object c10/test/CMakeFiles/c10_registry_test.dir/registry_test.cpp.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/deconvolution.c.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/fully-connected.c.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/sgemm/6x8-psimd.c.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/q8gemm/2x4c8-sse2.c.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/q8gemm/4x4c2-sse2.c.o
[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_pool_kernel_f32.cpp.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/q8conv/4x4c2-sse2.c.o
[ 12%] Built target sleefsse4
Compiling  misc/nvmlwrap.cu                    > /home/feng/pytorch/build/nccl/obj/misc/nvmlwrap.o
Scanning dependencies of target c10_OpSchema_test
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 12%] Building CXX object c10/test/CMakeFiles/c10_OpSchema_test.dir/dispatch/OpSchema_test.cpp.o
[ 12%] Building C object confu-deps/QNNPACK/CMakeFiles/qnnpack.dir/src/q8dw/9c8-sse2.c.o
[ 12%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/time.cc.o
[ 12%] Linking C static library ../../lib/libqnnpack.a
[ 13%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/wire_format_lite.cc.o
[ 13%] Built target qnnpack
Scanning dependencies of target c10_InlineStreamGuard_test
[ 13%] Building CXX object c10/test/CMakeFiles/c10_InlineStreamGuard_test.dir/impl/InlineStreamGuard_test.cpp.o
[ 13%] Linking CXX executable ../../bin/c10_OpSchema_test
[ 13%] Built target c10_OpSchema_test
Scanning dependencies of target c10_StreamGuard_test
[ 13%] Building CXX object c10/test/CMakeFiles/c10_StreamGuard_test.dir/StreamGuard_test.cpp.o
[ 13%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/gemm_u8s8s32x_convolution.cpp.o
[ 13%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/any.cc.o
[ 13%] Linking CXX executable ../../bin/c10_registry_test
[ 13%] Built target c10_registry_test
Scanning dependencies of target c10_DeviceGuard_test
[ 13%] Linking CXX executable ../../bin/c10_StreamGuard_test
[ 13%] Building CXX object c10/test/CMakeFiles/c10_DeviceGuard_test.dir/DeviceGuard_test.cpp.o
[ 13%] Built target c10_StreamGuard_test
Scanning dependencies of target c10_TypeTraits_test
[ 13%] Building CXX object c10/test/CMakeFiles/c10_TypeTraits_test.dir/util/TypeTraits_test.cpp.o
[ 13%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/any.pb.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 13%] Generating src/x86_64-fma/2d-fourier-16x16.py.o
[ 13%] Built target ATEN_CUDA_FILES_GEN_TARGET
Scanning dependencies of target c10_Metaprogramming_test
[ 13%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/api.pb.cc.o
[ 13%] Building CXX object c10/test/CMakeFiles/c10_Metaprogramming_test.dir/util/Metaprogramming_test.cpp.o
[ 13%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_u8s8s32x_1x1_convolution.cpp.o
[ 13%] Linking CXX executable ../../bin/c10_TypeTraits_test
[ 13%] Built target c10_TypeTraits_test
Scanning dependencies of target c10_logging_test
[ 13%] Building CXX object c10/test/CMakeFiles/c10_logging_test.dir/logging_test.cpp.o
[ 13%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/compiler/importer.cc.o
[ 13%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx2_gemm_f32.cpp.o
[ 14%] Linking CXX executable ../../bin/c10_InlineStreamGuard_test
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 14%] Built target c10_InlineStreamGuard_test
Scanning dependencies of target c10_Array_test
[ 14%] Building CXX object c10/test/CMakeFiles/c10_Array_test.dir/util/Array_test.cpp.o
[ 14%] Linking CXX executable ../../bin/c10_DeviceGuard_test
Compiling  misc/ibvwrap.cu                     > /home/feng/pytorch/build/nccl/obj/misc/ibvwrap.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 14%] Built target c10_DeviceGuard_test
Scanning dependencies of target c10_InlineDeviceGuard_test
[ 14%] Building CXX object c10/test/CMakeFiles/c10_InlineDeviceGuard_test.dir/impl/InlineDeviceGuard_test.cpp.o
[ 14%] Linking CXX executable ../../bin/c10_Metaprogramming_test
[ 14%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/compiler/parser.cc.o
[ 14%] Built target c10_Metaprogramming_test
Scanning dependencies of target c10_typeid_test
[ 14%] Linking CXX executable ../../bin/c10_Array_test
[ 14%] Building CXX object c10/test/CMakeFiles/c10_typeid_test.dir/util/typeid_test.cpp.o
[ 14%] Built target c10_Array_test
Scanning dependencies of target c10_flags_test
[ 14%] Building CXX object c10/test/CMakeFiles/c10_flags_test.dir/flags_test.cpp.o
[ 14%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_pooling.cpp.o
[ 14%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/descriptor.cc.o
[ 14%] Linking CXX executable ../../bin/c10_logging_test
[ 14%] Built target c10_logging_test
Scanning dependencies of target c10_TypeList_test
Skipping _th_multinomial Because of Arg: Generator * (Generator*) 
Skipping _th_normal Because of Arg: Generator * (Generator*) 
Skipping _th_normal Because of Arg: Generator * (Generator*) 
Skipping _th_normal Because of Arg: Generator * (Generator*) 
Skipping _th_tensor Because of Arg: Storage (Storage) 
Skipping _th_tensor Because of Arg: Storage (Storage) 
Skipping rrelu_with_noise Because of Arg: Generator * (Generator*) 
Skipping rrelu_with_noise_forward Because of Arg: Generator * (Generator*) 
[ 14%] Building CXX object c10/test/CMakeFiles/c10_TypeList_test.dir/util/TypeList_test.cpp.o
Skipping thnn_conv_transpose2d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping thnn_conv_transpose3d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping thnn_conv2d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping thnn_conv_depthwise2d_backward Because of Arg: std::array<bool,2> (std::array<bool,2>) 
Skipping thnn_conv3d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping thnn_conv_dilated2d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping thnn_conv_dilated3d_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping _cudnn_rnn_backward Because of Arg: std::array<bool,4> (std::array<bool,4>) 
Skipping _cudnn_init_dropout_state because it is a factory method
Skipping _fused_dropout Because of Arg: Generator * (Generator *) 
Skipping arange because it is a factory method
Skipping bartlett_window because it is a factory method
Skipping bernoulli Because of Arg: Generator * (Generator *) 
Skipping bernoulli Because of Arg: Generator * (Generator *) 
Skipping blackman_window because it is a factory method
Skipping clamp Because of Arg: c10::optional<Scalar> (Scalar) 
Skipping clamp Because of Arg: c10::optional<Scalar> (Scalar) 
Skipping _convolution_double_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping cudnn_convolution_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping cudnn_convolution_transpose_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping cumsum Because of Arg: ScalarType (ScalarType) 
Skipping cumprod Because of Arg: ScalarType (ScalarType) 
Skipping einsum Because of Arg: std::string (std::string) 
Skipping empty because it is a factory method
Skipping empty_like because it is a factory method
Skipping empty_strided because it is a factory method
Skipping eye because it is a factory method
Skipping full because it is a factory method
Skipping full_like because it is a factory method
Skipping hann_window because it is a factory method
Skipping hamming_window because it is a factory method
Skipping _cufft_set_plan_cache_max_size Because of Ret: void (void)
Skipping _cufft_clear_plan_cache Because of Ret: void (void)
Skipping linspace because it is a factory method
Skipping logspace because it is a factory method
Skipping log_softmax Because of Arg: ScalarType (ScalarType) 
Skipping mean Because of Arg: ScalarType (ScalarType) 
Skipping mean Because of Arg: ScalarType (ScalarType) 
Skipping mean Because of Arg: ScalarType (ScalarType) 
Skipping mkldnn_convolution_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping miopen_convolution_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping miopen_convolution_transpose_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping native_batch_norm_backward Because of Arg: std::array<bool,3> (std::array<bool,3>) 
Skipping ones because it is a factory method
Skipping ones_like because it is a factory method
Skipping rand because it is a factory method
Skipping rand_like because it is a factory method
Skipping randint because it is a factory method
Skipping randint_like because it is a factory method
Skipping randn because it is a factory method
Skipping randn_like because it is a factory method
Skipping randperm because it is a factory method
Skipping range because it is a factory method
Skipping rrelu Because of Arg: Generator * (Generator *) 
Skipping softmax Because of Arg: ScalarType (ScalarType) 
Skipping sum Because of Arg: ScalarType (ScalarType) 
Skipping sum Because of Arg: ScalarType (ScalarType) 
Skipping sum Because of Arg: ScalarType (ScalarType) 
Skipping prod Because of Arg: ScalarType (ScalarType) 
Skipping prod Because of Arg: ScalarType (ScalarType) 
Skipping prod Because of Arg: ScalarType (ScalarType) 
Skipping zeros because it is a factory method
Skipping zeros_like because it is a factory method
Skipping _standard_gamma Because of Arg: Generator * (Generator *) 
Skipping poisson Because of Arg: Generator * (Generator *) 
Skipping sparse_coo_tensor because it is a factory method
Skipping _sparse_coo_tensor_unsafe because it is a factory method
Skipping _sparse_coo_tensor_with_dims because it is a factory method
Skipping _sparse_coo_tensor_with_dims_and_tensors because it is a factory method
Skipping sparse_mask Because of Arg: SparseTensorRef (SparseTensorRef) 
Skipping to because it is a factory method
Skipping data_ptr Because of Ret: void* (void*)
Skipping multinomial Because of Arg: Generator * (Generator *) 
Skipping normal Because of Arg: Generator * (Generator *) 
Skipping normal Because of Arg: Generator * (Generator *) 
Skipping normal Because of Arg: Generator * (Generator *) 
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 14%] Built target __aten_op_header_gen
Scanning dependencies of target sleefavx
[ 14%] Building C object sleef/src/libm/CMakeFiles/sleefavx.dir/sleefsimdsp.c.o
[ 14%] Linking CXX executable ../../bin/c10_InlineDeviceGuard_test
[ 14%] Linking CXX executable ../../bin/c10_flags_test
[ 14%] Built target c10_flags_test
[ 14%] Built target c10_InlineDeviceGuard_test
Scanning dependencies of target dispsse_obj
Scanning dependencies of target dispavx_obj
[ 14%] Building C object sleef/src/libm/CMakeFiles/dispsse_obj.dir/dispsse.c.o
[ 14%] Building C object sleef/src/libm/CMakeFiles/dispavx_obj.dir/dispavx.c.o
[ 14%] Linking CXX executable ../../bin/c10_TypeList_test
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 14%] Built target c10_TypeList_test
[ 15%] Building C object sleef/src/libm/CMakeFiles/sleefavx.dir/sleefsimddp.c.o
[ 15%] Linking CXX executable ../../bin/c10_typeid_test
[ 15%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_lrn_kernel_f32.cpp.o
[ 15%] Built target c10_typeid_test
Compiling  misc/rings.cu                       > /home/feng/pytorch/build/nccl/obj/misc/rings.o
[ 15%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_concat.cpp.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 15%] Built target dispsse_obj
[ 15%] Built target dispavx_obj
[ 15%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_u8s8s32x_convolution.cpp.o
[ 15%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/descriptor.pb.cc.o
[ 15%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/descriptor_database.cc.o
[ 15%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_i8i8_pooling.cpp.o
[ 15%] Built target sleefavx
Scanning dependencies of target sleef
[ 15%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefdp.c.o
[ 15%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/nchw_pooling.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_reducer.cpp.o
[ 16%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefsp.c.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_gemm_f32.cpp.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/duration.pb.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_dw_conv_kernel_f32.cpp.o
Compiling  misc/utils.cu                       > /home/feng/pytorch/build/nccl/obj/misc/utils.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_reorder.cpp.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_engine.cpp.o
[ 16%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefld.c.o
[ 16%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefqp.c.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/dynamic_message.cc.o
[ 16%] Linking C static library ../../lib/libsleef.a
[ 16%] Built target sleef
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/empty.pb.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_convolution_winograd.cpp.o
Compiling  misc/enqueue.cu                     > /home/feng/pytorch/build/nccl/obj/misc/enqueue.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/extension_set_heavy.cc.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_lrn.cpp.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/field_mask.pb.cc.o
[ 16%] Generating src/x86_64-fma/2d-winograd-8x8-3x3.py.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/generated_message_reflection.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/generated_message_table_driven.cc.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/gzip_stream.cc.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_sse42_convolution.cpp.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/printer.cc.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_convolution_winograd.cpp.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/strtod.cc.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx2_1x1_convolution.cpp.o
[ 16%] Generating src/x86_64-fma/blas/s8gemm.py.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/tokenizer.cc.o
Compiling  transport/p2p.cu                    > /home/feng/pytorch/build/nccl/obj/transport/p2p.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 16%] Generating src/x86_64-fma/blas/c8gemm.py.o
[ 16%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_eltwise.cpp.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/io/zero_copy_stream_impl.cc.o
[ 16%] Generating src/x86_64-fma/blas/s4c6gemm.py.o
[ 16%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/map_field.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/message.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/reflection_ops.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/service.cc.o
[ 17%] Generating src/x86_64-fma/blas/conv1x1.py.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_pooling.cpp.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx2_conv_kernel_f32.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 17%] Generating src/x86_64-fma/blas/sgemm.py.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/source_context.pb.cc.o
[ 17%] Generating src/x86_64-fma/max-pooling.py.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/struct.pb.cc.o
[ 17%] Generating src/x86_64-fma/relu.py.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_dw_convolution.cpp.o
[ 17%] Generating src/x86_64-fma/softmax.py.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/mathlimits.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/stubs/substitute.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/text_format.cc.o
Compiling  transport/shm.cu                    > /home/feng/pytorch/build/nccl/obj/transport/shm.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/timestamp.pb.cc.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_batch_normalization.cpp.o
[ 17%] Generating src/x86_64-fma/blas/sdotxf.py.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_inner_product.cpp.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/type.pb.cc.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_reorder_utils.cpp.o
[ 17%] Generating src/x86_64-fma/blas/shdotxf.py.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/unknown_field_set.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/delimited_message_util.cc.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_u8s8s32x_1x1_conv_kernel.cpp.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/field_comparator.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/field_mask_util.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/datapiece.cc.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_batch_normalization.cpp.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/default_value_objectwriter.cc.o
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_sse42_1x1_convolution.cpp.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/error_listener.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/field_mask_utility.cc.o
Compiling  transport/net.cu                    > /home/feng/pytorch/build/nccl/obj/transport/net.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 17%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_u8s8s32x_wino_convolution.cpp.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/json_escaping.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/json_objectwriter.cc.o
[ 17%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/json_stream_parser.cc.o
[ 18%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/object_writer.cc.o
[ 19%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx2_convolution.cpp.o
[ 19%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_1x1_convolution.cpp.o
Scanning dependencies of target nnpack
[ 19%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/proto_writer.cc.o
[ 19%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/init.c.o
[ 19%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/convolution-inference.c.o
[ 19%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/protostream_objectsource.cc.o
[ 19%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/fully-connected-inference.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/pooling-output.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/relu-output.c.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/protostream_objectwriter.cc.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/type_info.cc.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/softmax-output.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/fully-connected-output.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/relu-input-gradient.c.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/convolution-input-gradient.c.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/type_info_test_helper.cc.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/convolution-kernel-gradient.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/convolution-output.c.o
[ 20%] Building C object confu-deps/NNPACK/CMakeFiles/nnpack.dir/src/x86_64-fma/softmax.c.o
[ 20%] Linking C static library ../../lib/libnnpack.a
[ 20%] Built target nnpack
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/internal/utility.cc.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/cpu_reorder.cpp.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/json_util.cc.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/message_differencer.cc.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/time_util.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/util/type_resolver_util.cc.o
Compiling  transport/net_socket.cu             > /home/feng/pytorch/build/nccl/obj/transport/net_socket.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/wire_format.cc.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/wrappers.pb.cc.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx2_1x1_conv_kernel_f32.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_common_conv_kernel.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/gemm_convolution_utils.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_uni_lrn.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_softmax.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_transpose_src_utils.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_rnn.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_eltwise.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/ref_convolution.cpp.o
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/nspc_batch_normalization.cpp.o
[ 20%] Linking CXX static library ../../../lib/libprotobuf.a
[ 20%] Built target libprotobuf
[ 20%] Generating ../../../../third_party/protobuf/src/google/protobuf/compiler/js/well_known_types_embed.cc
Scanning dependencies of target libprotoc
[ 20%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/cpu/jit_avx512_core_conv_winograd_kernel_f32.cpp.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/code_generator.cc.o
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/command_line_interface.cc.o
Compiling  transport/net_ib.cu                 > /home/feng/pytorch/build/nccl/obj/transport/net_ib.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 20%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_enum.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_enum_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_extension.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_file.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_generator.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_helpers.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_map_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_message.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_message_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_padding_optimizer.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_primitive_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_service.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/cpp/cpp_string_field.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_doc_comment.cc.o
Compiling  collectives/all_reduce.cu           > /home/feng/pytorch/build/nccl/obj/collectives/all_reduce.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_enum.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_enum_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_field_base.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_generator.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_helpers.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_map_field.cc.o
[ 21%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_message.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_message_field.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_primitive_field.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_reflection_class.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_repeated_enum_field.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_repeated_message_field.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_repeated_primitive_field.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_source_generator_base.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/csharp/csharp_wrapper_field.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_context.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_doc_comment.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_enum.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_enum_field.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_enum_field_lite.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_enum_lite.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_extension.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_extension_lite.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_field.cc.o
Compiling  collectives/all_gather.cu           > /home/feng/pytorch/build/nccl/obj/collectives/all_gather.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_file.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_generator.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_generator_factory.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_helpers.cc.o
[ 22%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_lazy_message_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_lazy_message_field_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_map_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_map_field_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message_builder.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message_builder_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message_field.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message_field_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_message_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_name_resolver.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_primitive_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_primitive_field_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_service.cc.o
Compiling  collectives/broadcast.cu            > /home/feng/pytorch/build/nccl/obj/collectives/broadcast.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_shared_code_generator.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_string_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/java/java_string_field_lite.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_enum.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_enum_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_extension.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_field.cc.o
[ 23%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_file.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_generator.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_helpers.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_map_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_message.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_message_field.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/javanano/javanano_primitive_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/js/js_generator.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/js/well_known_types_embed.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_enum.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_enum_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_extension.cc.o
Compiling  collectives/reduce.cu               > /home/feng/pytorch/build/nccl/obj/collectives/reduce.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_file.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_generator.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_helpers.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_map_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_message.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_message_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_oneof.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/objectivec/objectivec_primitive_field.cc.o
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/php/php_generator.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 24%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/plugin.cc.o
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/plugin.pb.cc.o
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/python/python_generator.cc.o
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/ruby/ruby_generator.cc.o
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/subprocess.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotoc.dir/__/src/google/protobuf/compiler/zip_writer.cc.o
Compiling  collectives/reduce_scatter.cu       > /home/feng/pytorch/build/nccl/obj/collectives/reduce_scatter.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 25%] Linking CXX shared library ../../../../lib/libmkldnn.so
[ 25%] Built target mkldnn
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 25%] Linking CXX static library ../../../lib/libprotoc.a
[ 25%] Built target libprotoc
Scanning dependencies of target protoc
[ 25%] Building CXX object third_party/protobuf/cmake/CMakeFiles/protoc.dir/__/src/google/protobuf/compiler/main.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 25%] Linking CXX executable ../../../bin/protoc
[ 25%] Built target protoc
Scanning dependencies of target gen_onnx_proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/prof_dag.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/predictor_consts.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/torch.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/caffe2.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/hsm.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/metanet.proto
[ 25%] Running C++/Python protocol buffer compiler on /home/feng/pytorch/caffe2/proto/caffe2_legacy.proto
[ 25%] Running gen_proto.py on onnx/onnx.in.proto
Processing /home/feng/pytorch/third_party/onnx/onnx/onnx.in.proto
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto
Compiling  all_reduce.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_reduce_sum.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto3
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx.pb.h
generating /home/feng/pytorch/build/third_party/onnx/onnx/onnx_pb.py
[ 25%] Running C++ protocol buffer compiler on /home/feng/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto
Scanning dependencies of target Caffe2_PROTO
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/caffe2_legacy.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/caffe2.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/predictor_consts.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/prof_dag.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/hsm.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/metanet.pb.cc.o
[ 25%] Building CXX object caffe2/proto/CMakeFiles/Caffe2_PROTO.dir/torch.pb.cc.o
[ 25%] Built target gen_onnx_proto
[ 25%] Running gen_proto.py on onnx/onnx-operators.in.proto
Processing /home/feng/pytorch/third_party/onnx/onnx/onnx-operators.in.proto
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto3
Writing /home/feng/pytorch/build/third_party/onnx/onnx/onnx-operators.pb.h
generating /home/feng/pytorch/build/third_party/onnx/onnx/onnx_operators_pb.py
[ 25%] Running C++ protocol buffer compiler on /home/feng/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto
Scanning dependencies of target onnx_proto
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx_proto.dir/onnx/onnx_onnx_torch.pb.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx_proto.dir/onnx/onnx-operators_onnx_torch.pb.cc.o
[ 26%] Linking CXX static library ../../lib/libonnx_proto.a
[ 26%] Built target onnx_proto
Scanning dependencies of target onnx
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/version_converter/convert.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/function.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/controlflow/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/data_type_utils.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/version_converter/helper.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/__/__/caffe2/onnx/torch_ops/schema.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/nn/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/__/__/caffe2/onnx/torch_ops/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/nn/old.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/logical/defs.cc.o
[ 26%] Built target Caffe2_PROTO
Scanning dependencies of target Caffe2_perfkernels_avx2
[ 26%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx2.dir/embedding_lookup_avx2.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/logical/old.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/reduction/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/generator/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/generator/old.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/tensor/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/tensor/old.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/schema.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/traditionalml/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/math/defs.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/math/old.cc.o
[ 26%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/rnn/defs.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/rnn/old.cc.o
[ 27%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx2.dir/math_cpu_avx2.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/experiments/defs.cc.o
[ 27%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx2.dir/common_avx2.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/defs/experiments/experiments_functions.cc.o
[ 27%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx2.dir/typed_axpy_avx2.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/onnxifi_utils.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/common/ir_pb_converter.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/common/status.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/common/assertions.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/common/model_helpers.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/common/interned_strings.cc.o
[ 27%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx2.dir/embedding_lookup_fused_8bit_rowwise_avx2.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/checker.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/shape_inference/implementation.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/optimizer/pass_registry.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/optimizer/optimize.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/optimizer/pass_manager.cc.o
[ 27%] Building CXX object third_party/onnx/CMakeFiles/onnx.dir/onnx/optimizer/pass.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
Scanning dependencies of target caffe2_protos
[ 27%] Linking CXX static library ../lib/libcaffe2_protos.a
[ 27%] Built target caffe2_protos
Scanning dependencies of target Caffe2_perfkernels_avx
[ 27%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx.dir/adagrad_avx.cc.o
[ 28%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx.dir/typed_axpy_avx.cc.o
[ 28%] Building CXX object caffe2/perfkernels/CMakeFiles/Caffe2_perfkernels_avx.dir/common_avx.cc.o
[ 28%] Built target Caffe2_perfkernels_avx
[ 28%] Built target Caffe2_perfkernels_avx2
[ 28%] Linking CXX static library ../../lib/libonnx.a
[ 28%] Built target onnx
Scanning dependencies of target caffe2
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
Compiling  broadcast.cu                        > /home/feng/pytorch/build/nccl/obj/collectives/device/broadcast_sum.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
ptxas warning : Too big maxrregcount value specified 96, will be ignored
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
Compiling  reduce.cu                           > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_sum.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 28%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/DLConvertor.cpp.o
[ 28%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/TensorUtils.cpp.o
[ 28%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUGenerator.cpp.o
[ 28%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/TensorGeometry.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/UndefinedType.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/Utils.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/Context.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUGeneral.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUTypeDefault.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseTensorImpl.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/ExpandUtils.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/detail/ComplexHooksInterface.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/detail/CPUGuardImpl.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/detail/CUDAHooksInterface.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/cpu/FlushDenormal.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Storage.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/context_base.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/thread_pool.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/ATenCoreTest.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/StorageImpl.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Formatting.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/LegacyTypeDispatch.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/register_symbols.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/VariableHooksInterface.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Tensor.cpp.o
[ 29%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/interned_strings.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/TensorOptions.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Range.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/ivalue.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Allocator.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/ATenGeneral.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/UndefinedTensorImpl.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/Scalar.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/blob.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/intrusive_ptr.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/TensorImpl.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/UniqueVoidPtr.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/type.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/core/OptionsGuard.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Embedding.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/SoftMax.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/DispatchStub.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Dropout.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorCompare.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/LinearAlgebra.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/GridSampler.cpp.o
[ 30%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/ReduceOps.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/UnaryOps.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Linear.cpp.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Indexing.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/PixelShuffle.cpp.o
Compiling  all_gather.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_gather_sum.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorIterator.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/LegacyBridge.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TypeProperties.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Copy.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Loss.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/EmbeddingBag.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Normalization.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/WeightNorm.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Resize.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Convolution.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/RoiPooling.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/PackedSequence.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/LegacyDefinitions.cpp.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Distance.cpp.o
Compiling  reduce_scatter.cu                   > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_scatter_sum.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorFactories.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/ConvolutionTBC.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/SummaryOps.cpp.o
[ 31%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorTransformations.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Unique.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorIteratorReduce.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Pooling.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Distributions.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/SpectralOps.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Memory.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorProperties.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Scalar.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorShape.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/BinaryOps.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/Activation.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/LossCTC.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/RNN.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/ConstantPadNd.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/TensorConversions.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/BatchLinearAlgebra.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/sparse/SparseTensorMath.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/sparse/SparseTensor.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/SpectralOps.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkldnn/Conv.cpp.o
[ 32%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUByteType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUCharType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUCopy.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUDoubleType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUFloatType.cpp.o
Compiling  all_reduce.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_reduce_prod.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUHalfType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUIntType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPULongType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUShortType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/RegisterCPU.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUByteType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUCharType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUDoubleType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUFloatType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUIntType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPULongType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/SparseCPUShortType.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/TypeDefault.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THGeneral.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THAllocator.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THSize.cpp.o
[ 33%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THStorageFunctions.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensor.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorCopy.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorRandom.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorMath.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorMoreMath.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorEvenMoreMath.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorConv.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THTensorLapack.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THBlas.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THLapack.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THLogAdd.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THRandom.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THFile.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THDiskFile.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THMemoryFile.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/THVector.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/vector/AVX.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/TH/vector/AVX2.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/THNN/init.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/UnaryOpsKernel.cpp.AVX2.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/Activation.cpp.AVX2.cpp.o
[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/SoftMaxKernel.cpp.AVX2.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/GridSamplerKernel.cpp.AVX2.cpp.o
Compiling  broadcast.cu                        > /home/feng/pytorch/build/nccl/obj/collectives/device/broadcast_prod.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/ReduceOpsKernel.cpp.AVX2.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/BinaryOpsKernel.cpp.AVX2.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
Compiling  reduce.cu                           > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_prod.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/DistanceOpsKernel.cpp.AVX2.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/TensorCompareKernel.cpp.AVX2.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/UnaryOpsKernel.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/Activation.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/SoftMaxKernel.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/GridSamplerKernel.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/ReduceOpsKernel.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/BinaryOpsKernel.cpp.AVX.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/DistanceOpsKernel.cpp.AVX.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/TensorCompareKernel.cpp.AVX.cpp.o
Compiling  all_gather.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_gather_prod.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/UnaryOpsKernel.cpp.DEFAULT.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/Activation.cpp.DEFAULT.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/SoftMaxKernel.cpp.DEFAULT.cpp.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/GridSamplerKernel.cpp.DEFAULT.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/ReduceOpsKernel.cpp.DEFAULT.cpp.o
Compiling  reduce_scatter.cu                   > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_scatter_prod.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/BinaryOpsKernel.cpp.DEFAULT.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/DistanceOpsKernel.cpp.DEFAULT.cpp.o
[ 35%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/cpu/TensorCompareKernel.cpp.DEFAULT.cpp.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/mkldnn/Runtime.cpp.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/aten/aten_op.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/allgather_ops.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/allreduce_ops.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/barrier_ops.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/broadcast_ops.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/common.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/common_world_ops.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/context.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/reduce_scatter_ops.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/gloo/store_handler.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/script/lexer.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/script/compiler.cc.o
Compiling  all_reduce.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_reduce_min.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/init_intrinsics_check.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/module.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_dag_utils.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/event.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/graph.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/plan_executor.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/int8_serialization.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/tensor_int8.cc.o
[ 36%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/context.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/prof_dag_counters.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/blob_stats.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/qtensor.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_simple.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/memonger.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/transform.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/operator_c10wrapper.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/context_base.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/common.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/blob_serialization.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_async_tracing.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/workspace.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/tensor_impl.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/init_omp.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/operator.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/init.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/operator_schema.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/tensor.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_async_base.cc.o
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_simple_refcount.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 37%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/stats.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/types.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/allocator.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_dag.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/numa.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/net_async_scheduling.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/qtensor_serialization.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/db.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/proto_convert.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/proto_wrap.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/proto_utils.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/murmur_hash3.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/smart_tensor_printer.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/signal_handler.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/string_utils.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/threadpool/ThreadPool.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/cpuid.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/bench_utils.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/math_cpu.cc.o
Compiling  broadcast.cu                        > /home/feng/pytorch/build/nccl/obj/collectives/device/broadcast_min.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/math_utils.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/thread_name.cc.o
[ 38%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/threadpool/pthreadpool.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/utils/threadpool/pthreadpool_impl.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/predictor/predictor.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/predictor/predictor_utils.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/predictor/predictor_config.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/nomnigraph/tests/test_util.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/core/nomnigraph/Representations/NeuralNet.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/db/create_db_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/db/protodb.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/distributed/file_store_handler.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
Compiling  reduce.cu                           > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_min.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/distributed/file_store_handler_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/distributed/store_handler.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/distributed/store_ops.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/utils/ideep_register.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/dropout_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/pool_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/momentum_sgd_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/local_response_normalization_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/relu_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/elementwise_sum_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/squeeze_op.cc.o
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/utility_ops.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 39%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/conv_fusion_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/operator_fallback_ideep.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/concat_split_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/spatial_batch_norm_op.cc.o
Compiling  all_gather.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_gather_min.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/fully_connected_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/ideep/operators/conv_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/mpi/mpi_common.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
Compiling  reduce_scatter.cu                   > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_scatter_min.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/mpi/mpi_ops.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/observers/time_observer.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/observers/runcnt_observer.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/backend.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/onnx_exporter.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/backend_rep.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/helper.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/onnxifi_init.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/onnx/device.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lpnorm_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/gru_unit_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sparse_normalize_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/while_op.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/unique_ops.cc.o
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/feed_blob_op.cc.o
Compiling  all_reduce.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_reduce_max.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 40%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/index_ops.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/clip_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_div_gradient_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/glu_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reservoir_sampling.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/dropout_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/resize_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/roi_align_rotated_gradient_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tensor_protos_db_input.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sparse_to_dense_mask_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pool_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/relu_n_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/instance_norm_gradient_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reciprocal_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/leaky_relu_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/distance_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ensure_cpu_output_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/locally_connected_op_util.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/partition_ops.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/selu_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/do_op.cc.o
[ 41%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_reducer_fused_8bit_rowwise_ops.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/free_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_top_k_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_bucketize_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/heatmap_max_keypoint_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/filler_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/softsign_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_op_shared.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/enforce_finite_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/local_response_normalization_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/moments_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sparse_to_dense_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/data_couple.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tt_linear_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/arg_ops.cc.o
Compiling  broadcast.cu                        > /home/feng/pytorch/build/nccl/obj/collectives/device/broadcast_max.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/assert_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
Compiling  reduce.cu                           > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_max.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/feature_maps_ops.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/if_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/acos_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/relu_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/accumulate_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/spatial_softmax_with_loss_op.cc.o
[ 42%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/listwise_l2r_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sigmoid_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cast_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/integral_image_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/flexible_top_k.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_sub_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sequence_ops.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/remove_data_blocks_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/h_softmax_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/expand_squeeze_dims_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/slice_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reduce_front_back_max_ops.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_gradient_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/stats_put_ops.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/bbox_transform_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/collect_and_distribute_fpn_rpn_proposals_op.cc.o
Compiling  all_gather.cu                       > /home/feng/pytorch/build/nccl/obj/collectives/device/all_gather_max.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reshape_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/prepend_dim_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/roi_align_gradient_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sqrt_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/segment_reduction_op.cc.o
[ 43%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_div_op.cc.o
Compiling  reduce_scatter.cu                   > /home/feng/pytorch/build/nccl/obj/collectives/device/reduce_scatter_max.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/byte_weight_dequant_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_sum_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/upsample_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ensure_clipped_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cosh_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/margin_ranking_criterion_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/roi_pool_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tanh_gradient_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lp_pool_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pow_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rowmul_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rsqrt_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/roi_align_rotated_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/bisect_percentile_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/percentile_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/normalize_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sin_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_moments_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lstm_unit_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/jsd_op.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
Compiling  functions.cu                        > /home/feng/pytorch/build/nccl/obj/collectives/device/functions.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pad_op.cc.o
[ 44%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sigmoid_gradient_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/string_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/create_scope_op.cc.o
ptxas warning : Too big maxrregcount value specified 96, will be ignored
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_reducer_rowwise_8bit_ops.cc.o
nvcc warning : The 'compute_20', 'sm_20', and 'sm_21' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
nvlink fatal   : Internal error: reference to deleted section
Makefile:83: recipe for target '/home/feng/pytorch/build/nccl/obj/collectives/device/devlink.o' failed
make[5]: *** [/home/feng/pytorch/build/nccl/obj/collectives/device/devlink.o] Error 1
Makefile:45: recipe for target 'devicelib' failed
make[4]: *** [devicelib] Error 2
Makefile:25: recipe for target 'src.build' failed
make[3]: *** [src.build] Error 2
CMakeFiles/nccl_external.dir/build.make:110: recipe for target 'nccl_external-prefix/src/nccl_external-stamp/nccl_external-build' failed
make[2]: *** [nccl_external-prefix/src/nccl_external-stamp/nccl_external-build] Error 2
CMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/nccl_external.dir/all' failed
make[1]: *** [CMakeFiles/nccl_external.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_reducer_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/deform_conv_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/gather_ranges_to_dense_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_transpose_op_mobile.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_matmul_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/crf_viterbi_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/thresholded_relu_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/replace_nan_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/mean_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/stylizer_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/is_empty_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/channel_stats_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sinusoid_position_encoding_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/apmeter_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/key_split_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/square_root_divide_op.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reduce_ops.cc.o
[ 45%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/softmax_shared.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_mul_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/roi_align_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/minmax_gradient_ops.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/deform_conv_gradient_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reduce_front_back_sum_ops.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/transpose_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/text_file_reader_utils.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elu_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reduce_front_back_mean_ops.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/workspace_ops.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/text_file_reader.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/given_tensor_fill_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/utility_ops.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/communicator_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/find_duplicate_elements_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/abs_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cbrt_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_box_cox_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sqr_op.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/last_n_window_collector.cc.o
[ 46%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tanh_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/length_split_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/gather_fused_8bit_rowwise_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/onnxifi_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/logit_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/boolean_mask_ops.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/stop_gradient.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/asin_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_sparse_to_dense_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/channel_shuffle_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/counter_ops.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/sinh_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_mul_gradient_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ngram_ops.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/accuracy_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reduction_ops.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/matmul_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rank_loss_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/softplus_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conditional_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/loss_op.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/boolean_unmask_ops.cc.o
[ 47%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/weighted_multi_sampling_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/fused_rowwise_random_quantization_ops.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reciprocal_gradient_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/softmax_with_loss_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/numpy_tile_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/piecewise_linear_transform_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/space_batch_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/floor_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/log_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_logical_ops.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_add_gradient_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ceil_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/index_hash_ops.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/weighted_sample_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/atomic_ops.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/one_hot_ops.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_ops_schema.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/merge_id_lists_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/shape_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/perplexity_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/normalize_l1_op.cc.o
[ 48%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/map_ops.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/concat_split_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/load_save_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/find_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/top_k.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/group_norm_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/spatial_batch_norm_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tile_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/box_with_nms_limit_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/tan_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/channel_backprop_stats_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/fully_connected_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/zero_gradient_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/stump_func_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/fused_rowwise_8bit_conversion_ops.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/negative_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/softmax_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/half_float_ops.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ctc_beam_search_decoder_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/given_tensor_byte_string_to_uint8_fill_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/onnx_while_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/negate_gradient_op.cc.o
[ 49%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pool_gradient_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/flatten_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_ops_utils.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/summarize_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/minmax_ops.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_tile_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/im2col_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/generate_proposals_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/stats_ops.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/order_switch_ops.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/reverse_packed_segs_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/norm_planar_yuv_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/exp_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cos_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/atan_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/ctc_greedy_decoder_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/scale_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_transpose_gradient_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/instance_norm_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/prelu_op.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/batch_gather_ops.cc.o
[ 50%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/expand_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cosine_embedding_criterion_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pack_segments.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_add_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/multi_class_accuracy_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/copy_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/mod_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/dataset_ops.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/affine_channel_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/lengths_pad_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/spatial_batch_norm_gradient_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cross_entropy_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/locally_connected_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rmac_regions_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/variable_length_sequence_padding.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/hard_sigmoid_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/pack_rnn_sequence_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/fc_inference.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_op_eigen.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/gather_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/swish_op.cc.o
[ 51%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_sub_gradient_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/conv_transpose_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quant_decode_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/elementwise_linear_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/layer_norm_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/cube_op.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/layer_norm.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/batch_matmul.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/flatten.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/averaged_loss.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/add.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/batch_gather.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/filler.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/enforce_finite.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/expand_dims.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/stop_gradient.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/cast.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/mul.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/sigmoid.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/relu.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/fc.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/sparse_lengths_sum.cc.o
[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/concat.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/schemas/sigmoid_cross_entropy_with_logits.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/expand_dims_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/add_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/fc_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/concat_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/relu_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/batch_matmul_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/flatten_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/sparse_lengths_sum_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/sigmoid_cross_entropy_with_logits_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/sigmoid_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/filler_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/averaged_loss_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/cast_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/stop_gradient_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/batch_gather_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/enforce_finite_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/experimental/c10/cpu/mul_cpu.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rnn/recurrent_network_op.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rnn/recurrent_network_executor.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/rnn/recurrent_network_blob_fetcher_op.cc.o
[ 53%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/init_qnnpack.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_add_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_average_pool_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_channel_shuffle_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_concat_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_conv_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_conv_transpose_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_dequantize_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_fc_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_flatten_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_given_tensor_fill_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_leaky_relu_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_max_pool_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_quantize_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_relu_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_reshape_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_resize_nearest_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_roi_align_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_slice_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_sigmoid_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/operators/quantized/int8_softmax_op.cc.o
[ 54%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/distributed.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/optimize_ideep.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/distributed_converter.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/dead_code_elim.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/mobile.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/optimizer.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/sink.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/onnxifi_transformer.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/passes.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/annotations.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/converter.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/backend_cutting.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/fusion.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/opt/device.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/perfkernels/typed_axpy.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/perfkernels/fused_8bit_rowwise_embedding_lookup.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/perfkernels/adagrad.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/perfkernels/embedding_lookup.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/perfkernels/math_cpu_base.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/queue/queue_ops.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/queue/rebatching_queue_ops.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/queue/rebatching_queue.cc.o
[ 55%] Building CXX object caffe2/CMakeFiles/caffe2.dir/queue/blobs_queue.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/queue/blobs_queue_db.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/momentum_sgd_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/adam_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/learning_rate_adaption_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/clip_tensor_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/yellowfin_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/wngrad_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/gftrl_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/iter_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/learning_rate_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/ftrl_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/adadelta_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/lars_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/adagrad_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/sgd/rmsprop_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/share/contrib/nnpack/conv_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/share/contrib/depthwise/depthwise3x3_conv_op.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/transforms/single_op_transform.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/transforms/conv_to_nnpack_transform.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/transforms/pattern_net_transform.cc.o
[ 56%] Building CXX object caffe2/CMakeFiles/caffe2.dir/transforms/common_subexpression_elimination.cc.o
[ 57%] Linking CXX shared library ../lib/libcaffe2.so
[ 57%] Built target caffe2
Makefile:138: recipe for target 'all' failed
make: *** [all] Error 2
Failed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn --use-qnnpack caffe2'
<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1.
1.
1.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0):
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
683,827,0,"HalfTensor Training Needs non-Stateless Method in F.Linear. Hi Guys,

Currently trying to call backward() on a network trained in FP16 with a linear output results in an error:







This is easily fixed by replacing these calls with the non-stateless versions, as I've done [here](https://github.com/ajbrock/pytorch/blob/master/torch/nn/_functions/linear.py). I'm not sure if this replacement is in line with pytorch style (or if there are plans to implement stateless methods for HalfTensors which would render this irrelevant), but I can submit a PR if needbe.

Best,

Andy. ['\r\nimport torch\r\nimport torch.nn.functional as F\r\nfrom torch.autograd import Variable as V\r\nx = V(torch.randn(20,5).cuda().half(),requires_grad=True)\r\ninp = V(torch.randn(100,5).cuda().half())\r\nout = F.linear(inp,x)\r\nout2 = out.mean()\r\nout2\r\nVariable containing:\r\n1.00000e-02 *\r\n -4.1840\r\n[torch.cuda.HalfTensor of size 1 (GPU 0)]\r\n\r\n\r\nout2.backward()\r\n', '\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/home/visionlab/anaconda2/lib/python2.7/site-packages/torch/autograd/variable.py"", line 145, in backward\r\n    self._execution_engine.run_backward((self,), (gradient,), retain_variables)\r\n  File ""/home/visionlab/anaconda2/lib/python2.7/site-packages/torch/nn/_functions/linear.py"", line 25, in backward\r\n    grad_weight = torch.mm(grad_output.t(), input)\r\nRuntimeError: Type HalfTensor doesn\'t implement stateless methods\r\n']"
512,11232,0,[sparse autograd] create get_indices/values; allow backward via ctor. []
576,22586,0,"got nan when gumbel_softmax calculated in GPU. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce


got results: 
> GPU: nan 0.004% probability happen, tot 38
> CPU: nan 0.000% probability happen, tot 0

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

no nan happen

## Environment

 - PyTorch Version (1.1.0):
 - OS (Linux):
 - How you installed PyTorch ():
 - Python version: 2.7
 - CUDA/cuDNN version: 9.0
. ['\r\nimport torch\r\nimport torch.nn as nn\r\nimport math\r\n\r\nif __name__ == ""__main__"":\r\n    batch_size = 128\r\n    temperature = 5.0\r\n    theta = torch.FloatTensor([1.753356814384460449,1.898535370826721191,0.6992630958557128906,\r\n                                0.2227068245410919189,0.6384450793266296387,1.431323885917663574,\r\n                                -0.05012089386582374573, -0.06672633439302444458])\r\n    device = torch.device(""cuda:0"" if torch.cuda.is_available() else ""cpu"")\r\n    t_gpu = theta.repeat(batch_size, 1).to(device)\r\n    max_num = 1000000\r\n    nan_num = 0\r\n    for i in range(max_num):\r\n        weight = nn.functional.gumbel_softmax(t_gpu, temperature)\r\n        if math.isnan(torch.sum(weight)):\r\n            nan_num+=1\r\n    print(""GPU: nan {:.3f}% probability happen, tot {}"".format(100.0 * nan_num / max_num, nan_num))\r\n    nan_num = 0\r\n    t_cpu = theta.repeat(batch_size, 1)\r\n    for i in range(max_num):\r\n        weight = nn.functional.gumbel_softmax(t_cpu, temperature)\r\n        if math.isnan(torch.sum(weight)):\r\n            nan_num+=1\r\n    print(""CPU: nan {:.3f}% probability happen, tot {}"".format(100.0 * nan_num / max_num, nan_num))\r\n']"
729,30578,0,"gradients of symeig not correct and gradcheck fails. ## üêõ Bug

The off-diagonal elements of torch.symeig's gradients are off by a factor of 2. Further, checking the gradients with torch.autograd.gradcheck gives a RuntimeError.

## To Reproduce

The following code computes an eigenvalue decomposition of a symmetric matrix and corresponding derivatives with two different approaches. One approach uses torch.symeig and backward() to compute the gradient. The second approach uses torch.symeig and numerical differentiation to compute the gradient.
Further, torch.autograd.gradcheck is called to test torch.symeig and it gives a RuntimeError.


This prints

Some observations can be made:
First, since numerical differentiation is not implemented to take the symmetry of the matrix M into account, only an upper triangular matrix is computed. This is true for both the version implemented above and for the error message of torch.autograd.gradcheck. The two numerical differentiation versions are identical.
Second, the off-diagonal elements computed via backward() and those computed via numerical differentiation differ by a factor of 2.

## Expected behavior

The derivative computed via backward() should (at least in the upper triangular part) be identical to the numerical differentiation gradient. The reason why this is not the case is that the structure of inputs to torch.symeig (i.e., the symmetry of the inputs) is not taken into account in the backward pass of torch.symeig. Derivatives of functions of symmetric matrices need some extra care, as equation (138) in the [matrix cookbook](https://www.math.uwaterloo.ca/~hwolkowi/matrixcookbook.pdf) highlights. As far as I can tell, only the [line of code which computes the return value of symeig's backward()](https://github.com/pytorch/pytorch/blob/dd52f50fc85e6710f020936c1fc5f14673508350/tools/autograd/templates/Functions.cpp#L1797) needs to be modified.
To demonstrate this, the following implements a custom gradient of symeig where the backward pass return value is changed slightly.

This prints

This agrees with numerical differentiation.

So, should the implementation of symeig_backward be changed?

## Environment

Output from environment collection script:



cc @vishwakftw @SsnL @jianyuh. ['\r\nimport numpy as np\r\nimport torch\r\nfrom torch.autograd import Variable\r\n\r\n\r\ndef get_numerical_gradient(func, x, epsilon):\r\n    """"""\r\n    Numerical differentiation.\r\n    If e_ij is the matrix with 1 in row i, column j and 0 elsewhere,\r\n    get_numerical_gradient computes\r\n        g_ij = func(x + epsilon*e_ij) - func(x - epsilon*e_ij))/(2*epsilon)\r\n    for all i and j and returns the gradient matrix constructed from\r\n    the g_ij.\r\n    """"""\r\n    g = np.zeros_like(x)\r\n    for i in range(0, x.shape[0]):\r\n        for j in range(0, x.shape[1]):\r\n            e = np.zeros_like(x)\r\n            e[i, j] = 1.0\r\n            g[i, j] = (func(x+epsilon*e) - func(x-epsilon*e)) / (2*epsilon)\r\n    return g\r\n\r\n\r\n#\r\n# The following two functions perform the same calculation: a sum over all\r\n# eigenvalues and eigenvectors\r\n#\r\ndef sum_val_plus_vec_torch(x):\r\n    d, u = torch.symeig(x, eigenvectors=True)\r\n    return torch.sum(d) + torch.sum(u)\r\n\r\n\r\n# This version is used for numerical differentiation.\r\ndef sum_val_plus_vec_np(x):\r\n    x_torch = Variable(torch.from_numpy(x.copy()))\r\n    s = sum_val_plus_vec_torch(x_torch)\r\n    return s.data.numpy()\r\n\r\n\r\n# for numerical gradient\r\nepsilon = 1e-6\r\n# random symmetric matrix\r\ndim = 2\r\nM = np.random.randn(dim, dim)\r\nM = M + M.T\r\n\r\n# numerical gradient\r\ngrad_num = get_numerical_gradient(sum_val_plus_vec_np, M, epsilon)\r\n\r\n# torch gradient\r\nM_torch = Variable(torch.from_numpy(M.copy()), requires_grad=True)\r\nsum_torch = sum_val_plus_vec_torch(M_torch)\r\nsum_torch.backward()\r\ngrad_torch = M_torch.grad.data.numpy()\r\n\r\nprint(\'-\'*10, \'numerical differentiation\')\r\nprint(grad_num)\r\nprint(\'-\'*10, \'torch\')\r\nprint(grad_torch)\r\n\r\nM_torch = Variable(torch.from_numpy(M.copy()), requires_grad=True)\r\nprint(torch.autograd.gradcheck(sum_val_plus_vec_torch, M_torch))\r\n', '\r\n---------- numerical differentiation\r\n[[1.00980921 0.08135323]\r\n [0.         0.99019079]]\r\n---------- torch\r\n[[1.00980921 0.04067662]\r\n [0.04067662 0.99019079]]\r\nTraceback (most recent call last):\r\n  File ""grad_test.py"", line 62, in <module>\r\n    print(torch.autograd.gradcheck(sum_val_plus_vec_torch, M_torch))\r\n  File ""C:\\Users\\abc\\Miniconda3\\envs\\main\\lib\\site-packages\\torch\\autograd\\gradcheck.py"", line\r\n289, in gradcheck\r\n    \'numerical:%s\\nanalytical:%s\\n\' % (i, j, n, a))\r\n  File ""C:\\Users\\abc\\Miniconda3\\envs\\main\\lib\\site-packages\\torch\\autograd\\gradcheck.py"", line\r\n227, in fail_test\r\n    raise RuntimeError(msg)\r\nRuntimeError: Jacobian mismatch for output 0 with respect to input 0,\r\nnumerical:tensor([[1.0098],\r\n        [0.0814],\r\n        [0.0000],\r\n        [0.9902]], dtype=torch.float64)\r\nanalytical:tensor([[1.0098],\r\n        [0.0407],\r\n        [0.0407],\r\n        [0.9902]], dtype=torch.float64\r\n', '\r\nclass SymEig(torch.autograd.Function):\r\n    """"""\r\n    This modified version of torch.symeig has different gradients.\r\n    The forward pass is not modified.\r\n    """"""\r\n    @staticmethod\r\n    def forward(ctx, in_tensor):\r\n        d, u = torch.symeig(in_tensor, eigenvectors=True)\r\n        ctx.save_for_backward(d, u)\r\n        return d, u\r\n\r\n    @staticmethod\r\n    def backward(ctx, *grad_output):\r\n        gd, gu = grad_output\r\n        d, u = ctx.saved_tensors\r\n        grad_input = None\r\n\r\n        ut = u.transpose(-2, -1)\r\n\r\n        F = d.unsqueeze(-2) - d.unsqueeze(-1)\r\n        F.diagonal(0, -2, -1).fill_(float(\'inf\'))\r\n        F.pow_(-1)\r\n\r\n        F.mul_(torch.matmul(ut, gu))\r\n\r\n        grad_input = torch.matmul(\r\n            u,\r\n            torch.matmul(torch.diag_embed(gd) + F, ut)\r\n        )\r\n        # until this point, no modification\r\n        #\r\n        # since A is symmetric, use equation (138) matrix cookbook\r\n        return grad_input + grad_input.transpose(-2, -1) \\\r\n            - torch.diag_embed(grad_input.diagonal(dim1=-2, dim2=-1))\r\n\r\n\r\n# test modified torch gradient\r\ndef sum_val_plus_vec_torch_modified(x):\r\n    d, u = SymEig.apply(x)\r\n    return torch.sum(d) + torch.sum(u)\r\n\r\n\r\nM_torch_modified = Variable(torch.from_numpy(M.copy()), requires_grad=True)\r\nsum_torch_modified = sum_val_plus_vec_torch_modified(M_torch_modified)\r\nsum_torch_modified.backward()\r\ngrad_torch_modified = M_torch_modified.grad.data.numpy()\r\n\r\nprint(\'-\'*10, \'torch modified\')\r\nprint(grad_torch_modified)\r\n', '\r\n---------- torch modified\r\n[[1.00980921 0.08135323]\r\n [0.08135323 0.99019079]]\r\n', '\r\nPyTorch version: 1.3.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.1\r\n\r\nOS: Microsoft Windows 10 Pro\r\nGCC version: (x86_64-posix-seh, Built by strawberryperl.com project) 8.3.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.17.4\r\n[pip] torch==1.3.1\r\n[conda] blas                      1.0                         mkl\r\n[conda] mkl                       2019.4                      245\r\n[conda] mkl-service               2.3.0            py37hb782905_0\r\n[conda] mkl_fft                   1.0.15           py37h14836fe_0\r\n[conda] mkl_random                1.1.0            py37h675688f_0\r\n[conda] pytorch                   1.3.1           py3.7_cuda101_cudnn7_0    pytorch\r\n']"
383,24675,0,"Migrate `_multinomial_alias_setup` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
132,13494,0,"Throws error when backward through sum() twice. ## üêõ Bug
 is special that we can backward() through it multiple times since it doesn't have saved variable, so nothing was really destroyed after the first backward.

This behavior is bad as we might silently backward through it multiple times without noticing, but the grad accumulates.

## To Reproduce


@zdevito told me briefly how to fix, I will send a PR for it soon. 
. ['\r\na = torch.randn(2, 2, 2, 2).requires_grad_(True)\r\na_sum = a.sum()\r\na_sum.backward()\r\na_sum.backward()\r\n']"
463,28868,0,"How to build caffe2 with ONNX opset version greater than 9?. ## ‚ùì Questions and Help

Hello,
I've currently worked with freshly merged feature pytorch/vision#1401 and won't able to find a way to make Caffe2 work with ONNX operation set 10?

Is there a way to build a Caffe2 from source with this opset?
 . []"
545,3610,0,"High GPU memory usage on master. Running cyclegan from https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix on master takes huge amount of memory (>11G with default options). It only takes 3.5G on 0.3 and 0.2 branches. 

The memory usage increases as I run more iteration. It seems some tensors are not freed properly.

I remember running on a pre-ATen-merge version without such issue.

Repro command:


By the way, this doesn't happen on the other model in the repo, pix2pix. ['\r\npython train.py --dataroot ./datasets/maps --name maps_cyclegan --model cycle_gan --no_dropout --niter 1 --niter_decay 0 --no_html --max_dataset_size 10 --batchSize 1\r\n']"
308,1362,0,"Feature Request: noise contrastive estimation/negative sampling. There isn't a standard loss function implementing this, even though it's pretty common. I am perfectly willing to implement it myself, if nobody else feels like it. It shouldn't be terribly complicated. I would structure it something like:
(N, C)C = num_classes(N)0 <= targets[i] <= C-1
The API for tensorflow also uses a parameter  so that by setting it to  you can switch to a negative sampling objective from nce. Is this worth doing?

Is this something that already exists? Is this something worth implementing?. []"
393,3231,0,".numpy() conversion problem. Converting an ndarray to a buffer and back works as expected, but not if the ndarray was given by  where t is a 

This works:



This doesn't:

. ['python\r\nb = np.frombuffer(bytes(np.arange(0, 100)), dtype=float)\r\nprint(b.shape)\r\n', 'python\r\na = torch.arange(0, 100)\r\nb = np.frombuffer(bytes(a.numpy()), dtype=float)\r\nprint(b.shape)\r\n']"
42,5388,1,"Perf regression: indexing 1-d tensor. After the Tensor/Variable merge we have a perf regression with indexing a 1-d tensor:

As of 6a2afe3



As of Tensor/Variable merge:



Note that indexing a Python list is even faster:



This affects things like:
https://github.com/pytorch/examples/blob/4ef2d4d0c8524372d0047e050065edcac665ce1a/word_language_model/data.py#L39-L46. ['python\r\n>>> import torch\r\n>>> x = torch.randn(1000)\r\n>>> %timeit x[0]\r\n435 ns ¬± 3.34 ns per loop (mean ¬± std. dev. of 7 runs, 1000000 loops each)\r\n>>> %timeit x[0] = 1\r\n449 ns ¬± 1.41 ns per loop (mean ¬± std. dev. of 7 runs, 1000000 loops each)\r\n', 'python\r\n>>> import torch\r\n>>> x = torch.randn(1000)\r\n>>> %timeit x[0]\r\n1000000 loops, best of 3: 1.05 ¬µs per loop\r\n>>> %timeit x[0] = 1\r\n100000 loops, best of 3: 4.02 ¬µs per loop\r\n', 'python\r\n>>> x = [0] * 1000\r\n>>> %timeit x[0]\r\n10000000 loops, best of 3: 36.3 ns per loop\r\n>>> %timeit x[0] = 1\r\n10000000 loops, best of 3: 37.7 ns per loop\r\n']"
469,992,0,"loading GPU checkpoints on CPU with remapping is trying to load torch.cuda. As @jzbontar reports:
serialization storage remapping is trying to load somewhere in the codepath.

> I get an error when loading a cuda tensor on a CPU only machine.  Here is the code I use: https://gist.github.com/jzbontar/b50f8c9dd22e49ff68c7c91dad63166a. The error is: AssertionError('\nFound no NVIDIA driver on your system... Both machines use pytorch version 0.1.10.. []"
558,2733,0,"Pytorch in multi-cpu cluster. Hi, 
I would like to use the distributed module to train a convolution net in a CPU cluster. Investigating your code, the function torch.cuda.device_count() is called in several places, and is used to populate the device_ids list. Since I don't have any GPU devices in my cluster, the method device_count() will always return 0 and any subsequent attempt to access device_ids[0] will result in an index exception.
Taking a naive path and changing device_count so that it always returns the number of nodes I intend to use then I get a different error: 

if not all(input.is_cuda for input in inputs):
   raise TypeError('Broadcast function not implemented for CPU tensors')

So I would like to ask you whether you have any plans to implement the distributed module to train networks in a multi-cpu cluster.

Many thanks. []"
726,16229,0,"test_dag_net_forking is flaky on ROCm. This was first surfaced in #15817 but I am filing a new bug for clarity.

Error looks like:



https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-devtoolset7-rocmrpm-centos7.5-test/5483/console

This seems to be specifically a ROCm failure. CC @bddppq @iotamudelta . ['\r\n01:46:35 ../.local/lib/python2.7/site-packages/caffe2/python/hypothesis_test.py::TestOperators::test_constant_fill PASSED [  7%]\r\n01:46:35 ../.local/lib/python2.7/site-packages/caffe2/python/hypothesis_test.py::TestOperators::test_cos PASSED [  8%]\r\n01:46:36 ../.local/lib/python2.7/site-packages/caffe2/python/hypothesis_test.py::TestOperators::test_dag_net_forking ./.jenkins/caffe2/test.sh: line 120:  5452 Segmentation fault      (core dumped) ""$PYTHON"" -m pytest -x -v --disable-warnings --junit-xml=""$pytest_reports_dir/result.xml"" --ignore ""$caffe2_pypath/python/test/executor_test.py"" --ignore ""$caffe2_pypath/python/operator_test/matmul_op_test.py"" --ignore ""$caffe2_pypath/python/operator_test/pack_ops_test.py"" --ignore ""$caffe2_pypath/python/mkl/mkl_sbn_speed_test.py"" ${rocm_ignore_test[@]} ""$caffe2_pypath/python"" ""${EXTRA_TESTS[@]}""\r\n01:46:36 + echo \'Stopping container...\'\r\n']"
666,19366,0,"[ONNX] RNN activation function exported to ONNX with wrong string case. ## üêõ Bug

If we export  module to ONNX, the  attribute is written is all lower case. Several backends assume these strings to be case-sensitive, where this can be a blocking issue during runtime. There is an open issue (https://github.com/onnx/onnx/issues/1934) in the ONNX repo to make this this explicit in the spec. PyTorch's ONNX exporter should also consider writing strings with correct case in  attribute. 

## To Reproduce

Steps to reproduce the behavior:

1. Create a simple model with  module.
1. Export this model to ONNX using 
1. Check the  attribute for the case of the string. As an example, the string will be 'tanh', where ideally it should be 'Tanh'.

## Expected behavior

The  attribute value should match the case specified in ONNX spec. 

## Environment
This can be seen in all environments.. []"
352,17231,0,"testing.assert_allclose should assert tensors have the same devices. ## üêõ Bug

This unit test should pass:

        ind = tor.LongTensor([110, 125, 235, 333, 404]).cuda()
        nd_shape = tor.LongTensor([10, 10, 10]).cuda()
        xy = array_to_nd_index(ind, nd_shape)
        result = [[1, 1, 0],
                  [1, 2, 5],
                  [2, 3, 5],
                  [3, 3, 3],
                  [4, 0, 4]]
        tortest.assert_allclose(result, xy)

However, I get:

        RuntimeError: expected type torch.LongTensor but got torch.cuda.LongTensor

Here's the solution I wrote in my own assert function, though it may be a bit permissive:

        if a.is_cuda and not b.is_cuda:
            b = b.cuda()
        elif b.is_cuda and not a.is_cuda:
            a = a.cuda()

## Environment

 - PyTorch Version (e.g., 1.0):    1.0.1
 - OS (e.g., Linux):    Windows
 - How you installed PyTorch (, , source):    pip
 - Python version:    3.6
 - CUDA/cuDNN version:    0.9
. []"
370,24145,0,"sccache crashes when building `Distribution.cu` on Windows. There are many occurences of this build error in Azure Pipelines.
https://dev.azure.com/pytorch/PyTorch/_build/results?buildId=3891
https://dev.azure.com/pytorch/PyTorch/_build/results?buildId=3901
https://dev.azure.com/pytorch/PyTorch/_build/results?buildId=3695

Any ideas, @yf225?. ['\r\n[737/1919] Building NVCC (Device) object caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/torch_generated_Distributions.cu.obj\r\nFAILED: caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/torch_generated_Distributions.cu.obj \r\ncmd.exe /C ""cd /D C:\\w\\1\\s\\windows\\pytorch\\build\\build\\caffe2\\CMakeFiles\\torch.dir\\__\\aten\\src\\ATen\\native\\cuda && C:\\w\\1\\s\\windows\\conda\\envs\\py3\\Library\\bin\\cmake.exe -E make_directory C:/w/1/s/windows/pytorch/build/build/caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/. && C:\\w\\1\\s\\windows\\conda\\envs\\py3\\Library\\bin\\cmake.exe -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=C:/w/1/s/windows/pytorch/build/build/caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/./torch_generated_Distributions.cu.obj -D generated_cubin_file:STRING=C:/w/1/s/windows/pytorch/build/build/caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/./torch_generated_Distributions.cu.obj.cubin.txt -P C:/w/1/s/windows/pytorch/build/build/caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/torch_generated_Distributions.cu.obj.Release.cmake""\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\ncl : Command line warning D9025 : overriding \'/EHs\' with \'/EHa\'\r\ncl : Command line warning D9025 : overriding \'/EHa\' with \'/EHs\'\r\nDistributions.cu\r\nerror: failed to execute compile\r\ncaused by: error reading compile response from server\r\ncaused by: Failed to read response header\r\ncaused by: An existing connection was forcibly closed by the remote host. (os error 10054)\r\nCMake Error at torch_generated_Distributions.cu.obj.Release.cmake:279 (message):\r\n  Error generating file\r\n  C:/w/1/s/windows/pytorch/build/build/caffe2/CMakeFiles/torch.dir/__/aten/src/ATen/native/cuda/./torch_generated_Distributions.cu.obj\r\n']"
118,22764,0,"[feature request] torch.hypot.  returns real and imaginary components as the last dimension. Two very frequent functions to consume it are:  and  (in NumPy). Abs is similar to regular , so meanwhile complex tensor support is not developed,  could do 's job.

NumPy also has a , although it accepts two arrays. We may have two versions: one accepting two arrays, another accepting only one array and a dim. Essentially,  is a version of , specialized for two element vectors only.. []"
88,21462,1,"Slow convolution with large kernels, should be using FFT. ## üêõ Bug

When using  with a large kernel size (1024 for instance) on gpu, the cudnn implementation is very slow and gets slower as I increase the kernel size. I thought it was using FFT but apparently not. If it were using FFT, the computation time should be independent of the kernel size, because the kernel is anyway padded to the length of the input.

I have tried benchmarking with both  set to  and . My implementation using the FFT is significantly faster especially when using a stride of 1. You will find hereafter the code both for the FFT based convolution implementation I use and the profiling. My implementation is within ~5e-5 of the reference implementation for random weights and input. For a kernel size of 1024, with 64 channels, a stride of 1 and an input of length 64000, the default implementation is about 20 times slower than the FFT based one. When using a kernel size of 2048, it is 40 times slower.


## To Reproduce

Steps to reproduce the behavior:

1. Copy the code below in 
2. Run 

torch.cuda.synchronize()

## Expected behavior

When using a stride of 1 and large kernel size, the FFT implementation is much faster than the default one. The FFT one takes 160ms whatever the size of the kernel, versus 3.3 seconds (resp 6.7) for the default one with a kernel size of 1024 (resp 2048).  For large strides, the cudnn implementation is competitive or faster as expected (the FFT only has an interest if we want the convolution for all positions).
I would expect cudnn to provide a fast implementation for large kernels with low stride, which can be especially useful in audio (filters implementation). When talking about this around me, most people were surprised as it has been announced that an FFT based implementation was added to cudnn.

## Environment

Collecting environment information...
PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: version 3.13.4

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration:
GPU 0: Quadro GP100
GPU 1: Quadro GP100

Nvidia driver version: 410.79
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.15.4
[pip3] torch==1.1.0
[pip3] torchvision==0.2.2
[conda] blas                      1.0                         mkl
[conda] mkl                       2018.0.3                      1
[conda] mkl_fft                   1.0.6            py37h7dd41cf_0
[conda] mkl_random                1.0.1            py37h4414c95_1
[conda] pytorch                   1.1.0           py3.7_cuda10.0.130_cudnn7.5.1_0    pytorch
[conda] torchvision               0.2.2                      py_3    pytorch


cc @csarofeen @ptrblck @mruberry @peterbell10 @VitalyFedyunin @ngimel. ['\r\n\r\nOutput from the above code in my environment:\r\n']"
181,16027,0,"More readable error message for index error of nn.Embedding  in CUDA. ## üöÄ Feature
More readable error message for index error of nn.Embedding  in CUDA

## Motivation

If nn.Embedding received a tensor containing larger values than , raise an error as follows:



However, if nn.Embedding exists in CUDA, raises error message as follows:



This error message is too hard to know why the error is occurred.
I spent a lot of time to find out the reason, so I created this feature request.. ['\r\nRuntimeError: index out of range at ...\r\n', '\r\nRuntimeError: cuda runtime error (59) : device-side assert triggered ...\r\n']"
28,160,1,"loss functions return wrong values. The following code outputs:
4, 0.4, 4
instead of
4, 0.4, 0.04

and there seem to be errors for other loss functions as well, like SmoothL1Loss.


. ['\nloss = nn.L1Loss()\ny = Variable(torch.FloatTensor(1).fill_(0))\nprint(loss.forward(Variable(torch.FloatTensor(1).fill_(4.)), y))\nprint(loss.forward(Variable(torch.FloatTensor(1).fill_(.4)), y))\nprint(loss.forward(Variable(torch.FloatTensor(1).fill_(.04)), y))\n']"
106,2576,0,"CUDA multinomial is limited to 2^24 categories. As reported by @Moustapha6C. The following fails, because there are too many categories:



cc @ezyang @gchanan @zou3519 @bdhirsh @jbschlosser @anjali411 @ngimel @fritzo @neerajprad @alicanb @vishwakftw @nikitaved @vincentqb. ['python\r\nx = torch.randn(9000 * 5000).cuda().abs()\r\nout = torch.multinomial(x, 10, replacement=True)\r\n']"
646,9264,0,"Dilated Conv3d segfaults (cpu). I have encountered a segfault when running  with dilation under pytorch 0.4.0 on the cpu for some specific tensor sizes. This is the code to reproduce the behavior:



And this is the stack trace from gdb:


And this is the environment information:


Thanks for your help!. ['\r\nimport torch\r\nimport torch.nn as nn\r\nmod = nn.Conv3d(96, 256, 4, 1, 0, 2)     # does not crash with dilation = 1\r\nmod(torch.zeros([1, 96, 111, 63, 111]))\r\n', '\r\n#0  0x00007fffbfb0c3d7 in THNN_Floatvol2col(float const*, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, float*)\r\n    () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#1  0x00007fffbfc240cb in THNN_FloatVolumetricDilatedConvolution_updateOutput ()\r\n   from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#2  0x00007fffbf42ae43 in at::CPUFloatType::thnn_conv_dilated3d_forward(at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#3  0x00007fffdeda145d in torch::autograd::VariableType::thnn_conv_dilated3d_forward (this=0x555556570a40, self=..., weight=..., kernel_size=..., bias=..., \r\n    stride=..., padding=..., dilation=...) at torch/csrc/autograd/generated/VariableType.cpp:17592\r\n#4  0x00007fffbf625595 in at::Type::thnn_conv_dilated3d(at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#5  0x00007fffded3ec54 in torch::autograd::VariableType::thnn_conv_dilated3d (this=0x555556570a40, self=..., weight=..., kernel_size=..., bias=..., stride=..., \r\n    padding=..., dilation=...) at torch/csrc/autograd/generated/VariableType.cpp:17528\r\n#6  0x00007fffbf313a2b in at::native::_convolution_nogroup(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>) () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#7  0x00007fffbf620bae in at::Type::_convolution_nogroup(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#8  0x00007fffded40db7 in torch::autograd::VariableType::_convolution_nogroup (this=0x555556570a40, input=..., weight=..., bias=..., stride=..., padding=..., \r\n    dilation=..., transposed=false, output_padding=...) at torch/csrc/autograd/generated/VariableType.cpp:18403\r\n#9  0x00007fffbf318fe8 in at::native::_convolution(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>, long, bool, bool, bool) () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#10 0x00007fffbf620b64 in at::Type::_convolution(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>, long, bool, bool, bool) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#11 0x00007fffded40a6e in torch::autograd::VariableType::_convolution (this=0x555556570a40, input=..., weight=..., bias=..., stride=..., padding=..., \r\n    dilation=..., transposed=false, output_padding=..., groups=1, benchmark=false, deterministic=false, cudnn_enabled=true)\r\n    at torch/csrc/autograd/generated/VariableType.cpp:18386\r\n#12 0x00007fffbf313e0e in at::native::convolution(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>, long) () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#13 0x00007fffbf620afe in at::Type::convolution(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, bool, at::ArrayRef<long>, long) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#14 0x00007fffdece124c in torch::autograd::VariableType::convolution (this=0x555556570a40, input=..., weight=..., bias=..., stride=..., padding=..., \r\n    dilation=..., transposed=<optimised out>, output_padding=..., groups=1) at torch/csrc/autograd/generated/VariableType.cpp:18368\r\n#15 0x00007fffbf3141aa in at::native::conv3d(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, long) () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#16 0x00007fffbf620d22 in at::Type::conv3d(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::ArrayRef<long>, at::ArrayRef<long>, at::ArrayRef<long>, long) const () from /home/martin/miniconda3/envs/BAI/lib/python3.6/site-packages/torch/lib/libATen.so\r\n#17 0x00007fffdece147e in torch::autograd::VariableType::conv3d (this=0x555556570a40, input=..., weight=..., bias=..., stride=..., padding=..., dilation=..., \r\n    groups=1) at torch/csrc/autograd/generated/VariableType.cpp:18446\r\n#18 0x00007fffdee94387 in at::conv3d (groups=1, dilation=..., padding=..., stride=..., bias=..., weight=..., input=...)\r\n    at /opt/conda/conda-bld/pytorch_1524584710464/work/torch/lib/tmp_install/include/ATen/Functions.h:3044\r\n#19 torch::autograd::dispatch_conv3d (groups=1, dilation=..., padding=..., stride=..., bias=..., weight=..., input=...)\r\n    at torch/csrc/autograd/generated/python_torch_functions_dispatch.h:1073\r\n#20 torch::autograd::THPVariable_conv3d (self=<optimised out>, args=<optimised out>, kwargs=<optimised out>)\r\n    at torch/csrc/autograd/generated/python_torch_functions.cpp:1662\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 0.4.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 8.0.61\r\n\r\nOS: Ubuntu 16.04.4 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.14.5)\r\n[pip] torch (0.4.0)\r\n[pip] torchvision (0.2.1)\r\n[conda] pytorch                   0.4.0           py36_cuda8.0.61_cudnn7.1.2_1    pytorch\r\n[conda] torchvision               0.2.1                    py36_1    pytorch\r\n']"
488,30717,0,"TestTorchDeviceTypeXLA: Could not start gRPC server. Excerpt from [this CircleCI build](https://circleci.com/gh/pytorch/pytorch/3768299) on the  branch:



cc @ezyang @gchanan @zou3519 @ailzhang. ['\r\nDec 04 01:51:20 E1204 01:51:20.635135781     187 server_chttp2.cc:40]        {""created"":""@1575424280.635041133"",""description"":""No address added out of total 1 resolved"",""file"":""external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc"",""file_line"":348,""referenced_errors"":[{""created"":""@1575424280.635039519"",""description"":""Failed to add any wildcard listeners"",""file"":""external/grpc/src/core/lib/iomgr/tcp_server_posix.cc"",""file_line"":324,""referenced_errors"":[{""created"":""@1575424280.635019167"",""description"":""Address family not supported by protocol"",""errno"":97,""file"":""external/grpc/src/core/lib/iomgr/socket_utils_common_posix.cc"",""file_line"":379,""os_error"":""Address family not supported by protocol"",""syscall"":""socket"",""target_address"":""[::]:40934""},{""created"":""@1575424280.635038986"",""description"":""Unable to configure socket"",""fd"":7,""file"":""external/grpc/src/core/lib/iomgr/tcp_server_utils_posix_common.cc"",""file_line"":217,""referenced_errors"":[{""created"":""@1575424280.635035502"",""description"":""Address already in use"",""errno"":98,""file"":""external/grpc/src/core/lib/iomgr/tcp_server_utils_posix_common.cc"",""file_line"":190,""os_error"":""Address already in use"",""syscall"":""bind""}]}]}]}\r\nDec 04 01:51:20 2019-12-04 01:51:20.635182: E tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:509] Unknown: Could not start gRPC server\r\nDec 04 01:51:20 2019-12-04 01:51:20.637020: E tensorflow/compiler/xla/xla_client/tf_logging.cc:11] Check failed: tensorflow::NewServer(server_def, &server_) == ::tensorflow::Status::OK() (Unknown: Could not start gRPC server vs. OK)\r\nDec 04 01:51:20 \r\nDec 04 01:51:20 Running tests...\r\nDec 04 01:51:20 ----------------------------------------------------------------------\r\nDec 04 01:51:20 \r\nDec 04 01:51:20 ======================================================================\r\nDec 04 01:51:20 ERROR [0.000s]: setUpClass (__main__.TestTorchDeviceTypeXLA)\r\nDec 04 01:51:20 ----------------------------------------------------------------------\r\nDec 04 01:51:20 Traceback (most recent call last):\r\nDec 04 01:51:20   File ""/var/lib/jenkins/workspace/test/common_device_type.py"", line 326, in setUpClass\r\nDec 04 01:51:20     cls.primary_device = str(xm.xla_device())\r\nDec 04 01:51:20   File ""/opt/conda/lib/python3.6/site-packages/torch_xla-0.8-py3.6-linux-x86_64.egg/torch_xla/core/xla_model.py"", line 142, in xla_device\r\nDec 04 01:51:20     devices = get_xla_supported_devices(devkind=devkind)\r\nDec 04 01:51:20   File ""/opt/conda/lib/python3.6/site-packages/torch_xla-0.8-py3.6-linux-x86_64.egg/torch_xla/core/xla_model.py"", line 42, in get_xla_supported_devices\r\nDec 04 01:51:20     xla_devices = torch_xla._XLAC._xla_get_devices()\r\nDec 04 01:51:20 RuntimeError: tensorflow/compiler/xla/xla_client/xrt_local_service.cc:56 : Check failed: tensorflow::NewServer(server_def, &server_) == ::tensorflow::Status::OK() (Unknown: Could not start gRPC server vs. OK)\r\n']"
507,30796,0,"How to Build pytorch with local protobuf rather than third_party/protobuf?. ## ‚ùì Questions and Help
I want to build pytorch with my own os built protobuf lib rather than third_part/protobuf, Which prefix to change, Can anyone help me?


### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
. []"
108,15617,0,"Feature request: transposed locally connected layer. ## üöÄ Feature

transposed version of locally connected layer, similar to the transposed version of convolution layer but without weight sharing.

## Motivation

Similar to the necessity of the transposed convolution layer,  the locally connected layer (issue #499, PR #1583) should also have a transposed version.



cc @albanD @mruberry @jbschlosser. []"
199,20101,0,"jit tracing error for nn.Sequential with nn.Conv2d in torch 1.1.0 . ## üêõ Bug

 
when tracing nn.Sequential with nn.Conv2d in torch 1.1.0 

## To Reproduce

Steps to reproduce the behavior:



Raises the following error 


## Expected behavior

Expected to convert without issues

## Environment

PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 18.04.2 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: version 3.10.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.1.85
cuDNN version: /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so.7.0.5

Versions of relevant libraries:
[pip3] numpy==1.16.2
[pip3] numpy-image-widget==2019.1.6
[pip3] torch==1.1.0
[pip3] torchfile==0.1.0
[pip3] torchvision==0.2.1
[conda] Could not collect
. ['python\r\nRuntimeError: Cannot insert a Tensor that requires grad as a constant. Consider making it a parameter or input, or detaching the gradient\r\n', 'python\r\nfrom torch import nn\r\nimport torch.jit\r\n\r\nmodel = nn.Sequential(nn.Conv2d(2, 2, 1, 1, 1))\r\n\r\ntorch.jit.trace(model.forward, torch.randn(1, 1, 2, 2))\r\n', 'python\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-3-5e9a2f5de8a5> in <module>\r\n      4 model = nn.Sequential(nn.Conv2d(2, 2, 1, 1, 1))\r\n      5 \r\n----> 6 torch.jit.trace(model.forward, torch.randn(1, 1, 2, 2))\r\n\r\n~/.virtualenvs/test/lib/python3.6/site-packages/torch/jit/__init__.py in trace(func, example_inputs, optimize, check_trace, check_inputs, check_tolerance, _force_outplace, _module_class)\r\n    693         traced = torch._C._create_function_from_trace(name, func, example_inputs,\r\n    694                                                       var_lookup_fn,\r\n--> 695                                                       _force_outplace)\r\n    696 \r\n    697     # Check the trace against new traces created from user-specified inputs\r\n\r\n~/.virtualenvs/test/lib/python3.6/site-packages/torch/nn/modules/container.py in forward(self, input)\r\n     90     def forward(self, input):\r\n     91         for module in self._modules.values():\r\n---> 92             input = module(input)\r\n     93         return input\r\n     94 \r\n\r\n~/.virtualenvs/test/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             hook(self, input)\r\n    490         if torch._C._get_tracing_state():\r\n--> 491             result = self._slow_forward(*input, **kwargs)\r\n    492         else:\r\n    493             result = self.forward(*input, **kwargs)\r\n\r\n~/.virtualenvs/test/lib/python3.6/site-packages/torch/nn/modules/module.py in _slow_forward(self, *input, **kwargs)\r\n    479         tracing_state._traced_module_stack.append(self)\r\n    480         try:\r\n--> 481             result = self.forward(*input, **kwargs)\r\n    482         finally:\r\n    483             tracing_state.pop_scope()\r\n\r\n~/.virtualenvs/test/lib/python3.6/site-packages/torch/nn/modules/conv.py in forward(self, input)\r\n    336                             _pair(0), self.dilation, self.groups)\r\n    337         return F.conv2d(input, self.weight, self.bias, self.stride,\r\n--> 338                         self.padding, self.dilation, self.groups)\r\n    339 \r\n    340 \r\n\r\nRuntimeError: Cannot insert a Tensor that requires grad as a constant. Consider making it a parameter or input, or detaching the gradient\r\nTensor:\r\n(1,1,.,.) = \r\n  0.3550\r\n\r\n(2,1,.,.) = \r\n 0.01 *\r\n  9.7722\r\n\r\n(1,2,.,.) = \r\n -0.5052\r\n\r\n(2,2,.,.) = \r\n  0.5900\r\n[ Variable[CPUType]{2,2,1,1} ]\r\n']"
238,5302,0,"Slow first .cuda() call. I upgraded to v0.3.1 using conda and have since experienced really slow performance the first time I call .cuda(). I tried solutions listed [here](https://discuss.pytorch.org/t/model-cuda-takes-long-time/102/20) and [here](https://discuss.pytorch.org/t/model-cuda-takes-long-time/102/20) but no luck. I then tried installing the latest version from source but still experienced the slowdown. Any help would be hugely appreciated!

Info
- OS: CentOS 7.4.1708
- PyTorch version: tried 0.3.1 (conda) and 0.4.0a0+6279367 (source)
- How you installed PyTorch (conda, pip, source): conda, source
- Python version: 3.6.3
- CUDA/cuDNN version: 8.0.61, 7.0.2
- GPU models and configuration: 1080ti
- GCC version (if compiling from source): 7.2.0. []"
320,28245,0,"PyTorch RPC should expose critical metrics to the application.. ## üöÄ Feature

Context for Model Parallel: https://github.com/pytorch/pytorch/issues/23110

## Motivation

When applications are using complex distributed primitives like RPC, RRef and Distributed Autograd, debugging issues can be cumbersome. We should have a way of exposing metrics to applications. This could simply be a  API that returns information about various things. The full list of metrics needs to be decided, although a few examples could be number of owner rrefs, number of user rrefs, RPC latency, Distributed autograd latency etc.

cc @ezyang @gchanan @zou3519 @jerryzh168 @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @gqchen @aazzolini @rohan-varma @xush6528. []"
633,30076,0,"LibTorch(C++) with Cuda is raising an exception. I am trying to create NN with LibTorch 1.3 and C++ using Cuda 10.1 and Windows 10. For the build I am using Visual Studio 2019.

So far I tried basic examples and [MNIST example][1] with CPU which is working. However I cannot run it with CUDA. I tried to move model to GPU as it is described [here][2], but it is not working. 

> To move your model to GPU memory, you can write model.to(at::kCUDA);. Make sure the inputs to a model are also living in CUDA memory by calling tensor.to(at::kCUDA), which will return a new tensor in CUDA memory.

So I tried just simple

    int main(){
        auto net = std::make_shared<Net>();
        net->to(torch::kCUDA); //crashes here
    }

Then I tried to move simple Tensors to gpu memory but it crashes as well.

    #include <torch/torch.h>

    int main() 
    {
	    torch::Tensor a = torch::ones({ 2, 2 }, torch::requires_grad());
	    torch::Tensor b = torch::randn({ 2, 2 });
	    a.to(torch::kCUDA);    //Here it crashes
	    b.to(torch::kCUDA);    //
	    auto c = a + b;
    }

and I got:

    Exception thrown at 0x00007FFB8263A839 in Resnet50.exe: Microsoft C++ exception: c10::Error at memory location 0x000000E574979F30.
    Unhandled exception at 0x00007FFB8263A839 in Resnet50.exe: Microsoft C++ exception: c10::Error at memory location 0x000000E574979F30.

In debug mode it is pointing to  to

    auto operator()(Parameters... args) -> decltype(std::declval<FuncType>()(std::forward<Parameters>(args)...)) {
      return kernel_func_(std::forward<Parameters>(args)...);
    }

Using  shows it can find cuda device. 

Therefore I decided to build it from source but I it's not working either. It's related to [this](https://github.com/pytorch/pytorch/issues/30075#issue-525005329) post.

  [1]: https://pytorch.org/cppdocs/frontend.html#end-to-end-example
  [2]: https://pytorch.org/tutorials/advanced/cpp_export.html#step-4-executing-the-script-module-in-c. []"
560,6512,0,"Scalar operations are traced incorrectly. This code:

prints

because it's not using the tensor overload. We should change the dispatch code to never use the scalar overloads when they really are tensors.. ['python\r\nimport torch                                    \r\n                                                \r\nx = torch.randn(5, 2)                           \r\ny = torch.tensor(2.)                                                          \r\ndef fn(x, y):                                   \r\n    return x + y                                \r\ntrace, _ = torch.jit.get_trace_graph(fn, (x, y))\r\nprint(trace.graph())                            \r\n', '\r\ngraph(%0 : Float(5, 2)\r\n      %1 : Float()) {\r\n  %2 : Float(5, 2) = aten::add[other={2}, alpha={1}](%0)\r\n  return (%2);\r\n}\r\n']"
3,537,1,"Initial call to .cuda() very slow with Titan X. The first call to .cuda() takes more than one minute when run on a system with a titan X:




Swapping a GTX 980ti on the exact same system results in normal timings (although with a very slight delay for the first call). On my laptop (GTX 960M), it is almost instant. 

. ['\r\nimport torch\r\nfrom datetime import datetime\r\n\r\nfor i in range(10):\r\n    x = torch.randn(10, 10, 10, 10) # similar timings regardless of the tensor size\r\n    t1 = datetime.now()\r\n    x.cuda()\r\n    print(i, datetime.now() - t1)\r\n', '\r\n0 0:02:01.451538\r\n1 0:00:00.000205\r\n2 0:00:00.000057\r\n3 0:00:00.000058\r\n4 0:00:00.000053\r\n5 0:00:00.000054\r\n6 0:00:00.000052\r\n7 0:00:00.000051\r\n8 0:00:00.000059\r\n9 0:00:00.000051\r\n']"
97,20230,0,"[jit] torch.tensor doesn't support list of tuples. ## üêõ Bug

Cannot create a tensor using  from a list of tuples.

## To Reproduce

Steps to reproduce the behavior:



gives the following error:


## Expected behavior

Should not give an error. Works in pure python.

## Environment
Pytorch 1.1.0

## Additional context

A workaround is to use a list of lists instead.
. ['python\r\nimport torch\r\n\r\n@torch.jit.script\r\ndef test():\r\n  li = [(1, 2, 3, 4), (5, 6, 7, 8), (9, 10, 11, 12)]\r\n  return torch.tensor(li)\r\n', '\r\nRuntimeError: \r\nInput list to torch.tensor must be of ints, floats, or bools, got (int, int, int, int):\r\n@torch.jit.script\r\ndef test():\r\n  li = [(1, 2, 3, 4), (5, 6, 7, 8), (9, 10, 11, 12)]\r\n  return torch.tensor(li)\r\n         ~~~~~~~~~~~~ <--- HERE\r\n']"
21,23156,1,"Pruning off NaN values in the gradient graph still produces NaN gradients.. ## üêõ Bug

This is a niche bug, but it might cause troubles in advanced users who like to use masking to filter out NaN losses. Simply put, when NaN losses are masked out using , performing  on the sum of the losses should produce valid gradients (assuming that the gradient graph is smooth everywhere except for the masked losses). When 

## To Reproduce

Steps to reproduce the behavior:

Define the environment as follows. We will be backpropagating gradients to a very simple  layer.



Performing a forward inference on the linear layer and propagating gradients from there works as intended if no  is involved.



Suppose that  has  in one of its rows.



Performing backwards computation on the sum of the matrix above should
produce  gradients. This is expected.



However, using  or  index slicing on the leaf nodes to mask out problematic gradient graphs should not.


We can check whether masking out final losses works in cases where no  is involved.



The accumulated gradient in the latter case is less than the former because index slicing () on the computation graph prevented the third row in  from affecting the gradient computation.

## Environment

Collecting environment information...
PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.14.5
GCC version: Could not collect
CMake version: Could not collect

Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] numpy==1.16.3
[pip] torch==1.0.0
[conda] torch                     1.0.0                     <pip>

## Additional context

None.
. ['python\r\nimport torch\r\nimport torch.nn as nn\r\nx = torch.ones(3, 4)\r\nlinear = nn.Linear(4, 2)\r\ndef has_err(x):\r\n    return bool(((x != x) | (x == float(""inf"")) | (x == float(""-inf""))).any().item())\r\n', 'python\r\nlinear(x).sum().backward()\r\nprint(linear.weight.grad)\r\n# tensor([[3., 3., 3., 3.],\r\n#         [3., 3., 3., 3.]])\r\nassert not has_err(linear.weight.grad)\r\n', 'python\r\nx[2].fill_(float(""nan""))\r\nprint(linear(x))\r\n# tensor([[ 0.0570, -1.0066],\r\n#         [ 0.0570, -1.0066],\r\n#         [    nan,     nan]], grad_fn=<AddmmBackward>)\r\n', 'python\r\nlinear.zero_grad()\r\nlinear(x).sum().backward()\r\nprint(linear.weight.grad)\r\n# tensor([[nan, nan, nan, nan],\r\n#         [nan, nan, nan, nan]])\r\nassert has_err(linear.weight.grad)\r\n', 'python\r\nlinear.zero_grad()\r\nlinear(x)[:2].sum().backward()\r\nassert not has_err(linear.weight.grad)  # AssertionError raised\r\n', 'python\r\nx = torch.ones(3, 4)\r\nx[2].fill_(0.5)\r\nlinear.zero_grad()\r\nlinear(x).sum().backward()\r\nprint(linear.weight.grad)\r\n# without masking:\r\n# tensor([[2.5000, 2.5000, 2.5000, 2.5000],\r\n#         [2.5000, 2.5000, 2.5000, 2.5000]])\r\nlinear.zero_grad()\r\nlinear(x)[2:].sum().backward()\r\nprint(linear.weight.grad)\r\n# with masking:\r\n# tensor([[2., 2., 2., 2.],\r\n#         [2., 2., 2., 2.]])\r\n']"
418,6318,0,"Bug of ByteTensor. Here is an example which I want to do:

But this code will encounter an issue, which raise

So how can I judge if a Tensor in a list?
. ['python\r\nimport torch\r\na = torch.randn(3)\r\nb = torch.randn(3)\r\nc = [a]\r\nif a in c:\r\n    .....\r\n......\r\nif b in c:\r\n    .....\r\n']"
40,27902,1,"Slowdown due to thread specific model caching. ## üêõ Bug

PyTorch appears to have an issue with threads that causes it to not properly warm up models if executed by different threads  in succession. This is why when using multi-instances of the model on the same GPU, it does not provide a speedup and in some cases is even slower than a single instance.

## To Reproduce

**Steps to reproduce the behavior:**

I have a simple libtorch code snippet that reproduces this issue. In short all it does is run the same model (Resnet50 model from the torchvision  that was traced to produce a torchscript version of the same). The code was run on a Titian V with a batch size of 1.

1. Create model in main thread
2. Launch thread that runs model N times in a loop, reporting the runtime each time
3. Launch N threads that each run the model once, reporting the runtime each time


## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Is debug build: No
CUDA used to build PyTorch: 10.1.243

OS: Ubuntu 18.04.3 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: version 3.14.0

Python version: 3.6
Is CUDA available: No
CUDA runtime version: 10.1.243
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.3

Versions of relevant libraries:
[pip] msgpack-numpy==0.4.3.2
[pip] numpy==1.16.4
[pip] torch==1.2.0a0+afb7a16
[pip] torchtext==0.4.0
[pip] torchvision==0.3.0a0
[conda] magma-cuda100             2.5.0                         1    local
[conda] mkl                       2019.1                      144  
[conda] mkl-include               2019.1                      144  
[conda] nomkl                     3.0                           0  
[conda] torch                     1.2.0a0+afb7a16          pypi_0    pypi
[conda] torchtext                 0.4.0                    pypi_0    pypi
[conda] torchvision               0.3.0a0                  pypi_0    pypi


cc @ezyang @gchanan @zou3519 @suo. ['\r\n#include <torch/script.h>\r\n\r\n#include <pthread.h>\r\n#include <unistd.h>\r\n#include <chrono>\r\n#include <iostream>\r\n\r\nstruct inferStruct {\r\n  at::Tensor output_;\r\n  torch::jit::script::Module module_;\r\n  std::vector<torch::jit::IValue> inputs_;\r\n};\r\n\r\n// Run model 5 times\r\nvoid*\r\nNForwardPass(void* run)\r\n{\r\n  inferStruct* run_tmp = reinterpret_cast<inferStruct*>(run);\r\n  for (int i = 0; i < 5; i++) {\r\n    auto t1 = std::chrono::high_resolution_clock::now();\r\n    run_tmp->output_ = run_tmp->module_.forward(run_tmp->inputs_).toTensor();\r\n    auto t2 = std::chrono::high_resolution_clock::now();\r\n    auto duration =\r\n        std::chrono::duration_cast<std::chrono::microseconds>(t2 - t1).count();\r\n    std::cout << duration / 1000.0\r\n              << "" ms to run model in process thread (NForwardPass)""\r\n              << std::endl;\r\n  }\r\n}\r\n\r\n// Run model 1 time\r\nvoid*\r\nForwardPass(void* run)\r\n{\r\n  inferStruct* run_tmp = reinterpret_cast<inferStruct*>(run);\r\n  auto t1 = std::chrono::high_resolution_clock::now();\r\n  run_tmp->output_ = run_tmp->module_.forward(run_tmp->inputs_).toTensor();\r\n  auto t2 = std::chrono::high_resolution_clock::now();\r\n  auto duration =\r\n      std::chrono::duration_cast<std::chrono::microseconds>(t2 - t1).count();\r\n  std::cout << duration / 1000.0\r\n            << "" ms to run model in process thread (ForwardPass)"" << std::endl;\r\n}\r\n\r\nint\r\nmain()\r\n{\r\n  // Model loaded in main thread\r\n  torch::Device device_ = torch::Device(torch::kCUDA, 0);\r\n  std::string model_path = ""resnet50_libtorch.pt"";\r\n  torch::jit::script::Module module1 = torch::jit::load(model_path, device_);\r\n  std::vector<torch::jit::IValue> inputs_(1);\r\n  inputs_[0] = torch::zeros({1, 3, 224, 224}).to(device_);\r\n  // pre-warm model\r\n  at::Tensor output = module1.forward(inputs_).toTensor();\r\n\r\n  inferStruct run1;\r\n  pthread_t thread_id1;  //, thread_id2;\r\n\r\n  run1.module_ = module1;\r\n  run1.inputs_ = inputs_;\r\n\r\n  // Run model in main thread N times and report runtime each time\r\n  for (int i = 0; i < 5; i++) {\r\n    auto t1 = std::chrono::high_resolution_clock::now();\r\n    output = module1.forward(inputs_).toTensor();\r\n    auto t2 = std::chrono::high_resolution_clock::now();\r\n    auto duration =\r\n        std::chrono::duration_cast<std::chrono::microseconds>(t2 - t1).count();\r\n    std::cout << duration / 1000.0 << "" ms to run model in main thread""\r\n              << std::endl;\r\n  }\r\n  sleep(1);\r\n\r\n  // Run N threads and in each run model once and report runtime each time\r\n  std::cout << std::endl;\r\n  for (int i = 0; i < 5; i++) {\r\n    pthread_create(&thread_id1, NULL, ForwardPass, &run1);\r\n    pthread_join(thread_id1, NULL);\r\n  }\r\n  sleep(1);\r\n\r\n  // Run 1 thread and in it run the model N and report runtime each time\r\n  std::cout << std::endl;\r\n  pthread_create(&thread_id1, NULL, NForwardPass, &run1);\r\n  pthread_join(thread_id1, NULL);\r\n\r\n  return 0;\r\n}\r\n']"
508,123,0,"0 indexed random. What about having torch.IntTensor(10).random_(4) returning integers between 0 and 3 instead of 1 and 4, to make it consistent with numpy.random.randint?
. []"
431,31611,0,"the example program using libtorch is not linked against torch_cuda when USE_CUDA is ON. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

Looks like https://github.com/pytorch/pytorch/issues/15992 is coming back again after the split of the torch library.

## To Reproduce

Steps to reproduce the behavior:

1. The following script throws ""Torch is not linked against CUDA"" and gets 0 as output.

2. The following one is working correctly and gets 1 as output.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

The behaviour keeps consistent in code snippet 1 and code snippet 2.

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): master
 - OS (e.g., Linux): Windows
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): python setup.py build
 - Python version: doesn't matter
 - CUDA/cuDNN version: doesn't matter
 - GPU models and configuration: doesn't matter
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->


cc @ezyang @gchanan @zou3519 @ngimel @peterjc123. ['cpp\r\n#include <ATen/ATen.h>\r\n#include <torch/torch.h>\r\n#include <iostream>\r\n\r\nint main() {\r\n\tstd::cout << torch::cuda::is_available() << std::endl;\r\n\ttorch::Tensor tensor = at::tensor({ -1, 1 }, at::kCUDA);\r\n        return 0;\r\n}\r\n', 'cpp\r\n#include <ATen/ATen.h>\r\n#include <torch/torch.h>\r\n#include <iostream>\r\n#include <Windows.h>\r\n\r\nint main() {\r\n\tLoadLibraryA(""torch_cuda.dll"");\r\n\tstd::cout << torch::cuda::is_available() << std::endl;\r\n\ttorch::Tensor tensor = at::tensor({ -1, 1 }, at::kCUDA);\r\n        return 0;\r\n}\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
17,22127,1,"Cpu memory leak when only doing model forwarding in a loop. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce
Cpu memory leak when only doing model forwarding in a loop
<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

define the model as simple as :

and write the test program as:


## Expected behavior
look into the system monitor, the related python process's memory should be stable. but in fact the memory increase over time.
<!-- A clear and concise description of what you expected to happen. -->

## Environment

 - PyTorch Version ( 1.1):
 - OS (Linux & OSX):
 - How you installed PyTorch ():
 - Python version: 3.6 & 3.7
 - Any other relevant information: when using gc.collect(), the increasing becomes slow, however it won't help since i want to use LSTM layers(quickly out of memory)

## Additional context

<!-- Add any other context about the problem here. -->
I am writing a reinforcement learning program, during every episode(in loops) I will do model forwardings. This memory leak problem is vital. . ['\r\nclass TestLeakModel(nn.Module):\r\n    def __init__(self):\r\n        super(TestLeakModel,self).__init__()\r\n        self.conv1 = nn.Conv2d(in_channels=18, out_channels=16, kernel_size=3, padding=1)   # WEIGHTs ARE INITED\r\n        self.conv2 = nn.Conv2d(in_channels=16, out_channels=16, kernel_size=3,\r\n                               padding=1)  # WEIGHTs ARE INITED\r\n        self.conv3 = nn.Conv2d(in_channels=16, out_channels=16, kernel_size=3, padding=1)\r\n        self.conv4 = nn.Conv2d(in_channels=16, out_channels=16, kernel_size=3, padding=1)  # WEIGHTs ARE INITED\r\n        self.conv5 = nn.Conv2d(in_channels=16, out_channels=16, kernel_size=3,\r\n                               padding=1)  # WEIGHTs ARE INITED\r\n        self.fc1 = nn.Linear(in_features=64*16, out_features=128)\r\n        self.fc2 = nn.Linear(in_features=128, out_features=128)\r\n        self.fc3 = nn.Linear(in_features=128, out_features=128)\r\n        self.fc4 = nn.Linear(in_features=128, out_features=128)\r\n        self.fc5 = nn.Linear(in_features=128, out_features=128)\r\n        self.fc6 = nn.Linear(in_features=128, out_features=7)\r\n\r\n    def forward(self, input):\r\n        x = self.conv1(input)\r\n        x = self.conv2(x)\r\n        x = self.conv3(x)\r\n        x = self.conv4(x)\r\n        x = self.conv5(x)\r\n\r\n        x = Flatten()(x)\r\n        x = self.fc1(x)\r\n        x = self.fc2(x)\r\n        x = self.fc3(x)\r\n        x = self.fc4(x)\r\n        x = self.fc5(x)\r\n        x = self.fc6(x)\r\n\r\n        x = F.softmax(x)\r\n        return x\r\n', '\r\ndef test():\r\n    x = torch.randn((1, 18, 8, 8))\r\n    import gc\r\n    for i in range(10000000):\r\n        # gc.collect()\r\n        with torch.no_grad():\r\n            testmodel.forward(x)\r\n\r\n']"
361,31277,0,"nn.MultiHeadAttention with different similarity measures. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->

## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->

## Pitch

<!-- A clear and concise description of what you want to happen. -->

Current nn.MultiHeadAttention uses matrix multiplication similarity, i.e., (Q@K.t()), but variants of this similarity are not available directly, for example, 

dot product similarity, i.e., 
, 

additive similarity, 
, 

general dot product similarity, 
.

These variants should also be in PyTorch.


## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->

## Additional context

<!-- Add any other context or screenshots about the feature request here. -->


cc @zhangguanheng66. ['(Q*K.t())', '(Wq*Q.t() + Wk*K.t())', '(Q*W*K.t())']"
597,27626,0,"Cross entropy with sequence log_softmax not (almost) equal to 1. ## ‚ùì Is this a feature or a bug

When using the Cross entropy with K-target class in a sequence application, is it expected to squeeze before calling the loss or we are suppose to just past a vector of minibatch_size, sequence_length, K-tag ?

Because, in this line of code   the  step is giving me prob vector greater than 1 or not (almost) equal to 1. 
> After the exponantial application for sure.

Here an example of my situation, when 
. ['\r\ny_target = [0, 1, 1, 1, 1, 1, 1, 7, 3, 3, 4, 5]\r\n\r\ny_predict = tensor([[[-3.2910, -3.7040, -3.9663, -4.1059, -4.1012, -4.1368, -4.1158,\r\n              -4.2506, -4.3760, -4.1655, -3.7205, -2.8966],\r\n             [8.8342, 9.8005, 9.9371, 9.5386, 9.1664, 8.5789, 7.4153,\r\n              3.6922, 1.4415, -4.2969, -9.6262, -9.6677],\r\n             [4.8800, 3.9539, 3.4548, 3.2552, 3.2441, 3.1305, 3.0244,\r\n              3.4114, 2.4158, 0.8764, -1.0089, -1.9860],\r\n             [0.9770, 0.4299, 0.5240, 0.6457, 0.3984, 0.4953, 0.4214,\r\n              0.4627, 3.8482, 5.2386, 3.0858, 1.8424],\r\n             [-7.9146, -7.7125, -7.8830, -7.8319, -7.5219, -7.4129, -6.9861,\r\n              -5.2630, -5.4942, 1.5527, 8.9790, 4.6239],\r\n             [-11.0455, -10.9685, -10.4619, -9.8926, -9.7860, -9.2574, -8.6142,\r\n              -6.8966, -3.1693, -1.9010, 2.4475, 10.5265],\r\n             [3.2678, 3.2880, 3.1630, 3.0535, 3.2340, 3.1786, 3.6118,\r\n              3.5331, 1.1905, 0.1634, -0.8760, -2.4547],\r\n             [1.0813, 1.1683, 1.2462, 1.3132, 1.4225, 1.4196, 1.5218,\r\n              1.9667, 1.2652, 0.6920, -0.1019, -0.8134],\r\n             [0.9259, 1.0986, 1.2023, 1.2958, 1.3188, 1.3190, 1.3048,\r\n              1.1060, 1.0091, 0.1047, -0.7875, -0.9094]]])\r\n\r\nlog_softmax(y_predict, 1) # vector prob not (almost) equal to 1\r\nlog_softmax(y_predict, 2) # vector (almost) equal to 1\r\n']"
141,3652,0,"Fix far-fetched Boolean ambiguity for byte tensor with one value in it.. Testing non-empty tensor in an if statement will unconditionally raise a RuntimeError stating that ""bool value of non-empty torch.ByteTensor objects is ambiguous"". But when there's only one value, it's bool value is pretty straightforward.
What do you think?. []"
659,2344,0,"Does CosineEmbeddingLoss support CUDA tensors?. Noticed this as I tried to use the CosineEmbeddingLoss with a model copied to the GPU.



My default assumption is that I'm using cuda() wrong in some way. Thoughts?. ['\r\nimport torch\r\nfrom torch.autograd import Variable\r\nfrom torch.nn._functions.loss import CosineEmbeddingLoss\r\n\r\ninput1 = Variable(torch.rand(5,10))\r\ninput1 = input1.cuda()\r\n\r\ninput2 = Variable(torch.rand(5,10))\r\ninput2 = input2.cuda()\r\n\r\ny = Variable(torch.FloatTensor([1.0] * input1.size()[0]))\r\n\r\nloss = CosineEmbeddingLoss()\r\nloss(input1, input2, y)\r\n\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/_functions/loss.py"", line 41, in forward\r\n    torch.eq(y, -1, out=_idx)\r\nTypeError: torch.eq received an invalid combination of arguments - got (torch.FloatTensor, int, out=torch.cuda.ByteTensor), but expected one of:\r\n * (torch.FloatTensor tensor, float value, *, torch.FloatTensor out)\r\n      didn\'t match because some of the arguments have invalid types: (torch.FloatTensor, int, out=torch.cuda.ByteTensor)\r\n * (torch.FloatTensor tensor, torch.FloatTensor other, *, torch.FloatTensor out)\r\n      didn\'t match because some of the arguments have invalid types: (torch.FloatTensor, int, out=torch.cuda.ByteTensor)\r\n * (torch.FloatTensor tensor, float value, *, torch.ByteTensor out)\r\n      didn\'t match because some of the arguments have invalid types: (torch.FloatTensor, int, out=torch.cuda.ByteTensor)\r\n * (torch.FloatTensor tensor, torch.FloatTensor other, *, torch.ByteTensor out)\r\n      didn\'t match because some of the arguments have invalid types: (torch.FloatTensor, int, out=torch.cuda.ByteTensor)\r\n']"
401,20675,0,"Windows 10 CUDA 9 CUDNN 7.5 Pytorch 1.1 CUDNN_STATUS_EXECUTION_FAILED. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
Firstly I tested tensorflow-gpu 1.12, it works on CUDA GPU well. 
Then I followed pytorch tutorial to setup a simple CIFAR10 net, it works well on cpu. I tested cuda&cudnn is_available, both of them return True, however the gpu-enabled CIFAR10 net failed on gpu with exception CUDNN_STATUS_EXECUTION_FAILED.

Inputs is cudnn acceptable:  True
Traceback (most recent call last):
  File ""D:/Python/pytorch/tutorial/tut_4_classifier_gpu.py"", line 97, in <module>
    outputs = net(inputs)
  File ""D:\Python\Python36\lib\site-packages\torch\nn\modules\module.py"", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File ""D:/Python/pytorch/tutorial/tut_4_classifier_gpu.py"", line 62, in forward
    x = self.pool(F.relu(self.conv1(x)))
  File ""D:\Python\Python36\lib\site-packages\torch\nn\modules\module.py"", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File ""D:\Python\Python36\lib\site-packages\torch\nn\modules\conv.py"", line 320, in forward
    self.padding, self.dilation, self.groups)
RuntimeError: cuDNN error: CUDNN_STATUS_EXECUTION_FAILED
. []"
697,11751,0,"Segfault in autograd using hook. ## Issue description

I found several errors in autograd:
* Segfault during / when using hook (e.g. through ) on non-reachable tensor, whose grad is implicitely calculated () because it is an output of a function in the gradient graph but is independent of the backprop root tensor. (See code and traceback below.)
* No hook is called if this non-reachable tensor is an output of an index operation (e.g.  while root only depends on  and complete  has .) (See code below.) That issue is not related to the others, but I encountered it in the same run, so I want to mention it here, too.
* If such a hook is called (e.g.  from ), the  argument is  but should be a tensor with -values, because that is the actually used value for the required  and therefore should be modifiable. (See code below.)

Here is the traceback for the Segfault: (Notice the lines . But I think, the actual source of the problem is, that in [this](https://github.com/pytorch/pytorch/blob/6f6b03566ba3c4828f6ee87a772f9d161be0bae7/torch/csrc/autograd/engine.cpp#L447) line, the inputs are not but should be initialized as variables with -values, as fallbacks if no function overrides them. Or am I wrong?)

I really would like to fix this, but to be honest, I'm not sure if I have enough expertise to do it right. So I open this issue for others. I hope, it helps.

## Code example

a0grad = 0a1a0a.grada0grad = None= 0a1a0Segmentation faultgradNone0.backward().grad()


## System Info

- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): I tested two versions (same errors for both): current master from source, v0.4.1 via pip
- Build command you used (if compiling from source): 
- OS: Linux Mint 18.3 Sylvia
- PyTorch version:  I tested two versions (same errors for both): current master, v0.4.1
- Python version: 3.6.6
- CUDA/cuDNN version: None
- GPU models and configuration: No CUDA
- GCC version (if compiling from source): (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
- CMake version: version 3.12.0
- Versions of any other relevant libraries:
[pip] 18.0. ['\r\n## Traceback\r\n\r\n\r\n']"
409,8282,0,"Loaded network with load_state_dict has different shape but works anyway. After it was verified on [discuss.pytorch](https://discuss.pytorch.org/t/loaded-network-has-different-shape-but-works-anyway/19398) that this is indeed unwanted behaviour, I am forwarding this to you:

## Issue description

I trained a model with among others had the following layer:

and then saved it to a file with state_dict and torch.save.

Then, when I wanted to load that model using load_state_dict, by accident the same layer was setup as follows:


Nevertheless, the model was loaded without error. It seemed that the weights were just duplicated 32 times, but I have not verified. So the question is how this is consistent with API documentation. I have not found a statement that says load_state_dict would somehow fix shape inconsistencies automatically. It seems you have a documentation vs reality mismatch here. (Now you need to decide which one to fix)

## Code example



Provided by discuss .pytorch user ptrblck

## System Info
pytorch 0.4 release

. [""\r\npath = './test_model.pth'\r\n\r\nmodel = nn.Conv2d(64, 1, 3, 1, 1)\r\ntorch.save(model.state_dict(), path)\r\n\r\nmodel = nn.Conv2d(64, 32, 3, 1, 1)\r\nmodel.load_state_dict(torch.load(path))\r\n\r\nfor w in model.weight[:, :, 0, 0]:\r\n    print(w)\r\n""]"
260,19126,0,"weight_norm doesn't support eta and returns nan for zero weights. ## üêõ Bug

backprop on weights generated with torch._weight_norm that are zero filled yields nan gradients. I don't see a way to add an eta to the norm to prevent this.

## To Reproduce

Steps to reproduce the behavior:



I'm encountering nan's during backprop during training of a network with weight normalization. From this seemingly related thread it sounds like the advice is to add an eta to the norm, but in this case the norm is generated in pytorch's c++ implementation and I don't see an obvious way to do this.

## Expected behavior

I expect there to be a way to generate non-nan gradients for weight-norm weights that are zero filled

## Environment

 - PyTorch Version (e.g., 1.0): 1.0.0
 - OS (e.g., Linux): Mac and Centos
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source):
 - Python version: 3.6
 - CUDA/cuDNN version: None
 - GPU models and configuration: None
 - Any other relevant information:

## Additional context



cc @albanD @mruberry. ['\r\nw = torch.zeros(1, 3)\r\nv = w / w.norm()\r\ng = w.norm()\r\nv.requires_grad = True\r\ng.requires_grad = True\r\ntorch._weight_norm(v, g).matmul(torch.randn(3,1)).backward()\r\nv.grad\r\n> tensor([[nan, nan, nan]])\r\ng.grad\r\n> tensor(nan)\r\n']"
472,12127,0,"how to use the checkpoint function. I  try to use the checkpoint function,when I train,gpu keeps the memory but don't work  and the train progress don't work either(without any error print). How can I make the checkpoint function work.
. []"
382,31657,0,"Use of Sequence collections for abstract classes in Dataset. ## üöÄ Feature
Using the sequence (or any other similar Python abstract class) for the  class in order to tackle the note in lines 30-32 of :

def __len__(self)__len__

By using the  abstract classes, we can see in the official Python documentation that they have the exact abstract methods that the  class expects, i.e.  and .

## Motivation

My motivation is three-fold: (1) tackling the note mentioned above left by the PyTorch contributors, (2) let the code be auto-documented‚Äîsince accessing this code states explicitly that you need to define those two methods and, (3) using Python abstract classes instead of inheritting from object (which is a rather deprecated practice for when Python did not have abstract classes capabilities).

## Pitch

Implement the Dataset class using new Python abstract classes capabilities, or at least discuss about it.

## Alternatives

I currently do not have alternative proposals.

## Additional context

.


cc @SsnL. []"
342,23054,0,"ConcatDataset returns different error messages setting out of range plus index and minus index.. ## üêõ Bug

ConcatDataset returns different error messages setting out of range plus index and minus index. 

## To Reproduce

## Expected behavior
I think it's better that x[100] and x[-100] have the same error message.

My way to solve this is to chage [these lines](https://github.com/pytorch/pytorch/blob/master/torch/utils/data/dataset.py#L197-L200) like this.


## Environment
 - PyTorch Version (e.g., 1.0): 1.1.0
 - OS (e.g., Linux): Ubuntu 18.04
 - How you installed PyTorch (, , source): pip
 - Python version: Python 3.7.3
 - CUDA/cuDNN version: None
 - GPU models and configuration: None

. ['\r\n>>> import torch\r\n>>> from torch.utils import data\r\n>>> x=data.ConcatDataset((range(10),range(10)))\r\n>>> x[-100]\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/home/mueda/code/python/rc/doc/.venv/lib/python3.7/site-packages/torch/utils/data/dataset.py"", line 78, in __getitem__\r\n    raise ValueError(""absolute value of index should not exceed dataset length"")\r\nValueError: absolute value of index should not exceed dataset length\r\n>>> x[100]\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/home/mueda/code/python/rc/doc/.venv/lib/python3.7/site-packages/torch/utils/data/dataset.py"", line 85, in __getitem__\r\n    return self.datasets[dataset_idx][sample_idx]\r\nIndexError: list index out of range\r\n', '\r\n        if idx < 0:\r\n            idx = len(self) + idx\r\n        if not (0 <= idx < len(self)):\r\n            raise ValueError(""absolute value of index should not exceed dataset length"")\r\n']"
213,20855,0,"pytorch0.4 -> pytorch1.0.1 RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation. The code run well in pytorch  0.4 . But in pytorch1.0.1, I got the error  as following. How to locate the question and resolve it? Thanks very much.
 File ""G:/20190215-backup/bsandnielianToImage/optimizer_ExpAnglesplit_faceseg_splitBs_faceExpRecong.py"", line 215, in optimizer
    loss.backward()
  File ""E:\Program Files\Python35\lib\site-packages\torch\tensor.py"", line 102, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File ""E:\Program Files\Python35\lib\site-packages\torch\autograd\__init__.py"", line 90, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation. []"
278,15260,0,"MultiGPU for gru. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

During runtime of GRU under multi-GPU environment, there is a RuntimeError: Expected hidden size (3, 64, 12), got (3, 16, 12) where the first, second, and third arguments are the number of GRU layers, batch size and number of hidden units respectively. My model run well under single-GPU environment.

In Pytorch Forum, a question ""DataParallel LSTM/GRU wrong hidden batch size (8 GPUs)"" has been asked. One solution is to set batch_first to True for gru. But the error was still there after the setting. The correct solution is to store the hidden state inside the model rather than return it like the below code block(from user AnodyneCodeAsher Newcomer):




<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->
My wrong code sample:

Please help to fix this bug. Thanks a lot.

## Environment
 - PyTorch Version 1,0:
 - OS Ubuntu 16.04:
 - How you installed PyTorch:
 - Python version: 3.6
 - CUDA/cuDNN version: 9.0





cc @zou3519. ['python\r\nclass LSTM(nn.Module):\r\n    def __init__(self, initial_state):\r\n        super(LSTM, self).__init__()\r\n\r\n        self.lstm = nn.LSTM(\r\n            ...\r\n            batch_first=True)\r\n        self.hn = initial_state\r\n            \r\n    def forward(self, input):\r\n        output, hn = self.lstm(input, self.hn)\r\n        self.hn = hn\r\n        return output\r\n', 'python\r\nclass LSTM(nn.Module):\r\n    def __init__(self, initial_state):\r\n        super(LSTM, self).__init__()\r\n\r\n        self.lstm = nn.LSTM(\r\n            ...\r\n            batch_first=True)\r\n            \r\n    def forward(self, input, hidden):\r\n        output, hn = self.lstm(input, hidden)\r\n        return output, hn\r\n']"
724,14891,0,"Wrong recursive module::load. ## üêõ Bug

Parameters and buffers must be checked recursively during the load procedure [module.cpp#L297](https://github.com/pytorch/pytorch/blob/8311bbee7f1dd33346f18c769cfeb8c5b5941874/torch/csrc/api/src/nn/module.cpp#L297). 
For example, like this:
. []"
173,3293,0,"Tensor constructor passed numpy ndarray does not check type.. 

According to @colesbury, however, it does look like ndarray passed into Tensor is doing the correct codepath.

CC @aszlam. ['\r\n>>> torch.Tensor(numpy.ndarray(shape=(2,2),dtype=""int8""))\r\n\r\n 0.6229  0.0000\r\n 0.0000  0.0000\r\n[torch.FloatTensor of size 2x2]\r\n\r\n>>> torch.from_numpy(numpy.ndarray(shape=(2,2),dtype=""int8""))\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nRuntimeError: can\'t convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.\r\n']"
438,24568,0,"Migrate `ge` and `ge_` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
247,14365,0,"Assertion fails when using DataParallel with two nn.Embedding . ## üêõ Bug
I'm using the nightly build: 1.0.0.dev20181123. This issue is very similar to #13569 .  When I instantiate two nn.Embedding, with DataParallel and with max_norm=1.0, I get the following assert


If I remove the self.lut_dummy, the issue disappears. 

## To Reproduce


## Output
1.0.0.dev20181123
/home/software/LM_stash/amitoj/pytorch1.0/local/lib/python2.7/site-packages/torch/nn/parallel/data_parallel.py:25: UserWarning:
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 1. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(imbalance_warn.format(device_ids[min_pos], device_ids[max_pos]))
ok1
ok1
ok2
Traceback (most recent call last):
  File ""error_train.py"", line 25, in <module>
    main()
  File ""error_train.py"", line 22, in main
    output = model(src)
  File ""/home/software/LM_stash/amitoj/pytorch1.0/local/lib/python2.7/site-packages/torch/nn/modules/module.py"", line 479, in __call__
    result = self.forward(*input, **kwargs)
  File ""/home/software/LM_stash/amitoj/pytorch1.0/local/lib/python2.7/site-packages/torch/nn/parallel/data_parallel.py"", line 143, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File ""/home/software/LM_stash/amitoj/pytorch1.0/local/lib/python2.7/site-packages/torch/nn/parallel/data_parallel.py"", line 153, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File ""/home/software/LM_stash/amitoj/pytorch1.0/local/lib/python2.7/site-packages/torch/nn/parallel/parallel_apply.py"", line 83, in parallel_apply
    raise output
RuntimeError: output_nr_ == 0 ASSERT FAILED at /pytorch/torch/csrc/autograd/variable.cpp:196, please report a bug to PyTorch.

## Additional context
Observations
1. If I comment out the self.lut_dummy, the issue disappears. Though in my real model, I am using the .
2. If max_norm is removed, the issue disappears again.
3. If I set os.environ[""CUDA_VISIBLE_DEVICES""] to ""0"" or ""1"", again, the code works just fine.


cc @ezyang @gchanan @SsnL @albanD. ['\r\nRuntimeError: output_nr_ == 0 ASSERT FAILED at /pytorch/torch/csrc/autograd/variable.cpp:196, please report a bug to PyTorch.\r\n', '\r\nimport torch\r\nimport os\r\n\r\nprint torch.__version__\r\nclass Moda(torch.nn.Module):\r\n    def __init__(self):\r\n        super(Moda, self).__init__()\r\n        self.lut_dummy = torch.nn.Embedding(1, 1, max_norm=1.0).to(""cuda"")\r\n        self.lut_a = torch.nn.Embedding(22, 256, max_norm=1.0).to(""cuda"")\r\n\r\n    def forward(self, src):\r\n        print ""ok1""\r\n        ebd = self.lut_a(src)\r\n        print ""ok2""\r\n        return ebd\r\n\r\ndef main():\r\n    os.environ[\'CUDA_VISIBLE_DEVICES\'] = ""0,1""\r\n    model = Moda()\r\n    model = torch.nn.DataParallel(model)\r\n    src = torch.randint(4,(2,)).to(""cuda"")\r\n    output = model(src)\r\n\r\nif __name__ == \'__main__\':\r\n    main()\r\n']"
673,29293,0,"Using tensor cores. I would like to know if I build PyTorch on SM_70 or SM_75, will it automatically use tensor cores or I have to explicitly specify something during the compilation or before run.
Any comment?. []"
751,22697,0,"[docs] torch.lerp typo. ## üìö Documentation

https://pytorch.org/docs/master/torch.html#torch.lerp



Should probably be  must be broadcastable at the end.
. []"
635,16501,0,"[sparse sum] Sparse sum over dimmension gives unexpected results.. ## üêõ Bug

When summing over dimension 0 of tensor of 2 dimensions I'm getting a scalar, whereas summing over dimension -2 gives the correct answer. Is that expected?

## To Reproduce



## Expected behavior




## Environment


. [""\r\n    x = norm_adj = torch.tensor([[1., 0., 0., 1.],\r\n                                 [0., 1., 0., 0.],\r\n                                 [0., 1., 1., 0.],\r\n                                 [0., 1., 0., 2.]]).to_sparse()\r\n    print('RIGHT')\r\n    print(torch.sparse.sum(x,dim=-2))\r\n    print('WRONG')\r\n    print(torch.sparse.sum(x,dim=0))\r\n"", '\r\nRIGHT\r\ntensor(indices=tensor([[0, 1, 2, 3]]),\r\n       values=tensor([1., 3., 1., 3.]),\r\n       size=(4,), nnz=4, layout=torch.sparse_coo)\r\nWRONG\r\ntensor(8.)\r\n', '\r\nPyTorch version: 1.0.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: None\r\n\r\nOS: Mac OSX 10.14.2\r\nGCC version: Could not collect\r\nCMake version: Could not collect\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.15.4)\r\n[pip] torch (1.0.0)\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2018.0.3                      1  \r\n[conda] mkl_fft                   1.0.6            py37hb8a8100_0  \r\n[conda] mkl_random                1.0.1            py37h5d10147_1  \r\n[conda] pytorch                   1.0.0                   py3.7_1    pytorch\r\n']"
446,25171,0,"Relation between AVX and TH?. Hi, I'm studying PyTorch internals, especially trying to find AVX implementation. (not AVX2.)

I built PyTorch from source with

What I've figured out is the AVX intrinsic function that is called for simple tensor addition.


I debugged with gdb, and set some breakpoints and succeeded it. Below is the result of  at gdb.


The AVX intrinsic  is called at #0

Now, I'm trying to find if there exists AVX acceleration of CNN, so I've debugged really simple code at [PyTorch tutorial](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html#sphx-glr-beginner-blitz-cifar10-tutorial-py) with same procedure as above. But I cannot find any AVX implementation.

So now I'm wondering if I've missed some options when I built PyTorch. I've googled a lot, and looking inside the CMake system, I haven't figured it out yet.
One I noticed it is there are AVX.cpp in TH directory.

And after searching TH, I also noticed that I don't have libTH.so file. In [a blog in PyTorch homepage](https://pytorch.org/blog/a-tour-of-pytorch-internals-2/#backend-torch-and-vendor-libraries), there is libTH.so.1 at torch/lib. Below is my  result at that directory.


In addition, in [this blog](https://apaszke.github.io/torch-internals.html), there is ""simd"" directory in , but I don't have it. Is there anyone who can tell me about what I'm missing?



. ['bash\r\nDEBUG=1 NO_CUDA=1 python setup.py develop\r\n', 'python\r\nz = torch.add(x, y)\r\n', '\r\n#0 ~/pytorch/aten/src/ATen/cpu/vec256/vec256_double.h:203\r\n...\r\n#18 ~/pytorch/build/aten/src/ATen/native/cpu/BinaryOpsKernel.cpp.AVX.cpp:29\r\n...\r\n#20 ~/pytorch/aten/src/ATen/native/BinaryOps.cpp:41\r\n', 'bash\r\nuser@user:~/pytorch/torch/lib\r\nc10d         libcaffe2_detectron_ops.so        libfbgemm.a     libprotobuf-lited.a  libshm.so           pkgconfig\r\ncmake        libcaffe2_module_test_dynamic.so  libgloo.a       libprotocd.a         libshm_windows      python3.6\r\nlibasmjit.a  libcaffe2_observers.so            libmkldnn.a     libpthreadpool.a     libsleef.a\r\nlibc10d.a    libclog.a                         libnnpack.a     libqnnpack.a         libtorch_python.so\r\nlibc10.so    libcpuinfo.a                      libprotobufd.a  libshm               libtorch.so\r\n']"
467,5198,0,[feature request] support batch diag. Should be easy to implement. But we need to figure out a good name/API. We can't reuse  as it will be ambiguous when input is 2D.  sounds weird to me... []
6,26165,1,"Memory leak in multithreading environment when loading checkpoint. ## üêõ Bug

I have a problem when loading saved checkpoint for pytorch model in seperate thread. CPU memory keeps increasing and is never released.

Multi-threading version of script increases RAM usage with each iteration and ends with 978 RESV memory (htop output).
Single-threading version holds with 374 RESV memory (htop output).
When I randomly initialize model (without state_dict loading) both versions use the same (smaller) amount of memory.

## To Reproduce



## Expected behavior

I expect the RAM to be cleared as no reference is being held to created models.

## Additional info

I have traced the issue to  https://github.com/pytorch/pytorch/blob/33221b19acc3dcacb11c38fdbff65d9a6ce90866/torch/nn/modules/module.py#L775
Commenting out this line makes the multi-threading version behave as single-threading one.

## Environment

 - PyTorch Version: 1.2.0
 - OS: Ubuntu 18.04
 - How you installed PyTorch: pip
 - Python version: 3.5.7


cc @ezyang @gchanan @zou3519 @jerryzh168. ['\r\nimport torch\r\nimport time\r\nimport threading\r\nimport torchvision\r\n\r\ndef create_tensor(index):\r\n    print(""Create model {}"".format(index))\r\n    resnet50 = torchvision.models.resnet50(pretrained=True)\r\n    del resnet50\r\n\r\ndef create_tensor_thread(index):\r\n    x = threading.Thread(target=create_tensor, args=(index,))\r\n    x.start()\r\n    x.join()\r\n\r\ndef run(use_threading=False):\r\n    for index in range(5):\r\n        if use_threading:\r\n            #memory leak observed \r\n            create_tensor_thread(index) \r\n        else:\r\n            #no memory leak observed\r\n            create_tensor(index)\r\n        time.sleep(5)\r\n\r\nrun(True)\r\n']"
332,28938,0,"Cannot select version in the tutorials page. ## üìö Documentation

The documentation pages can be viewed for different versions using the [versions page](https://pytorch.org/docs/versions.html). However, when navigating to the ""Tutorials"", the versions cannot be selected. This is a problem for the experimental parts (s.a. quantization), as we update the tutorials in master, which cannot be viewed.. []"
586,27296,0,"document: torch.quantize_per_tensor and torch.quantize_per_channel. add quantized tensor creation functions on torch.tensor( ) documentation, add the torch.quantize_per_tensor() and torch.quantize_per_channel(). 


@raghuramank100 for visibility. []"
607,1228,0,"Import torch causes error. This might be relevant to #691. I have installed pytorch from source on Mac OS successfully, but  causes error:
> 
>
> ImportError                               Traceback (most recent call last)
> <ipython-input-1-c031d3dd82fc> in <module>()
> ----> 1 import torch
> 
> /Users/dqwang/Study/tools/anaconda2/lib/python2.7/site-packages/torch/__init__.pyc in <module>()
>      51 sys.setdlopenflags(_dl_flags.RTLD_GLOBAL | _dl_flags.RTLD_NOW)
>      52 
> ---> 53 from torch._C import *
>      54 
>      55 __all__ += [name for name in dir(_C)
> 
> ImportError: dlopen(/Users/dqwang/Study/tools/anaconda2/lib/python2.7/site-packages/torch/_C.so, 10): Symbol not found: __ZNSs4_Rep20_S_empty_rep_storageE
>   Referenced from: /Users/dqwang/Study/tools/anaconda2/lib/python2.7/site-packages/torch/_C.so
>   Expected in: flat namespace
>  in /Users/dqwang/Study/tools/anaconda2/lib/python2.7/site-packages/torch/_C.so
> 
The author of that thread got away with the issue by installing from conda package rather than source, which solved my case as well. But I have to install from the source because of I need CUDA.. []"
139,31410,0,"can't close torch.utils.tensorboard.SummaryWriter in __del__. The program can not exit (print 'closed') when I try to close the  in .

The program can exit if the  is not in .

Python 3.7.5

Pytorch 1.3.1

tensorboard 2.0.0

OS: Ubuntu and Win10. [""\r\nfrom torch.utils.tensorboard import SummaryWriter\r\n\r\n\r\nclass Test:\r\n    def __init__(self):\r\n        self.tblog = SummaryWriter('exp/tb/exit_test')\r\n        # self.tblog.close()\r\n\r\n    def __del__(self):\r\n        self.tblog.close()\r\n        print('closed')\r\n\r\n\r\nif __name__ == '__main__':\r\n    tblog = Test()\r\n""]"
54,24373,1,"torch.as_tensor is very slow. ## üêõ Bug
## To Reproduce

This code:

prints


I don't expect  to be 100x slower than .

## Environment


. ['\r\n\r\nimport time\r\nimport torch\r\nimport numpy as np\r\n\r\ndata = [np.random.rand(8, 800, 1333) > 0.5 for _ in range(2)]\r\ndtype_np = np.bool\r\ndtype_pt = torch.bool\r\n\r\ndef f1():\r\n    return np.asarray(data, dtype=dtype_np)\r\n\r\ndef f2():\r\n    return np.stack(data)\r\n\r\ndef f3():\r\n    return torch.as_tensor(data, dtype=dtype_pt)\r\n\r\ndef f4():\r\n    return torch.stack([torch.from_numpy(x) for x in data])\r\n\r\ndef benchmark(f, iter, warmup):\r\n    for k in range(warmup): f()\r\n    start = time.perf_counter()\r\n    for k in range(iter): f()\r\n    torch.cuda.synchronize()\r\n    return time.perf_counter() - start\r\n\r\nprint(benchmark(f1, 10, 1))\r\nprint(benchmark(f2, 10, 1))\r\nprint(benchmark(f3, 10, 1))\r\nprint(benchmark(f4, 10, 1))\r\n', '\r\n0.2839105408638716\r\n0.013459203764796257\r\n20.43221192806959\r\n0.012655530124902725\r\n', '\r\nPyTorch version: 1.2.0.dev20190805\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0\r\nCMake version: version 3.12.2\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: \r\nGPU 0: Quadro GP100\r\nGPU 1: Quadro GP100\r\n\r\nNvidia driver version: 410.79\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] msgpack-numpy==0.4.4.3\r\n[pip3] numpy==1.16.4\r\n[pip3] numpydoc==0.7.0\r\n[pip3] torch-nightly==1.2.0.dev20190805\r\n[pip3] torchvision==0.4.0a0+6c7189f\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.1                      144  \r\n[conda] mkl-include               2019.1                      144  \r\n[conda] mkl-service               1.1.2            py36he904b0f_5  \r\n[conda] mkl_fft                   1.0.6            py36hd81dba3_0  \r\n[conda] mkl_random                1.0.2            py36hd81dba3_0\r\n']"
25,25243,1,"load pretrained model(trained in torch0.4) and got nan loss in torch1.2. Is it possible to cause Nan loss in pytorch1.2 when i load pretrained model trained in pytorch0.4?
Because pytorch1.2 support sync-bn while pytorch0.4 does not.
I have tested just random init and did not load pretrained model and the nan loss did not appear. []"
542,30321,0,"dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib Referenced from: /usr/local/bin/sccache. All OS X builds are failing due to this https://app.circleci.com/jobs/github/pytorch/pytorch/3698524

CircleCI ticket: https://support.circleci.com/hc/en-us/requests/63093. []"
161,16392,0,"squeeze operation edge case . ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

I found an inconsistent behavior with 

> tensor.squeeze()

, it could be that it was intentional and if so, I can't understand the reason for it.

## To Reproduce

1 ) 



2) 



In the second example, I hoped to get


I'd be glad to know whether it was a bug, and if not, why.

Cheers!
Shiran. []"
471,2240,0,"Error building torch from source for python 2.7 on macOS. Hello,

Here is the error.
I'm running macOS 10.12.6 (16G29), python 2.7 on anaconda 3, CUDA 8.0.90, Apple LLVM version 8.0.0 (clang-800.0.42.1). I installed LLVM 8.0.0 specifically since it's the one listed on cuda docs.
I have successfully built pyTorch from source for python 3.6 on this computer before, so I'm clueless how this is happening.
I will just use python 3 for now. Hope this information is helpful to you.


. []"
672,24711,0,"Migrate `hardtanh_backward` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
592,2754,0,"ppc64le test_cuda.py failures. I am using ppc64 Ubuntu 16.04. 
I compiled pytorch version 0.2.0 and am running into some problems with test_cuda.py.
To isolate the failures I commented out some of the types and float_types like so:

types = [
\#    torch.FloatTensor,
\#    torch.DoubleTensor,
\#    torch.LongTensor,
\#    torch.IntTensor,
\#    torch.ShortTensor,
    torch.CharTensor,
\#    torch.ByteTensor,
]

float_types = [
   torch.FloatTensor,
\#   torch.DoubleTensor
]  # TODO: add half...

Then I run ""python test_cuda.py""
I get a bunch of these errors:
/opt/pytorch/torch/lib/THC/THCTensorTopK.cuh:431: void gatherTopK(TensorInfo<T, IndexType>, IndexType, IndexType, IndexType, IndexType, TensorInfo<T, IndexType>, IndexType, IndexType, TensorInfo<long, IndexType>, IndexType) [with T = char, IndexType = unsigned int, Dim = 3, Order = true]: block: [64,0,0], thread: [9,0,0] Assertion  failed.

the only difference in each line are the block and thread data 

I also get a bunch of these for different tests:

  ERROR: test_CharTensor_tril (__main__.TestCuda)

----------------------------------------------------------------------
Traceback (most recent call last):
  File ""mytest_cuda.py"", line 358, in tmp
    gpu_tensor = to_gpu(cpu_tensor)
  File ""/opt/pytorch/test/common.py"", line 89, in to_gpu
    return obj.clone().type(t)
  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/_utils.py"", line 35, in _type
    return new_type(self.size()).copy_(self, async)
RuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/pytorch/torch/lib/THC/generic/THCTensorCopy.c:18

all failing at the same THCTensorCopy.c:18

All these failures only happen with type = torch.CharTensor

here is output of nvidia-smi
\# nvidia-smi
Fri Sep 15 21:54:54 2017
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 384.66                 Driver Version: 384.66                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           Off  | 00000000:03:00.0 Off |                    0 |
| N/A   45C    P0    59W / 149W |    426MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           Off  | 00000000:04:00.0 Off |                    0 |
| N/A   30C    P8    30W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           Off  | 00000002:03:00.0 Off |                    0 |
| N/A   32C    P8    26W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           Off  | 00000002:04:00.0 Off |                    0 |
| N/A   25C    P8    29W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+

. []"
517,8388,0,"Running simultaneous DataParallels can potentially result in locked models. I observed that running simultaneous DataParallels might result in at least one of the models being unable to progress at all.



System configuration:
- PyTorch 0.4.0 stable release, installed using 
- EC2 P2.8xlarge (8 x K80s)
- CUDA 8
- Python 3.6



On a separate machine with 8 x Titan X, the following happened after I tried running multiple parallel models:


There's RAM that's somehow unaccounted for.. ['\r\nubuntu@ip-XXX:~/vrex2$ ./run.sh\r\nLoading data file...\r\nLoaded!\r\n^CTraceback (most recent call last):\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/runpy.py"", line 193, in _run_module_as_main\r\n    ""__main__"", mod_spec)\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/runpy.py"", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File ""/home/ubuntu/vrex2/utils/train.py"", line 121, in <module>\r\n    main()\r\n  File ""/home/ubuntu/vrex2/utils/train.py"", line 116, in main\r\n    train(config)\r\n  File ""/home/ubuntu/vrex2/utils/train.py"", line 69, in train\r\n    scores = model(model_in)\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py"", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py"", line 114, in forward\r\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py"", line 124, in parallel_apply\r\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py"", line 57, in parallel_apply\r\n    thread.join()\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/threading.py"", line 1056, in join\r\n    self._wait_for_tstate_lock()\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/threading.py"", line 1072, in _wait_for_tstate_lock\r\n    elif lock.acquire(block, timeout):\r\nKeyboardInterrupt\r\n^CException ignored in: <module \'threading\' from \'/home/ubuntu/anaconda3/lib/python3.6/threading.py\'>\r\nTraceback (most recent call last):\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/threading.py"", line 1294, in _shutdown\r\n    t.join()\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/threading.py"", line 1056, in join\r\n    self._wait_for_tstate_lock()\r\n  File ""/home/ubuntu/anaconda3/lib/python3.6/threading.py"", line 1072, in _wait_for_tstate_lock\r\n    elif lock.acquire(block, timeout):\r\nKeyboardInterrupt\r\n^C^C^C^C^C^C\r\n', '\r\nubuntu@ip-96-115-215-139:~/vrex2$ nvidia-smi\r\nTue Jun 12 18:35:36 2018       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 384.111                Driver Version: 384.111                   |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla K80           On   | 00000000:00:17.0 Off |                    0 |\r\n| N/A   83C    P0   127W / 149W |   1998MiB / 11439MiB |     67%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  Tesla K80           On   | 00000000:00:18.0 Off |                    0 |\r\n| N/A   67C    P0   130W / 149W |   1878MiB / 11439MiB |     61%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  Tesla K80           On   | 00000000:00:19.0 Off |                    0 |\r\n| N/A   77C    P0   124W / 149W |   1878MiB / 11439MiB |     61%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  Tesla K80           On   | 00000000:00:1A.0 Off |                    0 |\r\n| N/A   63C    P0   128W / 149W |   1878MiB / 11439MiB |     62%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   4  Tesla K80           On   | 00000000:00:1B.0 Off |                    0 |\r\n| N/A   79C    P0   123W / 149W |   1878MiB / 11439MiB |     60%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   5  Tesla K80           On   | 00000000:00:1C.0 Off |                    0 |\r\n| N/A   68C    P0   127W / 149W |   1878MiB / 11439MiB |     59%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   6  Tesla K80           On   | 00000000:00:1D.0 Off |                    0 |\r\n| N/A   75C    P0   112W / 149W |   1878MiB / 11439MiB |     60%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   7  Tesla K80           On   | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   62C    P0   135W / 149W |   1878MiB / 11439MiB |     61%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0     76810      C   python                                      1985MiB |\r\n|    1     76810      C   python                                      1865MiB |\r\n|    2     76810      C   python                                      1865MiB |\r\n|    3     76810      C   python                                      1865MiB |\r\n|    4     76810      C   python                                      1865MiB |\r\n|    5     76810      C   python                                      1865MiB |\r\n|    6     76810      C   python                                      1865MiB |\r\n|    7     76810      C   python                                      1865MiB |\r\n+-----------------------------------------------------------------------------+\r\n', '\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.39                 Driver Version: 375.39                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX TIT...  Off  | 0000:04:00.0     Off |                  N/A |\r\n| 22%   50C    P2    84W / 250W |   2550MiB / 12207MiB |    100%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX TIT...  Off  | 0000:05:00.0     Off |                  N/A |\r\n| 22%   41C    P2    67W / 250W |   2394MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX TIT...  Off  | 0000:08:00.0     Off |                  N/A |\r\n| 22%   40C    P2    67W / 250W |   2276MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX TIT...  Off  | 0000:09:00.0     Off |                  N/A |\r\n| 22%   42C    P2    67W / 250W |   2157MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   4  GeForce GTX TIT...  Off  | 0000:85:00.0     Off |                  N/A |\r\n| 22%   24C    P8    15W / 250W |   1973MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   5  GeForce GTX TIT...  Off  | 0000:86:00.0     Off |                  N/A |\r\n| 22%   23C    P8    15W / 250W |   1975MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   6  GeForce GTX TIT...  Off  | 0000:89:00.0     Off |                  N/A |\r\n| 22%   23C    P8    15W / 250W |   1973MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   7  GeForce GTX TIT...  Off  | 0000:8A:00.0     Off |                  N/A |\r\n| 22%   24C    P8    15W / 250W |   1973MiB / 12207MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\n|=============================================================================|\r\n|    0     20159    C   python                                         400MiB |\r\n|    1     31020    C   python                                         419MiB |\r\n|    2     31020    C   python                                         301MiB |\r\n|    3     31020    C   python                                         182MiB |\r\n+-----------------------------------------------------------------------------+\r\n']"
96,27094,0,"[jit] Document what types can be traced. Our  docs don't mention that  can be traced, nor that NamedTuples cannot be traced

cc @suo. []"
103,13618,0,"test_dist_broadcast_coalesced_nccl timeout on CI. ['\r\nNov 06 05:00:37 ======================================================================\r\nNov 06 05:00:37 ERROR: test_dist_broadcast_coalesced_nccl (__main__.DistributedDataParallelTest)\r\nNov 06 05:00:37 ----------------------------------------------------------------------\r\nNov 06 05:00:37 Traceback (most recent call last):\r\nNov 06 05:00:37   File ""test_c10d.py"", line 349, in wrapper\r\nNov 06 05:00:37     self._join_processes(fn)\r\nNov 06 05:00:37   File ""test_c10d.py"", line 395, in _join_processes\r\nNov 06 05:00:37     self._check_return_codes(elapsed_time)\r\nNov 06 05:00:37   File ""test_c10d.py"", line 405, in _check_return_codes\r\nNov 06 05:00:37     raise RuntimeError(\'Process {} terminated or timed out after {} seconds\'.format(i, elapsed_time))\r\nNov 06 05:00:37 RuntimeError: Process 0 terminated or timed out after 30.030466556549072 seconds\r\n']"
412,15328,0,"torch.gesv forward handles singleton dimension, but backward doesn't. ## üêõ Bug

I'm running in to an issue where  accepts a  right hand side (with an  left hand side) in the forward pass, but the backward pass will fail. Unsqueezing the right hand side to  and then squeezing the output gets me the same size output (), but the backward pass also works.

## To Reproduce



## Expected behavior

Either (a) torch.gesv should require  to have the trailing singleton dimension in the forward pass (e.g. be  or (b) the backward pass should work if  doesn't have the singleton dimension.

## Environment

Reproducible on  installed via conda.
. [""python\r\nimport torch\r\n\r\nA = torch.randn(5, 5, requires_grad=True)\r\nb = torch.randn(5, requires_grad=True)\r\n\r\nsolve = torch.gesv(b.unsqueeze(-1), A)[0].squeeze(-1) # Works\r\nsolve.sum().backward() # Works\r\n\r\nsolve2 = torch.gesv(b, A)[0] # Works\r\nsolve2.sum().backward() # Doesn't work\r\n"", 'python\r\nTraceback (most recent call last):\r\n  File ""gesv_bug.py"", line 10, in <module>\r\n    solve2.sum().backward() # Doesn\'t work\r\n  File ""/home/jrg365/anaconda3/lib/python3.6/site-packages/torch/tensor.py"", line 102, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph)\r\n  File ""/home/jrg365/anaconda3/lib/python3.6/site-packages/torch/autograd/__init__.py"", line 90, in backward\r\n    allow_unreachable=True)  # allow_unreachable flag\r\nRuntimeError: Function GesvBackward returned an invalid gradient at index 0 - got [5, 1] but expected shape compatible with [5]\r\n']"
437,26893,0,"onnx export: einsum not supported. ## üêõ Bug

Exporting models which use  in their  method does not work


## To Reproduce

This is a minimal example:


which gives 

s

cc @matthewfeickert @kratsg. ['\r\nimport torch\r\nclass MyModel(torch.nn.Module):\r\n    def __init__(self):\r\n        super(MyModel,self).__init__()\r\n\r\n    def forward(self, inputs):\r\n        return torch.einsum(\'i->i\',inputs)\r\n\r\nmodel = MyModel()\r\ntorch.onnx.export(\r\n    model,\r\n    torch.randn(1),\r\n    ""pyhf.onnx"",\r\n    verbose=True,\r\n    input_names=[\'input\'],\r\n    output_names=[\'output\']\r\n)\r\n', '\r\n\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Expected behavior\r\n\r\nI would expect this export to work\r\n\r\n## Environment\r\n\r\nMac OS X \r\n\r\n']"
596,17537,0,"Cannot initial from_blob from std::vector.data(). ## üêõ Bug


## To Reproduce




I end up getting giberrish tensor returned from this function. Once the function returns to Python
. ['\r\ntorch::Tensor some_function()\r\n{\r\n    std::vector<int> overall_indices;\r\n    // .... fill the vector\r\n    torch::TensorOptions opts(torch::kInt);\r\n    auto t = torch::from_blob(overall_indices.data(), {n, 3}, opts);\r\n    return t\r\n}\r\n', '\r\nsome_function()\r\n-> tensor([[         5,          0,          0],\r\n        [         0, 1040267192,          0],\r\n        [-966454432,      32681,          1],\r\n        [         4,          0,          0]]']"
124,19201,0,"How do I edit a .t7 file?. I currently have a .t7 file which contains some arrays and raw text, but i want to reduce the number of entries in there. How do I edit the file?

So far, I can only display the file's contents using
. []"
227,4387,0,"cannot allocate memory. the problem arise when run after 1epoch, but works well in first train epoch as well as the  followed 1st validate epoch. batch_size is 8 and work_number is 2„ÄÇwhy this happened ?
File ""/home/luhongchao/anaconda2/lib/python2.7/site-packages/torch/utils/data/dataload
er.py"", line 301, in __iter__
    return DataLoaderIter(self)
  File ""/home/luhongchao/anaconda2/lib/python2.7/site-packages/torch/utils/data/dataload
er.py"", line 158, in __init__
    w.start()
  File ""/home/luhongchao/anaconda2/lib/python2.7/multiprocessing/process.py"", line 130, 
in start
    self._popen = Popen(self)
  File ""/home/luhongchao/anaconda2/lib/python2.7/multiprocessing/forking.py"", line 121, 
in __init__
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory. []"
747,1738,0,"How do make batchnorm to maintain multiple pairs of running_mean and running_var?. Hi,

The current batchnorm implementation only has one pair of running_mean and running_var. However, some modules in the neural networks may be used twice or more in one network forward. Based on my experimental experience and also stated in paper https://arxiv.org/pdf/1603.09025.pdf , different running_mean and running_var should be computed for different iterations(or time steps). I have found in my experiments, for the same testing data, net.eval() performs much worse than net.train() (backward is turned off here). The only difference in this situation is different running_mean and running_var are used. So how to make the batchnorm to keep multiple running_mean and running_var and I can choose to use the first pair in the first iteration, the second pair in the second iteration, and so on?. []"
400,27769,0,"Nvidia cuda documentation link renders wrong. Some of our docs link to ""CUDA documentation"" render incorrectly:

![image](https://user-images.githubusercontent.com/5652049/66680833-414d2d00-ec26-11e9-8347-5da72167ccb5.png)


cc @ezyang @gchanan @zou3519. []"
312,30965,0,"JIT breaks with postponed annotations. Targetting the correct issue this time, sorry for the noise

## üêõ Bug

As per [PEP 563 (Postponed Evaluation of Annotations)](https://www.python.org/dev/peps/pep-0563), typing annotations are not automatically evaluated as definition time starting with python 3.7 when using .

The solution is to avoid using   directly in [](https://github.com/pytorch/pytorch/blob/master/torch/jit/_recursive.py#L74) but to call [](https://docs.python.org/3.7/library/typing.html#typing.get_type_hints__future__` call will also be correctly evaluated. Should I make a PR?

## Testcase



This fails with traceback



cc @suo. ['python\r\nfrom __future__ import annotations\r\nfrom typing_extensions import Final\r\nimport torch\r\nimport torch.jit\r\n\r\nclass ModuleWithFinal(torch.nn.Module):\r\n    const: Final[int]\r\n    def __init__(self, const):\r\n        super().__init__()\r\n        self.const = const\r\n        \r\nmod = ModuleWithFinal(0)\r\ntorch.jit.script(mod)\r\n', 'text\r\n  File ""testcase.py"", line 14, in <module>\r\n    torch.jit.script(mod)\r\n  File ""torch/jit/__init__.py"", line 1256, in script\r\n    return torch.jit._recursive.recursive_script(obj)\r\n  File ""torch/jit/_recursive.py"", line 534, in recursive_script\r\n    return create_script_module(nn_module, infer_methods_to_compile(nn_module))\r\n  File ""torch/jit/_recursive.py"", line 293, in create_script_module\r\n    concrete_type = concrete_type_store.get_or_create_concrete_type(nn_module)\r\n  File ""torch/jit/_recursive.py"", line 236, in get_or_create_concrete_type\r\n    concrete_type_builder = infer_concrete_type_builder(nn_module)\r\n  File ""torch/jit/_recursive.py"", line 131, in infer_concrete_type_builder\r\n    if torch._jit_internal.is_final(ann):\r\n  File ""torch/_jit_internal.py"", line 645, in is_final\r\n    return ann.__module__ == \'typing_extensions\' and \\\r\nAttributeError: \'str\' object has no attribute \'__module__\'\r\n']"
566,23826,0,[quantization] Enable quantization OSS tests. These weren't run before. In progress: https://github.com/pytorch/pytorch/pull/23718. []
518,17315,0,"Autograd inside hooks is disabled by default?. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

I was playing around  with the   and ""intermediate gradients"". And discovered strange behaviour (as for me).  Looks like by default  is disabled inside hooks (using  to extract intermediate gradients). But why? To avoid a kind of ""backward inside backward""?

## To Reproduce

### Plain hook works fine.


Output:


### Autograd inside hook fails.


Output:

Ok, it fails because  there is no  for . Looks like we need to turn on .

### Autograd inside hook with  seems to work fine.


Output:

Now it woks fine. In addition, outside of hooks with gradients it works as usual.

### Autograd outside of hooks works as expected.


Output:

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behaviour
I expected   to work as usual inside hooks ().
I am not sure is it a bug or smth. I'm just worrying, why does it behave in such way?
<!-- A clear and concise description of what you expected to happen. -->

## Environment
. [""python\r\nimport torch\r\n\r\n\r\ndef extract(V):\r\n    def hook(grad):\r\n        V.grad = grad\r\n    return hook\r\n\r\nX = torch.ones(5, requires_grad=True)\r\nV = X.pow(3)\r\nY = V.sum()\r\n\r\nV.register_hook(extract(V))\r\nY.backward()\r\n\r\nprint('X.grad:', X.grad)\r\nprint('V.grad:', V.grad)\r\n"", '\r\nX.grad: tensor([3., 3., 3., 3., 3.])\r\nV.grad: tensor([1., 1., 1., 1., 1.])\r\n', ""python\r\nimport torch\r\n\r\n\r\ndef extract_and_grad(V):\r\n    def hook(grad):\r\n        V.grad = grad\r\n        V.grad.requires_grad_(True)\r\n        print('V.grad:', V.grad)\r\n        U = V.grad.pow(2).sum()\r\n        print('U:', U)\r\n        try:\r\n            dU_dV_grad = torch.autograd.grad(U, V.grad)\r\n            print('V.grad.grad:', dU_dV_grad)\r\n        except RuntimeError as err:\r\n            print(err)\r\n    return hook\r\n\r\nX = torch.ones(5, requires_grad=True)\r\nV = X.pow(3)\r\nY = V.sum()\r\n\r\nV.register_hook(extract_and_grad(V))\r\nY.backward()\r\n"", '\r\nV.grad: tensor([1., 1., 1., 1., 1.], requires_grad=True)\r\nU: tensor(5.)\r\nelement 0 of tensors does not require grad and does not have a grad_fn\r\n', ""python\r\nimport torch\r\n\r\n\r\ndef extract_and_grad_v2(V):\r\n    def hook(grad):\r\n        V.grad = grad\r\n        V.grad.requires_grad_(True)\r\n        print('V.grad:', V.grad)\r\n        \r\n        with torch.enable_grad():\r\n            U = V.grad.pow(2).sum()\r\n            print('U:', U)\r\n        try:\r\n            dU_dV_grad, = torch.autograd.grad(U, V.grad)\r\n            print('V.grad.grad:', dU_dV_grad)\r\n        except RuntimeError as err:\r\n            print(err)\r\n    return hook\r\n\r\nX = torch.ones(5, requires_grad=True)\r\nV = X.pow(3)\r\nY = V.sum()\r\n\r\nV.register_hook(extract_and_grad_v2(V))\r\nY.backward()\r\n"", '\r\nV.grad: tensor([1., 1., 1., 1., 1.], requires_grad=True)\r\nU: tensor(5., grad_fn=<SumBackward0>)\r\nV.grad.grad: tensor([2., 2., 2., 2., 2.])\r\n', ""python\r\nimport torch\r\n\r\n\r\ndef extract(V):\r\n    def hook(grad):\r\n        V.grad = grad\r\n    return hook\r\n\r\nX = torch.ones(5, requires_grad=True)\r\nV = X.pow(3)\r\nY = V.sum()\r\n\r\nV.register_hook(extract(V))\r\nY.backward()\r\n\r\nV.grad.requires_grad_(True)\r\nprint('X.grad:', X.grad)\r\nprint('V.grad:', V.grad)\r\nU = V.grad.pow(2).sum()\r\nprint('U:', U)\r\ntry:\r\n    dU_dV_grad, = torch.autograd.grad(U, V.grad)\r\n    print('V.grad.grad:', dU_dV_grad)\r\nexcept RuntimeError as err:\r\n    print(err)\r\n"", '\r\nX.grad: tensor([3., 3., 3., 3., 3.])\r\nV.grad: tensor([1., 1., 1., 1., 1.], requires_grad=True)\r\nU: tensor(5., grad_fn=<SumBackward0>)\r\nV.grad.grad: tensor([2., 2., 2., 2., 2.])\r\n', '\r\nPyTorch version: 1.0.1.post2\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Linux Mint 19.1 Tessa\r\nGCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: GPU 0: GeForce GTX 970\r\nNvidia driver version: 410.78\r\ncuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.4.2\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.15.4\r\n[pip] torch==1.0.1.post2\r\n[pip] torchvision==0.2.1\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.1                      144  \r\n[conda] mkl_fft                   1.0.10           py36ha843d7b_0  \r\n[conda] mkl_random                1.0.2            py36hd81dba3_0  \r\n[conda] pytorch                   1.0.1           py3.6_cuda10.0.130_cudnn7.4.2_2    pytorch\r\n[conda] torchvision               0.2.1                      py_2    pytorch\r\n']"
275,7569,0,"[Caffe2]How to set lr_mult and decay_mult in Conv layer?. In facebookresearch/detectron, I see a conv layer is add by:

conv_rpn_fpn = model.Conv(
         bl_in,
         'conv_rpn_fpn' + slvl,
         dim_in,
         dim_out,
         kernel=3,
         pad=1,
         stride=1,
         weight_init=gauss_fill(0.01),
         bias_init=const_fill(0.0)
 )

However, I don't find any parameter statement about lr_mult and decay_mult like that in a caffe conv layer. Could you please give me an example? Thanks a lot!







If you have a question or would like help and support, please ask at our
[forums](https://discuss.pytorch.org/).

If you are submitting a feature request, please preface the title with [feature request].
If you are submitting a bug report, please fill in the following details.

## Issue description

Provide a short description.

## Code example

Please try to provide a minimal example to repro the bug.
Error messages and stack traces are also helpful.

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


- PyTorch or Caffe2:
- How you installed PyTorch (conda, pip, source):
- Build command you used (if compiling from source):
- OS:
- PyTorch version:
- Python version:
- CUDA/cuDNN version:
- GPU models and configuration:
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
305,7343,0,"[memory leak] [PyTorch] .backward(create_graph=True). 

leaks with  but not with .

Discovered when running code in #7270 

cc @ezyang @albanD @zou3519 @gqchen @pearu @nikitaved. [""python\r\n>>> import torch\r\n>>> import gc\r\n>>> _ = torch.randn(1, device='cuda')\r\n>>> del _\r\n>>> torch.cuda.synchronize()\r\n>>> gc.collect()\r\n0\r\n>>> print(torch.cuda.memory_allocated())\r\n865280\r\n>>> x = torch.randn(1, device='cuda', requires_grad=True)\r\n>>> y = x.tanh()\r\n>>> y.backward(torch.ones_like(y), create_graph=True)\r\n>>> del x, y\r\n>>> torch.cuda.synchronize()\r\n>>> gc.collect()\r\n0\r\n>>> print(torch.cuda.memory_allocated())\r\n867328\r\n""]"
286,28323,0,"[quantization] fix the seed for hypothesis in CI. Currently the hypothesis is semi-random on CI. We need to fix the seed to something constant.

cc @jerryzh168 @jianyuh @dzhulgakov @raghuramank100. []"
293,6998,0,"[pytorch] Not handling python reload properly. Trying to reload some modules cause crashes:

On python 2.7 (crash with ubuntu release, error messages from debug build).

type->tp_flags & (1L<<9)' failed.
Aborted (core dumped)

>>> from torch import autograd
>>> reload(autograd)
terminate called after throwing an instance of 'std::runtime_error'
  what():  generic_type: cannot initialize type ""ProfilerEvent"": an object with that name is already defined
Aborted (core dumped)
`

@colesbury can you see an obvious reason for this? Or should I look into more details?. ['\r\n\r\n']"
87,19407,1,"torch.max slow for some inputs. ## Issue description

It seems that  can be quite slow depending on input. For example, sorting a tensor before calling  can make it miserably slow. Note that this issue exists even for non-pathological cases where input is not fully sorted. This was originally observed in my beam search implementation that seemed to run faster than greedy decoding at times.

## Code example

Here is a minimal example highlighting the issue. It's framed in terms of a greedy decoding algorithm:



The following are timing results from a number of different GPU configurations. Note that when the input to  is sorted it is always slower than , otherwise it is faster. The speed difference is definitely architecture dependent. Additionally,  is much more stable in terms of speed regardless of sorting.

Timings for a Titan X Pascal:


Timings for a 1080ti:


And finally timings when running on Google Colab (Tesla T4):


## System Info
This is from the Google Colab system:

. [""python\r\nfrom collections import namedtuple\r\nfrom types import SimpleNamespace\r\nimport time\r\n\r\nimport torch\r\n\r\nHypothesis = namedtuple('Hypothesis', ['sequence', 'score'])\r\n\r\nSOS = 1\r\nSPAN = 1\r\nBEAM_WIDTH = 1\r\nMAX_SEQ_LEN = 23\r\nBATCH_SIZE = 1000\r\nVOCAB_SIZE = 37000\r\nBEAMS = [\r\n    SimpleNamespace(hypotheses=[Hypothesis([SOS], 0.) for _ in range(BEAM_WIDTH)])\r\n    for _ in range(BATCH_SIZE)\r\n]\r\n\r\ndef update_greedy(scores, indices, beam, batch_idx):\r\n    ''' Update a particular beam in a greedy fashion '''\r\n    new_hypotheses = []\r\n    for hypothesis in beam.hypotheses:\r\n        new_score = hypothesis.score + scores[batch_idx]\r\n        new_sequence = hypothesis.sequence + indices[batch_idx].tolist()\r\n        new_hypotheses.append(Hypothesis(new_sequence, new_score))\r\n\r\n    beam.hypotheses = new_hypotheses\r\n\r\ndef update_beams(log_prob, beams, use_max=True):\r\n    ''' Update the beam batch '''\r\n    if use_max:\r\n        # originally max was used when BEAM_WIDTH == 1\r\n        scores, indices = torch.max(log_prob, 1)\r\n    else:\r\n        scores, indices = torch.topk(log_prob, 1, 1)\r\n        scores, indices = scores[:, 0], indices[:, 0]\r\n\r\n    for idx, beam in enumerate(beams):\r\n        update_greedy(scores, indices, beam, idx)\r\n        # If BEAM_WIDTH > 1 use different update approach\r\n\r\nfor sort in (True, False):\r\n  print(f'******sorting={sort}******')\r\n  for name, k, dim in [('batch', BATCH_SIZE, 0), ('vocab', VOCAB_SIZE, 1), ('span', SPAN, 2)]:\r\n    max_time = 0.\r\n    topk_time = 0.\r\n    for _ in range(MAX_SEQ_LEN):\r\n      log_prob = torch.rand(BATCH_SIZE, VOCAB_SIZE, SPAN).cuda()\r\n      if sort:\r\n        log_prob, _ = torch.topk(log_prob, k, dim, sorted=True)\r\n      start = time.time()\r\n      update_beams(log_prob, BEAMS, use_max=True)\r\n      max_time += time.time() - start\r\n\r\n      start = time.time()\r\n      update_beams(log_prob, BEAMS, use_max=False)\r\n      topk_time += time.time() - start\r\n\r\n    print(f'{name} dim: max={max_time / MAX_SEQ_LEN:.3f}s, topk={topk_time / MAX_SEQ_LEN:.3f}s')\r\n"", '\r\n******sorting=True******\r\nbatch dim: max=0.189s, topk=0.058s\r\nvocab dim: max=0.081s, topk=0.070s\r\nspan dim: max=0.262s, topk=0.075s\r\n\r\n******sorting=False******\r\nbatch dim: max=0.060s, topk=0.063s\r\nvocab dim: max=0.065s, topk=0.071s\r\nspan dim: max=0.069s, topk=0.073s\r\n', '\r\n******sorting=True******\r\nbatch dim: max=0.075s, topk=0.040s\r\nvocab dim: max=0.049s, topk=0.042s\r\nspan dim: max=0.150s, topk=0.043s\r\n\r\n******sorting=False******\r\nbatch dim: max=0.043s, topk=0.045s\r\nvocab dim: max=0.044s, topk=0.046s\r\nspan dim: max=0.045s, topk=0.047s\r\n', '\r\n******sorting=True******\r\nbatch dim: max=0.101s, topk=0.045s\r\nvocab dim: max=0.059s, topk=0.048s\r\nspan dim: max=0.214s, topk=0.050s\r\n\r\n******sorting=False******\r\nbatch dim: max=0.051s, topk=0.058s\r\nvocab dim: max=0.056s, topk=0.064s\r\nspan dim: max=0.055s, topk=0.063s\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0\r\nCMake version: version 3.12.0\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: GPU 0: Tesla T4\r\nNvidia driver version: 410.79\r\ncuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.5.0\r\n\r\nVersions of relevant libraries:\r\n[pip3] msgpack-numpy==0.4.3.2\r\n[pip3] numpy==1.16.2\r\n[pip3] torch==1.0.1.post2\r\n[pip3] torchsummary==1.5.1\r\n[pip3] torchtext==0.3.1\r\n[pip3] torchvision==0.2.2.post3\r\n[conda] Could not collect\r\n']"
133,11737,0,"torch.utils.cpp_extension.load doesn't change device after moving the model. ## Issue description
After using torch.utils.cpp_extension.load, returned module always puts tensors at GPU 0 ('cuda:0')
It causes problems when model is moved to another GPU. 
In my example I used code from https://github.com/mapillary/inplace_abn
See also mapillary/inplace_abn#52

## Code example

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).
PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 8.0.61

OS: Ubuntu 16.04.4 LTS
GCC version: (Ubuntu 4.9.4-2ubuntu1~16.04) 4.9.4
CMake version: version 3.12.0

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: 
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti
GPU 2: GeForce GTX 1080 Ti
GPU 3: GeForce GTX 1080 Ti

Nvidia driver version: 384.130
cuDNN version: Probably one of the following:
/usr/local/cuda-8.0/lib64/libcudnn.so
/usr/local/cuda-8.0/lib64/libcudnn.so.6
/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21
/usr/local/cuda-8.0/lib64/libcudnn_static.a
/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0/lib64/libcudnn_static.a
. ['\r\n""""""\r\nexample from https://github.com/MorvanZhou/PyTorch-Tutorial/blob/master/tutorial-contents/502_GPU.py\r\nDependencies:\r\ntorch: 0.4\r\ntorchvision\r\n""""""\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.utils.data as Data\r\nimport torchvision\r\n\r\nfrom modules.bn import InPlaceABN \r\n\r\n#===================================#\r\n# Change to cuda:0 to make it work  #\r\ndevice = torch.device(\'cuda:1\')     #\r\nprint(device)                       #\r\n#===================================#\r\n\r\nEPOCH = 1\r\nBATCH_SIZE = 50\r\nLR = 0.001\r\nDOWNLOAD_MNIST = True\r\n\r\ntrain_data = torchvision.datasets.MNIST(root=\'./mnist/\', train=True, transform=torchvision.transforms.ToTensor(), download=DOWNLOAD_MNIST,)\r\ntrain_loader = Data.DataLoader(dataset=train_data, batch_size=BATCH_SIZE, shuffle=True)\r\n\r\n\r\nclass CNN(nn.Module):\r\n    def __init__(self):\r\n        super(CNN, self).__init__()\r\n        self.conv1 = nn.Sequential(nn.Conv2d(in_channels=1, out_channels=16, kernel_size=5, stride=1, padding=2,),\r\n                                   nn.ReLU(), nn.MaxPool2d(kernel_size=2),)\r\n        self.conv2 = nn.Sequential(nn.Conv2d(16, 32, 5, 1, 2), nn.ReLU(), nn.MaxPool2d(2),)\r\n        \r\n        self.bn = InPlaceABN(32)\r\n        self.out = nn.Linear(32 * 7 * 7, 10)\r\n\r\n    def forward(self, x):\r\n        x = self.conv1(x)\r\n        x = self.conv2(x)\r\n        x = self.bn(x)\r\n        x = x.view(x.size(0), -1)\r\n        output = self.out(x)\r\n        return output\r\n\r\ncnn = CNN()\r\n\r\ncnn.to(device)      # Moves all model parameters and buffers to the GPU\r\n\r\noptimizer = torch.optim.Adam(cnn.parameters(), lr=LR)\r\nloss_func = nn.CrossEntropyLoss().cuda(device)\r\n\r\nfor epoch in range(EPOCH):\r\n    for step, (x, y) in enumerate(train_loader):\r\n        \r\n        b_x = x.to(device)     # Tensor on GPU\r\n        b_y = y.to(device)     # Tensor on GPU\r\n        \r\n        # This is where error happens\r\n        output = cnn(b_x)\r\n        loss = loss_func(output, b_y)\r\n        optimizer.zero_grad()\r\n        loss.backward()\r\n        optimizer.step()\r\n\r\n        if step % 50 == 0:\r\n            print(""Test passed"")\r\n            break\r\n\r\n\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-2-c7d32883c675> in <module>()\r\n     60         b_y = y.to(device)     # Tensor on GPU\r\n     61 \r\n---> 62         output = cnn(b_x)\r\n     63         loss = loss_func(output, b_y)\r\n     64         optimizer.zero_grad()\r\n\r\n~/torch-py3/lib/python3.5/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             result = self._slow_forward(*input, **kwargs)\r\n    490         else:\r\n--> 491             result = self.forward(*input, **kwargs)\r\n    492         for hook in self._forward_hooks.values():\r\n    493             hook_result = hook(self, input, result)\r\n\r\n<ipython-input-2-c7d32883c675> in forward(self, x)\r\n     41         x = self.conv1(x)\r\n     42         x = self.conv2(x)\r\n---> 43         x = self.bn(x)\r\n     44         x = x.view(x.size(0), -1)\r\n     45         output = self.out(x)\r\n\r\n~/torch-py3/lib/python3.5/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             result = self._slow_forward(*input, **kwargs)\r\n    490         else:\r\n--> 491             result = self.forward(*input, **kwargs)\r\n    492         for hook in self._forward_hooks.values():\r\n    493             hook_result = hook(self, input, result)\r\n\r\n~/kaggle_salt/modules/bn.py in forward(self, x)\r\n    106     def forward(self, x):\r\n    107         return inplace_abn(x, self.weight, self.bias, self.running_mean, self.running_var,\r\n--> 108                            self.training, self.momentum, self.eps, self.activation, self.slope)\r\n    109 \r\n    110 \r\n\r\n~/kaggle_salt/modules/functions.py in forward(ctx, x, weight, bias, running_mean, running_var, training, momentum, eps, activation, slope)\r\n     97 \r\n     98             # Update running stats\r\n---> 99             running_mean.mul_((1 - ctx.momentum)).add_(ctx.momentum * mean)\r\n    100             running_var.mul_((1 - ctx.momentum)).add_(ctx.momentum * var * count / (count - 1))\r\n    101 \r\n\r\nRuntimeError: arguments are located on different GPUs at /pytorch/aten/src/THC/generated/../generic/THCTensorMathPointwise.cu:233\r\n']"
407,3001,0,"Trying to do advanced indexing using a Variable causes a hang. **Minimal test case:**

    import torch
    x = torch.autograd.Variable(torch.FloatTensor([[0.1, 0.2], [0.3, 0.4]]))
    idx = torch.autograd.Variable(torch.LongTensor([1, 0]))
    print(x[idx, :])

**Expected output:**

Either:

    Variable containing:
     0.3000  0.4000
     0.1000  0.2000
    [torch.FloatTensor of size 2x2]

(the above is what is printed if I replace the last line with )

...or an immediate exception traceback informing me that advanced indices must be a  and not a .

**Actual output:**

The program initially hangs. *After* I interrupt the program with ^C, the following exception is displayed:

    Traceback (most recent call last):
      File ""loop.py"", line 5, in <module>
        print(x[idx, :])
      File ""/home/.../lib/python3.5/site-packages/torch/autograd/variable.py"", line 76, in __getitem__
        return Index.apply(self, key)
      File ""/home/.../lib/python3.5/site-packages/torch/autograd/_functions/tensor.py"", line 16, in forward
        result = i.index(ctx.index)
    IndexError: When performing advanced indexing the indexing objects must be LongTensors or convertible to LongTensors

**More details:**

From some digging around in pdb, it looked like [](https://github.com/pytorch/pytorch/blob/master/torch/autograd/variable.py#L78) was tail-calling itself via C code. While I couldn't identify the full stack, it looks like it eventually made its way to [this attempt to convert the  index to a ](https://github.com/pytorch/pytorch/blob/master/torch/csrc/generic/Tensor.cpp#L785). Sure enough, this also hangs:

    torch.LongTensor(idx)

Perhaps the  constructor is trying to treat the  as a iterable, and getting stuck because iterating through a  returns a sequence of ? (Happy to dig further, if someone can point me to the logic for initializing a .)

Python 3.5.2, GCC 5.4.0 on Linux,  = '0.2.0_3', no CUDA. []"
31,20146,1,"CPU Memory leak when using weight_decay in libtorch. ## Bug
When using weight_decay in libtorch, CPU Memory usage is slowly increasing.

## To Reproduce
I used docker container ""nvidia/cuda:9.2-cudnn7-devel-ubuntu18.04"", stable libtorch(1.1) for cuda9.0. This phenomenon can be reproduced using the mnist example in the pytorch/example repository.

rewrite examples/cpp/mnist/mnist.cpp l.148



Because the speed of increase is very slow, it may be better to increase the number of epochs. This happens with both CPU learning and GPU learning.

## Environment
- OS: Ubuntu 18.04.2 LTS
- GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
- CMake version: version 3.10.2
- CUDA runtime version: 9.2.148
- GPU models and configuration: GPU 0: GeForce RTX 2080 Ti
- Nvidia driver version: 410.104
- cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.4.1

## Additional context
This phenomenon happens also in cuda10.0 and libtorch nightly build for cuda10.0.. ['cpp\r\n- model.parameters(), torch::optim::SGDOptions(0.01).momentum(0.5));\r\n+ model.parameters(), torch::optim::SGDOptions(0.01).momentum(0.5).weight_decay(1e-4));\r\n']"
62,22866,1,"High CPU usage by torch.Tensor. ## üêõ Bug

Pytorch >= 1.0.1 uses a lot of CPU cores for making tensor from numpy array if numpy array was processed by np.transpose. The bug is not appears on pytorch 1.0.0. Nightly build has the same bug.

## To Reproduce

Steps to reproduce the behavior:

1. Install Pytorch >= 1.0.1
2. Run following code 

3. Open htop and enjoy 2500% CPU utilization by the process that is running the code.


This code (without np.transpose) works just fine - not more than 100% CPU utilization


Same abnormal behavior with torch.permute if you call it before tensor.cuda().


torch.permute after tensor.cuda() works just fine  - not more than 100% CPU utilization


## Expected behavior

I'm expecting utilization not more than 100%. 

## Environment



## Additional context

I've tried the same code on other server. On this server CPU usage is not increased so drastically but still shows 200% utilization with np.transpose and not more than 100% without.
. ['\r\nimport torch \r\nimport numpy as np\r\ndef preprocessing(batch, transpose=True):\r\n    if transpose:\r\n        batch = batch.transpose(0, 3, 1, 2)\r\n    return batch\r\n\r\nfor i in range(1000):\r\n    a = np.random.rand(8, 224, 224, 3)\r\n    a = preprocessing(a, transpose=True)\r\n    a = a.astype(np.float32)\r\n    a = torch.Tensor(a)\r\n    a = a.cuda()\r\n', '\r\nfor i in range(1000):\r\n    a = np.random.rand(8, 224, 224, 3).astype(np.float32)\r\n    a = preprocessing(a, transpose=False)\r\n    a = a.astype(np.float32)\r\n    a = torch.Tensor(a)\r\n    a = a.cuda()\r\n', '\r\nfor i in range(1000):\r\n    a = np.random.rand(8, 224, 224, 3).astype(np.float32)\r\n    a = preprocessing(a, transpose=False)\r\n    a = a.astype(np.float32)\r\n    a = torch.Tensor(a)\r\n    a = a.permute((0, 3, 1, 2))\r\n    a = a.cuda()\r\n', '\r\nfor i in range(1000):\r\n    a = np.random.rand(8, 224, 224, 3).astype(np.float32)\r\n    a = preprocessing(a, transpose=False)\r\n    a = a.astype(np.float32)\r\n    a = torch.Tensor(a)\r\n    a = a.cuda()\r\n    a = a.permute((0, 3, 1, 2))\r\n', '\r\nPyTorch version: 1.0.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration: \r\nGPU 0: TITAN RTX\r\n\r\nNvidia driver version: 418.39\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-10.0/targets/x86_64-linux/lib/libcudnn.so.7\r\n/usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudnn.so.7.5.0\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.15.1\r\n[pip3] torch==1.0.1\r\n[pip3] torchvision==0.2.1\r\n[conda] Could not collect\r\n']"
253,25775,0,"mean/sum(dtype) arg matching gives bad error message with positional dtype arg. ## üêõ Bug

 is broken yet  works. The error message is confusing as well.

![Screenshot 2019-09-06 11 11 08](https://user-images.githubusercontent.com/5674597/64439027-1efc4880-d097-11e9-8c00-eb420962d78e.png)
. []"
375,3542,0,"Minor: docker build fails on submodule because of gitdir with absolute path name (problem with git v 2.7/2.8, fixed in git v 2.9). error message is 

Reason:  pytorch was cloned with --recursive (as recommended) into   and the submodule stores in file 

the absolute pathname as

But when 
 
is run to copy  everything into  the absolute pathname won't match - hence the error.

This is apparently a know problem in git, see https://lwn.net/Articles/691223/  and fixed in v 2.9 
So may be you can just put a note on the page telling people about this to save them time. 
. [""\r\nRemoving intermediate container dee615013001\r\nStep 9/14 : COPY . .\r\n ---> 489276daed51\r\nStep 10/14 : RUN git submodule update --init\r\n ---> Running in ca195ce4b458\r\nfatal: Not a git repository: /data/work/Git/pytorch/.git/modules/torch/lib/gloo\r\nUnable to find current revision in submodule path 'torch/lib/gloo'                                      \r\nThe command '/bin/sh -c git submodule update --init' returned a non-zero code: 1\r\n"", '/data/work/Git/', '/data/work/Git/pytorch/.git/modules/torch/lib/gloo/.git', '\r\ngitdir: /data/work/Git/pytorch/.git/modules/torch/lib/gloo\r\n', '\r\nCOPY . . \r\n', '/opt']"
618,30986,0,"Wrong result for CPU implementation (m,).addmv((m, 0), (0,)) when BLAS is not used. ## üêõ Bug



gives



To be fixed in https://github.com/pytorch/pytorch/pull/30898. [""python\r\nimport torch\r\n\r\ndef run(dtype):\r\n    a = torch.ones((5,), device='cpu', dtype=dtype)\r\n    b = torch.empty((5, 0), device='cpu', dtype=dtype)\r\n    c = torch.empty((0,), device='cpu', dtype=dtype)\r\n    print(a.addmv(b, c, alpha=1, beta=3))\r\n\r\nrun(torch.float)\r\nrun(torch.int)\r\n"", '\r\ntensor([3., 3., 3., 3., 3.])\r\ntensor([9, 9, 9, 9, 9], dtype=torch.int32)\r\n']"
263,31300,0,"torch runtime error when manual link libmkldnn.so. ## üêõ Bug

I manual link libmkldnn.so, because I want to use some functions inside mkldnn, but pytorch get runtime error when I manual link libmkldnn.so

## To Reproduce

Steps to reproduce the behavior:


get runtime error


## Expected behavior

No runtime error

## Environment
PyTorch version: 1.3.0
Is debug build: No
CUDA used to build PyTorch: 10.1.243

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.17.3
[pip3] torch==1.3.0
[pip3] torchvision==0.4.1
[conda] Could not collect


cc @gujinghui @PenghuiCheng @XiaobingSuper @jianyuh. ['\r\nimport ctypes, os\r\n\r\nmkl_lib_name=""MY_MKL_PATH/lib/libmkldnn.so""\r\ndlopen_flags = os.RTLD_NOW | os.RTLD_GLOBAL # | os.RTLD_DEEPBIND\r\nctypes.CDLL(mkl_lib_name, dlopen_flags)\r\n\r\nnchw = [2, 3, 100, 100]\r\noihw = [4, 3, 5, 5]\r\n\r\nimport torch\r\nm = torch.nn.Conv2d(3, 4, 5, 1, 2)\r\nm(torch.rand(*nchw))\r\n', '\r\nTraceback (most recent call last):\r\n  File ""a.py"", line 13, in <module>\r\n    m(torch.rand(*nchw))\r\n  File ""/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py"", line 541, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/usr/local/lib/python3.7/dist-packages/torch/nn/modules/conv.py"", line 345, in forward\r\n    return self.conv2d_forward(input, self.weight)\r\n  File ""/usr/local/lib/python3.7/dist-packages/torch/nn/modules/conv.py"", line 342, in conv2d_forward\r\n    self.padding, self.dilation, self.groups)\r\nRuntimeError: std::exception\r\n']"
264,28249,0,"Add scopes to autograd profiler. ## üöÄ Feature

Add scopes within a torchscript model so you can get profile information per scope for both the forward and backward pass.

## Motivation

For distributed execution (model parallelism) we want to be able to measure the exact CPU time spent on different parts of a torchscript module so we can shard the model in a reasonable manner to different machines. We have high level ""components"" that represent shardable units of execution and want to use the autograd profiler to profile per component.

## Pitch

We want to add two custom methods into torch so we can describe the scope. Making them in C++ allows us to use them in torchscript as well in python.

TorchScript pseudocode


Python Sugar


These methods would add scope information to RecordFunction and thus provide it to the autograd Profiler. https://github.com/pytorch/pytorch/blob/master/torch/csrc/autograd/record_function.h

The current RECORD_FUNCTION implementation appears to track the lineage from backwards functions to the forward pass via sequence_nr so it should be easy to walk the RecordFunction tree and extract scope information. https://github.com/pytorch/pytorch/blob/master/torch/csrc/autograd/function.h#L104-L116 https://github.com/pytorch/pytorch/blob/master/tools/autograd/gen_variable_type.py#L238

One notable thing is that sequence_nr is currently thread_local. From what I've heard, the autograd/backward pass can be multithreaded and thus we will likely need to extend sequence_nr to include a thread ID as well as the current thread_local sequence_nr.

## Alternatives

There's ways to do this when running in the python environment w/ register_backward_hook + a custom nn.Module however there's no equivalent way to do this with torchscript since it doesn't support register_backward_hook. The autograd backward pass can also run multithreaded from my understanding so that would break that approach anyways.. ['py\r\ndef forward(self, x):\r\n  handle = torch._profiler_scope_enter(""foo"")\r\n  x = torch.relu(x)\r\n  ...\r\n  torch._profiler_scope_exit(handle)\r\n  return x\r\n', 'py\r\ndef forward(self, x):\r\n  with profiler.scope(""foo""):\r\n    x = torch.relu(x)\r\n    ...\r\n    return x\r\n']"
738,1113,0,"Possibly a bug: Why the default_collate in dataloader will change the type of the data?. I have a float train data. When I send it into dataloader and get it with enumerate. I found the type of my data has been changed into torch.DoubleTensor. But I really need is my original type. I found this was caused in `torch/utils/data/dataloader.py' in the definition of the default_collate. Is this a bug? Or how could I make it keep my original datatype?


. ['\r\ndef default_collate(batch):\r\n    ""Puts each data field into a tensor with outer dimension batch size""\r\n    if torch.is_tensor(batch[0]):\r\n        return torch.cat([t.unsqueeze(0) for t in batch], 0)\r\n    elif isinstance(batch[0], int):\r\n        return torch.LongTensor(batch)\r\n    elif isinstance(batch[0], float):\r\n        return torch.DoubleTensor(batch)\r\n    elif isinstance(batch[0], str):\r\n        return batch\r\n\r\n']"
130,11504,0,"[JIT] Tracer throws runtime exception for torch.normal. ## Issue description

The normal distribution (and hence all distributions that use the  sampler) is throwing a runtime exception under JIT (this seems to be a recent regression). I have isolated the issue to the following code snippet which throws an exception on PyTorch master, and is breaking many PyTorch models. cc. @zou3519, @apaszke, @fritzo. 

## Code example

The following code that returns a sample from a normal distribution,



throws a Runtime Exception:


## System Info


. ['python\r\ndef fn(mean, std):\r\n    return torch.normal(mean, std)\r\n\r\ncompiled_fn = torch.jit.trace(fn, (torch.zeros(2, 3), torch.ones(2, 3)))\r\n', '\r\nTraceback (most recent call last):\r\n  File ""/Users/npradhan/workspace/pyro_dev/pyro/examples/ex1.py"", line 10, in <module>\r\n    compiled_fn = torch.jit.trace(fn, (torch.zeros(2, 3), torch.ones(2, 3)))\r\n  File ""/Users/npradhan/miniconda2/envs/pytorch-master/lib/python3.6/site-packages/torch/jit/__init__.py"", line 501, in trace\r\n    module._create_method_from_trace(\'forward\', func, example_inputs)\r\n  File ""/Users/npradhan/workspace/pyro_dev/pyro/examples/ex1.py"", line 7, in fn\r\n    return d.sample()\r\n  File ""/Users/npradhan/miniconda2/envs/pytorch-master/lib/python3.6/site-packages/torch/distributions/normal.py"", line 54, in sample\r\n    return torch.normal(self.loc.expand(shape), self.scale.expand(shape))\r\nRuntimeError: Found an unsupported argument type in the JIT tracer: at::Generator*. File a bug report.\r\n', '\r\n  $ python collect_env.py\r\nCollecting environment information...\r\nPyTorch version: 0.5.0a0+f2f43ad\r\nIs debug build: No\r\nCUDA used to build PyTorch: None\r\n\r\nOS: Mac OSX 10.13.3\r\nGCC version: Could not collect\r\nCMake version: version 3.12.0\r\n\r\nPython version: 3.6\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.15.0)\r\n[pip] torch (0.5.0a0+f2f43ad)\r\n[pip] torchfile (0.1.0)\r\n[pip] torchvision (0.2.1)\r\n[conda] torch                     0.5.0a0+f2f43ad           <pip>\r\n[conda] torch                     0.5.0a0+2158f4a           <pip>\r\n[conda] torchfile                 0.1.0                     <pip>\r\n[conda] torchvision               0.2.1                     <pip>\r\n']"
80,21926,1,"Bug in saving indexed torch tensors makes it much slower than numpy.. ## üêõ Bug

I am indexing tensors and storing each element of the batch separately so that they can be read individually from disk. The output of the model is a tensor of size (40,100,256,256). When I index one element from it and store the (100,256,256) dimensional tensor using torch.save() it takes the exact same time as it takes to save the whole (40,100,256,256) object.

On the other hand, if I do a .numpy() and do the same process in numpy it is much faster.

May be some thing to do with how torch handles indexed sub-tensors. Is it a separate object, or the same one? 

Dummy code below reproduces the issue with PyTorch 1.0.1.

## To Reproduce


<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior
I'd expect torch and numpy to not be SO different.

## Environment
PyTorch version: 1.0.1
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 14.04.6 LTS
GCC version: (GCC) 5.2.0
CMake version: version 3.10.20171205-gd06b8

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.1.105
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN Xp

Nvidia driver version: 418.56
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.15.2
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.1                      144  
[conda] mkl_fft                   1.0.10           py36ha843d7b_0  
[conda] mkl_random                1.0.2            py36hd81dba3_0  
[conda] pytorch                   1.0.1           cuda100py36he554f03_0  
[conda] torchfile                 0.1.0                     <pip>
[conda] torchnet                  0.0.4                     <pip>
[conda] torchvision               0.2.1                    py36_0

## Additional context

Saving indexed sub-tensors can be important when storing features of images etc. Due to large dataset sizes, things are usually done in batches, but it may be important to extract each element out of the batch it was processed in.. [""\r\nimport time\r\nimport torch\r\nimport numpy as np\r\n\r\na = torch.rand((40,100,256,256))\r\nb = np.ones((40,100,256,256))\r\nc = a.cpu()\r\n\r\nt1 = time.time()\r\ntorch.save(a[0],open('torch1.p','wb'))\r\nt2 = time.time()\r\nprint(t2 - t1)\r\n\r\na = a.cuda()\r\ntorch.save(a[0],open('torch2.p','wb'))\r\nt3 = time.time()\r\nprint(t3 - t2)\r\n\r\nnp.save(open('numpy1.p','wb'),c[0])\r\nt4 = time.time()\r\nprint(t4 - t3)\r\n\r\nnp.save(open('numpy2.p','wb'),b[0])\r\nt5= time.time()\r\nprint(t5 - t4)\r\n""]"
172,13409,0,"[jit] add suggestions in ""unknown builtin op"" error messages. As an example, the following:

will fail with ""unknown builtin op"", even though  (with the underscore) is bound.

We should suggest ops with similar names when we can't find a matching schema.

So the error message could look like:
aten::masked_fillaten:masked_fill_`?
@torch.jit.script
def foo(a):
    mask = torch.rand(1).byte()
    a.masked_fill(mask, 1)
    ~~~~~~~~ <--- HERE
    return a
. ['\r\n@torch.jit.script\r\ndef foo(a):\r\n    mask = torch.rand(1).byte()\r\n    a.masked_fill(mask, 1)\r\n    return a\r\n']"
631,2627,0,"Conv3D on CPU segfaults. Running the code


Results in a segfault. Running the same code on the GPU works flawlessly. 
[Output from gdb](https://gist.github.com/dchansen/6c616b73e65a68c027efa29082e777a1)


The issue was originally raised [here](https://discuss.pytorch.org/t/segmentation-fault-for-sequential-and-conv3d-on-cpu/6353), but I've encountered the same bug independently. . ['import torch\r\nfrom torch import nn\r\nfrom torch.autograd import Variable\r\nv = Variable(torch.randn(1, 16, 128, 128, 128), volatile=True)\r\nmodel = nn.Conv3d(16,16,5)\r\nmodel(v)\r\n']"
735,8502,0,"[JIT] Don't support None in the script. Operator-level tests fail because we're using  in the script. Example failure:



Affected tests:

- 
- 
- 
- . ['\r\n======================================================================\r\nERROR: test_clamp_max (__main__.TestAutogradGenerated)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File ""test/test_autograd.py"", line 3665, in do_test\r\n    check(name)\r\n  File ""test/test_autograd.py"", line 3592, in check\r\n    fn, (self_variable,) + args_variable)\r\n  File ""test/test_autograd.py"", line 3498, in check_against_reference\r\n    outputs_test = func(*nograd_inputs)\r\n  File ""test/test_autograd.py"", line 3473, in script_fn\r\n    CU = torch.jit.CompilationUnit(script)\r\n  File ""/data/users/zdevito/pytorch/torch/jit/__init__.py"", line 352, in __init__\r\n    self.define(lang, _frames_up=_frames_up + 1)\r\n  File ""/data/users/zdevito/pytorch/torch/jit/__init__.py"", line 358, in define\r\n    self.module._define(lang, rcb, False)\r\nRuntimeError: \r\nundefined value None:\r\n\r\ndef the_method(i0):\r\n    return i0.clamp(0.5, None)\r\n                         ~~~~ <--- HERE\r\n']"
554,8987,0,"undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'. Hi, I met the following issue when build pytorch from source. I can build caffe2 successfully by using , but can not build pytorch by using . Does anyone know how to solve it? Thanks!

## Issue description

Failed to run 'bash tools/build_pytorch_libs.sh --use-nnpack caffe2 nanopb libshm gloo THD'

## Code example



## System Info
- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): source
- Build command you used (if compiling from source): 
- OS: Ubuntu 16.04
- PyTorch version: source code cloned from the master branch
- Python version: 3.5.2
- CUDA/cuDNN version: N/A
- GPU models and configuration: N/A
- GCC version (if compiling from source): 5.4
- CMake version: 3.11.0
- Versions of any other relevant libraries:

-Wall -Wno-unused -Wno-attributes -Wno-unused-result -Wno-psabi -ffp-contract=off -fno-math-errno -fno-trapping-mathonnx::GetEmptyStringAlreadyInited[abi:cxx11]()'
> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'
> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to . []"
292,13304,0,"ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1539602533843/work/aten/src/ATen/core/blob.h:79. ## üêõ Bug
Hello Great programmers:
        When I was using FAIR's platform Detectron to do training with *e2e_mask_rcnn_R-101-FPN_3x_gn.yaml* config file, I faced this issue which indicated me to report one BUG to Pytorch.

<!-- A clear and concise description of what the bug is. -->
1generalized_rcnn
## Additional context

<!-- Add any other context about the problem here. -->
By the way, *e2e_mask_rcnn_R-50-FPN_1x.yaml* config works fine for me.

Waiting your response, thank you .. ['\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n1.\r\n1.\r\n1.\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Expected behavior\r\nno exception or bug for training and testing.\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n', '\r\ngengfeng@ai-work-4:~/Downloads$ python collect_env.py \r\nCollecting environment information...\r\nPyTorch version: 1.0.0.dev20181015\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 18.04.1 LTS\r\nGCC version: (Ubuntu 5.5.0-12ubuntu1) 5.5.0 20171010\r\nCMake version: version 3.11.4\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: GeForce GTX 1080\r\nNvidia driver version: 390.87\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-9.0/lib64/libcudnn.so\r\n/usr/local/cuda-9.0/lib64/libcudnn.so.7\r\n/usr/local/cuda-9.0/lib64/libcudnn.so.7.2.1\r\n/usr/local/cuda-9.0/lib64/libcudnn_static.a\r\n/usr/local/cuda-9.1/lib64/libcudnn.so\r\n/usr/local/cuda-9.1/lib64/libcudnn.so.7.1.3\r\n/usr/local/cuda-9.1/lib64/libcudnn_static.a\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] cuda91                    1.0                  h4c16780_0    pytorch\r\n[conda] pytorch-nightly           1.0.0.dev20181015 py3.6_cuda9.0.176_cudnn7.1.2_0    pytorch\r\n[conda] torch                     0.4.0                     <pip>\r\n[conda] torchvision               0.2.1                     <pip>\r\n']"
256,22049,0,"Cannot update part of the parameters in DistributedDataParallel.. ## üêõ Bug

When I use multiple GPU while the loss is calculated by only part of the parameters. I get the following errors. Use only one GPU works well.




## To Reproduce

Steps to reproduce the behavior:

Define a network in which the loss only depends on part of the parameters. We get:


find_unused_parameters=Truetorch.nn.parallel.DistributedDataParallelforwardforwardforward

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: 1.2.0.dev20190620
CUDA used to build PyTorch: 9.0.176
OS: CentOS Linux release 7.5.1804 (Core)
GCC version: (crosstool-NG 1.23.0.449-a04d0) 7.3.0
CMake version: version 2.8.12.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration:
GPU 0: GeForce GTX 1080
GPU 1: GeForce GTX 1080
GPU 2: GeForce GTX 1080
GPU 3: GeForce GTX 1080

Nvidia driver version: 396.26
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] msgpack-numpy==0.4.3.2
[pip3] numpy==1.15.4
[pip3] pytorch-pretrained-bert==0.4.0
[pip3] torch==1.0.1.post2
[pip3] torchfile==0.1.0
[pip3] torchtext==0.4.0
[pip3] torchvision-nightly==0.2.1
[conda] pytorch-pretrained-bert   0.6.2                    pypi_0    pypi
[conda] torch-nightly             1.2.0.dev20190620          pypi_0    pypi
[conda] torchfile                 0.1.0                    pypi_0    pypi
[conda] torchtext                 0.4.0                    pypi_0    pypi. []"
9,1088,1,"GPU slower than CPU on a simple RNN test code. Hi,

I wanted to write an RNN from scratch using the pytorch cuda capabilities and I ran some preliminary tests to compare the speed of the CPU vs GPU. The task is very simple and consists of a for loop mimicking the update of the internal state x in an RNN with recurrent weight matrix J. I'm using a Quadro K620 with cuda 8.0.

When the size of x is N=1000 there seems to be a trade-off, with the GPU implementation consistently getting slower when the number of iterations increases (I ran some other tests with different sizes of the J matrix and this behaviour seems pretty systematic).

This is an example of running times I get when running the enclosed script (number of iterations are 100, 1000, 10000, 100000):

cpu: [0.010117292404174805, 0.058980703353881836, 0.45785975456237793, 4.512230634689331]
gpu: [0.0019445419311523438, 0.05474495887756348, 0.7503962516784668, 7.011191129684448]

I'd really appreciate some help on this. Thanks in advance.

The test script is the following:

. ['python\r\nimport numpy as np\r\nimport torch as tr\r\nimport math\r\nimport time\r\n\r\nGPUID = 0\r\ntr.cuda.set_device(GPUID)\r\n\r\nN = 1000\r\n\r\nJ = tr.randn(N,N)\r\nx = tr.randn(N)\r\nr = tr.randn(N)\r\n\r\nJn = J.numpy()\r\nxn = x.numpy()\r\nrn = r.numpy()\r\n\r\ncputimes = []\r\nfor sampl in (100, 1000, 10000, 100000):\r\n    start = time.time()\r\n    for i in xrange(sampl):\r\n        rn = np.tanh(xn)\r\n        xn = Jn.dot(xn);\r\n    end = time.time()\r\n    cputimes.append(end-start)\r\nprint(cputimes)\r\n\r\nJc = J.cuda()\r\nxc = x.cuda()\r\nrc = r.cuda()\r\n\r\ngputimes = []\r\nfor sampl in (100, 1000, 10000, 100000):\r\n    start = time.time()\r\n    for i in xrange(sampl):\r\n        rc = tr.tanh(xc)\r\n        xc = Jc.mv(xc);\r\n    end = time.time()\r\n    gputimes.append(end-start)\r\nprint(gputimes)\r\n']"
376,26551,0,"No way to disable mse_loss broadcasting warning. ## üêõ Bug

Hi, 

torch.nn.functional.mse_loss always throws a warning when using it with two tensors of different shapes.
There are legitimate reasons for wanting to use differently shaped tensor and taking advantage of the standard broadcasting behaviour of pytorch, so there needs to be a way to disable that warning.

## To Reproduce



## Expected behavior

There should be an optional parameter to disable the warning, like , .
As discussed here: https://github.com/pytorch/pytorch/issues/16045#issuecomment-476266780

## Additional context

There are legitimate cases for wanting to calculate the MSE between differently shaped tensors.
For example I need to calculate the difference between each sample and a subset of other samples. So I need to calculate the MSE between tensors shaped like:
(number of samples, dimension of a sample, 1) and (number of samples, dimension of a sample, number of samples in the subset).
I understand that safeguards need to be put in-place to avoid misleading people, as discussed in the original issue (https://github.com/pytorch/pytorch/issues/16045) but broadcasting is a Pytorch staple and users shouldn't have to re-implement basic functions like the MSE to make use of its full power.

Cheers
. ['\r\nimport torch\r\nimport torch.nn.functional as F\r\n\r\na = torch.randn(5, 4)\r\nb = torch.randn(5, 1)\r\n\r\nF.mse_loss(a, b)\r\n']"
280,29842,0,"CI timeout after running test_async_grad_guard_with_grad (jit.test_async.TestAsync). pytorch_linux_xenial_cuda9_cudnn7_py3_test
https://app.circleci.com/jobs/github/pytorch/pytorch/3600910



@suo 




cc @ezyang @gchanan @zou3519 @jerryzh168 @suo. ['\r\nNov 14 19:29:53 test_async_grad_guard_with_grad (jit.test_async.TestAsync) ... ok\r\nToo long with no output (exceeded 1h30m0s)\r\n']"
456,5563,0,"Import Error : no module  named torch. PyTorch GitHub Issues Guidelines
--------------------------------

We like to limit our issues to bug reports and feature requests. If you have a question or would like help and support, please visit our forums: https://discuss.pytorch.org/

If you are submitting a feature request, please preface the title with [feature request].

When submitting a bug report, please include the following information (where relevant):
- OS:
- PyTorch version:
- How you installed PyTorch (conda, pip, source):
- Python version:
- CUDA/cuDNN version:
- GPU models and configuration:
- GCC version (if compiling from source):

In addition, including the following information will also be very helpful for us to diagnose the problem:
- A script to reproduce the bug. Please try to provide as minimal of a test case as possible.
- Error messages and/or stack traces of the bug
- Context around what you are trying to do

![issue1](**https://user-images.githubusercontent.com/19254992/36958144-c011b122-205f-11e8-82c2-fe0b0e0ad4f3.png**)
image error running from terminal is at link in Bracket
OS 16.04 Pytorch version 0.31 Latest , installed using conda, python version 3.5/3.6 .
Cuda 8.0 Cudnn 5.1 . GCC version 5.4.0
I just cloned this repository https://github.com/thstkdgus35/EDSR-PyTorch and trying to run demo.sh file which runs main.py file which imports PyTorch. so the problem is **i am able to import torch from home directory in python3 shell but whenever i go to any folder/directory and run pytorch code or import torch in python3 shell it gives me error** of no module named torch (see image for details). Also **i have installed torch(Luajit) in home or default root directory**. so it might be possible reason.Please help with reference to my code in image.
![issue1](https://user-images.githubusercontent.com/19254992/36958482-2c7fe048-2062-11e8-86e8-b10f25f471cc.png)
. []"
402,4896,0,"Second order derivative in neural network w.r.t. input encounter all zero. 









the values of y somehow are all zero
while in none-neural network case







the values of y are all normal
How to fix this? . []"
734,10858,0,"unexpected behaviour when mixing no_grad decorator with no_grad context manager. ## Issue description

Mixing torch.no_grad decorator with torch.no_grad context re-enables gradients as per torch.is_grad_enabled.

## Code example


#### Output:
> False
> True

### Expectation

It would be my expectation that within the no_grad context the gradients would always be disabled.
This expectation matches the output when using nested contexts as below.


#### Output:
> False
> False

## System Info

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.2.148

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: GeForce GTX 1080 Ti
Nvidia driver version: 396.54
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] Could not collect
[conda] cuda92                    1.0                           0    pytorch
[conda] pytorch                   0.4.1           py36_cuda9.2.148_cudnn7.1.4_1  [cuda92]  pytorch
[conda] torchvision               0.2.1                    py36_1    pytorch
[conda] warpctc-pytorch           0.1                       <pip>. ['\r\nimport torch\r\n\r\n@torch.no_grad()\r\ndef nothing(x):\r\n    return x\r\n\r\ntestin = torch.Tensor([0])\r\nwith torch.no_grad():\r\n    print(torch.is_grad_enabled())\r\n    testout = nothing(testin)\r\n    print(torch.is_grad_enabled())\r\n', '\r\nimport torch\r\n\r\ndef nothing_no_nograd(x):\r\n  return x\r\n\r\ntestin = torch.Tensor([0])\r\nwith torch.no_grad():\r\n    print(torch.is_grad_enabled())\r\n    with torch.no_grad():\r\n        testout = nothing_no_nograd(testin)\r\n    print(torch.is_grad_enabled())\r\n']"
155,8369,0,"Something wrong with torch 0.4.0 in rnn?. If you have a question or would like help and support, please ask at our
[forums](https://discuss.pytorch.org/).

If you are submitting a feature request, please preface the title with [feature request].
If you are submitting a bug report, please fill in the following details.

## Issue description
I got something wrong with torch 0.4.0 in rnn. it's like there are errors about the RAM.


## Code example

Please try to provide a minimal example to repro the bug.
Error messages and stack traces are also helpful.

/home/python3/bin/python3.6': double free or corruption (fasttop): 0x00007fe73000aa50 ***
======= Backtrace: =========
/lib64/libc.so.6(+0x7c619)[0x7fe86b938619]
/usr/local/nvidia/lib64/libcuda.so.1(+0x1dedcf)[0x7fe860e4ddcf]
/usr/local/nvidia/lib64/libcuda.so.1(+0xf6ebb)[0x7fe860d65ebb]
/usr/local/nvidia/lib64/libcuda.so.1(cuStreamCreate+0x5b)[0x7fe860e9672b]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(+0x3258786)[0x7fe801f1c786]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(+0x328dec4)[0x7fe801f51ec4]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(_ZN17RNNBackwardFilterIfffE4initEP12cudnnContextP14cudnnRNNStructi11PerfOptions+0x3b0)[0x7fe807792d10]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(cudnnRNNBackwardWeights+0xed1)[0x7fe807791f01]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(_ZN2at6native26_cudnn_rnn_backward_weightERKNS_6TensorENS_8ArrayRefIS1_EElS3_S3_S3_S3_lllbdbbNS4_IlEES3_S3_+0xa7e)[0x7fe8000a0e5e]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(_ZN2at6native19_cudnn_rnn_backwardERKNS_6TensorENS_8ArrayRefIS1_EElS3_S3_S3_S3_S3_S3_S3_lllbdbbNS4_IlEES3_S3_St5arrayIbLm4EE+0x22f)[0x7fe8000a388f]
/home/python3/lib/python3.6/site-packages/torch/lib/libATen.so(_ZNK2at4Type19_cudnn_rnn_backwardERKNS_6TensorENS_8ArrayRefIS1_EElS3_S3_S3_S3_S3_S3_S3_lllbdbbNS4_IlEES3_S3_St5arrayIbLm4EE+0x9f)[0x7fe80030061f]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZNK5torch8autograd12VariableType19_cudnn_rnn_backwardERKN2at6TensorENS2_8ArrayRefIS3_EElS5_S5_S5_S5_S5_S5_S5_lllbdbbNS6_IlEES5_S5_St5arrayIbLm4EE+0x43b)[0x7fe824eead1b]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZN5torch8autograd9generated16CudnnRnnBackward5applyERKSt6vectorINS0_8VariableESaIS4_EE+0x6c6)[0x7fe824fb7f56]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZN5torch8autograd6Engine17evaluate_functionERNS0_12FunctionTaskE+0x3e2)[0x7fe824e46b62]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZN5torch8autograd6Engine11thread_mainEPNS0_9GraphTaskE+0xe5)[0x7fe824e47b75]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZN5torch8autograd6Engine11thread_initEi+0x5e)[0x7fe824e4402e]
/home/python3/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_ZN5torch8autograd6python12PythonEngine11thread_initEi+0x2a)[0x7fe824e71a8a]
/lib64/libstdc++.so.6(+0xb52b0)[0x7fe859a602b0]
/lib64/libpthread.so.0(+0x7e25)[0x7fe86c38fe25]
/lib64/libc.so.6(clone+0x6d)[0x7fe86b9b434d]
======= Memory map: ========

ollecting environment information...
PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 8.0.61

OS: CentOS Linux 7 (Core)
GCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)
CMake version: version 2.8.12.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 8.0.61
GPU models and configuration: 
GPU 0: Tesla P40
GPU 1: Tesla P40
GPU 2: Tesla P40
GPU 3: Tesla P40

Nvidia driver version: 390.30
cuDNN version: Probably one of the following:
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.6.0.21
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn_static.a

Versions of relevant libraries:
[pip3] numpy (1.14.2)
[pip3] torch (0.4.0)
[pip3] torchvision (0.2.1)
[conda] Could not collect
`

 by the way, The dataset size is about 300+G. 

Is the cuDNN error or something wrong with pytorch?
. ['python\r\n        def __init__(self, emb_ranges, x3_dim, x12_dim = 20, cell_size = 128,\r\n                 num_layers = 1, lr = 0.0002):\r\n        super(SelfComputeModel, self).__init__()\r\n        self.num_layers = num_layers\r\n        self.cell_size = cell_size\r\n\r\n        self.embeddings = nn.ModuleList()\r\n        for i in emb_ranges:\r\n            self.embeddings.append(nn.Embedding(i, x12_dim))\r\n\r\n        self.feat_dim = x12_dim * len(emb_ranges) + x3_dim\r\n        self.x3_dim = x3_dim\r\n        self.input_fc = nn.Linear(self.feat_dim, cell_size)\r\n        self.rnn = nn.LSTM(cell_size, cell_size, num_layers = num_layers)\r\n        self.output_fc = nn.Linear(cell_size, 1)\r\n\r\n    def forward(self, x_12, x_3, mask, label, is_h):\r\n        x_12, x_3, mask, label = self.numpy_to_torch(x_12, x_3, mask, label)\r\n        # Embedding\r\n        x12_feat = []\r\n        for i in range(x_12.shape[2]):\r\n            x12_feat.append(self.embeddings[i](x_12[:, :, i]))\r\n        feat = torch.cat(x12_feat + [x_3], 2)\r\n\r\n        T, bs, _ = feat.size()\r\n\r\n        feat = feat.resize(T * bs, self.feat_dim)\r\n        feat = F.relu(self.input_fc(feat))\r\n\r\n        h0 = Variable(torch.zeros(self.num_layers, bs, self.cell_size)).cuda()\r\n        c0 = Variable(torch.zeros(self.num_layers, bs, self.cell_size)).cuda()\r\n        feat = feat.resize(T, bs, self.cell_size)\r\n        outputs, _ = self.rnn(feat, [h0, c0])\r\n\r\n        outputs = outputs.resize(T * bs, self.cell_size)\r\n        pred = F.relu(self.output_fc(outputs)).squeeze(1)\r\n        pred = pred.resize(T, bs)\r\n\r\n        pred = (pred * mask).sum(0).squeeze(0)\r\n\r\n        return pred, FloatTensor(label)\r\n\r\n    def numpy_to_torch(self, x_12, x_3, mask, is_h, label = None):\r\n        tensors = []\r\n        x_12 = x_12.transpose([1, 0, 2])\r\n        tensors.append(Variable(torch.LongTensor(x_12)).cuda())\r\n        x_3 = x_3.transpose([1, 0, 2])\r\n        tensors.append(Variable(torch.FloatTensor(x_3)).cuda())\r\n        mask = mask.transpose()\r\n        tensors.append(Variable(torch.FloatTensor(mask)).cuda())\r\n        if label is not None:\r\n            tensors.append(Variable(torch.FloatTensor(label)).cuda())\r\n        tensors.append(Variable(torch.FloatTensor(is_h)).cuda())\r\n        return tensors\r\n', '\r\n## System Info\r\nPlease copy and paste the output from our\r\n\r\n']"
459,19920,0,CTC Decoder with KenLM Language Model. where is the implementation of ctc_decoder_with_kenlm in pytorch? I have found some 3rd party implementation but they are no longer supported by pytorch now?. []
532,9634,0,"Model only has gradients when ""x = x + bias"" and not when ""x += bias"". ## Issue description

I've built a simple model with a single bias layer (adding a set of constants to the inputs) as follows:


However, when I try training with this with an Adam optimizer, the weights of the bias layer do not change at all. Checking  shows that it is indeed in the optimizer, and checking  after running  returns a vector of all zeros.

As soon as I change the  to  in the forward() function, the model trains perfectly. The same issue also occurs with other operators such as . This model works:


It seems there is some difference with how the gradients of these are calculated which means that the gradients are all-zero when += is used and so training the model does not work. Is this intended behaviour?

## System Info
. ['python\r\nclass Bias(nn.Module):\r\n    def __init__(self, dim):\r\n        super(Bias, self).__init__()\r\n        self.bias = nn.Parameter(torch.zeros(dim))\r\n\r\n    def forward(self, x):\r\n        x += self.bias\r\n        return x\r\n', 'python\r\nclass Bias(nn.Module):\r\n    def __init__(self, dim):\r\n        super(Bias, self).__init__()\r\n        self.bias = nn.Parameter(torch.zeros(dim))\r\n\r\n    def forward(self, x):\r\n        x = x + self.bias\r\n        return x\r\n', '\r\nPyTorch version: 0.4.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 8.0.61\r\n\r\nOS: Ubuntu 16.04.2 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 8.0.61\r\nGPU models and configuration: \r\nGPU 0: TITAN X (Pascal)\r\n\r\nNvidia driver version: 384.81\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.14.5)\r\n[pip] numpydoc (0.8.0)\r\n[pip] torch (0.4.0)\r\n[pip] torchfile (0.1.0)\r\n[pip] torchsummary (1.3)\r\n[pip] torchvision (0.2.1)\r\n[conda] pytorch                   0.4.0           py36_cuda8.0.61_cudnn7.1.2_1    pytorch\r\n[conda] torchfile                 0.1.0                     <pip>\r\n[conda] torchsummary              1.3                       <pip>\r\n[conda] torchvision               0.2.1                    py36_1    pytorch\r\n']"
468,7544,0,"How to make dropout 'not scaling' during training?. Dropout always scale 1/(1-p) during training, but I want to get the original outputs. How to get it?. []"
478,10303,0,"cuda runtime error(59): device-side assert when running torch.topk. The code and dataset were the same as before, but I got the following error. However they could work well about a half mouth ago.
the pytorch's version is 0.3.1, BUT I find the version 0.4.0 also meeting with the same error
raceback (most recent call last):
File ""main.py"", line 341, in
main()
File ""main.py"", line 141, in main
train(train_loader, model, criterion, optimizer, epoch)
File ""main.py"", line 192, in train
prec1, prec5 = accuracy(output.data, target, topk=(1,5))
File ""main.py"", line 329, in accuracy
_, pred = output.topk(maxk, 1, True, True)
RuntimeError: invalid argument 5: k not in range for dimension at /pytorch/torch/lib/THC/generic/THCTensorTopK.cu:21
/pytorch/torch/lib/THCUNN/ClassNLLCriterion.cu:101: void cunn_ClassNLLCriterion_updateOutput_kernel(Dtype *, Dtype *, Dtype *, long *, Dtype *, int, int, int, int, long) [with Dtype = float, Acctype = float]: block: [0,0,0], thread: [0,0,0] Assertion t >= 0 && t < n_classes failed.
/pytorch/torch/lib/THCUNN/ClassNLLCriterion.cu:101: void cunn_ClassNLLCriterion_updateOutput_kernel(Dtype *, Dtype *, Dtype *, long *, Dtype *, int, int, int, int, long) [with Dtype = float, Acctype = float]: block: [0,0,0], thread: [1,0,0] Assertion t >= 0 && t < n_classes failed.
/pytorch/torch/lib/THCUNN/ClassNLLCriterion.cu:101: void cunn_ClassNLLCriterion_updateOutput_kernel(Dtype *, Dtype *, Dtype *, long *, Dtype *, int, int, int, int, long) [with Dtype = float, Acctype = float]: block: [0,0,0], thread: [2,0,0] Assertion t >= 0 && t < n_classes failed.
/pytorch/torch/lib/THCUNN/ClassNLLCriterion.cu:101: void cunn_ClassNLLCriterion_updateOutput_kernel(Dtype *, Dtype *, Dtype *, long *, Dtype *, int, int, int, int, long) [with Dtype = float, Acctype = float]: block: [0,0,0], thread: [3,0,0] Assertion t >= 0 && t < n_classes failed.
THCudaCheck FAIL file=/pytorch/torch/lib/THC/generic/THCStorage.c line=184 error=59 : device-side assert triggered
terminate called after throwing an instance of 'std::runtime_error'
what(): cuda runtime error (59) : device-side assert triggered at /pytorch/torch/lib/THC/generic/THCStorage.c:184
Aborted (core dumped). []"
104,27421,0,"[dataloader] Sampler abstract constructor API minor proposal. Currently the base abstract Sampler class [has](https://github.com/pytorch/pytorch/blob/master/torch/utils/data/sampler.py#L17):


The  is declared as a common argument but not saved to . Many samplers that do take  as argument indeed do that. And there exist samplers that do not even take  as argument. Two proposed suggestions: 1) add  to the abstract class; 2) remove  method from the base abstract class completely

cc @SsnL. ['python\r\ndef __init__(self, data_source):\r\n  pass\r\n']"
131,260,0,"define default GPU device. I think it would be useful to have a cuda.set_default_device in pytorch, so that the GPU 0 is not always the default one.. []"
44,27926,1,"`num_batches_tracked` update in `_BatchNorm` forward should be a single scalar update on host regardless of the residence of the layer. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->

 is single scalar that increments by 1 every time  is called on the  layer with both  &  set to true. Our current implementation stores it as a single-element buffer that resides on the same device as with the rest of its parameters/buffers.

We request the update & storage of  to be moved to host, despite the residence of the rest of parameters/buffers.

## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->

When we have a BN layer on accelerators (GPUs), every forward call that updates  triggers a single-element kernel launch, introducing unnecessary host overhead which could hurt our end-2-end perf in cpu bounded workload.

My last attempt to move  to the host from the device gives 0%~11% performance gain across some common problem sizes. #26550

## Pitch

<!-- A clear and concise description of what you want to happen. -->
We need a way that  would resides on device and be backward compatible for save/load modules. This involves relaxing some checks in python tests, which assumes that all values in  are buffers/parameters passed by reference.

## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->

My implementation #26550 does not give full backward compatibility (failing tests and not loading  by reference) and I don't know how to do that easily without a big hammer (rewriting  in  inherited from ).
But it does support save/load module, as well as allow assignment using tensor/scalar.. []"
194,8181,0,"Stop using ""from pip import main"". See https://github.com/pytorch/pytorch/pull/7411 for backstory. []"
378,23301,0,"Error while using Libtorch + OpenCV + Qt Creator. I have the following configuration in the .pro file

 

OpenCV works absolutely fine **without** ""QMAKE_CXXFLAGS += -D_GLIBCXX_USE_CXX11_ABI=**0**"". With this, however, I get this following errors:

![Screenshot_2019-07-24_14-35-50](https://user-images.githubusercontent.com/17313248/61799072-b6307800-ae2a-11e9-9bb3-e8b8068c8a87.png)

OpenCV works fine **with** ""QMAKE_CXXFLAGS += -D_GLIBCXX_USE_CXX11_ABI=**1**"" as well. But it throws a different set of errors:

![Screenshot_2019-07-24_14-38-10](https://user-images.githubusercontent.com/17313248/61799101-c183a380-ae2a-11e9-9da8-ff815f721dde.png)

Setting ""QMAKE_CXXFLAGS += -D_GLIBCXX_USE_CXX11_ABI=**0**"" has been recommended for Libtorch in most of the forums to avoid the errors above.

What could be a solution or some solutions to work around this?
(I am a newbie to both Libtorch and Qt Creator.). ['\r\n    TEMPLATE = app\r\n    CONFIG += console c++11\r\n    CONFIG -= app_bundle\r\n    CONFIG -= qt\r\n    CONFIG += thread\r\n    \r\n    SOURCES += main.cpp\r\n    \r\n    INCLUDEPATH += /usr/local/include/opencv4\r\n    LIBS += -L/usr/local/lib/\r\n    LIBS += -lopencv_core\r\n    LIBS += -lopencv_highgui\r\n    LIBS += -lopencv_imgproc\r\n    LIBS += -lopencv_videoio\r\n\r\n    QMAKE_CXXFLAGS += -D_GLIBCXX_USE_CXX11_ABI=0\r\n    \r\n    INCLUDEPATH += /path/to/libtorch/include\r\n    INCLUDEPATH += /path/to/libtorch/include/torch/csrc/api/include\r\n    LIBS += -L/path/to/libtorch/lib\r\n    LIBS += -ltorch -lc10\r\n']"
323,15771,0,"Implicit conversion error in caffe2. Hello,

While compiling generated sources(caffe2.pb.cc)  from caffe2.proto we are getting the implicit conversion error
protobuf version=v3.5.2
compiler:
 CC=aarch64-linux-android-clang \
 CXX=aarch64-linux-android-clang++




Thank you,


. [""\r\n/home/armnn1/armnn-devenv/armnn/src/armnnCaff2Parser/proto/caffe2.pb.cc:2269:9: error: implicit conversion changes signedness: '::google::protobuf::int32' (aka 'int') to\r\n      'google::protobuf::uint32' (aka 'unsigned int') [-Werror,-Wsign-conversion]\r\n        static_cast< ::google::protobuf::int32>(\r\n        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/home/armnn1/armnn-devenv/armnn/src/armnnCaff2Parser/proto/caffe2.pb.cc:2282:9: error: implicit conversion changes signedness: '::google::protobuf::int32' (aka 'int') to\r\n      'google::protobuf::uint32' (aka 'unsigned int') [-Werror,-Wsign-conversion]\r\n        static_cast< ::google::protobuf::int32>(\r\n        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/home/armnn1/armnn-devenv/armnn/src/armnnCaff2Parser/proto/caffe2.pb.cc:2326:9: error: implicit conversion changes signedness: '::google::protobuf::int32' (aka 'int') to\r\n      'google::protobuf::uint32' (aka 'unsigned int') [-Werror,-Wsign-conversion]\r\n        static_cast< ::google::protobuf::int32>(\r\n        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/home/armnn1/armnn-devenv/armnn/src/armnnCaff2Parser/proto/caffe2.pb.cc:2339:9: error: implicit conversion changes signedness: '::google::protobuf::int32' (aka 'int') to\r\n      'google::protobuf::uint32' (aka 'unsigned int') [-Werror,-Wsign-conversion]\r\n        static_cast< ::google::protobuf::int32>(\r\n        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/home/armnn1/armnn-devenv/armnn/src/armnnCaff2Parser/proto/caffe2.pb.cc:3017:9: error: implicit conversion changes signedness: '::google::protobuf::int32' (aka 'int') to\r\n      'google::protobuf::uint32' (aka 'unsigned int') [-Werror,-Wsign-conversion]\r\n        static_cast< ::google::protobuf::int32>(\r\n        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n""]"
725,30818,0,"kthvalue/median with scalar and dim=1 inconsistent between CPU and CUDA. ['\r\n>>> import torch\r\n>>> torch.kthvalue(torch.tensor(2, device=\'cuda\'), 1)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nIndexError: dimension specified as 0 but tensor has no dimensions\r\n>>> torch.kthvalue(torch.tensor(2, device=\'cpu\'), 1)\r\ntorch.return_types.kthvalue(\r\nvalues=tensor(2),\r\nindices=tensor(0))\r\n']"
455,22542,0,"Bug in CosineAnnealingWarmRestarts (T_mul instead of T_mult). ## üêõ Bug

The bug appears in PyTorch 1.1 in file lr_scheduler.py (line 686) for LR scheduler ""CosineAnnealingWarmRestarts"", where the parameter name is *T_mult* but in line 686 the name *T_mul* is used instead (python interpreter does not know variable *T_mul*).

## To Reproduce

The bug can be easily reproduced if the *T_mult* parameter of CosineAnnealingWarmRestart scheduler is not set properly (i.e. is < 1 or not an instance of int), causing Python to raise the error at line 686 (where *T_mul* is used instead of *T_mult*).

The following line will raise the error and cause the bug:


because 2.0 is not an instance of int.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

Line 686 of lr_scheduler.py should be modified from

into 


## Environment

- PyTorch Version (e.g., 1.0): 1.1
 - OS (e.g., Linux): Linux
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source):
 - Python version: 3.7
 - CUDA/cuDNN version: 10
 - GPU models and configuration: 1080 Ti
 - Any other relevant information: N/A. []"
379,18776,0,"Value of torch.backends.cudnn.benchmark Baked into JIT-Traced Modules ( 150x slowdown on ConvTranspose2d() ) [jit] [libtorch] [cudnn] . ## üêõ Bug

If you trace a module with  and load that script module in C++ via LibTorch, the resulting behavior in C++ depends on whether or not the  flag was set. Calls to  from the C++ API at runtime appear to have no effect.

## To Reproduce

**NOTE**: I was not able to verify this issue still exists on the latest nightly (20190402) because it appears the latest nightly (at least on Windows) cannot run JIT-traced models. Even the simplest model gives the following error:



1) Run the python script below:  or 
2) Compile + run the C++ code below.
3) Observe:
  a) Average time per call. I see ~0.8ms in the python script and either ~0.8 or ~120ms in C++ depending on the flag used in python. In either case, C++ sets benchmarking ON. (GTX 1080)
  b) Kernel run by CuDNN. w/either setting of the flag, the python code runs . With the flag ON, it runs  once (taking ~120ms) and then chooses the faster . If the flag was ON in python, C++ also chooses  but if the flag was OFF in python, it always chooses  regardless of the flag setting in C++.

I observed the choice of kernel using .

Python Script ():


C++ Code:


## Expected Behavior

I would expect that either: 1) the C++ setting of  should be respected (choosing the correct algorithm) or 2) at least print a warning that it is being overridden by the value of the flag at trace time.

## Additional Info
I printed the JIT graphs generated with benchmarking ON/OFF and got the following with the flag OFF:


The only change when the flag is ON is that register %17 is 1 instead of 0. I suppose this is where the ""hardcoding"" of the flag might be happening?

## Environment
Python code was run on Linux, C++ code was run on Windows

 - PyTorch Version (e.g., 1.0): 1.0.0.dev20190311 on linux, 2336f0ba0 on Windows
 - OS (e.g., Linux): Fedora 29, Windows 10 1809
 - How you installed PyTorch (, , source): conda (pytorch-nightly)
 - Python version: 3.7
 - CUDA/cuDNN version: CUDA 10, cuDNN 7.4.2
 - GPU models and configuration: Titan RTX (linux), GTX 1080 (windows)

cc @suo. ['\r\nINVALID_ARGUMENT:: Cannot find field. (deserialize at ..\\torch\\csrc\\jit\\import.cpp:108)\r\n(no backtrace available)\r\n', 'python\r\nimport sys\r\nimport time\r\n\r\nimport torch as th\r\nth.backends.cudnn.benchmark = bool(int(sys.argv[1]))\r\n\r\nmod = th.nn.ConvTranspose2d(8, 3, 4, 2, 1).cuda()\r\ninp = th.zeros(1, 8, 512, 512).cuda()\r\n\r\nmod(inp); mod(inp); mod(inp)\r\n\r\nsmod = th.jit.trace(mod, (inp,), check_trace=False)\r\nsmod.save(""smod.ptj"")\r\n\r\nN = 1000\r\nth.cuda.synchronize()\r\nstart = time.time()\r\nfor _ in range(N):\r\n    mod(inp)\r\n    th.cuda.synchronize()\r\nend = time.time()\r\nprint(""Time (ms):"", 1000*(end-start)/N)\r\n', 'c++\r\n#include <chrono>\r\n#include <iostream>\r\n\r\n#include <c10/cuda/CUDAGuard.h>\r\n#include <torch/script.h>\r\n#include <torch/torch.h>\r\n\r\n#include <cuda_runtime_api.h>\r\n\r\nint main() {\r\n  at::globalContext().setBenchmarkCuDNN(true);\r\n  auto nograd = torch::NoGradGuard();\r\n\r\n  try {\r\n    auto mod = torch::jit::load(""smod.ptj"");\r\n    mod->to(torch::kCUDA);\r\n    torch::jit::Stack input_stack = {torch::zeros({1, 8, 512, 512}, torch::kCUDA)};\r\n\r\n    mod->forward(input_stack);\r\n    mod->forward(input_stack);\r\n    mod->forward(input_stack);\r\n\r\n    const int N = 100;\r\n    cudaDeviceSynchronize();\r\n    const auto start = std::chrono::high_resolution_clock::now();\r\n    for (int i = 0; i < N; ++i) {\r\n      mod->forward(input_stack);\r\n      cudaDeviceSynchronize();\r\n    }\r\n    const auto end = std::chrono::high_resolution_clock::now();\r\n    const float elapsed = std::chrono::duration<float, std::milli>(end - start).count() / N;\r\n    std::cout << ""Time (ms): "" << elapsed << std::endl;\r\n  } catch (c10::Error e) {\r\n    std::cerr << e.what() << std::endl;\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n', '\r\ngraph(%input : Float(1, 8, 512, 512),\r\n      %1 : Float(8, 3, 4, 4),\r\n      %2 : Float(3)):\r\n  %3 : int = prim::Constant[value=2](), scope: ConvTranspose2d\r\n  %4 : int = prim::Constant[value=2](), scope: ConvTranspose2d\r\n  %5 : int[] = prim::ListConstruct(%3, %4), scope: ConvTranspose2d\r\n  %6 : int = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %7 : int = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %8 : int[] = prim::ListConstruct(%6, %7), scope: ConvTranspose2d\r\n  %9 : int = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %10 : int = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %11 : int[] = prim::ListConstruct(%9, %10), scope: ConvTranspose2d\r\n  %12 : bool = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %13 : int = prim::Constant[value=0](), scope: ConvTranspose2d\r\n  %14 : int = prim::Constant[value=0](), scope: ConvTranspose2d\r\n  %15 : int[] = prim::ListConstruct(%13, %14), scope: ConvTranspose2d\r\n  %16 : int = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %17 : bool = prim::Constant[value=0](), scope: ConvTranspose2d\r\n  %18 : bool = prim::Constant[value=0](), scope: ConvTranspose2d\r\n  %19 : bool = prim::Constant[value=1](), scope: ConvTranspose2d\r\n  %20 : Float(1, 3, 1024, 1024) = aten::_convolution(%input, %1, %2, %5, %8, %11, %12, %15, %16, %17, %18, %19), scope: ConvTranspose2d\r\n  return (%20)\r\n']"
200,9261,0,"memory leak for PyTorch -> dlpack -> CuPy. Hi again,

for this one, I'm not sure whether it is a cupy or pytorch issue, either, but I don't think this should run out of memory:

 will be high. Again it could be a refcounting thing that things are not going out of scope properly. (In which case it would be more of a CuPy issue.)

Best regards

Thomas. [""\r\nimport cupy\r\nimport torch.utils.dlpack\r\nimport gc\r\nfor i in range(10000):\r\n  b = torch.randn(1000,1000, device='cuda')\r\n  a = cupy.fromDlpack(torch.utils.dlpack.to_dlpack(b))\r\n  gc.collect()\r\n""]"
410,20296,0,"the capacity of memory when compiling pytorch from source. how large the capacity of memory is needed when compiling pytorch from source ?

I've got about 5GB available when compiling in ubuntu 18.04.  Each time I compile with **python setup.py install**, the compiling program will occupy all the capacity of memory. Then my screen is stuck. After a while,  the screen becomes dark and my laptop reboots.... 

Is there any way to setup some parameters to use less memory when compiling ? Many thanks.. []"
676,22616,0,"Error when loading a sparse tensor parameter from a state_dict in pytorch 1.1.0. ## üêõ Bug

In pytorch , if a  has a parameter which is a sparse tensor,  fails. For the mini snipped below it throws the following error:


On pytorch  there is no error.

## To Reproduce

Steps to reproduce the behavior:


## Expected behavior

The  loads the sparse tensor from the state dict.

## Environment



The virtual environment with torch  for which the above snipped throws **no** error:

. ['\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-2-ca845ac28325> in <module>\r\n     10 m = Test()\r\n     11 \r\n---> 12 m.load_state_dict(m.state_dict())\r\n\r\n~/anaconda3/envs/torch11/lib/python3.6/site-packages/torch/nn/modules/module.py in load_state_dict(self, state_dict, strict)\r\n    775         if len(error_msgs) > 0:\r\n    776             raise RuntimeError(\'Error(s) in loading state_dict for {}:\\n\\t{}\'.format(\r\n--> 777                                self.__class__.__name__, ""\\n\\t"".join(error_msgs)))\r\n    778         return _IncompatibleKeys(missing_keys, unexpected_keys)\r\n    779 \r\n\r\nRuntimeError: Error(s) in loading state_dict for Test:\r\n\tWhile copying the parameter named ""a"", whose dimensions in the model are torch.Size([2, 2]) and whose dimensions in the checkpoint are torch.Size([2, 2]).\r\n', 'python\r\nfrom torch import nn\r\nimport torch\r\nimport numpy as np\r\nclass Test(nn.Module):\r\n    def __init__(self):\r\n        super(Test, self).__init__()\r\n        self.a = nn.Parameter(torch.sparse_coo_tensor((np.array([0,1]),np.array([0,1])), np.array([1.0,2.0]), size=[2,2],\r\n                                                dtype=torch.float32), requires_grad=False)\r\n\r\nm = Test()\r\nm.load_state_dict(m.state_dict())\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.1.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration: GPU 0: Quadro P600\r\nNvidia driver version: 410.79\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.16.4\r\n[pip] torch==1.1.0\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.4                      243  \r\n[conda] mkl_fft                   1.0.12           py36ha843d7b_0  \r\n[conda] mkl_random                1.0.2            py36hd81dba3_0  \r\n[conda] pytorch                   1.1.0           py3.6_cuda10.0.130_cudnn7.5.1_0    pytorch\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.2 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration: GPU 0: Quadro P600\r\nNvidia driver version: 410.79\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.16.4\r\n[pip] torch==1.0.1.post2\r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.4                      243  \r\n[conda] mkl_fft                   1.0.12           py36ha843d7b_0  \r\n[conda] mkl_random                1.0.2            py36hd81dba3_0  \r\n[conda] pytorch                   1.0.1           py3.6_cuda10.0.130_cudnn7.4.2_2    pytorch\r\n']"
704,6034,0,"how could I get pytorch0.4 for maskrcnn. i want to deal 0dim. pytorch 0.3 can't deal 0 dim 
i can't find 0.4
can u help me?



PyTorch GitHub Issues Guidelines
--------------------------------

We like to limit our issues to bug reports and feature requests. If you have a question or would like help and support, please visit our forums: https://discuss.pytorch.org/

If you are submitting a feature request, please preface the title with [feature request].

When submitting a bug report, please include the following information (where relevant):
- OS:
- PyTorch version:
- How you installed PyTorch (conda, pip, source):
- Python version:
- CUDA/cuDNN version:
- GPU models and configuration:
- GCC version (if compiling from source):

In addition, including the following information will also be very helpful for us to diagnose the problem:
- A script to reproduce the bug. Please try to provide as minimal of a test case as possible.
- Error messages and/or stack traces of the bug
- Context around what you are trying to do

. []"
489,15187,0,"complex extension does not work. ## üêõ Bug

I was trying to build the [pytorch-complex](https://github.com/Roger-luo/pytorch-complex) which I haven't work on for 3 month with the following on Mac OS X Mojave.

Then I got the following error. 


And a bunch of others:



Then I tried to build the one in test (), with the same build script in pytorch-complex. I still got this.

## To Reproduce

Steps to reproduce the behavior:

1. git clone pytorch 1.0.0 or later
2. git clone , and run 

## Expected behavior

You will get that error.

## Environment



## Additional context

I did some search, I guess this might relate to https://github.com/martinmoene/gsl-lite/issues/63

However, I found it includes  in  which is strange...

cc: @ezyang . [""\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/DeviceType.h:46:20: error:\r\n      explicit specialization of non-template struct 'hash'\r\ntemplate <> struct hash<c10::DeviceType> {\r\n                   ^   ~~~~~~~~~~~~~~~~~\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/DeviceType.h:48:21: error:\r\n      expected '(' for function-style cast or type construction\r\n    return std::hash<int>()(static_cast<int>(k));\r\n           ~~~~~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/DeviceType.h:48:25: error:\r\n      expected '(' for function-style cast or type construction\r\n    return std::hash<int>()(static_cast<int>(k));\r\n                     ~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/DeviceType.h:48:27: error:\r\n      expected expression\r\n    return std::hash<int>()(static_cast<int>(k));\r\n"", ""\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/string_utils.h:54:12: error:\r\n      no member named 'stod' in namespace 'std'\r\nusing std::stod;\r\n      ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/string_utils.h:55:12: error:\r\n      no member named 'stoi' in namespace 'std'; did you mean 'atoi'?\r\nusing std::stoi;\r\n      ~~~~~^~~~\r\n           atoi\r\n/usr/include/c++/4.2.1/cstdlib:113:11: note: 'atoi' declared here\r\n  using ::atoi;\r\n          ^\r\nIn file included from src/module.cpp:1:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/extension.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/all.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/types.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/ATen.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/Allocator.h:2:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/core/Allocator.h:6:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/Device.h:5:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/Exception.h:5:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/StringUtil.h:5:\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/string_utils.h:56:12: error:\r\n      no member named 'stoull' in namespace 'std'\r\nusing std::stoull;\r\n      ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/string_utils.h:57:12: error:\r\n      no member named 'to_string' in namespace 'std'\r\nusing std::to_string;\r\n      ~~~~~^\r\nIn file included from src/module.cpp:1:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/extension.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/all.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/types.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/ATen.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/Allocator.h:2:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/core/Allocator.h:6:\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/Device.h:109:8: error:\r\n      explicit specialization of non-template struct 'hash'\r\nstruct hash<c10::Device> {\r\n       ^   ~~~~~~~~~~~~~\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/Device.h:109:8: error:\r\n      redefinition of 'hash'\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/DeviceType.h:46:20: note:\r\n      previous definition is here\r\ntemplate <> struct hash<c10::DeviceType> {\r\n                   ^\r\nIn file included from src/module.cpp:1:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/extension.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/all.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/types.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/ATen.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/Allocator.h:2:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/core/Allocator.h:7:\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:42:8: error:\r\n      no template named 'unique_ptr' in namespace 'std'\r\n  std::unique_ptr<void, DeleterFnPtr> ctx_;\r\n  ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:66:8: error:\r\n      no template named 'unique_ptr' in namespace 'std'\r\n  std::unique_ptr<void, DeleterFnPtr>&& move_context() {\r\n  ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:67:17: error:\r\n      no member named 'move' in namespace 'std'\r\n    return std::move(ctx_);\r\n           ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:102:54: error:\r\n      no type named 'nullptr_t' in namespace 'std'\r\ninline bool operator==(const UniqueVoidPtr& sp, std::nullptr_t) noexcept {\r\n                                                ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:105:29: error:\r\n      no type named 'nullptr_t' in namespace 'std'\r\ninline bool operator==(std::nullptr_t, const UniqueVoidPtr& sp) noexcept {\r\n                       ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:108:54: error:\r\n      no type named 'nullptr_t' in namespace 'std'\r\ninline bool operator!=(const UniqueVoidPtr& sp, std::nullptr_t) noexcept {\r\n                                                ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/util/UniqueVoidPtr.h:111:29: error:\r\n      no type named 'nullptr_t' in namespace 'std'\r\ninline bool operator!=(std::nullptr_t, const UniqueVoidPtr& sp) noexcept {\r\n                       ~~~~~^\r\nIn file included from src/module.cpp:1:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/extension.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/all.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include/torch/types.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/ATen.h:3:\r\nIn file included from /Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/ATen/Allocator.h:2:\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/core/Allocator.h:46:8: error:\r\n      no template named 'unique_ptr' in namespace 'std'\r\n  std::unique_ptr<void, DeleterFnPtr>&& move_context() {\r\n  ~~~~~^\r\n/Users/roger/.conda/envs/complex/lib/python3.7/site-packages/torch/lib/include/c10/core/Allocator.h:67:48: error:\r\n      no type named 'nullptr_t' in namespace 'std'\r\ninline bool operator==(const DataPtr& dp, std::nullptr_t) noexcept {\r\n                                          ~~~~~^\r\nfatal error: too many errors emitted, stopping now [-ferror-limit=]\r\n20 errors generated.\r\nerror: command 'gcc' failed with exit status 1\r\n"", '\r\nPyTorch version: 1.0.0a0+db5d313\r\nIs debug build: No\r\nCUDA used to build PyTorch: None\r\n\r\nOS: Mac OSX 10.14.1\r\nGCC version: Could not collect\r\nCMake version: version 3.12.2\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy (1.14.5)\r\n[conda] mkl                       2019.1                      144\r\n[conda] mkl-include               2019.1                      144\r\n[conda] torch                     1.0.0a0+db5d313           <pip>\r\n[conda] torch                     1.0.0a0+e77de07           <pip>\r\n']"
229,6437,0,"[caffe2] Double precision for operators?. A lot of the operators are not defined for double precision. I am planning on experimenting with double precision calculations and will add them as necessary. Would there be interest in me submitting a PR request with them? Is there a reason they are not currently enabled? The only drawback is larger library file size and slower compilation time but I suppose not by much.

Thank you,
Svet. []"
315,18496,0,"Can't compile c10::optional values() or operator-> in .cu file. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

Our implementation of optional doesn't seem to always be compilable in .cu files.  Compiling this commit: https://github.com/gchanan/pytorch/commit/6666ff1083a55e90b230d2269c13a3d30af8c0f4

gives me the following error:


I did a bit of digging and the problem seems to be with the constexpr functions, e.g.:
https://github.com/pytorch/pytorch/blob/654e59fcac4a9d4bf0b48306e1d7f7be5b7e40b1/c10/util/Optional.h#L600-L604

basically, for nvcc to compile this in a .cu file,  has to be a .  This doesn't seem possible with the constraint that bad_optional_access derives from  because  does not have  constructors.

Note that this only applies to calls to .  Calls to  seem to fail for other reasons that I didn't dig into.  But  passes fine, so the solution is to use that until we fix the issue.. []"
251,31698,0,"can't iter a dataSet imported by hdf5. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)

. [""\r\nimport torch\r\nimport numpy as np\r\nimport h5py\r\nimport torch.utils.data as data\r\nimport torch.nn as nn\r\n\r\n\r\nclass H5Dataset(data.Dataset):\r\n\r\n    def __init__(self, file_path):\r\n        super(H5Dataset, self).__init__()\r\n        h5_file = h5py.File(file_path)\r\n        self.set_x = np.array(h5_file.get('train_set_x'))\r\n        self.set_y = np.array(h5_file.get('train_set_y'))\r\n\r\n    def __getitem__(self):\r\n        return (torch.from_numpy(self.set_x), torch.from_numpy(self.set_y))\r\n\r\n    def __len__(self):\r\n        return self.set_x.shape[0]\r\n\r\nclass H5DatasetTest(H5Dataset):\r\n\r\n    def __init__(self, file_path):\r\n        super(H5Dataset, self).__init__()\r\n        h5_file = h5py.File(file_path)\r\n        self.set_x = np.array(h5_file.get('test_set_x'))\r\n        self.set_y = np.array(h5_file.get('test_set_y'))\r\n        self.classes = np.array(h5_file.get('list_classes'))\r\n\r\n    def __getitem__(self):\r\n        return (torch.from_numpy(self.set_x), torch.from_numpy(self.set_y), self.classes)\r\n\r\ntrainSet = H5Dataset('datasets/train_catvnoncat.h5')\r\ntestSet = H5DatasetTest('datasets/test_catvnoncat.h5')\r\n\r\nmodel = nn.Sequential(\r\n        nn.Linear(64*64*3,4096),\r\n        nn.Sigmoid(),\r\n)\r\n\r\noptimizer = torch.optim.SGD(model.parameters(),lr=0.001)\r\n\r\nloss_func = nn.CrossEntropyLoss()\r\n\r\ntrain_loader = data.DataLoader(dataset=trainSet, batch_size=64, shuffle=True)\r\n\r\nfor i in range(100):\r\n    for i, (image,lebel) in enumerate(train_loader):\r\n        image = image.view(100, 64 * 64)\r\n        optimizer.zero_grad()\r\n""]"
77,14231,1,"`index_select` on flat tensor faster than integer array indexing, even including reshaping. ## üêõ Bug

Integer array indexing appears to be slower than applying  to the flattened tensor, using flattened indexes, and then reshaping to the expected output size.

## To Reproduce

Reproduced in this gist: https://gist.github.com/gngdb/3d4f5aa27ee5199b0d4b997ffe21a6b4

## Expected behavior

If this is a faster way to implement integer array indexing, it should be the default. It might not be though, there are other uses for integer array indexing where this speed difference might not hold.

## Environment

PyTorch version: 0.4.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Scientific Linux release 7.5 (Nitrogen)
GCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-28)
CMake version: version 2.8.12.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 8.0.44
GPU models and configuration: 
GPU 0: TITAN X (Pascal)
GPU 1: TITAN X (Pascal)
GPU 2: TITAN X (Pascal)
GPU 3: TITAN X (Pascal)

Nvidia driver version: 390.87
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy (1.15.2)
[pip] torch (0.4.1.post2)
[pip] torchvision (0.2.1)
[conda] pytorch                   0.4.1           py36_py35_py27__9.0.176_7.1.2_2    pytorch
[conda] torchvision               0.2.1                    py36_1    pytorch. []"
246,21004,0,"PTX JIT compilation failed when running FasterRCNN. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
Trying to run FasterRCNN newly released in torchvision 0.3 runs into PTX JIT compilation failed error. This fails on my Google Cloud instance using GPU, but does not fail using CPU

## To Reproduce

Steps to reproduce the behavior:

Simple code that fails


Error output:


<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

To run

## Environment


## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nimport torch \r\nimport torchvision\r\nimport torch.nn as nn\r\n    \r\ndevice = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")\r\n\r\nmodel =torchvision.models.detection.fasterrcnn_resnet50_fpn(pretrained=True).to(device)\r\n    \r\nimages = list(torch.randn((1,3,512,512)).to(device))\r\ntargets = [{\r\n        ""boxes"": torch.randn((1,4)),\r\n        ""labels"": torch.randn((1)),\r\n        ""image_id"": torch.randn((1)),\r\n        ""area"": torch.randn((1)),\r\n        ""iscrowd"": torch.randn((1))\r\n    }]\r\ntargets = [{k: v.to(device) for k, v in t.items()} for t in targets]\r\n\r\nloss_dict = model(images, targets)\r\n', '\r\nFile ""debug2.py"", line 19, in <module>\r\n    loss_dict = model(images, targets)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torch/nn/modules/module.py"", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torchvision/models/detection/generalized_rcnn.py"", line 48, in forward\r\n    features = self.backbone(images.tensors)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torch/nn/modules/module.py"", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torch/nn/modules/container.py"", line 92, in forward\r\n    input = module(input)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torch/nn/modules/module.py"", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torchvision/models/_utils.py"", line 58, in forward\r\n    x = module(x)\r\n  File ""/opt/anaconda3/envs/nuscenes/lib/python3.7/site-packages/torch/nn/modules/module.py"", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\nRuntimeError: /pytorch/torch/csrc/jit/fuser/cuda/fused_kernel.cpp:202: a PTX JIT compilation failed\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.1.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Debian GNU/Linux 9.8 (stretch)\r\nGCC version: (Debian 6.3.0-18+deb9u1) 6.3.0 20170516\r\nCMake version: Could not collect\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: GPU 0: Tesla P100-PCIE-16GB\r\nNvidia driver version: 410.72\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] intel-numpy==1.15.1\r\n[pip3] numpy==1.16.3\r\n[pip3] torch==1.1.0\r\n[pip3] torchvision==0.3.0\r\n[conda] torch                     1.1.0                    pypi_0    pypi\r\n[conda] torchvision               0.3.0                    pypi_0    pypi\r\n']"
450,2117,0,"Add dynamic infer shape for nn.Linear. It's quite inconvenient for user to calculate the shape of tensor manually. I think it would be better to entitle nn.Linear with the ability to infer shape from the input tensor.
One possible solution is like numpy's reshape function, which is nn.Linear(-1, hidden_size) or nn.Linear(None, hidden_size) means automatic inferring.

My preliminary implementation for this is at here:
https://gist.github.com/VoVAllen/1420e410e3dfd368b8dc9061ad0c206a

This implementation doesn't create any overhead during the training process. Also I think this kind of style can be used in other layers such as nn.Conv.
Feel free to add any comments. . []"
533,1984,0,"Different results for batch size 1 Variables. pytorch version: '0.1.12_2'

Run this snippet (The required serialised tensor has been included in the attachment.



The output

[issue.zip](https://github.com/pytorch/pytorch/files/1124350/issue.zip)
. [""python\r\nimport torch\r\nfrom torch.autograd import Variable\r\nfrom torch import nn\r\n\r\ntorch.manual_seed(0)\r\n\r\nx_restored = Variable(torch.load('x.pth'), requires_grad=False)\r\nx_res_repeated = x_restored.repeat(10, 1)\r\n\r\nclass Network(nn.Module):\r\n    def __init__(self, dim_in, dim_out):\r\n        super(Network, self).__init__()\r\n        self.m = nn.Sequential(\r\n            nn.Linear(dim_in, 100),\r\n            nn.BatchNorm1d(100),\r\n            nn.ReLU(),\r\n            nn.Linear(100, 100),\r\n            nn.BatchNorm1d(100),\r\n            nn.ReLU(),\r\n            nn.Linear(100, dim_out*2)\r\n        )\r\n\r\n    def forward(self, X):\r\n        return self.m(X)\r\n\r\nnet = Network(x_restored.size()[1], 2)\r\nprint(net(x_restored))\r\nprint(net(x_res_repeated))\r\n"", '\r\nVariable containing:\r\n1.00000e-02 *\r\n -0.5704 -3.7342 -3.6541  7.4486\r\n[torch.FloatTensor of size 1x4]\r\n\r\nVariable containing:\r\n1.00000e-02 *\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.5703 -3.7480 -3.6610  7.4439\r\n -0.4867 -3.7301 -3.6103  7.4878\r\n -0.4867 -3.7301 -3.6103  7.4878\r\n[torch.FloatTensor of size 10x4]\r\n']"
745,8519,0,"[JIT] Passed-in parameter is not a 1D LongTensor when expected. Operator-level tests fail. Example failure:


Affected tests:
- 
- 
- 
- 
- . ['\r\n======================================================================\r\nERROR: test_repeat_single_number (__main__.TestAutogradGenerated)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File ""test/test_autograd.py"", line 3665, in do_test\r\n    check(name)\r\n  File ""test/test_autograd.py"", line 3592, in check\r\n    fn, (self_variable,) + args_variable)\r\n  File ""test/test_autograd.py"", line 3498, in check_against_reference\r\n    outputs_test = func(*nograd_inputs)\r\n  File ""test/test_autograd.py"", line 3474, in script_fn\r\n    return output_process_fn(CU.the_method(*tensors))\r\nRuntimeError: \r\nExpected a 1D LongTensor:\r\noperation failed in interpreter:\r\n\r\ndef the_method(i0):\r\n    return i0.repeat(2)\r\n           ~~~~~~~~~ <--- HERE\r\n']"
609,24587,0,"Migrate `log10` and `log10_` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
290,16316,0,"Please remove pytorch from pypi. ## üêõ Bug

I tried to install pytorch using pipenv (see https://github.com/pypa/pipenv/issues/3476).

You have put in a fancy thing which is supposed to open the browser. It did not. Instead there was no output and I believed that the installation was broken.

## To Reproduce

Steps to reproduce the behavior:

1. pipenv install pytorch

You will see something like this:



## Expected behavior

If you don't want people installing it from pypi then don't put it there.
Don't break dependency management tools.

## Environment

Collecting environment information...
PyTorch version: N/A  
Is debug build: N/A                    
CUDA used to build PyTorch: N/A                
                                        
OS: Ubuntu 18.04 LTS            
GCC version: (Ubuntu 7.3.0-16ubuntu3) 7.3.0
CMake version: version 3.5.1   
                       
Python version: 3.7      
Is CUDA available: N/A                  
CUDA runtime version: Could not collect
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect

## Additional context

I can understand your desire to be helpful. Trying to make a non interactive activity (dependency management) into an interactive activity is inevitably going to result in situations like this.

Please just make the installation fail promptly and noisily.. ['\r\n‚ûú pipenv install pytorch\r\nInstalling pytorch‚Ä¶\r\n‚†á Installing...\r\n']"
624,25176,0,"Tensor slicing with boolean numpy mask wrong. ## üêõ Bug
Numpy arrays of dtype  should be interpreted as masks when slicing torch arrays, just like tensors of dtype  are. Insead, such arrays are interpreted as indices.

## To Reproduce
Steps to reproduce the behavior:


Output

## Expected behavior
The expected behaviour is that the result is the same as for slicing with torch tensors with the same dtype, where for the input

we get the expected output


## Environment
 - PyTorch Version: 1.2.0a0+0885dd2
 - OS: Ubuntu 16.04.6 LTS
 - How you installed PyTorch: Nvidia docker image ()
 - Python version: 3.6
 - CUDA/cuDNN version: Nvidia driver version: 384.183, 
 - GPU models and configuration: Tesla V100
. ['python\r\nt = torch.tensor(range(5))\r\nmask = np.array([False, True, True, False, True])\r\n\r\nprint(t[mask.astype(np.bool)])\r\nprint(t[mask.astype(np.uint8)])\r\n', 'bash\r\ntensor([0, 1, 1, 0, 1])\r\ntensor([1, 2, 4])\r\n', 'python\r\nt = torch.tensor(range(5))\r\nmask = torch.tensor([False, True, True, False, True])\r\n\r\nprint(t[mask.to(torch.bool)])\r\nprint(t[mask.to(torch.uint8)])\r\n', 'bash\r\ntensor([1, 2, 4])\r\ntensor([1, 2, 4])\r\n']"
123,2523,0,"cudnn bindings not respecting current stream. currently, some cudnnSetStream calls are missing in the bindings, fix them.
Context: https://discuss.pytorch.org/t/torch-nn-in-context-of-a-cuda-stream/6304/3. []"
527,8594,0,"PyTorch 0.4 hangs with nn.DataParallel . I have an issue that matches [https://github.com/pytorch/pytorch/issues/7019](url) but the suggested solution does not work for me.

This code never returns a value to y:

    import torch
    import torch.nn as nn
    from torch.autograd import Variable

    class NET(nn.Module):
        def __init__(self):
            super(NET, self).__init__()
            self.dense = nn.Linear(256, 512)

        def forward(self, input):
            return self.dense(input)

    if __name__ == '__main__':
        model = NET()
        model = nn.DataParallel(model).cuda()
        x = Variable(torch.rand(128, 256))
        y = model(x) ##### <<<<--- GETS STUCK HERE FOREVER

the solution was to delete  NCCL_SHM_DISABLE=1 and NCCL_P2P_DISABLE=1 from /etc/nccl.conf

I do not have a /etc/nccl.conf in Ubuntu 18.04 but I did unset those environment variables and I get this:

NCCL version 2.1.15+cuda9.0
rig:2637:2637 [0] INFO NET : Using interface enp0s31f6:192.168.85.32<0>
rig:2637:2637 [0] INFO NET/Socket : 1 interfaces found
rig:2637:2637 [3] INFO Using 256 threads
rig:2637:2637 [3] INFO Min Comp Cap 6
rig:2637:2637 [3] INFO NCCL_SINGLE_RING_THRESHOLD=131072
rig:2637:2637 [3] INFO Ring 00 : 0 1 2 3
rig:2637:2637 [0] INFO Ring 00 : 0[0] -> 1[1] via P2P/direct pointer
rig:2637:2637 [1] INFO Ring 00 : 1[1] -> 2[2] via P2P/direct pointer
rig:2637:2637 [2] INFO Ring 00 : 2[2] -> 3[3] via P2P/direct pointer
rig:2637:2637 [3] INFO Ring 00 : 3[3] -> 0[0] via P2P/direct pointer
rig:2637:2637 [0] INFO Launch mode Group/CGMD
^C gives:
File ""/home/minimumnz/anaconda3/envs/tacotron/lib/python3.6/threading.py"", line 1072, in _wait_for_tstate_lock
elif lock.acquire(block, timeout):

it seems stuck in some thread.

    Collecting environment information...
    PyTorch version: 0.4.0
    Is debug build: No 
    CUDA used to build PyTorch: 9.0.176

    OS: Ubuntu 18.04 LTS 
    GCC version: (Ubuntu 7.3.0-16ubuntu3) 7.3.0 
    CMake version: Could not collect

    Python version: 3.6
    Is CUDA available: Yes 
    CUDA runtime version: Could not collect
    GPU models and configuration:
    GPU 0: GeForce GTX 1080 Ti
    GPU 1: GeForce GTX 1080 Ti
    GPU 2: GeForce GTX 1080 Ti
    GPU 3: GeForce GTX 1080 Ti

    Nvidia driver version: 390.67
    cuDNN version: Probably one of the following:
    /usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.3
    /usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a

    Versions of relevant libraries:
    [pip] numpy (1.14.5)
    [pip] torch (0.4.0)
    [pip] torchvision (0.2.1)
    [conda] cuda90 1.0 h6433d27_0 pytorch
    [conda] pytorch 0.4.0 py36_cuda9.0.176_cudnn7.1.2_1 [cuda90] pytorch
    [conda] torch 0.4.0 
    [conda] torchvision 0.2.1 py36_1 pytorch. []"
221,31528,0,"cuCtxGetDevice error and seg fault with DDP and OpenMPI. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
When using DistributedDataParallel with OpenMPI+UCX for certain tested models I'm getting this error in the DDP constructor (I believe it's during the model broadcast):



I observed this error using a resnet50 model but no error if I instead used a very small single-layer CNN.

## To Reproduce

The script is here:
https://github.com/sparticlesteve/nersc-pytorch-build/blob/911fc67b6667d3c6e3be972169e30e34c1a33af5/test_ddp.py

I submit via slurm a single-node job with 8 MPI ranks for 8 V100 gpus, something like:



My full log with stack trace is here:
https://gist.github.com/sparticlesteve/7307694f89329c277e16e452b524fefa

## Environment

PyTorch version: 1.3.1
Is debug build: No
OpenMPI: 4.0.1 with UCX 1.6
CUDA used to build PyTorch: 10.1.168
OS: openSUSE Leap 15.0
GCC version: (GCC) 7.3.0 20180125 (Cray Inc.)
CMake version: version 3.14.0
Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.1.168
GPU models and configuration:
GPU 0: Tesla V100-SXM2-16GB
GPU 1: Tesla V100-SXM2-16GB
GPU 2: Tesla V100-SXM2-16GB
GPU 3: Tesla V100-SXM2-16GB
GPU 4: Tesla V100-SXM2-16GB
GPU 5: Tesla V100-SXM2-16GB
GPU 6: Tesla V100-SXM2-16GB
GPU 7: Tesla V100-SXM2-16GB

Nvidia driver version: 440.33.01
cuDNN version: Could not collect

cc @ngimel @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. ['\r\n0: [1576565271.426514] [cgpu06:45376:0]    cuda_ipc_md.c:62   UCX  ERROR cuCtxGetDevice(&cu_device) is failed. ret:invalid device context\r\n0: [1576565271.426547] [cgpu06:45376:0]       ucp_rkey.c:250  UCX  ERROR Failed to unpack remote key from remote md[4]: Input/output error\r\n0: [cgpu06:45376:0:45523] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x20)\r\n']"
636,28346,0,"Error for quantize_dynamic(resnet18) + torch.jit.trace + ios-demo-app/PyTorchDemo. ## üêõ Bug

I'm getting an error while loading quantized resnet18 on iphone with [ios-demo-app/PyTorchDemo](https://github.com/pytorch/ios-demo-app/tree/master/PyTorchDemo).



## To Reproduce
Convert the model with:


Run the [ios-demo-app/PyTorchDemo](https://github.com/pytorch/ios-demo-app/tree/master/PyTorchDemo) with . Get the stacktrace above.
Here is the forked demo with coverted models: [mirth/ios-demo-app](https://github.com/mirth/ios-demo-app)

## Expected behavior
For default image demo with  i'm getting ~50ms per frame on iPhone 6s.
For  on same iPhone i'm getting ~250ms per frame.
For  i'm getting an error with stacktrace above.
I'm expecting no error.

## Environment

PyTorch version: 1.3.0
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.15
GCC version: Could not collect
CMake version: version 3.11.1

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] Could not collect
[conda] mkl                       2018.0.0             hc285769_4
[conda] mkl-service               1.1.2            py36h7ea6df4_4
[conda] torch                     1.3.0                    pypi_0    pypi
[conda] torchfile                 0.1.0                    pypi_0    pypi
[conda] torchnet                  0.0.4                    pypi_0    pypi
[conda] torchsummary              1.5.1                    pypi_0    pypi
[conda] torchvision               0.4.0                    pypi_0    pypi


cc @suo @jerryzh168 @jianyuh @dzhulgakov @raghuramank100. ['\r\n2019-10-20 16:33:20.005883+0300 PyTorchDemo[592:88998] false CHECK FAILED at /Users/distiller/project/aten/src/ATen/native/quantized/cpu/qlinear_dynamic.cpp\r\nThe above operation failed in interpreter, with the following stack trace:\r\nat code/__torch__/torchvision/models/resnet/___torch_mangle_59.py:288:8\r\n    input49 = torch._convolution(input48, weight35, None, [1, 1], [1, 1], [1, 1], False, [0, 0], 1, False, False, True)\r\n    input50 = torch.batch_norm(input49, weight36, bias17, running_mean17, running_var17, False, 0.10000000000000001, 1.0000000000000001e-05, True)\r\n    input51 = torch.relu_(input50)\r\n    input52 = torch._convolution(input51, weight37, None, [1, 1], [1, 1], [1, 1], False, [0, 0], 1, False, False, True)\r\n    out6 = torch.batch_norm(input52, weight38, bias18, running_mean18, running_var18, False, 0.10000000000000001, 1.0000000000000001e-05, True)\r\n    input53 = torch.add_(out6, input48, alpha=1)\r\n    input54 = torch.relu_(input53)\r\n    x = torch.adaptive_avg_pool2d(input54, [1, 1])\r\n    x0 = torch.flatten(x, 1, -1)\r\n    Y = ops.quantized.linear_dynamic(x0, _35)\r\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <--- HERE\r\n    return torch.to(Y, 6, False, False)\r\nCompiled from code /Users/tolik/anaconda3/lib/python3.6/site-packages/torch/nn/quantized/dynamic/modules/linear.py(42): forward\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py(525): _slow_forward\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py(539): __call__\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torchvision/models/resnet.py(208): forward\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py(525): _slow_forward\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py(539): __call__\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/jit/__init__.py(997): trace_module\r\n/Users/tolik/anaconda3/lib/python3.6/site-packages/torch/jit/__init__.py(858): trace\r\nrepro.py(17): <module>\r\n', ""\r\nimport torch\r\nfrom torchvision.models import resnet18\r\n\r\nmodel = resnet18()\r\nmodel.eval()\r\nexample = torch.rand(1, 3, 224, 224)\r\n\r\ntraced_script_module = torch.jit.trace(model, example)\r\ntraced_script_module.save('/tmp/resnet18_float32.pt')\r\n\r\n\r\nmodel = resnet18()\r\nmodel.eval()\r\nexample = torch.rand(1, 3, 224, 224)\r\n\r\nmodel = torch.quantization.quantize_dynamic(model, dtype=torch.qint8)\r\ntraced_script_module = torch.jit.trace(model, example)\r\ntraced_script_module.save('/tmp/resnet18_qint8.pt')\r\n""]"
656,8330,0,"x.copy_(y) doesn't work with sparse x. 

There isn't really any reason this shouldn't work; internally we have all the pieces implemented already.. ['\r\n>>> i = torch.LongTensor([[0, 2], [1, 0], [1, 2]])\r\n>>> v = torch.FloatTensor([3,      4,      5    ])\r\n>>> x = torch.sparse.FloatTensor(i.t(), v, torch.Size([2,3]))\r\n>>> x2 = torch.sparse.FloatTensor(i.t(), v, torch.Size([2,3]))\r\n>>> x.copy_(x2)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nRuntimeError: copy does not support torch.sparse.FloatTensor to torch.sparse.FloatTensor copy.\r\n']"
321,2001,0,"Implement similar PyTorch function as model.summary() in keras?.  in keras gives a very fine visualization of your model and it's very convenient when it comes to debugging the network. Can we try to implement something like it in PyTorch?

cc @ezyang @gchanan @zou3519 @bdhirsh @jbschlosser @albanD @mruberry. []"
727,27569,0,"Export from TorchScript to ONNX: torch.onnx.symbolic_opset9.dim does not exist. ## üêõ Bug

TorchScript -> ONNX conversion of a simple module fails

If one doesn‚Äôt jit-compile the model, everything works.

## To Reproduce



Output



## Expected behavior

I expected that a jit-compiled module consisting of just two  children should export to ONNX without hassle.

## Environment

Google Colab, I think at the moment it has PyTorch 1.2.0 and Python 3.6

## Additional context
I played around with TorchScript tracing / ONNX export of modules that work with namedtuples, got some errors. Trying to get a minimal example has led me to this code with no namedtuples.

cc @suo. ['\r\nfrom tempfile import TemporaryFile\r\n\r\nimport torch\r\nimport torch.onnx\r\nimport torch.jit\r\nfrom torch import nn, Tensor\r\n\r\nprint(f""PyTorch version is {torch.__version__}"")\r\n\r\nclass Model(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.module = nn.Linear(\r\n            in_features=8, out_features=4)\r\n        self.module2 = nn.Linear(\r\n            in_features=4, out_features=2)\r\n       \r\n    def forward(self, x: Tensor) -> Tensor:\r\n        preout = self.module(x)\r\n        out = self.module2(preout)\r\n        return out\r\n\r\n\r\nmodel = Model()\r\nmodel = torch.jit.script(model)\r\n\r\ndummy_input = torch.randn(3, 8)\r\ndummy_output = model(dummy_input)\r\n\r\nwith TemporaryFile() as temp:\r\n    torch.onnx.export(model=model, \r\n                      args=dummy_input, \r\n                      example_outputs=dummy_output,\r\n                      f=temp, \r\n                      verbose=True)\r\n', '\r\nPyTorch version is 1.2.0\r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py:562: UserWarning: ONNX export failed on ATen operator dim because torch.onnx.symbolic_opset9.dim does not exist\r\n  .format(op_name, opset_version, op_name))\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-1-036960002e79> in <module>()\r\n     33                       example_outputs=dummy_output,\r\n     34                       f=temp,\r\n---> 35                       verbose=True)\r\n \r\n7 frames\r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/__init__.py in export(model, args, f, export_params, verbose, training, input_names, output_names, aten, export_raw_ir, operator_export_type, opset_version, _retain_param_name, do_constant_folding, example_outputs, strip_doc_string, dynamic_axes)\r\n    130                         operator_export_type, opset_version, _retain_param_name,\r\n    131                         do_constant_folding, example_outputs,\r\n--> 132                         strip_doc_string, dynamic_axes)\r\n    133\r\n    134\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py in export(model, args, f, export_params, verbose, training, input_names, output_names, aten, export_raw_ir, operator_export_type, opset_version, _retain_param_name, do_constant_folding, example_outputs, strip_doc_string, dynamic_axes)\r\n     62             operator_export_type=operator_export_type, opset_version=opset_version,\r\n     63             _retain_param_name=_retain_param_name, do_constant_folding=do_constant_folding,\r\n---> 64             example_outputs=example_outputs, strip_doc_string=strip_doc_string, dynamic_axes=dynamic_axes)\r\n     65\r\n     66\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py in _export(model, args, f, export_params, verbose, training, input_names, output_names, operator_export_type, export_type, example_outputs, propagate, opset_version, _retain_param_name, do_constant_folding, strip_doc_string, dynamic_axes)\r\n    327                                                         output_names, operator_export_type,\r\n    328                                                         example_outputs, propagate,\r\n--> 329                                                         _retain_param_name, do_constant_folding)\r\n    330\r\n    331         # TODO: Don\'t allocate a in-memory string for the protobuf\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py in _model_to_graph(model, args, verbose, training, input_names, output_names, operator_export_type, example_outputs, propagate, _retain_param_name, do_constant_folding, _disable_torch_constant_prop)\r\n    223\r\n    224     graph = _optimize_graph(graph, operator_export_type,\r\n--> 225                             _disable_torch_constant_prop=_disable_torch_constant_prop)\r\n    226\r\n    227     if isinstance(model, torch.jit.ScriptModule) or isinstance(model, torch.jit.Function):\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py in _optimize_graph(graph, operator_export_type, _disable_torch_constant_prop)\r\n    125         torch._C._jit_pass_erase_number_types(graph)\r\n    126\r\n--> 127         graph = torch._C._jit_pass_onnx(graph, operator_export_type)\r\n    128         torch._C._jit_pass_lint(graph)\r\n    129         from torch.onnx.symbolic_helper import _export_onnx_opset_version\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/__init__.py in _run_symbolic_function(*args, **kwargs)\r\n    161 def _run_symbolic_function(*args, **kwargs):\r\n    162     from torch.onnx import utils\r\n--> 163     return utils._run_symbolic_function(*args, **kwargs)\r\n    164\r\n    165\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py in _run_symbolic_function(g, n, inputs, env, operator_export_type)\r\n    561                                   ""torch.onnx.symbolic_opset{}.{} does not exist""\r\n    562                                   .format(op_name, opset_version, op_name))\r\n--> 563                 op_fn = sym_registry.get_registered_op(op_name, \'\', opset_version)\r\n    564                 return op_fn(g, *inputs, **attrs)\r\n    565\r\n \r\n/usr/local/lib/python3.6/dist-packages/torch/onnx/symbolic_registry.py in get_registered_op(opname, domain, version)\r\n     89         warnings.warn(""ONNX export failed. The ONNX domain and/or version are None."")\r\n     90     global _registry\r\n---> 91     return _registry[(domain, version)][opname]\r\n\r\nKeyError: \'dim\'\r\n']"
692,3243,0,"Compile error:  ‚Äò__T0‚Äô was not declared in this scope. When I build PyTorch from source following the [README directions][1], I get an error:



Machine details:

* nvcc release 7.5, V7.5.17
* gcc version 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC)
* gcc version 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC)
* Python 3.6.1 with Anaconda
* OS: Red Hat

I'm not sure if I have cuDNN. I am using Amazon's EC2 Deep Learning AMI, and they say they have cuDNN drivers: https://aws.amazon.com/amazon-ai/amis/

[1]:https://github.com/pytorch/pytorch#from-source. [' shell\r\n[ 64%] Building CXX object gloo/CMakeFiles/gloo.dir/transport/tcp/device.cc.o\r\n[ 68%] Building CXX object gloo/CMakeFiles/gloo.dir/transport/tcp/pair.cc.o\r\n[ 72%] Linking CXX static library libgloo.a\r\n[ 72%] Built target gloo\r\n[ 76%] Building NVCC (Device) object gloo/CMakeFiles/gloo_cuda.dir/gloo_cuda_generated_cuda_private.cu.o\r\n[ 80%] Building NVCC (Device) object gloo/CMakeFiles/gloo_cuda.dir/gloo_cuda_generated_cuda.cu.o\r\n/home/ec2-user/pytorch/torch/lib/gloo/gloo/common/linux.h:26:26: error: ‚Äò__T0‚Äô was not declared in this scope\r\n const auto kPCIClass3D = PCIClassMatch{0x030200, 0xffff00};\r\n                          ^\r\n/home/ec2-user/pytorch/torch/lib/gloo/gloo/common/linux.h:29:31: error: ‚Äò__T0‚Äô was not declared in this scope\r\n const auto kPCIClassNetwork = PCIClassMatch{0x020000, 0xff0000};\r\n                               ^\r\nCMake Error at gloo_cuda_generated_cuda_private.cu.o.cmake:263 (message):\r\n  Error generating file\r\n  /home/ec2-user/pytorch/torch/lib/build/gloo/gloo/CMakeFiles/gloo_cuda.dir//./gloo_cuda_generated_cuda_private.cu.o\r\n\r\n\r\nmake[2]: *** [gloo/CMakeFiles/gloo_cuda.dir/gloo_cuda_generated_cuda_private.cu.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\n/home/ec2-user/pytorch/torch/lib/gloo/gloo/common/linux.h:26:26: error: ‚Äò__T0‚Äô was not declared in this scope\r\n const auto kPCIClass3D = PCIClassMatch{0x030200, 0xffff00};\r\n                          ^\r\n/home/ec2-user/pytorch/torch/lib/gloo/gloo/common/linux.h:29:31: error: ‚Äò__T0‚Äô was not declared in this scope\r\n const auto kPCIClassNetwork = PCIClassMatch{0x020000, 0xff0000};\r\n                               ^\r\nCMake Error at gloo_cuda_generated_cuda.cu.o.cmake:263 (message):\r\n  Error generating file\r\n  /home/ec2-user/pytorch/torch/lib/build/gloo/gloo/CMakeFiles/gloo_cuda.dir//./gloo_cuda_generated_cuda.cu.o\r\n\r\n\r\nmake[2]: *** [gloo/CMakeFiles/gloo_cuda.dir/gloo_cuda_generated_cuda.cu.o] Error 1\r\nmake[1]: *** [gloo/CMakeFiles/gloo_cuda.dir/all] Error 2\r\nmake: *** [all] Error 2 \xa0\r\n']"
573,4408,0,"torch.onnx.export fails on Linear when bias=False, torch.onnx.symbolic.matmul does not exist. Using  on a model that contains a linear layer with no bias, I receive an error: 



I've constructed a minimal working example that reproduces this


Environment Info:
. ['python\r\n~/venv3/lib/python3.5/site-packages/torch/onnx/__init__.py:312: UserWarning: ONNX export failed on matmul because torch.onnx.symbolic.matmul does not exist\r\n  File ""~/venv3/lib/python3.5/site-packages/torch/onnx/__init__.py"", line 151, in _export\r\n    proto = trace.export([], _onnx_opset_version)\r\nRuntimeError: ONNX export failed: Couldn\'t export operator matmul\r\n\r\nGraph we tried to export:\r\ngraph(%0 : Float(1, 128)\r\n      %1 : Float(2, 128)) {\r\n  %2 : Float(128!, 2!) = Transpose[perm=[1, 0]](%1), scope: Linear\r\n  %3 : Float(1, 2) = matmul(%0, %2), scope: Linear\r\n  return (%3);\r\n}\r\n', ""python\r\ndef mwe_bias():\r\n    linear = torch.nn.Linear(128, 2, bias=1)\r\n    args = tuple([torch.autograd.Variable(torch.randn(1, 128), requires_grad=True)])\r\n    torch.onnx.export(linear, args, 'foo.onnx', export_params=False)\r\n\r\n\r\ndef mwe_nobias():\r\n    linear = torch.nn.Linear(128, 2, bias=0)\r\n    args = tuple([torch.autograd.Variable(torch.randn(1, 128), requires_grad=True)])\r\n    torch.onnx.export(linear, args, 'foo.onnx', export_params=False)\r\n\r\n# does not cause an error\r\nmwe_bias()\r\n# Causes an error\r\nmwe_nobias()\r\n"", ""python\r\nsys.platform = linux\r\nsys.version = 3.5.2 (default, Nov 17 2016, 17:05:23) \\n[GCC 5.4.0 20160609]\r\ntorch.version.__version__ = '0.4.0a0+af3bffb'\r\ntorch.version.cuda = 8.0.61\r\n""]"
219,23070,0,"adam.py KeyError: 'betas'. ## üêõ Bug

File ""STS_main.py"", line 196, in <module>
    model, optimizer, loss = train(model, train_iter, optimizer, criterion)
  File ""STS_main.py"", line 72, in train
    optimizer.step()
  File ""/home/ubuntu/anaconda3/lib/python3.6/site-packages/torch/optim/adam.py"", line 85, in step
    beta1, beta2 = group['betas']
KeyError: 'betas'
. []"
340,17126,0,"Support callables in scripted functions. ## üöÄ Feature
Allow for callables (notably other scripted functions or ScriptModules) to be passed to scripted functions (Currently fails with ).

## Motivation

Attempting to tease out fusions from larger codebases (in my case maskrcnn_benchmark) where some blocks of code may not be scriptable, but subsets of those blocks may be. In a concrete example, I have a module which contains loop over sets of inputs & modules, where  is seen.  is itself a ScriptModule, and I'd like to be able to add the  to a fused group that's already being generated within that ScriptModule. However, there are several things that prevent the outermost module from being scripted. Pulling out the relevant code to a separate function like:


Should allow the desired fusion, but is currently not supported.

## Pitch

Allow callables (at least ScriptModules) to be passed as arguments to scripted functions and called.

## Alternatives

My specific use-case disappears as the scripting supports a certain level of python, but I would expect there to be other use-cases.

## Additional context

This is a proxy code I wrote to make sure that the error I was seeing wasn't from the larger application. This fails with . 




cc @suo. ['\r\n@torch.jit.script\r\ndef impl(m, x. y):\r\n    return m(x) + y\r\n', '\r\nimport torch\r\n\r\nclass Bias(torch.jit.ScriptModule):\r\n    def __init__(self, num_channels):\r\n        super(Bias, self).__init__()\r\n\r\n        self.bias = torch.nn.Parameter(torch.zeros(num_channels))\r\n\r\n    @torch.jit.script_method\r\n    def forward(self, x):\r\n        return x + self.bias.reshape(1, -1, 1, 1)\r\n\r\n@torch.jit.script\r\ndef fwd_impl(b, x, y):\r\n    return b(x) + y\r\n\r\n# Note: Not-scriptable in real app\r\nclass OuterModule(torch.nn.Module):\r\n    def __init__(self, n):\r\n        super(OuterModule, self).__init__()\r\n  \r\n        self.bias = Bias(n)\r\n\r\n    def forward(self, x, y):\r\n        return fwd_impl(self.bias, x, y)\r\n\r\nn, c, h, w = 32, 4, 16, 16\r\nx = torch.randn(n, c, h, w).cuda()\r\ny = torch.randn(n, c, h, w).cuda()\r\nm = OuterModule(c).cuda()\r\n\r\nwith torch.no_grad():\r\n    z = m(x, y)\r\n']"
272,21459,0,"RuntimeError: cublas runtime error . RuntimeError: cublas runtime error : the GPU program failed to execute at /pytorch/aten/src/THC/THCBlas.cu:411
My GPU is 2080ti,CUDA 10.0
How can I slove the problem?Thank you.. []"
427,7396,0,[JIT][script] Implement `train` on ScriptModules. []
91,1509,1,"GPU memory consumption increases while training. Hello, all
I am new to Pytorch and I meet a strange GPU memory behavior while training a CNN model for semantic segmentation. Batchsize = 1, and there are totally 100 image-label pairs in trainset, thus 100 iterations per epoch. However the **GPU memory consumption increases a lot at the first several iterations while training**.

[Platform] GTX TITAN X (12G), CUDA-7.5, cuDNN-5.0

> torch.backends.cudnn.enabled = False
> torch.backends.cudnn.benchmark = False

Then GPU memory consumption is **2934M -- 4413M -- 4433M -- 4537M -- 4537M -- 4537M** at the first six iterations.

> torch.backends.cudnn.enabled = True
> torch.backends.cudnn.benchmark = True

Then GPU memory consumption is **1686M -- 1791M -- 1791M -- 1791M -- 1791M -- 1791M** at the first six iterations.

**Why GPU memory consumption increases while training, especially, increases so largely while no cuDNN? (In my opinion, GPU memory consumption won't increase while the CNN has been build and starts training)** 

Does anyone meet the same problem? Or could anyone give some help?

This is the code snippet:

. [""Python\r\ndef train(train_loader, model, criterion, optimizer, epoch):\r\n    batch_time = AverageMeter()\r\n    data_time = AverageMeter()\r\n    losses = AverageMeter()\r\n\r\n    # switch to train mode\r\n    model.train()\r\n\r\n    end = time.time()\r\n    for i, (input, target) in enumerate(train_loader):\r\n        # measure data loading time\r\n        data_time.update(time.time() - end)\r\n\r\n        target = target.long()\r\n        input = input.cuda(async=True)\r\n        target = target.cuda(async=True)\r\n        input_var = torch.autograd.Variable(input)\r\n        target_var = torch.autograd.Variable(target)\r\n\r\n        # compute output\r\n        output = model(input_var)\r\n        loss = criterion(output, target_var)\r\n\r\n        # record loss\r\n        losses.update(loss.data[0], input.size(0))\r\n\r\n        # compute gradient and do SGD step\r\n        optimizer.zero_grad()\r\n        loss.backward()\r\n        optimizer.step()\r\n\r\n        # measure elapsed time\r\n        batch_time.update(time.time() - end)\r\n        end = time.time()\r\n\r\n        if i % args.print_freq == 0:\r\n            print('Epoch: [{0}][{1}/{2}]\\t'\r\n                  'Time {batch_time.val:.3f} ({batch_time.avg:.3f})\\t'\r\n                  'Data {data_time.val:.3f} ({data_time.avg:.3f})\\t'\r\n                  'Loss {loss.val:.4f} ({loss.avg:.4f})'.format(\r\n                   epoch, i+1, len(train_loader),\r\n                   batch_time=batch_time,\r\n                   data_time=data_time,\r\n                   loss=losses))\r\n""]"
502,3326,0,"nn.EmbeddingBag doesn't seem to support None offset for 2D tensors. Example

Gives
RuntimeError: expected a Variable argument, but got torch.LongTensor. ['\r\nimport torch\r\nfrom torch import nn\r\nfrom torch.autograd import Variable\r\na = Variable(torch.LongTensor([[1, 0, 2], [2, 1, 0], [0, 0, 1]]))\r\nembed = nn.EmbeddingBag(3, 4)\r\nembed(a)\r\n']"
671,26922,0,"DistAutogradContainer should not expose references for DistAutogradContext. More Context here: https://github.com/pytorch/pytorch/pull/25527/files#r328763171

DistAutogradContainer's API currently exposes mutable references to DistAutogradContext. This could lead to 'use after free' scenarios where DistAutogradContainer cleans up the context, but there is another thread that continues to use the reference. We should modify the API to ensure it returns shared_ptrs to the user to avoid any sort of ownership issues.

cc @ezyang @gchanan @zou3519 @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. []"
243,25481,0,"[feature request] symmetric matrix square root. This is needed when incorporating curvature information into optimization

There's PyTorch implementation of symmetric matrix square root op [here](https://github.com/msubhransu/matrix-sqrt) but they use PyTorch for backward pass only, and use scipy for forward pass

I've hacked something together by mirroring 




cc @vincentqb @vishwakftw @jianyuh @nikitaved @pearu @mruberry @heitorschueroff @SsnL. ['\r\n def symsqrt(a, cond=None, return_rank=False):\r\n    """"""Computes the symmetric square root of a positive definite matrix""""""\r\n\r\n    s, u = torch.symeig(a, eigenvectors=True)\r\n    cond_dict = {torch.float32: 1e3 * 1.1920929e-07, torch.float64: 1E6 * 2.220446049250313e-16}\r\n\r\n    if cond in [None, -1]:\r\n        cond = cond_dict[a.dtype]\r\n\r\n    above_cutoff = (abs(s) > cond * torch.max(abs(s)))\r\n\r\n    psigma_diag = torch.sqrt(s[above_cutoff])\r\n    u = u[:, above_cutoff]\r\n\r\n    B = u @ torch.diag(psigma_diag) @ u.t()\r\n    if return_rank:\r\n        return B, len(psigma_diag)\r\n    else:\r\n        return B\r\n\r\ndef symsqrt_test():\r\n    def randomly_rotate(X):\r\n        """"""Randomly rotate d,n data matrix X""""""\r\n        d, n = X.shape\r\n        z = torch.randn((d, d), dtype=X.dtype)\r\n        q, r = torch.qr(z)\r\n        d = torch.diag(r)\r\n        ph = d / abs(d)\r\n        rot_mat = q * ph\r\n        return rot_mat @ X\r\n\r\n    n = 20\r\n    d = 10\r\n    X = torch.randn((d, n))\r\n\r\n    # embed in a larger space\r\n    X = torch.cat([X, torch.zeros_like(X)])\r\n    X = randomly_rotate(X)\r\n    cov = X @ X.t()\r\n    sqrt, rank = symsqrt(cov, return_rank=True)\r\n    assert rank == d\r\n    assert torch.allclose(sqrt @ sqrt, cov, atol=1e-5)\r\n']"
552,15202,0,"The font size of equations in tutorial is too small. The tutorial at: https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#gradients
![image](https://user-images.githubusercontent.com/1032377/49982017-a95cb500-ff28-11e8-9465-7b0da9ce39c4.png)
. []"
111,30139,0,"RuntimeError: isTensor() INTERNAL ASSERT FAILED at /pytorch/aten/src/ATen/core/ivalue_inl.h:90, please report a bug to PyTorch. Expected Tensor but got Int (toTensor at /pytorch/aten/src/ATen/core/ivalue_inl.h:90). So, what I'm trying to do is to to convert torchscript model into onnx. Both scripting and tracing works during the creation of graph, but fails when the model is converted into onnx

Here's the error:

> 
Traceback (most recent call last):
  File ""yolo2script.py"", line 8, in <module>
    torch.onnx.export(model_scripted, dummy_input, ""yolov3.onnx"", example_outputs=model(dummy_input))
  File ""/usr/local/lib/python3.6/dist-packages/torch/onnx/__init__.py"", line 143, in export
    strip_doc_string, dynamic_axes, keep_initializers_as_inputs)
  File ""/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py"", line 66, in export
    dynamic_axes=dynamic_axes, keep_initializers_as_inputs=keep_initializers_as_inputs)
  File ""/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py"", line 382, in _export
    fixed_batch_size=fixed_batch_size)
  File ""/usr/local/lib/python3.6/dist-packages/torch/onnx/utils.py"", line 235, in _model_to_graph
    method_graph, params = model.forward._lowered_graph()
RuntimeError: isTensor() INTERNAL ASSERT FAILED at /pytorch/aten/src/ATen/core/ivalue_inl.h:90, please report a bug to PyTorch. Expected Tensor but got Int (toTensor at /pytorch/aten/src/ATen/core/ivalue_inl.h:90)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x33 (0x7f83210f0813 in /usr/local/lib/python3.6/dist-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1876251 (0x7f82bdc7d251 in /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch.so)
frame #2: torch::jit::script::Method::_lowered_graph() + 0x161 (0x7f82c0420771 in /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x5af698 (0x7f832229b698 in /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch_python.so)
frame #4: <unknown function> + 0x2110f4 (0x7f8321efd0f4 in /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #6: python3() [0x4f88ba]
frame #8: python3() [0x4f6128]
frame #9: python3() [0x4f7d60]
frame #10: python3() [0x4f876d]
frame #12: python3() [0x4f6128]
frame #13: python3() [0x4f7d60]
frame #14: python3() [0x4f876d]
frame #16: python3() [0x4f6128]
frame #17: python3() [0x4f7d60]
frame #18: python3() [0x4f876d]
frame #20: python3() [0x4f6128]
frame #21: python3() [0x4f7d60]
frame #22: python3() [0x4f876d]
frame #24: python3() [0x4f6128]
frame #26: python3() [0x6415b2]
frame #31: __libc_start_main + 0xe7 (0x7f83267afb97 in /lib/x86_64-linux-gnu/libc.so.6)

Here's my system:

Collecting environment information...
PyTorch version: 1.3.1
Is debug build: No
CUDA used to build PyTorch: 10.1.243

OS: Ubuntu 18.04.2 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: version 3.16.0-rc3

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration: GPU 0: GeForce GTX 1060 with Max-Q Design
Nvidia driver version: 418.87.00
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.2

Versions of relevant libraries:
[pip3] efficientnet-pytorch==0.4.0
[pip3] numpy==1.17.4
[pip3] torch==1.3.1
[pip3] torch2trt==0.0.2
[pip3] torchetl==0.3.9
[pip3] torchvision==0.4.2
[conda] Could not collect




If you need the model source code, I will provide it to you asap. Thank you !

cc @houseroad @spandantiwari @lara-hdr @BowenBao @neginraoof. []"
107,14320,0,"[caffe2] Fails to build with fbgemm enabled. ## üêõ Bug

Caffe2 git master fails to build with fbgemm enabled (), giving the following error:

This error seems to be caused by the recent commit https://github.com/pytorch/pytorch/commit/fb8c3d62feacf5c3d39f6fb034db944a89a0bcf4. It was building fine some commits before it.

## To Reproduce

Steps to reproduce the behavior:

1. mkdir build
1. cd build
1. [cmake options](https://bpaste.net/show/ca5a7eb99368)
1. make -j1

## Expected behavior

A succesful build with fbgemm enabled.

## Environment

 - **PyTorch Version:** git master (currently at https://github.com/pytorch/pytorch/commit/f79fb58744ba70970de652e46ea039b03e9ce9ff)
 - **OS:** Arch Linux x86_64
 - **How you installed PyTorch:** source
 - **Build command you used (if compiling from source):** already shown above
 - **Python version:** 3.7.1
 - **CUDA/cuDNN version:** not enabled in this example
 - **GPU models and configuration:** not enabled in this example
 - **Compiler:** gcc 8.2.1
 - **Any other relevant information:** the same error occurs when enabling cuda and using gcc 7.3.1

## Additional context

It builds fine when disabling fbgemm ().. ['\r\n[ 45%] Building CXX object caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o\r\nIn file included from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/dnnlowp.h:11,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/caffe2_dnnlowp_utils.h:4,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/utility_dnnlowp_ops.h:4,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/elementwise_sum_dnnlowp_op_avx2.cc:1:\r\n/storage/linux/abs/caffe2-git/src/pytorch/third_party/fbgemm/include/fbgemm/QuantUtils.h:9:10: fatal error: cpuinfo.h: No such file or directory\r\n #include <cpuinfo.h>\r\n          ^~~~~~~~~~~\r\ncompilation terminated.\r\nmake[2]: *** [caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/build.make:63: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o] Error 1\r\nmake[1]: *** [CMakeFiles/Makefile2:4460: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/all] Error 2\r\nmake: *** [Makefile:141: all] Error 2\r\n']"
325,27694,0,"Deployment training model at C + + end. When the model does not contain a custom layer, it can be deployed directly on the C + + side using JIT mechanism and libtorch library.

But my model contains a custom c++ and CUDA layer. Now that I'm deploying the model on the c++ side, do I need to compile the custom c++ and CUDA layers into the libtorch library?
Thank you!!!

cc @suo @yf225. []"
732,7496,0,"Train a model using multiple GPUs . ## Issue Description
I tried to train my model on multiple gpus. However, when I launch the program, it seems that the model is allocated to gpus, but no data is fed into model. Using nvidia-smi, i find hundreds of MB of memory is consumed on each gpu. I guess these memory usage is for model initialization in each gpu.

I am sharing 8 gpus with others on the server, so I limit my program on GPU 2 and GPU 3 by following command.


## Code example
I ran this official tutorial on my machine and the same thing happens again. https://pytorch.org/tutorials/beginner/blitz/data_parallel_tutorial.html

## System Info
PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 8.0.61

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 7.5.17
GPU models and configuration:
GPU 0: GeForce GTX TITAN X
GPU 1: GeForce GTX TITAN X
GPU 2: GeForce GTX TITAN X
GPU 3: GeForce GTX TITAN X
GPU 4: GeForce GTX TITAN X
GPU 5: GeForce GTX TITAN X
GPU 6: GeForce GTX TITAN X
GPU 7: GeForce GTX TITAN X

Nvidia driver version: 375.88
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.5.1.10
/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.20
/usr/lib/x86_64-linux-gnu/libcudnn_static_v5.a
/usr/lib/x86_64-linux-gnu/libcudnn_static_v6.a
/usr/local/lib/python2.7/dist-packages/torch/lib/libcudnn.so.6

Versions of relevant libraries:
[pip3] msgpack-numpy (0.4.1)
[pip3] numpy (1.14.0)
[pip3] numpydoc (0.7.0)
[pip3] torch (0.4.0)
[pip3] torchtext (0.2.3)
[pip3] torchvision (0.2.1)
[conda] torch                     0.4.0                     <pip>
[conda] torchtext                 0.2.3                     <pip>
[conda] torchvision               0.2.1                     <pip>. [""python\r\nos.environ['CUDA_VISIBLE_DEVICES'] = '2,3'\r\n""]"
220,4894,0,"Inconsistent size error when using pin_memory() after torch.unbind(). - OS: Ubuntu 14.04
- PyTorch version: 0.3.0.post4
- How you installed PyTorch: conda
- Python version: 3.6.3
- CUDA version: 8

Script to reproduce the error:

. ['python\r\nimport torch\r\na = torch.zeros(3, 4)\r\na1, a2, a3 = torch.unbind(a, 0)\r\na1 = a1.pin_memory()\r\n', '\r\nTraceback (most recent call last):\r\n\r\n  File ""<ipython-input-67-b93d604f6d7e>"", line 1, in <module>\r\n    a1 = a1.pin_memory()\r\n\r\n  File ""<path-to>/anaconda3/lib/python3.6/site-packages/torch/tensor.py"", line 82, in pin_memory\r\n    return type(self)().set_(storage.pin_memory()).view_as(self)\r\n\r\n  File ""<path-to>/anaconda3/lib/python3.6/site-packages/torch/tensor.py"", line 198, in view_as\r\n    return self.view(tensor.size())\r\n\r\nRuntimeError: invalid argument 2: size \'[4]\' is invalid for input with 12 elements at /opt/conda/conda-bld/pytorch_1512386481460/work/torch/lib/TH/THStorage.c:41\r\n']"
237,145,0,"embeddings layer with IntTensor / cuda.IntTensor inputs. Would it be possible to feed the embedding layer with IntTensors rather than LongTensors only?
. []"
163,23393,0,"RuntimeError: set_storage is not allowed on Tensor created from .data or .detach(). ## üêõ Bug Here is the issue while trying to execute the this bunch of code. 

<!-- A clear and concise description of what the bug is. -->

## My code is below..



   
   
    
 = 




 - PyTorch Version (1.0):
 - Linux
 - pip3 install torchvision:
 - Build command you used (if compil:
 - Python version 3.7


. [""\r\nbob = sy.VirtualWorker(hook, id='bob')\r\nalice = sy.VirtualWorker(hook, id='alice')\r\nsecure_worker = sy.VirtualWorker(hook, id='secure_worker')\r\n"", '\r\nbob.add_workers([alice, secure_worker])\r\nalice.add_workers([bob, secure_worker])\r\nsecure_worker.add_workers([alice, bob])\r\n', '\r\ndata = th.tensor([[1,1],[0,0],[0,1],[1,0.]], requires_grad = True)\r\ntarget = th.tensor([[0],[1],[1],[0.]], requires_grad = True)\r\nbob_data = data[0:2].send(bob)\r\nbob_target = data[0:2].send(bob)\r\nalice_data = data[2:0].send(alice)\r\nalice_target = data[2:0].send(alice)\r\nmodel = nn.Linear(2,1)\r\nbob_model = model.copy().send(bob)\r\nalice_model = model.copy().send(alice)\r\nbob_opt = optim.SGD(params=bob_model.parameters(), lr=0.1)\r\nalice_opt = optim.SGD(params=alice_model.parameters(), lr=0.1)\r\n\r\nbob_opt.zero_grad()\r\nbob_pred = bob_model(bob_data)\r\nbob_loss = ((bob_pred - bob_target)**2).sum()\r\nbob_loss.backward()\r\nbob_opt.step()\r\nbob_loss = bob_loss.get().data\r\n    \r\nalice_opt.zero_grad()\r\nalice_pred = alice_model(alice_data)\r\nalice_loss = ((alice_pred - alice_target)**2).sum()\r\nalice_loss.backward()\r\nalice_opt.step()\r\nalice_loss = alice_loss.get().data\r\n    \r\nalice_model.move(secure_worker)\r\nbob_model.move(secure_worker)\r\nsecure_worker._objects\r\n\r\n> {49257609311: Parameter containing:\r\n tensor([[-0.5138, -0.4376]], requires_grad=True),\r\n 44327728419: Parameter containing:\r\n tensor([-0.2540], requires_grad=True),\r\n 3967825735: Parameter containing:\r\n tensor([[0.3148, 0.3909]], requires_grad=True),\r\n 97077675381: Parameter containing:\r\n tensor([0.1789], requires_grad=True)}\r\n----> model.weight.data.set_(((alice_model.weight.data + bob_model.weight.data) /2).get())\r\n\r\n\r\nRuntimeError Traceback (most recent call last)\r\n<ipython-input-26-841b837bc662> in <module>\r\n----> 1 model.weight.data.set_(((alice_model.weight.data + bob_model.weight.data) /2).get())\r\n\r\nRuntimeError: set_storage is not allowed on Tensor created from .data or .detach()\r\n']"
190,3395,0,"dlopen libnvrtc instead of dynamically linking against it. Starting from commit https://github.com/pytorch/pytorch/commit/50e51eaa7fa5c252c2f4508cb5984734050177f1 we are linking against nvrtc and libcuda on CUDA builds. 
This has two consequences:
- pytorch CUDA builds can only be done on GPU-enabled machines, because libcuda.so comes with the nvidia driver
- the pytorch binaries with libcuda.so link dependency cant be run on CPU-only machines.

We need to fix this, and instead dlopen nvrtc, so that we can ship the next set of binaries to run on CPU / CUDA machines (just like our previous releases).. []"
32,5812,1,"memory leaky on DataLoader. - OS: Ubuntu16.04
- PyTorch version: 0.3.1
- PyTorchNet version: 0.0.1
- How you installed PyTorch (conda, pip, source): conda
- Python version: 3.6.4
- CUDA/cuDNN version: CUDA 9.0.176/cuDNN 7.0.5.15

**The script to reproduce the bug:** 

**Error messages**

- The  of  is set to 64, then on epoch 1, before :
![screenshot from 2018-03-15 20-23-31](https://user-images.githubusercontent.com/9991443/37463453-30928920-2890-11e8-93d0-d0dbad043997.png)

- After , you could see the memory is grow up to about 3 times:
![screenshot from 2018-03-15 20-24-00](https://user-images.githubusercontent.com/9991443/37463507-5f8d2992-2890-11e8-9f7d-b6a754314c6a.png)

- Furthermore, if I change the  of  to 1000, then on epoch 1, before , you could see the memory use is just only **715MB**, it's strange:
<img width=""867"" alt=""qq20180315-225225 2x"" src=""https://user-images.githubusercontent.com/9991443/37471232-3815a042-28a4-11e8-89e5-b971a9e3af93.png"">

- After , you could see the memory haven't change:
<img width=""748"" alt=""qq20180315-225238 2x"" src=""https://user-images.githubusercontent.com/9991443/37471400-8e578920-28a4-11e8-8c51-34bb35c80e6c.png"">
. ["" python\r\nfrom torch import nn\r\nfrom torch.autograd import Variable\r\nfrom torch.optim import Adam\r\nfrom torchnet.engine import Engine\r\nfrom tqdm import tqdm\r\nimport torchvision.transforms as transforms\r\nfrom torch.utils.data import DataLoader\r\nfrom torchvision.datasets import MNIST\r\n\r\nclass MNISTNet(nn.Module):\r\n    def __init__(self):\r\n        super(MNISTNet, self).__init__()\r\n        self.features = nn.Sequential(\r\n            nn.Conv2d(in_channels=1, out_channels=64, kernel_size=7, stride=2, padding=3),\r\n            nn.Conv2d(in_channels=64, out_channels=128, kernel_size=3, stride=2, padding=1),\r\n            nn.Conv2d(in_channels=128, out_channels=256, kernel_size=3, stride=2, padding=1),\r\n            nn.Conv2d(in_channels=256, out_channels=512, kernel_size=3, stride=2, padding=1),\r\n            nn.Conv2d(in_channels=512, out_channels=512, kernel_size=3, stride=1, padding=1)\r\n        )\r\n        self.classifier = nn.Linear(in_features=2 * 2 * 512, out_features=10)\r\n\r\n    def forward(self, x):\r\n        out = self.features(x)\r\n        out = out.view(out.size(0), -1)\r\n        classes = self.classifier(out)\r\n        return classes\r\n\r\n\r\ndef get_iterator(mode):\r\n    data = MNIST(root='./', train=mode, transform=transforms.ToTensor(), download=True)\r\n    return DataLoader(dataset=data, batch_size=64, shuffle=mode, num_workers=4)\r\n\r\n\r\ndef processor(sample):\r\n    data, labels, training = sample\r\n    data = Variable(data).cuda()\r\n    labels = Variable(labels).cuda()\r\n    classes = model(data)\r\n    loss = loss_criterion(classes, labels)\r\n    return loss, classes\r\n\r\n\r\ndef on_sample(state):\r\n    state['sample'].append(state['train'])\r\n\r\n\r\ndef on_start_epoch(state):\r\n    state['iterator'] = tqdm(state['iterator'])\r\n\r\n\r\ndef on_end_epoch(state):\r\n    engine.test(processor, get_iterator(False))\r\n\r\n\r\nif __name__ == '__main__':\r\n\r\n    model = MNISTNet().cuda()\r\n    loss_criterion = nn.CrossEntropyLoss().cuda()\r\n\r\n    optimizer = Adam(model.parameters())\r\n    engine = Engine()\r\n    engine.hooks['on_sample'] = on_sample\r\n    engine.hooks['on_start_epoch'] = on_start_epoch\r\n    engine.hooks['on_end_epoch'] = on_end_epoch\r\n\r\n    engine.train(processor, get_iterator(True), maxepoch=100, optimizer=optimizer)\r\n""]"
634,15839,0,"MyPy Type Hinting Stub Files?. ## üìö Documentation
### (should this be a feature request?)
<!-- A clear and concise description of what content in https://pytorch.org/docs is an issue. If this has to do with the general https://pytorch.org website, please file an issue at https://github.com/pytorch/pytorch.github.io/issues/new/choose instead. If this has to do with https://pytorch.org/tutorials, please file an issue at https://github.com/pytorch/tutorials/issues/new -->

Having  type annotated stub files ([PEP561](https://www.python.org/dev/peps/pep-0561/)) and type hinted source ([PEP484](https://www.python.org/dev/peps/pep-0484/)) would be beneficial for maintainability, new users, and making contributions easier. . []"
212,25172,0,"test_det_logdet_slogdet_batched (in test_cuda.py) fails on ppc64le. ## üêõ Bug



https://github.com/pytorch/pytorch/blob/v1.2.0/test/test_cuda.py#L2224 fails for me on ppc64le.

On following the test through to https://github.com/pytorch/pytorch/blob/v1.2.0/test/test_torch.py#L6558 and then testing all the different possible combinations, the failures are seen for all combinations of  and  in both  and  (the other tests in there are fine).

I went through and commented out the assert statements and printed out the tensors that were being compared for each of the combinations:



## To Reproduce

Steps to reproduce the behavior:

1. Build from source on ppc64le
1. Run the tests

## Expected behavior

The test should pass

## Environment

PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.1.105

OS: Red Hat Enterprise Linux
GCC version: (GCC) 8.2.0
CMake version: version 3.13.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 10.1.105
GPU models and configuration: 
GPU 0: Tesla V100-SXM2-16GB
GPU 1: Tesla V100-SXM2-16GB

Nvidia driver version: 418.67
cuDNN version: 7.4.2.24
magma version: 7.5.1

Versions of relevant libraries:
[pip3] numpy==1.16.2
[pip3] torch==1.2.0
[conda] Could not collect

PyTorch built from source
Build command: PYTORCH_BUILD_VERSION=1.2.0 PYTORCH_BUILD_NUMBER=1 VERBOSE=1 LDFLAGS=""$LDFLAGS -ldl"" CFLAGS="""" CXXFLAGS="""" USE_FFMPEG=ON USE_GLOO_IBVERBS=1 USE_GFLAGS=ON USE_GLOG=ON CUDNN_LIB_DIR=$EBROOTCUDNN/lib64 CUDNN_INCLUDE_DIR=$EBROOTCUDNN/include TORCH_CUDA_ARCH_LIST=""3.5 6.0 7.0""  /rds/bear-apps/devel/2019a/branfosj-eb-pytorch/EL7/EL7-power9/software/Python/3.7.2-GCCcore-8.2.0/bin/python setup.py build

. ['\r\n    @unittest.skipIf(not TEST_MAGMA, ""no MAGMA library detected"")\r\n    def test_det_logdet_slogdet_batched(self):\r\n        _TestTorchMixin._test_det_logdet_slogdet_batched(self, \'cuda\')\r\n', ""\r\n3\r\n(3,)\r\n    run_test(matsize, batchdims, mat_chars=['sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([-2.5175e-35, -1.5868e-38, -9.0737e-36], device='cuda:0')\r\ntensor([-4.0940e-35,  0.0000e+00,  0.0000e+00], device='cuda:0')\r\n\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([nan, nan, nan], device='cuda:0')\r\ntensor([nan, -inf, -inf], device='cuda:0')\r\n\r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([-1.,  0.,  0.], device='cuda:0')\r\ntensor([-1., -1., -1.], device='cuda:0')\r\n\r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([-79.1810,     -inf,     -inf], device='cuda:0')\r\ntensor([-79.6672, -87.0365, -80.6877], device='cuda:0')\r\n\r\n    run_test(matsize, batchdims, mat_chars=['sing', 'non_sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([ 3.8190e-34, -3.9619e-01, -3.5083e-33], device='cuda:0')\r\ntensor([ 6.4256e-34, -3.9619e-01, -1.0143e-32], device='cuda:0')\r\n\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([-76.9479,      nan,      nan], device='cuda:0')\r\ntensor([-76.4276,      nan,      nan], device='cuda:0')\r\n\r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([ 1., -1., -1.], device='cuda:0')\r\ntensor([ 1., -1., -1.], device='cuda:0')\r\n\r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([-76.4276,  -0.9259, -73.6685], device='cuda:0')\r\ntensor([-76.9479,  -0.9259, -74.7302], device='cuda:0')\r\n\r\n\r\n3 \r\n(5, 3)\r\n    run_test(matsize, batchdims, mat_chars=['sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[ 1.7500e-33, -3.9282e-36,  4.5183e-36],\r\n        [ 9.6257e-34,  8.1698e-35, -1.6681e-40],\r\n        [ 1.2369e-34,  1.6281e-35, -1.5470e-33],\r\n        [ 2.4720e-33, -2.6346e-33, -6.8148e-35],\r\n        [ 3.7382e-35, -1.8944e-33,  5.6313e-35]], device='cuda:0')\r\ntensor([[ 0.0000e+00,  0.0000e+00, -0.0000e+00],\r\n        [ 1.0046e-33,  6.8543e-35, -0.0000e+00],\r\n        [-0.0000e+00, -0.0000e+00,  0.0000e+00],\r\n        [ 2.3483e-33,  0.0000e+00,  0.0000e+00],\r\n        [ 0.0000e+00, -2.2742e-33,  0.0000e+00]], device='cuda:0')\r\n  \r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[-75.4257,      nan, -81.3849],\r\n        [-76.0235, -78.4900,      nan],\r\n        [-78.0753, -80.1031,      nan],\r\n        [-75.0803,      nan,      nan],\r\n        [-79.2719,      nan, -78.8621]], device='cuda:0')\r\ntensor([[    -inf,     -inf,     -inf],\r\n        [-75.9808, -78.6656,     -inf],\r\n        [    -inf,     -inf,     -inf],\r\n        [-75.1316,     -inf,     -inf],\r\n        [    -inf,      nan,     -inf]], device='cuda:0')\r\n  \r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([[ 0.,  0., -0.],\r\n        [ 1.,  1., -0.],\r\n        [-0., -0.,  0.],\r\n        [ 1.,  0.,  0.],\r\n        [ 0., -1.,  0.]], device='cuda:0')\r\ntensor([[ 1., -1.,  1.],\r\n        [ 1.,  1., -1.],\r\n        [ 1.,  1., -1.],\r\n        [ 1., -1., -1.],\r\n        [ 1., -1.,  1.]], device='cuda:0')\r\n  \r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([[    -inf,     -inf,     -inf],\r\n        [-75.9808, -78.6656,     -inf],\r\n        [    -inf,     -inf,     -inf],\r\n        [-75.1316,     -inf,     -inf],\r\n        [    -inf, -75.1637,     -inf]], device='cuda:0')\r\ntensor([[-75.4257, -81.5249, -81.3849],\r\n        [-76.0235, -78.4900, -91.5917],\r\n        [-78.0753, -80.1031, -75.5490],\r\n        [-75.0803, -75.0166, -78.6714],\r\n        [-79.2719, -75.3464, -78.8621]], device='cuda:0')\r\n\r\n    run_test(matsize, batchdims, mat_chars=['sing', 'non_sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[-7.2073e-35, -9.6858e-01,  2.1245e-34],\r\n        [-2.1929e-02, -3.3690e-33,  8.4981e-02],\r\n        [ 2.3438e-36,  8.2995e-01, -4.4813e-33],\r\n        [ 2.1107e+00,  3.5198e-34, -1.5583e+00],\r\n        [ 1.3380e-36,  2.1991e+00, -2.2806e-34]], device='cuda:0')\r\ntensor([[-0.0000e+00, -9.6858e-01,  0.0000e+00],\r\n        [-2.1929e-02, -2.5940e-33,  8.4981e-02],\r\n        [-0.0000e+00,  8.2995e-01, -0.0000e+00],\r\n        [ 2.1107e+00,  3.0731e-34, -1.5583e+00],\r\n        [ 2.6372e-36,  2.1991e+00, -0.0000e+00]], device='cuda:0')\r\n\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[     nan,      nan, -77.5343],\r\n        [     nan,      nan,  -2.4653],\r\n        [-82.0413,  -0.1864,      nan],\r\n        [  0.7470, -77.0295,      nan],\r\n        [-82.6019,   0.7880,      nan]], device='cuda:0')\r\ntensor([[    -inf,      nan,     -inf],\r\n        [     nan,      nan,  -2.4653],\r\n        [    -inf,  -0.1864,     -inf],\r\n        [  0.7470, -77.1652,      nan],\r\n        [-81.9234,   0.7880,     -inf]], device='cuda:0')\r\n\r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([[-0., -1.,  0.],\r\n        [-1., -1.,  1.],\r\n        [-0.,  1., -0.],\r\n        [ 1.,  1., -1.],\r\n        [ 1.,  1., -0.]], device='cuda:0')\r\ntensor([[-1., -1.,  1.],\r\n        [-1., -1.,  1.],\r\n        [ 1.,  1., -1.],\r\n        [ 1.,  1., -1.],\r\n        [ 1.,  1., -1.]], device='cuda:0')\r\n\r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([[       -inf, -3.1922e-02,        -inf],\r\n        [-3.8199e+00, -7.5032e+01, -2.4653e+00],\r\n        [       -inf, -1.8638e-01,        -inf],\r\n        [ 7.4703e-01, -7.7165e+01,  4.4361e-01],\r\n        [-8.1923e+01,  7.8803e-01,        -inf]], device='cuda:0')\r\ntensor([[-7.8615e+01, -3.1922e-02, -7.7534e+01],\r\n        [-3.8199e+00, -7.4771e+01, -2.4653e+00],\r\n        [-8.2041e+01, -1.8638e-01, -7.4485e+01],\r\n        [ 7.4703e-01, -7.7029e+01,  4.4361e-01],\r\n        [-8.2602e+01,  7.8803e-01, -7.7463e+01]], device='cuda:0')\r\n\r\n\r\n5\r\n(3,)\r\n    run_test(matsize, batchdims, mat_chars=['sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([ 1.0570e-49, -1.6987e-49,  9.0382e-51], device='cuda:0')\r\ntensor([ 0.0000e+00, -4.2903e-49,  3.6495e-50], device='cuda:0')\r\n\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([-112.7712,       nan, -115.2304], device='cuda:0')\r\ntensor([     -inf,       nan, -113.8347], device='cuda:0')\r\n\r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([ 0., -1.,  1.], device='cuda:0')\r\ntensor([ 1., -1.,  1.], device='cuda:0')\r\n  \r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([     -inf, -111.3703, -113.8347], device='cuda:0')\r\ntensor([-112.7712, -112.2968, -115.2304], device='cuda:0')\r\n  \r\n    run_test(matsize, batchdims, mat_chars=['sing', 'non_sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([-7.0089e-49, -2.0986e+00,  6.3015e-51], device='cuda:0')\r\ntensor([-6.6740e-49, -2.0986e+00,  1.0697e-49], device='cuda:0')\r\n  \r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([      nan,       nan, -115.5911], device='cuda:0')\r\ntensor([      nan,       nan, -112.7593], device='cuda:0')\r\n  \r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([-1., -1.,  1.], device='cuda:0')\r\ntensor([-1., -1.,  1.], device='cuda:0')\r\n  \r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([-110.9285,    0.7413, -112.7593], device='cuda:0')\r\ntensor([-110.8795,    0.7413, -115.5911], device='cuda:0')\r\n\r\n\r\n5 \r\n(5, 3)\r\n    run_test(matsize, batchdims, mat_chars=['sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[-5.4639e-49,  1.0809e-48, -1.4355e-48],\r\n        [ 4.0162e-50, -1.6792e-49, -1.4588e-49],\r\n        [ 4.5016e-49, -6.4845e-49,  4.9028e-49],\r\n        [ 8.8669e-49, -1.1956e-50, -9.0934e-50],\r\n        [ 1.0180e-50, -2.3492e-49,  2.9704e-50]], device='cuda:0')\r\ntensor([[-0.0000e+00,  1.0751e-48,  5.9039e-49],\r\n        [ 0.0000e+00, -4.9508e-50,  0.0000e+00],\r\n        [ 5.8240e-49, -1.3868e-48,  0.0000e+00],\r\n        [ 8.6981e-49, -1.3410e-49,  0.0000e+00],\r\n        [-6.8240e-51, -1.2646e-48, -3.6321e-49]], device='cuda:0')\r\n  \r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[      nan, -110.4463,       nan],\r\n        [-113.7389,       nan,       nan],\r\n        [-111.3222,       nan, -111.2369],\r\n        [-110.6443,       nan,       nan],\r\n        [-115.1115,       nan, -114.0406]], device='cuda:0')\r\ntensor([[     -inf, -110.4516, -111.0511],\r\n        [     -inf,       nan,      -inf],\r\n        [-111.0647,       nan,      -inf],\r\n        [-110.6636,       nan,      -inf],\r\n        [      nan,       nan,       nan]], device='cuda:0')\r\n  \r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([[-0.,  1.,  1.],\r\n        [ 0., -1.,  0.],\r\n        [ 1., -1.,  0.],\r\n        [ 1., -1.,  0.],\r\n        [-1., -1., -1.]], device='cuda:0')\r\ntensor([[-1.,  1., -1.],\r\n        [ 1., -1., -1.],\r\n        [ 1., -1.,  1.],\r\n        [ 1., -1., -1.],\r\n        [ 1., -1.,  1.]], device='cuda:0')\r\n  \r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([[     -inf, -110.4516, -111.0511],\r\n        [     -inf, -113.5297,      -inf],\r\n        [-111.0647, -110.1971,      -inf],\r\n        [-110.6636, -112.5332,      -inf],\r\n        [-115.5114, -110.2894, -111.5369]], device='cuda:0')\r\ntensor([[-111.1285, -110.4463, -110.1625],\r\n        [-113.7389, -112.3083, -112.4491],\r\n        [-111.3222, -110.9573, -111.2369],\r\n        [-110.6443, -114.9506, -112.9217],\r\n        [-115.1115, -111.9726, -114.0406]], device='cuda:0')\r\n  \r\n    run_test(matsize, batchdims, mat_chars=['sing', 'non_sing'])\r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[ 2.0255e-49, -4.7865e-01,  5.8494e-50],\r\n        [-3.8510e+00,  2.4657e-49,  4.6330e-01],\r\n        [-9.1485e-51,  2.4230e-02, -5.0224e-49],\r\n        [ 7.1769e-01, -1.7340e-49, -4.0999e+00],\r\n        [-1.5233e-48, -5.1991e-01,  1.5723e-49]], device='cuda:0')\r\ntensor([[ 4.0698e-49, -4.7865e-01,  0.0000e+00],\r\n        [-3.8510e+00, -4.9829e-49,  4.6330e-01],\r\n        [ 0.0000e+00,  2.4230e-02,  0.0000e+00],\r\n        [ 7.1769e-01,  0.0000e+00, -4.0999e+00],\r\n        [ 0.0000e+00, -5.1991e-01, -2.2120e-49]], device='cuda:0')\r\n  \r\n        self.assertEqual(actual_value, expected_value, allow_inf=True)\r\ntensor([[-112.1209,       nan, -113.3629],\r\n        [      nan, -111.9242,   -0.7694],\r\n        [      nan,   -3.7202,       nan],\r\n        [  -0.3317,       nan,       nan],\r\n        [      nan,       nan, -112.3741]], device='cuda:0')\r\ntensor([[-111.4231,       nan,      -inf],\r\n        [      nan,       nan,   -0.7694],\r\n        [     -inf,   -3.7202,      -inf],\r\n        [  -0.3317,      -inf,       nan],\r\n        [     -inf,       nan,       nan]], device='cuda:0')\r\n  \r\n        self.assertEqual(sign_value, actual_value[0], allow_inf=True)\r\ntensor([[ 1., -1.,  0.],\r\n        [-1., -1.,  1.],\r\n        [ 0.,  1.,  0.],\r\n        [ 1.,  0., -1.],\r\n        [ 0., -1., -1.]], device='cuda:0')\r\ntensor([[ 1., -1.,  1.],\r\n        [-1.,  1.,  1.],\r\n        [-1.,  1., -1.],\r\n        [ 1., -1., -1.],\r\n        [-1., -1.,  1.]], device='cuda:0')\r\n  \r\n        self.assertEqual(expected_value, actual_value[1], allow_inf=True)\r\ntensor([[-111.4231,   -0.7368,      -inf],\r\n        [   1.3483, -111.2207,   -0.7694],\r\n        [     -inf,   -3.7202,      -inf],\r\n        [  -0.3317,      -inf,    1.4110],\r\n        [     -inf,   -0.6541, -112.0328]], device='cuda:0')\r\ntensor([[-112.1209,   -0.7368, -113.3629],\r\n        [   1.3483, -111.9242,   -0.7694],\r\n        [-115.2183,   -3.7202, -111.2128],\r\n        [  -0.3317, -112.2762,    1.4110],\r\n        [-110.1032,   -0.6541, -112.3741]], device='cuda:0')\r\n""]"
244,28444,0,"Problem installing from source on CentOS 6.5. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

I ran the following code:

1. conda create detectron2 python=3.7
2. conda activate detectron2
3. conda install numpy ninja pyyaml mkl mkl-include setuptools cmake cffi typing
4. git clone --recursive https://github.com/pytorch/pytorch
5. cd pytorch
6. export CMAKE_PREFIX_PATH=${CONDA_PREFIX:-""$(dirname $(which conda))/../""}
7. python setup.py install

This gave the following stdout (sorry for the wall of text!):
-Wall -Wno-unused -Wno-attributes -Wno-unused-result -Wno-psabi -ffp-contract=off -fno-math-errno -fno-trapping-math/nethome/ebj26/apps/pytorch/third_party/nccl/nccl/src'
Compiling  misc/nvmlwrap.cc                    > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/nvmlwrap.o
Compiling  misc/rings.cc                       > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/rings.o
Compiling  init.cc                             > /nethome/ebj26/apps/pytorch/build/nccl/obj/init.o
Compiling  misc/group.cc                       > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/group.o
Grabbing   include/nccl_net.h                  > /nethome/ebj26/apps/pytorch/build/nccl/include/nccl_net.h
Compiling  misc/ibvwrap.cc                     > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/ibvwrap.o
Compiling  collectives/reduce_scatter.cc       > /nethome/ebj26/apps/pytorch/build/nccl/obj/collectives/reduce_scatter.o
Compiling  channel.cc                          > /nethome/ebj26/apps/pytorch/build/nccl/obj/channel.o
Compiling  collectives/all_gather.cc           > /nethome/ebj26/apps/pytorch/build/nccl/obj/collectives/all_gather.o
Compiling  transport/p2p.cc                    > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport/p2p.o
Compiling  enqueue.cc                          > /nethome/ebj26/apps/pytorch/build/nccl/obj/enqueue.o
Compiling  bootstrap.cc                        > /nethome/ebj26/apps/pytorch/build/nccl/obj/bootstrap.o
Compiling  misc/argcheck.cc                    > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/argcheck.o
Compiling  transport/shm.cc                    > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport/shm.o
Compiling  transport/net.cc                    > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport/net.o
Compiling  misc/topo.cc                        > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/topo.o
Compiling  transport/net_ib.cc                 > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport/net_ib.o
Compiling  collectives/broadcast.cc            > /nethome/ebj26/apps/pytorch/build/nccl/obj/collectives/broadcast.o
Compiling  transport.cc                        > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport.o
Compiling  transport/net_socket.cc             > /nethome/ebj26/apps/pytorch/build/nccl/obj/transport/net_socket.o
Compiling  misc/utils.cc                       > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/utils.o
Compiling  misc/trees.cc                       > /nethome/ebj26/apps/pytorch/build/nccl/obj/misc/trees.o
Compiling  collectives/all_reduce.cc           > /nethome/ebj26/apps/pytorch/build/nccl/obj/collectives/all_reduce.o
Compiling  collectives/reduce.cc               > /nethome/ebj26/apps/pytorch/build/nccl/obj/collectives/reduce.o
Generating nccl.h.in                           > /nethome/ebj26/apps/pytorch/build/nccl/include/nccl.h
Generating nccl.pc.in                          > /nethome/ebj26/apps/pytorch/build/nccl/lib/pkgconfig/nccl.pc
make[2]: Entering directory /nethome/ebj26/apps/pytorch/third_party/nccl/nccl/src/collectives/device'
make[2]: Entering directory /nethome/ebj26/apps/pytorch/third_party/nccl/nccl/src/collectives/device'
Linking    libnccl.so.2.4.8                    > /nethome/ebj26/apps/pytorch/build/nccl/lib/libnccl.so.2.4.8
make: *** [src.build] Segmentation fault (core dumped)
[200/3081] Building CXX object third_party/protobuf/cmake/CMakeFiles/libprotobuf.dir/__/src/google/protobuf/descriptor.cc.o
ninja: build stopped: subcommand failed.
Traceback (most recent call last):
  File ""setup.py"", line 759, in <module>
    build_deps()
  File ""setup.py"", line 311, in build_deps
    cmake=cmake)
  File ""/nethome/ebj26/apps/pytorch/tools/build_pytorch_libs.py"", line 59, in build_caffe2
    cmake.build(my_env)
  File ""/nethome/ebj26/apps/pytorch/tools/setup_helpers/cmake.py"", line 334, in build
    self.run(build_args, my_env)
  File ""/nethome/ebj26/apps/pytorch/tools/setup_helpers/cmake.py"", line 142, in run
    check_call(command, cwd=self.build_dir, env=env)
  File ""/nethome/ebj26/apps/anaconda3/envs/detectron2/lib/python3.7/subprocess.py"", line 347, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['cmake', '--build', '.', '--target', 'install', '--config', 'Release', '--', '-j', '16']' returned non-zero exit status 1.

PyTorch version: N/A
Is debug build: N/A
CUDA used to build PyTorch: N/A

OS: CentOS release 6.5 (Final)
GCC version: (GCC) 5.5.0
CMake version: version 3.14.0

Python version: 3.7
Is CUDA available: N/A
CUDA runtime version: Could not collect
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.17.2
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] mkl-service               2.3.0            py37he904b0f_0  
[conda] mkl_fft                   1.0.14           py37ha843d7b_0  
[conda] mkl_random                1.1.0            py37hd6b4f25_0
`

## Additional context

Any help would be greatly appreciated!
. ['\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Expected behavior\r\n\r\nClean install of pytorch from source\r\n\r\n## Environment\r\n\r\nOutput from collect_env.py:\r\n']"
510,24918,0,"A lot of deprecation warnings in tests. Several test suites, for example test_indexing, throw deprecation warnings like this: 

. []"
641,27844,0,"torch.hub does not handle tags and branches with path separator (e.g. ""/"") in them. ## üêõ Bug

 treats tag or branch names as file paths; if the tag or branch has a path separator (e.g. ""/"" on Linux) in it e.g. branch  as in

    torch.hub.list(""moabitcoin/ig65m-pytorch:issues/4"")

then torch hub integration fails e.g. see




## To Reproduce

Steps to reproduce the behavior:

1. add a simple hubconf.py to your repository
1. create a tag or branch with a path separator in its name
1. use torch hub functionality with that tag or branch

## Expected behavior

 works with arbitrary git tags and branches

## Environment

<details>
<summary>env</summary>



</details>


## Additional context

Workaround: create a tag or branch alias without the path separator in it.

cc @ailzhang. ['\r\n>>> torch.hub.list(""moabitcoin/ig65m-pytorch:issues/4"")\r\nDownloading: ""https://github.com/moabitcoin/ig65m-pytorch/archive/issues/4.zip"" to /root/.cache/torch/hub/issues/4.zip\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/usr/local/lib/python3.6/dist-packages/torch/hub.py"", line 272, in list\r\n    repo_dir = _get_cache_or_reload(github, force_reload, True)\r\n  File ""/usr/local/lib/python3.6/dist-packages/torch/hub.py"", line 153, in _get_cache_or_reload\r\n    download_url_to_file(url, cached_file, progress=False)\r\n  File ""/usr/local/lib/python3.6/dist-packages/torch/hub.py"", line 398, in download_url_to_file\r\n    f = tempfile.NamedTemporaryFile(delete=False, dir=dst_dir)\r\n  File ""/usr/lib/python3.6/tempfile.py"", line 690, in NamedTemporaryFile\r\n    (fd, name) = _mkstemp_inner(dir, prefix, suffix, flags, output_type)\r\n  File ""/usr/lib/python3.6/tempfile.py"", line 401, in _mkstemp_inner\r\n    fd = _os.open(file, flags, 0o600)\r\nFileNotFoundError: [Errno 2] No such file or directory: \'/root/.cache/torch/hub/issues/tmpq24habt0\'\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.3.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.1.243\r\n\r\nOS: Ubuntu 18.04.3 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.17.2\r\n[pip3] torch==1.3.0\r\n[pip3] torchvision==0.4.1\r\n[conda] Could not collect\r\n']"
482,29024,0,"Speed slows down after model quantization. my model is based on E-inception,after quantized  , i found it forward slower,
the original model run on CPU cost 200ms and 20ms on GPU , but the quantized model cost 290ms,

is it caused by the operation of layers concatenate?? 


cc @jerryzh168 @jianyuh @dzhulgakov @raghuramank100 @jamesr66a. []"
240,28781,0," run run_test.py has error. ## ‚ùì Questions and Help
hi 
I am new at pytorch 

i try to install pytorch with ROCm and step by step following https://rocm-documentation.readthedocs.io/en/latest/Deep_learning/Deep-learning.html#building-pytorch-for-rocm 

output of ""PYTORCH_TEST_WITH_ROCM=1 python test/run_test.py --verbose"" should all correct ,but i got some error like this


test_lerp_tensor_weights,
test_unused_output_device_cuda were failed 

could anyone help me figure out please

my hardware :
os ubuntu 16.04
motherboard ROG CROSSHAIR VI HERO
cpu 2700x
gpu rx480 * 2


. ['\r\nTest executor: [\'/usr/bin/python\']\r\nExcluding cpp_extensions on ROCm\r\nExcluding distributed on ROCm\r\nExcluding multiprocessing on ROCm\r\nExcluding multiprocessing_spawn on ROCm\r\nSelected tests: autograd, c10d, c10d_spawn, cuda, cuda_primary_ctx, dataloader, distributions, docs_coverage, expecttest, fake_quant, indexing, jit, logging, mkldnn, nccl, nn, numba_integration, optim, qat, quantization, quantized, quantized_tensor, quantized_nn_mods, quantizer, sparse, torch, type_info, type_hints, utils, namedtuple_return_api, jit_fuser, tensorboard, namedtensor, type_promotion, jit_disabled, function_schema\r\nRunning test_autograd ... [2019-10-28 03:37:35.924929]\r\ntest___getitem__ (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_beg (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_comb (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_dup (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_end (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_mid (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_sub (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_sub_2 (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_sub_3 (__main__.TestAutograd) ... ok\r\ntest___getitem___adv_index_var (__main__.TestAutograd) ... ok\r\ntest___getitem___slice (__main__.TestAutograd) ... ok\r\ntest___getitem___slice_index (__main__.TestAutograd) ... ok\r\ntest___radd___constant (__main__.TestAutograd) ... ok\r\ntest___radd___scalar_constant (__main__.TestAutograd) ... ok\r\ntest___rdiv___constant (__main__.TestAutograd) ... ok\r\ntest___rdiv___scalar_constant (__main__.TestAutograd) ... ok\r\ntest___rmul___constant (__main__.TestAutograd) ... ok\r\ntest___rmul___scalar_constant (__main__.TestAutograd) ... ok\r\ntest___rpow___constant (__main__.TestAutograd) ... ok\r\ntest___rpow___scalar_constant (__main__.TestAutograd) ... ok\r\ntest___rsub___constant (__main__.TestAutograd) ... ok\r\ntest___rsub___scalar_constant (__main__.TestAutograd) ... ok\r\ntest_abs (__main__.TestAutograd) ... ok\r\ntest_abs_scalar (__main__.TestAutograd) ... ok\r\ntest_accumulate_grad (__main__.TestAutograd) ... ok\r\ntest_accumulate_grad_tensor_reference (__main__.TestAutograd) ... ok\r\ntest_acos (__main__.TestAutograd) ... ok\r\ntest_add (__main__.TestAutograd) ... ok\r\ntest_add_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_add_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_add_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_add_constant (__main__.TestAutograd) ... ok\r\ntest_add_scalar (__main__.TestAutograd) ... ok\r\ntest_add_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_add_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_add_scalar_constant (__main__.TestAutograd) ... ok\r\ntest_addbmm (__main__.TestAutograd) ... ok\r\ntest_addbmm_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addbmm_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addbmm_coef (__main__.TestAutograd) ... ok\r\ntest_addbmm_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addbmm_scalar_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addcdiv (__main__.TestAutograd) ... ok\r\ntest_addcdiv_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_addcdiv_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar_scale (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar_scale_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scalar_scale_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scale (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scale_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_addcdiv_scale_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcmul (__main__.TestAutograd) ... ok\r\ntest_addcmul_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_addcmul_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar_scale (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar_scale_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addcmul_scalar_scale_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addcmul_scale (__main__.TestAutograd) ... ok\r\ntest_addcmul_scale_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_addcmul_scale_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_addmm (__main__.TestAutograd) ... ok\r\ntest_addmm_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addmm_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addmm_coef (__main__.TestAutograd) ... ok\r\ntest_addmm_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addmm_scalar_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addmv (__main__.TestAutograd) ... ok\r\ntest_addmv_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addmv_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addmv_coef (__main__.TestAutograd) ... ok\r\ntest_addmv_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addmv_scalar_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addr (__main__.TestAutograd) ... ok\r\ntest_addr_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_addr_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_addr_coef (__main__.TestAutograd) ... ok\r\ntest_anomaly_detect_nan (__main__.TestAutograd) ... ok\r\ntest_as_strided (__main__.TestAutograd) ... ok\r\ntest_asin (__main__.TestAutograd) ... ok\r\ntest_atan (__main__.TestAutograd) ... ok\r\ntest_atan2 (__main__.TestAutograd) ... ok\r\ntest_atan2_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_atan2_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_atan2_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_atan2_scalar (__main__.TestAutograd) ... ok\r\ntest_atan_scalar (__main__.TestAutograd) ... ok\r\ntest_attribute_deletion (__main__.TestAutograd) ... ok\r\ntest_backward (__main__.TestAutograd) ... ok\r\ntest_backward_badcalls (__main__.TestAutograd) ... ok\r\ntest_backward_copy (__main__.TestAutograd) ... ok\r\ntest_backward_no_grad (__main__.TestAutograd) ... ok\r\ntest_backward_twice_retained_graph_with_saved_values (__main__.TestAutograd) ... ok\r\ntest_backward_twice_retained_graph_without_saved_values (__main__.TestAutograd) ... ok\r\ntest_backward_twice_with_saved_values (__main__.TestAutograd) ... ok\r\ntest_backward_twice_without_saved_values (__main__.TestAutograd) ... ok\r\ntest_baddbmm (__main__.TestAutograd) ... ok\r\ntest_baddbmm_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_baddbmm_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_baddbmm_coef (__main__.TestAutograd) ... ok\r\ntest_baddbmm_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_baddbmm_scalar_broadcast_lhs_coef (__main__.TestAutograd) ... ok\r\ntest_bmm (__main__.TestAutograd) ... ok\r\ntest_broadcast_tensors (__main__.TestAutograd) ... ok\r\ntest_call_legacy_twice (__main__.TestAutograd) ... /root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\nok\r\ntest_cat (__main__.TestAutograd) ... ok\r\ntest_cat_empty (__main__.TestAutograd) ... ok\r\ntest_cat_empty_legacy (__main__.TestAutograd) ... ok\r\ntest_cat_negdim_1 (__main__.TestAutograd) ... ok\r\ntest_cat_negdim_2 (__main__.TestAutograd) ... ok\r\ntest_ceil (__main__.TestAutograd) ... ok\r\ntest_ceil_scalar (__main__.TestAutograd) ... ok\r\ntest_chain_matmul (__main__.TestAutograd) ... ok\r\ntest_checkpointing (__main__.TestAutograd) ... skipped \'test is slow; run with PYTORCH_TEST_WITH_SLOW to enable test\'\r\ntest_cholesky (__main__.TestAutograd) ... ok\r\ntest_cholesky_inverse (__main__.TestAutograd) ... ok\r\ntest_cholesky_solve (__main__.TestAutograd) ... ok\r\ntest_chunk (__main__.TestAutograd) ... ok\r\ntest_chunk_dim (__main__.TestAutograd) ... ok\r\ntest_chunk_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_clamp (__main__.TestAutograd) ... ok\r\ntest_clamp_max (__main__.TestAutograd) ... ok\r\ntest_clamp_max_scalar (__main__.TestAutograd) ... ok\r\ntest_clamp_max_scalar_kwarg (__main__.TestAutograd) ... ok\r\ntest_clamp_min (__main__.TestAutograd) ... ok\r\ntest_clamp_min_scalar (__main__.TestAutograd) ... ok\r\ntest_clamp_scalar (__main__.TestAutograd) ... ok\r\ntest_clone (__main__.TestAutograd) ... ok\r\ntest_clone_scalar (__main__.TestAutograd) ... ok\r\ntest_contiguous (__main__.TestAutograd) ... ok\r\ntest_contiguous_not_contiguous (__main__.TestAutograd) ... ok\r\ntest_cos (__main__.TestAutograd) ... ok\r\ntest_cos_scalar (__main__.TestAutograd) ... ok\r\ntest_cosh (__main__.TestAutograd) ... ok\r\ntest_cosh_scalar (__main__.TestAutograd) ... ok\r\ntest_cross (__main__.TestAutograd) ... ok\r\ntest_cross_dim (__main__.TestAutograd) ... ok\r\ntest_cumprod (__main__.TestAutograd) ... ok\r\ntest_cumprod_dim1 (__main__.TestAutograd) ... ok\r\ntest_cumprod_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumprod_scalar (__main__.TestAutograd) ... ok\r\ntest_cumprod_scalar_zeros (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim0 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim0_cast (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim0_cast_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim1 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim2 (__main__.TestAutograd) ... ok\r\ntest_cumprod_zeros_dim2_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim0 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim0_scalar (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim0_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim1 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim1_cast (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim1_cast_neg0 (__main__.TestAutograd) ... ok\r\ntest_cumsum_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_custom_autograd_no_early_free (__main__.TestAutograd) ... ok\r\ntest_custom_autograd_repeated_grad_grad (__main__.TestAutograd) ... ok\r\ntest_deep_reentrant (__main__.TestAutograd) ... ok\r\ntest_dep_nograd (__main__.TestAutograd) ... ok\r\ntest_dependent_backward (__main__.TestAutograd) ... ok\r\ntest_det (__main__.TestAutograd) ... ok\r\ntest_det_1x1 (__main__.TestAutograd) ... ok\r\ntest_det_batched (__main__.TestAutograd) ... ok\r\ntest_det_batched_1x1 (__main__.TestAutograd) ... ok\r\ntest_det_batched_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_det_batched_symmetric (__main__.TestAutograd) ... ok\r\ntest_det_batched_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_det_batched_symmetric_psd (__main__.TestAutograd) ... ok\r\ntest_det_dim2_null (__main__.TestAutograd) ... ok\r\ntest_det_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_det_rank1 (__main__.TestAutograd) ... ok\r\ntest_det_rank2 (__main__.TestAutograd) ... ok\r\ntest_det_symmetric (__main__.TestAutograd) ... ok\r\ntest_det_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_det_symmetric_psd (__main__.TestAutograd) ... ok\r\ntest_detach (__main__.TestAutograd) ... ok\r\ntest_detach_base (__main__.TestAutograd)\r\ndetaching base does not detach view ... ok\r\ntest_diag_1d (__main__.TestAutograd) ... ok\r\ntest_diag_2d (__main__.TestAutograd) ... ok\r\ntest_diag_2d_1 (__main__.TestAutograd) ... ok\r\ntest_diag_2d_2 (__main__.TestAutograd) ... ok\r\ntest_diag_2d_tall (__main__.TestAutograd) ... ok\r\ntest_diag_2d_tall_neg (__main__.TestAutograd) ... ok\r\ntest_diag_2d_tall_pos (__main__.TestAutograd) ... ok\r\ntest_diag_2d_wide (__main__.TestAutograd) ... ok\r\ntest_diag_2d_wide_neg (__main__.TestAutograd) ... ok\r\ntest_diag_2d_wide_pos (__main__.TestAutograd) ... ok\r\ntest_diag_embed (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_1 (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_2 (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_tall (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_tall_neg (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_tall_pos (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_wide (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_wide_neg (__main__.TestAutograd) ... ok\r\ntest_diagonal_2d_wide_pos (__main__.TestAutograd) ... ok\r\ntest_diagonal_3d_1 (__main__.TestAutograd) ... ok\r\ntest_diagonal_3d_2 (__main__.TestAutograd) ... ok\r\ntest_diagonal_3d_3 (__main__.TestAutograd) ... ok\r\ntest_diagonal_derivative_requires_grad (__main__.TestAutograd) ... ok\r\ntest_dir (__main__.TestAutograd) ... ok\r\ntest_dist (__main__.TestAutograd) ... ok\r\ntest_dist_4 (__main__.TestAutograd) ... ok\r\ntest_dist_4_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_dist_4_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_dist_4_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_dist_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_dist_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_dist_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_dist_scalar (__main__.TestAutograd) ... ok\r\ntest_dist_scalar_4 (__main__.TestAutograd) ... ok\r\ntest_dist_scalar_4_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_dist_scalar_4_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_dist_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_dist_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_div (__main__.TestAutograd) ... ok\r\ntest_div_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_div_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_div_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_div_constant (__main__.TestAutograd) ... ok\r\ntest_div_scalar (__main__.TestAutograd) ... ok\r\ntest_div_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_div_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_div_scalar_constant (__main__.TestAutograd) ... ok\r\ntest_dot (__main__.TestAutograd) ... ok\r\ntest_duplicate_backward_root (__main__.TestAutograd) ... ok\r\ntest_eq_ (__main__.TestAutograd) ... ok\r\ntest_eq__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_eq__pyscalar (__main__.TestAutograd) ... ok\r\ntest_eq__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_eq__scalar (__main__.TestAutograd) ... ok\r\ntest_eq__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_erf (__main__.TestAutograd) ... ok\r\ntest_erf_scalar (__main__.TestAutograd) ... ok\r\ntest_erfc (__main__.TestAutograd) ... ok\r\ntest_erfc_scalar (__main__.TestAutograd) ... ok\r\ntest_erfinv (__main__.TestAutograd) ... ok\r\ntest_erfinv_scalar (__main__.TestAutograd) ... ok\r\ntest_exp (__main__.TestAutograd) ... ok\r\ntest_exp_scalar (__main__.TestAutograd) ... ok\r\ntest_expand (__main__.TestAutograd) ... ok\r\ntest_expand_1_element (__main__.TestAutograd) ... ok\r\ntest_expand_as (__main__.TestAutograd) ... ok\r\ntest_expand_new_dim (__main__.TestAutograd) ... ok\r\ntest_expand_new_dim_front_old_front_1 (__main__.TestAutograd) ... ok\r\ntest_expand_scalar_to_dims (__main__.TestAutograd) ... ok\r\ntest_expand_scalar_to_scalar (__main__.TestAutograd) ... ok\r\ntest_expand_size (__main__.TestAutograd) ... ok\r\ntest_expm1 (__main__.TestAutograd) ... ok\r\ntest_expm1_scalar (__main__.TestAutograd) ... ok\r\ntest_fft_ifft_rfft_irfft (__main__.TestAutograd) ... skipped \'PyTorch is built without MKL support\'\r\ntest_fill (__main__.TestAutograd) ... ok\r\ntest_fill__number (__main__.TestAutograd) ... ok\r\ntest_fill__number_scalar (__main__.TestAutograd) ... ok\r\ntest_fill__variable (__main__.TestAutograd) ... ok\r\ntest_flip_d0 (__main__.TestAutograd) ... ok\r\ntest_flip_d012 (__main__.TestAutograd) ... ok\r\ntest_flip_d02 (__main__.TestAutograd) ... ok\r\ntest_flip_d20 (__main__.TestAutograd) ... ok\r\ntest_flip_neg_d (__main__.TestAutograd) ... ok\r\ntest_floor (__main__.TestAutograd) ... ok\r\ntest_floor_scalar (__main__.TestAutograd) ... ok\r\ntest_fmod (__main__.TestAutograd) ... ok\r\ntest_fmod_scalar (__main__.TestAutograd) ... ok\r\ntest_fmod_scalar_tensor (__main__.TestAutograd) ... ok\r\ntest_fmod_scalar_tensor_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_fmod_scalar_tensor_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_fmod_tensor (__main__.TestAutograd) ... ok\r\ntest_fmod_tensor_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_fmod_tensor_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_fmod_tensor_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_frac (__main__.TestAutograd) ... ok\r\ntest_frac_scalar (__main__.TestAutograd) ... ok\r\ntest_free_deep_graph (__main__.TestAutograd) ... ok\r\ntest_free_deep_graph_complicated (__main__.TestAutograd) ... ok\r\ntest_free_deep_graph_pyfunction (__main__.TestAutograd) ... ok\r\ntest_function (__main__.TestAutograd) ... ok\r\ntest_function_returns_input (__main__.TestAutograd) ... ok\r\ntest_gather_dim0 (__main__.TestAutograd) ... ok\r\ntest_gather_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_gather_dim1 (__main__.TestAutograd) ... ok\r\ntest_gather_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_both (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_both_neg0 (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_index (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_index_neg0 (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_input (__main__.TestAutograd) ... ok\r\ntest_gather_scalar_input_neg0 (__main__.TestAutograd) ... ok\r\ntest_gc_in_destructor (__main__.TestAutograd) ... /root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\n/root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\nok\r\ntest_ge_ (__main__.TestAutograd) ... ok\r\ntest_ge__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_ge__pyscalar (__main__.TestAutograd) ... ok\r\ntest_ge__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_ge__scalar (__main__.TestAutograd) ... ok\r\ntest_ge__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_ger (__main__.TestAutograd) ... ok\r\ntest_grad (__main__.TestAutograd) ... ok\r\ntest_grad_badcalls (__main__.TestAutograd) ... ok\r\ntest_grad_fn_badcalls (__main__.TestAutograd) ... ok\r\ntest_grad_nonleaf (__main__.TestAutograd) ... ok\r\ntest_grad_nonleaf_many_outputs (__main__.TestAutograd) ... ok\r\ntest_grad_nonleaf_register_hook (__main__.TestAutograd) ... ok\r\ntest_grad_unreachable (__main__.TestAutograd) ... ok\r\ntest_gradcheck_fail_when_no_differentiable_outputs_and_num_grad_not_zero (__main__.TestAutograd) ... ok\r\ntest_gradcheck_nondeterministic (__main__.TestAutograd) ... ok\r\ntest_gradcheck_single_input (__main__.TestAutograd) ... ok\r\ntest_gradcheck_sparse_input (__main__.TestAutograd) ... ok\r\ntest_gt_ (__main__.TestAutograd) ... ok\r\ntest_gt__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_gt__pyscalar (__main__.TestAutograd) ... ok\r\ntest_gt__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_gt__scalar (__main__.TestAutograd) ... ok\r\ntest_gt__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_hessian_vector (__main__.TestAutograd) ... ok\r\ntest_hook_none (__main__.TestAutograd) ... ok\r\ntest_hooks (__main__.TestAutograd) ... ok\r\ntest_hooks_cpp (__main__.TestAutograd) ... ok\r\ntest_index_add_dim (__main__.TestAutograd) ... ok\r\ntest_index_add_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_add_scalar_all_dim (__main__.TestAutograd) ... ok\r\ntest_index_add_scalar_all_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_add_scalar_input_dim (__main__.TestAutograd) ... ok\r\ntest_index_add_scalar_input_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_backward_does_not_save_tensor (__main__.TestAutograd) ... ok\r\ntest_index_copy_dim (__main__.TestAutograd) ... ok\r\ntest_index_copy_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_copy_scalar_all_dim (__main__.TestAutograd) ... ok\r\ntest_index_copy_scalar_all_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_copy_scalar_input_dim (__main__.TestAutograd) ... ok\r\ntest_index_copy_scalar_input_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_fill_dim (__main__.TestAutograd) ... ok\r\ntest_index_fill_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_both_dim (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_both_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_index_dim (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_index_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_input_dim (__main__.TestAutograd) ... ok\r\ntest_index_fill_scalar_input_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_fill_variable_dim (__main__.TestAutograd) ... ok\r\ntest_index_fill_variable_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_select_dim (__main__.TestAutograd) ... ok\r\ntest_index_select_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_select_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_index_select_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_index_select_scalar_mixed_dim (__main__.TestAutograd) ... ok\r\ntest_index_select_scalar_mixed_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_indexing (__main__.TestAutograd) ... ok\r\ntest_indexing_duplicates (__main__.TestAutograd) ... ok\r\ntest_inplace (__main__.TestAutograd) ... ok\r\ntest_inplace_view_backprop_base (__main__.TestAutograd) ... ok\r\ntest_inplace_view_backprop_view (__main__.TestAutograd) ... ok\r\ntest_inplace_view_backprop_view_of_view (__main__.TestAutograd) ... ok\r\ntest_inplace_view_backward (__main__.TestAutograd) ... ok\r\ntest_inplace_view_gradcheck (__main__.TestAutograd) ... ok\r\ntest_inplace_view_makes_base_require_grad (__main__.TestAutograd) ... ok\r\ntest_inplace_view_modify_base (__main__.TestAutograd) ... ok\r\ntest_inplace_view_non_contig (__main__.TestAutograd) ... ok\r\ntest_inplace_view_of_view (__main__.TestAutograd) ... ok\r\ntest_inplace_view_python (__main__.TestAutograd) ... ok\r\ntest_inplace_view_saved_output (__main__.TestAutograd) ... ok\r\ntest_inplace_view_weak_grad_fn (__main__.TestAutograd) ... ok\r\ntest_invalid_gradients (__main__.TestAutograd) ... ok\r\ntest_inverse (__main__.TestAutograd) ... ok\r\ntest_inverse_batched (__main__.TestAutograd) ... ok\r\ntest_isolated_node (__main__.TestAutograd) ... ok\r\ntest_kthvalue (__main__.TestAutograd) ... ok\r\ntest_kthvalue_dim (__main__.TestAutograd) ... ok\r\ntest_kthvalue_dim_1d (__main__.TestAutograd) ... ok\r\ntest_kthvalue_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_kthvalue_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_kthvalue_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_kthvalue_keepdim_dim_1d (__main__.TestAutograd) ... ok\r\ntest_kthvalue_keepdim_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_kthvalue_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_kthvalue_scalar (__main__.TestAutograd) ... ok\r\ntest_kthvalue_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_kthvalue_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_kthvalue_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_kthvalue_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_le_ (__main__.TestAutograd) ... ok\r\ntest_le__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_le__pyscalar (__main__.TestAutograd) ... ok\r\ntest_le__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_le__scalar (__main__.TestAutograd) ... ok\r\ntest_le__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_leaf_assignment (__main__.TestAutograd) ... ok\r\ntest_legacy_function_deprecation_warning (__main__.TestAutograd) ... ok\r\ntest_legacy_function_none_grad (__main__.TestAutograd) ... /root/pytorch/torch/csrc/autograd/python_function.cpp:622: UserWarning: Legacy autograd function with non-static forward method is deprecated and will be removed in 1.3. Please use new-style autograd function with static forward method. (Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)\r\n  ""(Example: https://pytorch.org/docs/stable/autograd.html#torch.autograd.Function)"");\r\nok\r\ntest_lerp_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_lerp_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_lerp_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_lerp_scalar (__main__.TestAutograd) ... ok\r\ntest_lerp_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_lerp_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_lerp_scalar_no_broadcast (__main__.TestAutograd) ... ok\r\ntest_lerp_tensor_weights (__main__.TestAutograd) ... ERROR\r\ntest_log (__main__.TestAutograd) ... ok\r\ntest_log10 (__main__.TestAutograd) ... ok\r\ntest_log10_scalar (__main__.TestAutograd) ... ok\r\ntest_log1p (__main__.TestAutograd) ... ok\r\ntest_log1p_scalar (__main__.TestAutograd) ... ok\r\ntest_log2 (__main__.TestAutograd) ... ok\r\ntest_log2_scalar (__main__.TestAutograd) ... ok\r\ntest_log_scalar (__main__.TestAutograd) ... ok\r\ntest_log_softmax_kwarg_dtype_would_break_jit_loader (__main__.TestAutograd) ... ok\r\ntest_logdet (__main__.TestAutograd) ... ok\r\ntest_logdet_1x1 (__main__.TestAutograd) ... ok\r\ntest_logdet_batched (__main__.TestAutograd) ... ok\r\ntest_logdet_batched_1x1 (__main__.TestAutograd) ... ok\r\ntest_logdet_batched_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_logdet_batched_symmetric (__main__.TestAutograd) ... ok\r\ntest_logdet_batched_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_logdet_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_logdet_symmetric (__main__.TestAutograd) ... ok\r\ntest_logdet_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_logsumexp (__main__.TestAutograd) ... ok\r\ntest_logsumexp_scalar (__main__.TestAutograd) ... ok\r\ntest_lt_ (__main__.TestAutograd) ... ok\r\ntest_lt__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_lt__pyscalar (__main__.TestAutograd) ... ok\r\ntest_lt__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_lt__scalar (__main__.TestAutograd) ... ok\r\ntest_lt__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_mark_non_differentiable (__main__.TestAutograd) ... ok\r\ntest_mark_non_differentiable_mixed (__main__.TestAutograd) ... ok\r\ntest_mark_non_differentiable_none (__main__.TestAutograd) ... ok\r\ntest_masked_fill (__main__.TestAutograd) ... ok\r\ntest_masked_fill_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_masked_fill_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_masked_fill_scalar (__main__.TestAutograd) ... ok\r\ntest_masked_fill_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_masked_fill_scalar_variable (__main__.TestAutograd) ... ok\r\ntest_masked_fill_tensor (__main__.TestAutograd) ... ok\r\ntest_masked_scatter (__main__.TestAutograd) ... ok\r\ntest_masked_scatter_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_masked_scatter_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_masked_scatter_scalar (__main__.TestAutograd) ... ok\r\ntest_masked_scatter_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_masked_select (__main__.TestAutograd) ... ok\r\ntest_masked_select_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_masked_select_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_masked_select_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_masked_select_scalar (__main__.TestAutograd) ... ok\r\ntest_masked_select_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_masked_select_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_matmul (__main__.TestAutograd) ... ok\r\ntest_matmul_1d_2d (__main__.TestAutograd) ... ok\r\ntest_matmul_1d_3d (__main__.TestAutograd) ... ok\r\ntest_matmul_1d_4d (__main__.TestAutograd) ... ok\r\ntest_matmul_2d_1d (__main__.TestAutograd) ... ok\r\ntest_matmul_2d_2d (__main__.TestAutograd) ... ok\r\ntest_matmul_2d_3d (__main__.TestAutograd) ... ok\r\ntest_matmul_3d_1d (__main__.TestAutograd) ... ok\r\ntest_matmul_3d_2d (__main__.TestAutograd) ... ok\r\ntest_matmul_4d_1d (__main__.TestAutograd) ... ok\r\ntest_matmul_4d_4d (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=-1 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=-2 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=-3 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=0 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=1 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=2 (__main__.TestAutograd) ... ok\r\ntest_matrix_power_n=3 (__main__.TestAutograd) ... ok\r\ntest_max (__main__.TestAutograd) ... ok\r\ntest_max_dim (__main__.TestAutograd) ... ok\r\ntest_max_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_max_elementwise (__main__.TestAutograd) ... ok\r\ntest_max_elementwise_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_max_elementwise_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_max_elementwise_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_max_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_max_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_max_scalar (__main__.TestAutograd) ... ok\r\ntest_max_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_max_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_max_scalar_elementwise (__main__.TestAutograd) ... ok\r\ntest_max_scalar_elementwise_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_max_scalar_elementwise_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_max_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_max_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mean (__main__.TestAutograd) ... ok\r\ntest_mean_dim (__main__.TestAutograd) ... ok\r\ntest_mean_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mean_dtype (__main__.TestAutograd) ... ok\r\ntest_mean_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_mean_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mean_scalar (__main__.TestAutograd) ... ok\r\ntest_mean_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_mean_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mean_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_mean_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_median (__main__.TestAutograd) ... ok\r\ntest_median_dim (__main__.TestAutograd) ... ok\r\ntest_median_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_median_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_median_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_median_scalar (__main__.TestAutograd) ... ok\r\ntest_median_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_median_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_median_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_median_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_min (__main__.TestAutograd) ... ok\r\ntest_min_dim (__main__.TestAutograd) ... ok\r\ntest_min_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_min_elementwise (__main__.TestAutograd) ... ok\r\ntest_min_elementwise_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_min_elementwise_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_min_elementwise_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_min_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_min_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_min_scalar (__main__.TestAutograd) ... ok\r\ntest_min_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_min_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_min_scalar_elementwise (__main__.TestAutograd) ... ok\r\ntest_min_scalar_elementwise_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_min_scalar_elementwise_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_min_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_min_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mm (__main__.TestAutograd) ... ok\r\ntest_mode (__main__.TestAutograd) ... ok\r\ntest_mode_dim (__main__.TestAutograd) ... ok\r\ntest_mode_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mode_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_mode_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mode_scalar (__main__.TestAutograd) ... ok\r\ntest_mode_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_mode_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mode_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_mode_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_mul (__main__.TestAutograd) ... ok\r\ntest_mul_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_mul_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_mul_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_mul_constant (__main__.TestAutograd) ... ok\r\ntest_mul_out (__main__.TestAutograd) ... ok\r\ntest_mul_out_result_requires_grad (__main__.TestAutograd) ... ok\r\ntest_mul_scalar (__main__.TestAutograd) ... ok\r\ntest_mul_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_mul_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_mul_scalar_constant (__main__.TestAutograd) ... ok\r\ntest_multi_backward (__main__.TestAutograd) ... ok\r\ntest_multi_backward_no_grad (__main__.TestAutograd) ... ok\r\ntest_mv (__main__.TestAutograd) ... ok\r\ntest_mvlgamma_p=1 (__main__.TestAutograd) ... ok\r\ntest_mvlgamma_p=2 (__main__.TestAutograd) ... ok\r\ntest_mvlgamma_p=3 (__main__.TestAutograd) ... ok\r\ntest_mvlgamma_p=5 (__main__.TestAutograd) ... ok\r\ntest_narrow_dim (__main__.TestAutograd) ... ok\r\ntest_narrow_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_narrow_empty_dim (__main__.TestAutograd) ... ok\r\ntest_narrow_empty_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_naughty_anomaly_access (__main__.TestAutograd) ... expected failure\r\ntest_naughty_autograd_function_stashing_ctx (__main__.TestAutograd) ... ok\r\ntest_naughty_legacy_function_backward_before_forward (__main__.TestAutograd) ... ok\r\ntest_naughty_legacy_function_early_access (__main__.TestAutograd) ... ok\r\ntest_naughty_legacy_variable_grad_fn (__main__.TestAutograd) ... ok\r\ntest_ne_ (__main__.TestAutograd) ... ok\r\ntest_ne__broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_ne__pyscalar (__main__.TestAutograd) ... ok\r\ntest_ne__pyscalar_scalar (__main__.TestAutograd) ... ok\r\ntest_ne__scalar (__main__.TestAutograd) ... ok\r\ntest_ne__scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_next_functions (__main__.TestAutograd) ... ok\r\ntest_no_grad (__main__.TestAutograd) ... ok\r\ntest_no_grad_assignment (__main__.TestAutograd) ... ok\r\ntest_no_grad_copy (__main__.TestAutograd) ... ok\r\ntest_no_grad_input (__main__.TestAutograd) ... ok\r\ntest_no_grad_modifies_version (__main__.TestAutograd) ... ok\r\ntest_no_grad_python_function (__main__.TestAutograd)\r\nPython Functions should respect grad mode. ... ok\r\ntest_no_requires_grad_inplace (__main__.TestAutograd) ... ok\r\ntest_no_unnecessary_save (__main__.TestAutograd) ... ok\r\ntest_norm_-inf (__main__.TestAutograd) ... ok\r\ntest_norm_0 (__main__.TestAutograd) ... ok\r\ntest_norm_0_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_0_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_0_5 (__main__.TestAutograd) ... ok\r\ntest_norm_1 (__main__.TestAutograd) ... ok\r\ntest_norm_1_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_1_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_1_5_default (__main__.TestAutograd) ... ok\r\ntest_norm_1_5_dim (__main__.TestAutograd) ... ok\r\ntest_norm_1_5_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_2 (__main__.TestAutograd) ... ok\r\ntest_norm_2_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_2_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_2_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_norm_2_dim_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_3 (__main__.TestAutograd) ... ok\r\ntest_norm_3_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_3_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_3_dim (__main__.TestAutograd) ... ok\r\ntest_norm_3_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_3_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_norm_3_dim_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_default (__main__.TestAutograd) ... ok\r\ntest_norm_fro (__main__.TestAutograd) ... ok\r\ntest_norm_fro_default (__main__.TestAutograd) ... ok\r\ntest_norm_inf (__main__.TestAutograd) ... ok\r\ntest_norm_inf_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_1_5_dim (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_1_5_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_2_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_2_dim_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_3_dim (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_3_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_3_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_norm_keepdim_3_dim_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_0_5 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_1 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_1_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_neg_1_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_1_5 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_2 (__main__.TestAutograd) ... ok\r\ntest_norm_neg_2_2_dim (__main__.TestAutograd) ... ok\r\ntest_norm_neg_2_2_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_norm_nuc (__main__.TestAutograd) ... ok\r\ntest_norm_nuc_batched (__main__.TestAutograd) ... ok\r\ntest_norm_subgradient (__main__.TestAutograd) ... ok\r\ntest_numpy_requires_grad (__main__.TestAutograd) ... ok\r\ntest_once_differentiable (__main__.TestAutograd) ... ok\r\ntest_permute (__main__.TestAutograd) ... ok\r\ntest_permute_neg_dim (__main__.TestAutograd) ... ok\r\ntest_permute_scalar (__main__.TestAutograd) ... ok\r\ntest_pickle (__main__.TestAutograd) ... ok\r\ntest_pinverse (__main__.TestAutograd) ... ok\r\ntest_pow (__main__.TestAutograd) ... ok\r\ntest_pow_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_pow_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_pow_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_pow_constant (__main__.TestAutograd) ... ok\r\ntest_pow_scalar (__main__.TestAutograd) ... ok\r\ntest_pow_scalar_base (__main__.TestAutograd) ... ok\r\ntest_pow_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_pow_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_pow_scalar_constant (__main__.TestAutograd) ... ok\r\ntest_pow_zero_tensor_gradient (__main__.TestAutograd) ... ok\r\ntest_prod (__main__.TestAutograd) ... ok\r\ntest_prod_dim (__main__.TestAutograd) ... ok\r\ntest_prod_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims0 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims0_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims1 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims1_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims2 (__main__.TestAutograd) ... ok\r\ntest_prod_keepdim_zeros_dims2_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_scalar (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_dim_zero (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_dim_zero_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_keepdim_dim_zero (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_keepdim_dim_zero_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_scalar_zero (__main__.TestAutograd) ... ok\r\ntest_prod_single_zero (__main__.TestAutograd) ... ok\r\ntest_prod_zerodims0 (__main__.TestAutograd) ... ok\r\ntest_prod_zerodims1 (__main__.TestAutograd) ... ok\r\ntest_prod_zerodims2 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims0 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims0_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims1 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims1_neg0 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims2 (__main__.TestAutograd) ... ok\r\ntest_prod_zeros_dims2_neg0 (__main__.TestAutograd) ... ok\r\ntest_profiler (__main__.TestAutograd) ... ok\r\ntest_profiler_aggregation_fake (__main__.TestAutograd) ... ok\r\ntest_profiler_aggregation_lstm (__main__.TestAutograd) ... ok\r\ntest_profiler_shapes (__main__.TestAutograd) ... ok\r\ntest_put (__main__.TestAutograd) ... ok\r\ntest_put_accumulate (__main__.TestAutograd) ... ok\r\ntest_qr_square_batched (__main__.TestAutograd) ... ok\r\ntest_qr_square_many_batched (__main__.TestAutograd) ... ok\r\ntest_qr_square_single (__main__.TestAutograd) ... ok\r\ntest_qr_tall_batched (__main__.TestAutograd) ... ok\r\ntest_qr_tall_many_batched (__main__.TestAutograd) ... ok\r\ntest_qr_tall_single (__main__.TestAutograd) ... ok\r\ntest_reciprocal (__main__.TestAutograd) ... ok\r\ntest_reciprocal_scalar (__main__.TestAutograd) ... ok\r\ntest_record_function (__main__.TestAutograd) ... FAIL\r\ntest_reduce_dtype (__main__.TestAutograd) ... ok\r\ntest_reentrant (__main__.TestAutograd) ... ok\r\ntest_reentrant_priority (__main__.TestAutograd) ... ok\r\ntest_remainder (__main__.TestAutograd) ... ok\r\ntest_remainder_scalar (__main__.TestAutograd) ... ok\r\ntest_remainder_scalar_tensor (__main__.TestAutograd) ... ok\r\ntest_remainder_scalar_tensor_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_remainder_tensor (__main__.TestAutograd) ... ok\r\ntest_remainder_tensor_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_remainder_tensor_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_renorm_dim (__main__.TestAutograd) ... ok\r\ntest_renorm_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_renorm_norm_1 (__main__.TestAutograd) ... ok\r\ntest_renorm_norm_inf (__main__.TestAutograd) ... ok\r\ntest_repeat (__main__.TestAutograd) ... ok\r\ntest_repeat_scalar (__main__.TestAutograd) ... ok\r\ntest_repeat_single_number (__main__.TestAutograd) ... ok\r\ntest_repeat_unsqueeze (__main__.TestAutograd) ... ok\r\ntest_requires_grad (__main__.TestAutograd) ... ok\r\ntest_requires_grad_ (__main__.TestAutograd) ... ok\r\ntest_requires_grad_inplace (__main__.TestAutograd) ... ok\r\ntest_reshape (__main__.TestAutograd) ... ok\r\ntest_reshape_1d (__main__.TestAutograd) ... ok\r\ntest_reshape_as (__main__.TestAutograd) ... ok\r\ntest_reshape_as_scalar (__main__.TestAutograd) ... ok\r\ntest_reshape_as_scalar_to_dims (__main__.TestAutograd) ... ok\r\ntest_reshape_scalar_to_1d (__main__.TestAutograd) ... ok\r\ntest_reshape_scalar_to_scalar (__main__.TestAutograd) ... ok\r\ntest_reshape_size (__main__.TestAutograd) ... ok\r\ntest_resize (__main__.TestAutograd) ... ok\r\ntest_resize__fewer_dims (__main__.TestAutograd) ... ok\r\ntest_resize__scalar (__main__.TestAutograd) ... ok\r\ntest_resize__scalar_to_dims (__main__.TestAutograd) ... ok\r\ntest_resize_as_ (__main__.TestAutograd) ... ok\r\ntest_resize_as__scalar (__main__.TestAutograd) ... ok\r\ntest_resize_as__scalar_to_dims (__main__.TestAutograd) ... ok\r\ntest_retain_grad (__main__.TestAutograd) ... ok\r\ntest_retain_grad_cycle (__main__.TestAutograd) ... ok\r\ntest_return_duplicate (__main__.TestAutograd) ... ok\r\ntest_return_duplicate_inplace (__main__.TestAutograd) ... ok\r\ntest_return_leaf (__main__.TestAutograd) ... ok\r\ntest_return_leaf_inplace (__main__.TestAutograd) ... ok\r\ntest_roll_d0 (__main__.TestAutograd) ... ok\r\ntest_roll_d02 (__main__.TestAutograd) ... ok\r\ntest_roll_d12 (__main__.TestAutograd) ... ok\r\ntest_roll_d20 (__main__.TestAutograd) ... ok\r\ntest_roll_flattened (__main__.TestAutograd) ... ok\r\ntest_roll_loop_shift (__main__.TestAutograd) ... ok\r\ntest_roll_neg_shift (__main__.TestAutograd) ... ok\r\ntest_roll_three_dims (__main__.TestAutograd) ... ok\r\ntest_rot90_default (__main__.TestAutograd) ... ok\r\ntest_rot90_k1_d01 (__main__.TestAutograd) ... ok\r\ntest_rot90_k1_d12 (__main__.TestAutograd) ... ok\r\ntest_rot90_k1_neg_d (__main__.TestAutograd) ... ok\r\ntest_round (__main__.TestAutograd) ... ok\r\ntest_round_scalar (__main__.TestAutograd) ... ok\r\ntest_rsqrt (__main__.TestAutograd) ... ok\r\ntest_rsqrt_scalar (__main__.TestAutograd) ... ok\r\ntest_save_none_for_backward (__main__.TestAutograd) ... ok\r\ntest_save_output_nr (__main__.TestAutograd) ... ok\r\ntest_saved_variables_deprecated (__main__.TestAutograd) ... ok\r\ntest_scatter_add_dim0 (__main__.TestAutograd) ... ok\r\ntest_scatter_add_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_add_dim1 (__main__.TestAutograd) ... ok\r\ntest_scatter_add_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_add_scalar_all_dim0 (__main__.TestAutograd) ... ok\r\ntest_scatter_add_scalar_all_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_dim0 (__main__.TestAutograd) ... ok\r\ntest_scatter_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_dim1 (__main__.TestAutograd) ... ok\r\ntest_scatter_dim1_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_scalar_all_dim0 (__main__.TestAutograd) ... ok\r\ntest_scatter_scalar_all_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_scatter_scalartensor_all_dim0 (__main__.TestAutograd) ... ok\r\ntest_scatter_scalartensor_all_dim0_neg0 (__main__.TestAutograd) ... ok\r\ntest_select_1d (__main__.TestAutograd) ... ok\r\ntest_select_dim (__main__.TestAutograd) ... ok\r\ntest_select_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_select_sum (__main__.TestAutograd) ... ok\r\ntest_select_wrap_dim (__main__.TestAutograd) ... ok\r\ntest_select_wrap_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_set_data_preserve_pyobj (__main__.TestAutograd) ... ok\r\ntest_set_data_tensorimpl_type (__main__.TestAutograd) ... ok\r\ntest_set_grad_enabled (__main__.TestAutograd) ... ok\r\ntest_setitem (__main__.TestAutograd) ... ok\r\ntest_setitem_mask (__main__.TestAutograd) ... ok\r\ntest_shape (__main__.TestAutograd) ... ok\r\ntest_sharded_grad (__main__.TestAutograd) ... ok\r\ntest_sigmoid (__main__.TestAutograd) ... ok\r\ntest_sigmoid_scalar (__main__.TestAutograd) ... ok\r\ntest_sign (__main__.TestAutograd) ... ok\r\ntest_sign_scalar (__main__.TestAutograd) ... ok\r\ntest_sin (__main__.TestAutograd) ... ok\r\ntest_sin_scalar (__main__.TestAutograd) ... ok\r\ntest_sinh (__main__.TestAutograd) ... ok\r\ntest_sinh_scalar (__main__.TestAutograd) ... ok\r\ntest_slogdet_1x1_neg_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_1x1_pos_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_batched_1x1_neg_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_batched_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_slogdet_batched_pos_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_batched_symmetric (__main__.TestAutograd) ... ok\r\ntest_slogdet_batched_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_slogdet_distinct_singular_values (__main__.TestAutograd) ... ok\r\ntest_slogdet_neg_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_pos_det (__main__.TestAutograd) ... ok\r\ntest_slogdet_sign (__main__.TestAutograd) ... ok\r\ntest_slogdet_symmetric (__main__.TestAutograd) ... ok\r\ntest_slogdet_symmetric_pd (__main__.TestAutograd) ... ok\r\ntest_solve (__main__.TestAutograd) ... ok\r\ntest_solve_batched (__main__.TestAutograd) ... ok\r\ntest_solve_batched_broadcast_A (__main__.TestAutograd) ... ok\r\ntest_solve_batched_broadcast_b (__main__.TestAutograd) ... ok\r\ntest_solve_batched_dims (__main__.TestAutograd) ... ok\r\ntest_sort (__main__.TestAutograd) ... ok\r\ntest_sort_dim (__main__.TestAutograd) ... ok\r\ntest_sort_dim_desc (__main__.TestAutograd) ... ok\r\ntest_sort_dim_desc_scalar (__main__.TestAutograd) ... ok\r\ntest_sort_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_sort_scalar (__main__.TestAutograd) ... ok\r\ntest_sparse_backward (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_both_scalar (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_dim0 (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_dim1 (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_dim_neg (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_ind_scalar (__main__.TestAutograd) ... ok\r\ntest_sparse_gather_x_scalar (__main__.TestAutograd) ... ok\r\ntest_sparse_mm_backward (__main__.TestAutograd) ... ok\r\ntest_split (__main__.TestAutograd) ... ok\r\ntest_split_dim (__main__.TestAutograd) ... ok\r\ntest_split_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_split_size_list (__main__.TestAutograd) ... ok\r\ntest_split_size_list_dim (__main__.TestAutograd) ... ok\r\ntest_split_size_list_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_split_with_sizes (__main__.TestAutograd) ... ok\r\ntest_split_with_sizes_dim (__main__.TestAutograd) ... ok\r\ntest_split_with_sizes_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_split_with_sizes_size_0 (__main__.TestAutograd) ... ok\r\ntest_sqrt (__main__.TestAutograd) ... ok\r\ntest_sqrt_scalar (__main__.TestAutograd) ... ok\r\ntest_squeeze (__main__.TestAutograd) ... ok\r\ntest_squeeze_1_dim (__main__.TestAutograd) ... ok\r\ntest_squeeze_1_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_squeeze_input_sizes_are_ones (__main__.TestAutograd) ... ok\r\ntest_squeeze_not_1_dim (__main__.TestAutograd) ... ok\r\ntest_squeeze_not_1_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_squeeze_scalar (__main__.TestAutograd) ... ok\r\ntest_squeeze_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_stack (__main__.TestAutograd) ... ok\r\ntest_std (__main__.TestAutograd) ... ok\r\ntest_std_dim (__main__.TestAutograd) ... ok\r\ntest_std_dim_1d (__main__.TestAutograd) ... ok\r\ntest_std_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_std_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_std_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_std_keepdim_dim_1d (__main__.TestAutograd) ... ok\r\ntest_std_keepdim_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_std_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_std_mean (__main__.TestAutograd) ... ok\r\ntest_std_mean_dim (__main__.TestAutograd) ... ok\r\ntest_std_mean_dim_1d (__main__.TestAutograd) ... ok\r\ntest_std_mean_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_std_mean_keepdim_dim_1d (__main__.TestAutograd) ... ok\r\ntest_sub (__main__.TestAutograd) ... ok\r\ntest_sub_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_sub_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_sub_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_sub_constant (__main__.TestAutograd) ... ok\r\ntest_sub_scalar_broadcast_lhs (__main__.TestAutograd) ... ok\r\ntest_sub_scalar_broadcast_rhs (__main__.TestAutograd) ... ok\r\ntest_sub_scalar_constant (__main__.TestAutograd) ... ok\r\ntest_sum (__main__.TestAutograd) ... ok\r\ntest_sum_dim (__main__.TestAutograd) ... ok\r\ntest_sum_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_sum_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_sum_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_sum_multi_dim (__main__.TestAutograd) ... ok\r\ntest_sum_multi_dim_keepdim (__main__.TestAutograd) ... ok\r\ntest_sum_scalar (__main__.TestAutograd) ... ok\r\ntest_sum_scalar_dim (__main__.TestAutograd) ... ok\r\ntest_sum_scalar_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_sum_scalar_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_sum_scalar_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_sum_to_with_empty_dim_grad (__main__.TestAutograd) ... ok\r\ntest_svd (__main__.TestAutograd) ... ok\r\ntest_svd_batched (__main__.TestAutograd) ... ok\r\ntest_svd_large (__main__.TestAutograd) ... ok\r\ntest_svd_no_singularvectors (__main__.TestAutograd) ... ok\r\ntest_svd_tall (__main__.TestAutograd) ... ok\r\ntest_svd_tall_all (__main__.TestAutograd) ... ok\r\ntest_svd_tall_all_batched (__main__.TestAutograd) ... ok\r\ntest_svd_tall_batched (__main__.TestAutograd) ... ok\r\ntest_svd_wide (__main__.TestAutograd) ... ok\r\ntest_svd_wide_all (__main__.TestAutograd) ... ok\r\ntest_svd_wide_all_batched (__main__.TestAutograd) ... ok\r\ntest_svd_wide_batched (__main__.TestAutograd) ... ok\r\ntest_symeig (__main__.TestAutograd) ... ok\r\ntest_symeig_no_eigenvectors (__main__.TestAutograd) ... ok\r\ntest_t (__main__.TestAutograd) ... ok\r\ntest_take (__main__.TestAutograd) ... ok\r\ntest_take_scalar_both (__main__.TestAutograd) ... ok\r\ntest_take_scalar_data (__main__.TestAutograd) ... ok\r\ntest_take_scalar_index (__main__.TestAutograd) ... ok\r\ntest_tan (__main__.TestAutograd) ... ok\r\ntest_tanh (__main__.TestAutograd) ... ok\r\ntest_tanh_scalar (__main__.TestAutograd) ... ok\r\ntest_thread_shutdown (__main__.TestAutograd) ... ok\r\ntest_to_sparse (__main__.TestAutograd) ... ok\r\ntest_too_many_grads (__main__.TestAutograd) ... ok\r\ntest_topk (__main__.TestAutograd) ... ok\r\ntest_topk_dim (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_scalar (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_sort (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_sort_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_sort_scalar (__main__.TestAutograd) ... ok\r\ntest_topk_dim_desc_sort_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_dim_scalar (__main__.TestAutograd) ... ok\r\ntest_topk_dim_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_topk_scalar (__main__.TestAutograd) ... ok\r\ntest_trace (__main__.TestAutograd) ... ok\r\ntest_transpose_1d (__main__.TestAutograd) ... ok\r\ntest_transpose_2d (__main__.TestAutograd) ... ok\r\ntest_transpose_3d (__main__.TestAutograd) ... ok\r\ntest_transpose_dim (__main__.TestAutograd) ... ok\r\ntest_transpose_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_transpose_dim_neg0_neg1 (__main__.TestAutograd) ... ok\r\ntest_transpose_dim_neg1 (__main__.TestAutograd) ... ok\r\ntest_transpose_scalar (__main__.TestAutograd) ... ok\r\ntest_trapz (__main__.TestAutograd) ... ok\r\ntest_triangular_solve (__main__.TestAutograd) ... ok\r\ntest_tril (__main__.TestAutograd) ... ok\r\ntest_tril_batched (__main__.TestAutograd) ... ok\r\ntest_tril_batched_idx (__main__.TestAutograd) ... ok\r\ntest_tril_idx (__main__.TestAutograd) ... ok\r\ntest_tril_more_batched (__main__.TestAutograd) ... ok\r\ntest_triu (__main__.TestAutograd) ... ok\r\ntest_triu_batched (__main__.TestAutograd) ... ok\r\ntest_triu_batched_idx (__main__.TestAutograd) ... ok\r\ntest_triu_idx (__main__.TestAutograd) ... ok\r\ntest_triu_more_batched (__main__.TestAutograd) ... ok\r\ntest_trunc (__main__.TestAutograd) ... ok\r\ntest_trunc_scalar (__main__.TestAutograd) ... ok\r\ntest_type_conversions (__main__.TestAutograd) ... ok\r\ntest_unbind (__main__.TestAutograd) ... ok\r\ntest_unfold (__main__.TestAutograd) ... ok\r\ntest_unfold_lastdim (__main__.TestAutograd) ... ok\r\ntest_unfold_lastdim_neg0 (__main__.TestAutograd) ... ok\r\ntest_unfold_neg0 (__main__.TestAutograd) ... ok\r\ntest_unfold_scalar (__main__.TestAutograd) ... ok\r\ntest_unfold_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_first (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_first_neg0 (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_last (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_last_neg0 (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_middle (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_middle_neg0 (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_scalar (__main__.TestAutograd) ... ok\r\ntest_unsqueeze_scalar_neg0 (__main__.TestAutograd) ... ok\r\ntest_unused_output (__main__.TestAutograd) ... ok\r\ntest_var (__main__.TestAutograd) ... ok\r\ntest_var_dim (__main__.TestAutograd) ... ok\r\ntest_var_dim_1d (__main__.TestAutograd) ... ok\r\ntest_var_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_var_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_var_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_var_keepdim_dim_1d (__main__.TestAutograd) ... ok\r\ntest_var_keepdim_dim_1d_neg0 (__main__.TestAutograd) ... ok\r\ntest_var_keepdim_dim_neg0 (__main__.TestAutograd) ... ok\r\ntest_var_mean (__main__.TestAutograd) ... ok\r\ntest_var_mean_differentiable (__main__.TestAutograd) ... ok\r\ntest_var_mean_dim (__main__.TestAutograd) ... ok\r\ntest_var_mean_dim_1d (__main__.TestAutograd) ... ok\r\ntest_var_mean_keepdim_dim (__main__.TestAutograd) ... ok\r\ntest_var_mean_keepdim_dim_1d (__main__.TestAutograd) ... ok\r\ntest_variable_traverse (__main__.TestAutograd) ... ok\r\ntest_version_counter (__main__.TestAutograd) ... ok\r\ntest_view (__main__.TestAutograd) ... ok\r\ntest_view_1d (__main__.TestAutograd) ... ok\r\ntest_view_as (__main__.TestAutograd) ... ok\r\ntest_view_as_scalar (__main__.TestAutograd) ... ok\r\ntest_view_as_scalar_to_dims (__main__.TestAutograd) ... ok\r\ntest_view_scalar_to_1d (__main__.TestAutograd) ... ok\r\ntest_view_scalar_to_scalar (__main__.TestAutograd) ... ok\r\ntest_view_size (__main__.TestAutograd) ... ok\r\ntest_volatile_deprecated (__main__.TestAutograd) ... ok\r\ntest_where (__main__.TestAutograd) ... ok\r\ntest_where_broadcast_all (__main__.TestAutograd) ... ok\r\ntest_where_scalar (__main__.TestAutograd) ... ok\r\ntest_where_scalar_broadcast_mask (__main__.TestAutograd) ... ok\r\ntest_where_scalar_broadcast_non_mask (__main__.TestAutograd) ... ok\r\ntest_zero_ (__main__.TestAutograd) ... ok\r\ntest_zero__scalar (__main__.TestAutograd) ... ok\r\ntest_GRU_grad_and_gradgrad_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_LSTM_grad_and_gradgrad_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_advanced_indexing_backwards_large_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_backward_device_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'fewer than 2 devices detected\'\r\ntest_cdist_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_cross_device_reentrant_autograd_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_ctc_loss_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_ctc_loss_cudnn_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_free_unneeded_tensor_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_grad_assignment_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_inputbuffer_add_multidevice_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'fewer than 2 devices detected\'\r\ntest_lstmcell_backward_only_one_output_grad_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_pdist_large_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_pin_memory_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_profiler_emit_nvtx_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_pyscalar_conversions_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_requires_grad_factory_cpu_float32 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_requires_grad_factory_cpu_float64 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_rnn_backward_to_input_but_not_parameters_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'Only runs on cuda\'\r\ntest_set_requires_grad_only_for_floats_cpu_float32 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_set_requires_grad_only_for_floats_cpu_float64 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_set_requires_grad_only_for_floats_cpu_int16 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_set_requires_grad_only_for_floats_cpu_int32 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_set_requires_grad_only_for_floats_cpu_int64 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_set_requires_grad_only_for_floats_cpu_int8 (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_sparse_ctor_getter_backward_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_sparse_mask_autograd_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_unused_output_device_cpu (__main__.TestAutogradDeviceTypeCPU) ... skipped \'fewer than 2 devices detected\'\r\ntest_where_functional_cpu (__main__.TestAutogradDeviceTypeCPU) ... ok\r\ntest_GRU_grad_and_gradgrad_cuda (__main__.TestAutogradDeviceTypeCUDA) ... /root/.local/lib/python2.7/site-packages/torch/backends/cudnn/__init__.py:107: UserWarning: PyTorch was compiled without cuDNN support. To use cuDNN, rebuild PyTorch making sure the library is visible to the build system.\r\n  ""PyTorch was compiled without cuDNN support. To use cuDNN, rebuild ""\r\nok\r\ntest_LSTM_grad_and_gradgrad_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_advanced_indexing_backwards_large_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_backward_device_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_cdist_cuda (__main__.TestAutogradDeviceTypeCUDA) ... skipped ""test doesn\'t currently work on the ROCm stack""\r\ntest_cross_device_reentrant_autograd_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_ctc_loss_cuda (__main__.TestAutogradDeviceTypeCUDA) ... skipped ""test doesn\'t currently work on the ROCm stack""\r\ntest_ctc_loss_cudnn_cuda (__main__.TestAutogradDeviceTypeCUDA) ... skipped ""test doesn\'t currently work on the ROCm stack""\r\ntest_free_unneeded_tensor_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_grad_assignment_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_inputbuffer_add_multidevice_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_lstmcell_backward_only_one_output_grad_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_pdist_large_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_pin_memory_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_profiler_emit_nvtx_cuda (__main__.TestAutogradDeviceTypeCUDA) ... skipped ""test doesn\'t currently work on the ROCm stack""\r\ntest_pyscalar_conversions_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_requires_grad_factory_cuda_float32 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_requires_grad_factory_cuda_float64 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_rnn_backward_to_input_but_not_parameters_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_float16 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_float32 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_float64 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_int16 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_int32 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_int64 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_set_requires_grad_only_for_floats_cuda_int8 (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_sparse_ctor_getter_backward_cuda (__main__.TestAutogradDeviceTypeCUDA) ... skipped ""test doesn\'t currently work on the ROCm stack""\r\ntest_sparse_mask_autograd_cuda (__main__.TestAutogradDeviceTypeCUDA) ... ok\r\ntest_unused_output_device_cuda (__main__.TestAutogradDeviceTypeCUDA) ... Memory access fault by GPU node-2 (Agent handle: 0x35ea260) on address (nil). Reason: Page not present or supervisor privilege.\r\nTraceback (most recent call last):\r\n  File ""test/run_test.py"", line 455, in <module>\r\n    main()\r\n  File ""test/run_test.py"", line 447, in main\r\n    raise RuntimeError(message)\r\nRuntimeError: test_autograd failed! Received signal: SIGIOT\r\n\r\n']"
151,17699,0,"nn.Embedding broken for half. ## üêõ Bug

Using the following script will break with error 



<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1. Run the script above

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

No error
<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): 1.0.1.post2
 - OS (e.g., Linux): Mac OSX 10.14.3
 - How you installed PyTorch (, , source): conda
 - Build command you used (if compiling from source):
 - Python version: 3.6
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nimport torch\r\nimport torch.nn as nn\r\n\r\nb = nn.Embedding(10, 20, 0)\r\nb.half()\r\nb(torch.randint(0, 10, size=(5, 10)))\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
207,13929,0,"Maturing JIT Optimization Framework. ## üöÄ Feature
Taking a current look at the JIT optimization framework there are a couple of feature missing. 

We do not have a structure that captures post pass analysis of the optimization pass. Analysis are fundamental in optimization as they allow us to understand the necessary passes better. For example if PyTorch had a simple analysis per pass that calculated the number of nodes in the computational graph changed we could introduce features such as fixed point optimization. We could mature even further to Immutable passes (analysis passes) which outline in what order to apply passes to maximize performance. Currently we have a very trivial implementation of optimization which simply runs [passes in linear order](https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/graph_executor.cpp#L458).

Another feature are pass managers. PyTorch implicitly does this by defining families of optimization passes (e.g. PeepholeOptimizeImpl implements a family of peephole optimization). An explicit OO implementation of pass managers will substantially clean up the code.

Simplifying the implementation of passes will increase agility. There's a lot of code reuse happening with respect to iterating the graph and checking for a pattern to apply a transform. If we could implement type's of passes (e.g. PredicatePass/PatternMatchPass, LoopPass), we could simplify code and reduce code reuse. 

## Motivation
I'm hoping by introducing these concepts to PyTorch's JIT we could mature the optimization framework and increase the performance of PyTorch in general.

## Pitch

This same approach and features I've implemented in the [ONNX optimization framework](https://github.com/onnx/onnx/tree/master/onnx/optimizer). If we agree that PyTorch needs these features I can start working on this.. []"
601,1151,0,"Does pytorch implement SpatialUpSamplingBilinear layer?. Hi, I want to load a model trained by torch, which contains the layer ""nn.SpatialUpSamplingBilinear"", the convert code is simple as blow:



it will generate the exception:


And I find the  in pytorch,  does it function like the layer ? 
. [""\r\nimport torch\r\nfrom torch.utils.serialization import load_lua\r\nmodel = load_lua('model.net')\r\n"", ""\r\nT7ReaderException: don't know how to deserialize Lua class nn.SpatialUpSamplingBilinear. If you want to ignore this error and load this object as a dict, specify unknown_classes=True in reader's constructor\r\n"", 'class torch.nn.UpsamplingBilinear2d', 'nn.SpatialUpSamplingBilinear']"
399,3573,0,"Mac OS X build with Python 3.6 fails. One representative error:



The cause of the problem is aa911939a328eff55c9b28b39ed3c43507ba8a2a:



It seems that on clang, changing the type parameter here is sufficient to cause template instantiation to fail.

Maybe the easiest way to fix this is to write a more portable version of PyInt_FromLong (and friends) which always returns .. ['\r\ntorch/csrc/autograd/functions/init.cpp:220:37: error: address of overloaded function \'getTupleAttr\' does not match required type \'_object *(_object *, void *)\'\r\n  {(char*)""output_padding"", (getter)getTupleAttr<ConvBackwardBackward, std::vector<int>, ConvParams,\r\n                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ntorch/csrc/autograd/functions/init.cpp:82:11: note: candidate template ignored: invalid explicitly-specified argument for template parameter \'Convert\'\r\nPyObject* getTupleAttr(PyObject* obj, void* _unused)\r\n', '\r\n   {(char*)""output_padding"", (getter)getTupleAttr<ConvForward, std::vector<int>, ConvParams,\r\n-                                         &ConvParams::output_padding, long, PyInt_FromLong>, NULL, NULL, NULL},\r\n+                                         &ConvParams::output_padding, int64_t, PyInt_FromLong>, NULL, NULL, NULL},\r\n']"
602,16558,0,"Pytorch Import:  failed to map segment Error . I installed Pytorch .3.1 using pip3 for python3.5, and the installation was successful.
However, I am unable to load the package in python

import torch
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""user/.local/lib/python3.5/site-packages/torch/__init__.py"", line 56, in <module>
    from torch._C import *
ImportError: libgcc_s.so.1: failed to map segment from shared object


Can anybody help, how to resolve this?

Best. []"
557,27820,0,"IterableDataset should be added into dataset.pyi. ## üêõ Bug
trying to import  in  creates an error in PyCharm. look at the following picture:
![ÂõæÁâá](https://user-images.githubusercontent.com/44257865/66712058-9c6b5500-edc9-11e9-9492-64c416939e7b.png)

It says that , where in , we can see that:
![ÂõæÁâá](https://user-images.githubusercontent.com/44257865/66712088-f9670b00-edc9-11e9-9ad4-417bc791c207.png)

It's obviously that there is no  but only its super class  exists.
I believe it should be added.


## To Reproduce
Steps to reproduce the behavior:

1. Open PyCharm
2. Write 
3. Error

## Expected behavior

No unresolved reference hinted.

## Environment


## Additional context


cc @SsnL @ezyang. ['\r\nPyTorch version: 1.2.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: Could not collect\r\n\r\nOS: Arch Linux\r\nGCC version: (GCC) 9.2.0\r\nCMake version: version 3.15.4\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: 10.1.243\r\nGPU models and configuration: GPU 0: GeForce RTX 2060\r\nNvidia driver version: 435.21\r\ncuDNN version: /usr/lib/libcudnn.so.7.6.4\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.17.2\r\n[pip3] torch==1.2.0\r\n[pip3] torchvision==0.4.0a0\r\n[conda] Could not collect\r\n']"
743,29805,0,"I use Torch Script to convert  has error. ## ‚ùì Questions and Help
attribute 'use_res_connect' of type 'bool' is not usable in a script method (did you forget to add it __constants__?):
at d:\PyCode\FeatherNetB\models\FeatherNet2.py:77:15
    @torch.jit.script_method
    def forward(self, x):
        if str(self.use_res_connect) == ""True"":
               ~~~~~~~~~~~~~~~~~~~~ <--- HERE
            return x + self.conv(x)
        else:
            if self.downsample is not None:
                return self.downsample(x) + self.conv(x)
            else:
                return self.conv(x)
### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
. []"
394,28775,0,"[feature request] Whether or not any planning to support mips64 arch environments. 

## üöÄ Feature
pytorch can be compiled in  arch successfully, and then utilize related API to develop :+1: 

## Motivation
I'm working on compiling pytorch in mips64 arch, but it doesn't work


I have tried add  in  and , same error happened.

## Pitch
pytorch can be compiled in  arch

<!-- A clear and concise description of what you want to happen. -->

## Alternatives
1) When I see warning info in  for , I plan to fake match rule in , for example:

The ultimate result will also failed since  . So, whether or not  support  arch, too? Thanks!
. ['\r\n(pytorch-venv) [root@lx-app-1 build]# git branch\r\n* v1.3.0\r\n\r\n(pytorch-venv) [root@lx-app-1 build]# cmake -DUSE_DISTRIBUTED=OFF -DBLAS=ATLAS -DAtlas_BLAS_LIBRARY=/usr/lib64/atlas/ -DAtlas_CBLAS_INCLUDE_DIR=/usr/include/atlas-mips64el-base/ -DAtlas_CBLAS_LIBRARY=/usr/lib64/atlas/USE_MPI=OFF -DUSE_FBGEMM=OFF -DCMAKE_SYSTEM_PROCESSOR=mips64  -DUSE_PYTORCH_QNNPACK=OFF -DBUILD_TEST=ON -DUSE_NNPACK=OFF -DUSE_QNNPACK=OFF -DUSE_NUMA=OFF  -DBUILD_CAFFE2_MOBILE=OFF  -DBUILD_BINARY=ON -DUSE_OPENCV=ON -DUSE_CUDA=OFF -DCMAKE_BUILD_TYPE=Release ..\r\n(pytorch-venv) [root@lx-app-1 build]# make -j $(nproc)\r\n... ...\r\nCMake Warning at third_party/cpuinfo/CMakeLists.txt:71 (MESSAGE):\r\n  Target processor architecture ""mips64"" is not supported in cpuinfo.\r\n  cpuinfo will compile, but cpuinfo_initialize() will always fail.\r\n... ...\r\n\r\n... ...\r\n[  6%] Generating contrib/playground/resnetdemo/override_no_test_model_no_checkpoint.py\r\n[  6%] Building C object sleef/src/libm/CMakeFiles/sleefpurecfma_scalar.dir/sleefsimdsp.c.o\r\n[  6%] Building C object sleef/src/libm/CMakeFiles/sleefdetpurec_scalar.dir/sleefsimddp.c.o\r\n[  6%] Building C object sleef/src/libm/CMakeFiles/sleefpurec_scalar.dir/sleefsimdsp.c.o\r\n[  6%] Building C object sleef/src/libm/CMakeFiles/sleefdetpurecfma_scalar.dir/sleefsimdsp.c.o\r\n[  6%] Built target c10\r\n[  6%] Building C object sleef/src/libm/CMakeFiles/sleefdetpurecfma_scalar.dir/sleefsimddp.c.o\r\n[  6%] Generating contrib/playground/resnetdemo/rendezvous_filestore.py\r\nIn file included from /home/yancy/pytorch/third_party/sleef/src/libm/sleefsimdsp.c:187:0:\r\n/home/yancy/pytorch/third_party/sleef/src/arch/helperpurec_scalar.h:56:2: error: #error FP_FAST_FMA or FP_FAST_FMAF not defined\r\n #error FP_FAST_FMA or FP_FAST_FMAF not defined\r\n... ...\r\n', '\r\n... ...\r\n-ELSEIF(NOT CMAKE_SYSTEM_PROCESSOR MATCHES ""^(i[3-6]86|AMD64|x86(_64)?|armv[5-8].*|aarch64)$"")\r\n+ELSEIF(NOT CMAKE_SYSTEM_PROCESSOR MATCHES ""^(i[3-6]86|AMD64|x86(_64)?|armv[5-8].*|aarch64|mips64|mips64el)$"")\r\n... ...\r\n']"
366,3158,0,"[Feature Request] Sparse-Dense elementwise Multiplication . Hi, thanks again for the great work.

I would like to raise an issue to discussion how to implement the following features:
Dense[m,1] * Sparse[m,n] -> Sparse[m,n]
Sparse[m,n] * Dense[1,n] -> Sparse[m,n]
Sparse[m*n] * Dense[b,1,n] -> Sparse[b,m,n]

these features are fully supported by the [cuSPARSE Level 3](https://developer.nvidia.com/cusparse), as for the CPU side, I'm not quite sure weather MKL was satisfied. 

I would like to help on the implementation if needed, could anyone give me a brief guideline that what have be done and what still need to be do?



 

cc @ezyang @gchanan @zou3519 @bdhirsh @jbschlosser @aocsa @nikitaved @pearu @mruberry @vincentqb. []"
328,11980,0,"[Enhancement] Increase user-friendliness of dataset.random_split. ## Issue description

Currently, when using the [random_split function](https://github.com/pytorch/pytorch/blob/master/torch/utils/data/dataset.py)  the parameters that need to be given are:
- dataset
- list that contains the lengths of splits to be produced

This means a user has to calculate these upfront and add them to the function as parameters like this:




Wouldn't it be better if the second parameter was a list that contains the percentages in which the users wants the split to happen, like this:
 .

The result of this change would be cleaner code for the user and also I believer in a more natural way of creating the splits.

I would like to pick this up as a pull request!





cc @VitalyFedyunin @ejguan. []"
125,15028,0,"License unavailable in the installed package. Hi. I noticed that, after pytorch is installed, the PKG-INFO file says the license is unknown. Our tools rely on this file to obtain the correct license information. Is it possible to put correct license information in it?

For example,  has:
. ['\r\nMetadata-Version: 1.0\r\nName: torch\r\nVersion: 0.4.1\r\nSummary: Tensors and Dynamic neural networks in Python with strong GPU acceleration\r\nHome-page: UNKNOWN\r\nAuthor: UNKNOWN\r\nAuthor-email: UNKNOWN\r\nLicense: UNKNOWN\r\nDescription: UNKNOWN\r\nPlatform: UNKNOWN\r\n']"
198,21922,0,"Segmentation fault using all_reduce with cuda:1 (MPI). ## üêõ Bug

Using  under cuda-aware MPI with a cuda device other than  causes segmentation fault. I managed to bypass this for a very specific use case by setting  and then using  within pytorch.
 
## To Reproduce



Steps to reproduce the behavior:

> mpirun -np 4 --oversubscribe -host 127.0.0.1 python test.py

Segmentation fault:

## Expected behavior

No crash

## Environment

PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.6 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: version 3.14.0

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration: 
GPU 0: Tesla P100-PCIE-16GB
GPU 1: Tesla P100-PCIE-16GB

Nvidia driver version: 418.67
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.16.4
[pip3] numpydoc==0.8.0
[pip3] torch==1.1.0
[pip3] torchvision==0.3.0a0+c94a158
[conda] blas                      1.0                         mkl  
[conda] libmklml                  2018.0.3                      0  
[conda] magma-cuda100             2.5.0                         1    pytorch
[conda] mkl                       2019.4                      243  
[conda] mkl-dnn                   0.14                 h6bb024c_0  
[conda] mkl-include               2019.4                      243  
[conda] mkl-service               2.0.2            py36h7b6447c_0  
[conda] mkl_fft                   1.0.12           py36ha843d7b_0  
[conda] mkl_random                1.0.2            py36hd81dba3_0  
[conda] torch                     1.1.0                    pypi_0    pypi
[conda] torchvision               0.3.0a0+c94a158          pypi_0    pypi


MPI 3.0.0 - cuda aware. ['python\r\nimport os\r\nimport socket\r\nimport torch\r\nimport torch.distributed as dist\r\n\r\n\r\ndef run(rank, size):\r\n    t = torch.rand(1).cuda()\r\n    gather_t = [torch.ones_like(t) for _ in range(size)]\r\n    dist.all_gather(gather_t, t)\r\n\r\ndef init_processes(rank, size, fn, backend=\'tcp\'):\r\n    """""" Initialize the distributed environment. """"""\r\n    dist.init_process_group(backend, rank=rank, world_size=size)\r\n    fn(rank, size)\r\n\r\n\r\nif __name__ == ""__main__"":\r\n    world_size = int(os.environ[\'OMPI_COMM_WORLD_SIZE\'])\r\n    world_rank = int(os.environ[\'OMPI_COMM_WORLD_RANK\'])\r\n\r\n    torch.cuda.set_device(1)\r\n    init_processes(world_rank, world_size, run, backend=\'mpi\')\r\n', '\r\n[prototype:02781] *** Process received signal ***\r\n[prototype:02781] Signal: Segmentation fault (11)\r\n[prototype:02781] Signal code: Invalid permissions (2)\r\n[prototype:02781] Failing at address: 0x7f4e64a00000\r\n[prototype:02781] [ 0] /lib/x86_64-linux-gnu/libpthread.so.0(+0x11390)[0x7f4f088a8390]\r\n[prototype:02781] [ 1] /lib/x86_64-linux-gnu/libc.so.6(+0x14e045)[0x7f4f0861b045]\r\n[prototype:02781] [ 2] /opt/openmpi-3.0.0/lib/libopen-pal.so.40(+0x49eec)[0x7f4eb2f8ceec]\r\n[prototype:02781] [ 3] /opt/openmpi-3.0.0/lib/libmpi.so.40(ompi_datatype_sndrcv+0x53a)[0x7f4ee0b4713a]\r\n[prototype:02781] [ 4] /opt/openmpi-3.0.0/lib/libmpi.so.40(ompi_coll_base_allgather_intra_recursivedoubling+0x8f)[0x7f4ee0b898bf]\r\n[prototype:02781] [ 5] /opt/openmpi-3.0.0/lib/libmpi.so.40(MPI_Allgather+0x12e)[0x7f4ee0b47e3e]\r\n[prototype:02781] [ 6] /root/anaconda/lib/python3.6/site-packages/torch/lib/libtorch_python.so(+0x71d826)[0x7f4ef9818826]\r\n[prototype:02781] [ 7] /root/anaconda/lib/python3.6/site-packages/torch/lib/libtorch_python.so(_ZN4c10d15ProcessGroupMPI7runLoopEv+0x27c)[0x7f4ef9814c6c]\r\n[prototype:02781] [ 8] /root/anaconda/lib/libstdc++.so.6(+0xb8678)[0x7f4ee259e678]\r\n[prototype:02781] [ 9] /lib/x86_64-linux-gnu/libpthread.so.0(+0x76ba)[0x7f4f0889e6ba]\r\n[prototype:02781] [10] /lib/x86_64-linux-gnu/libc.so.6(clone+0x6d)[0x7f4f085d441d]\r\n[prototype:02781] *** End of error message ***\r\n']"
154,27703,0,"FAIL: test_torch (__main__.TestDocCoverage). ## üêõ Bug

after our v1.3.0 doc changes i am seeing a test failure

FAIL: test_torch (__main__.TestDocCoverage)


## To Reproduce

Steps to reproduce the behavior:

1. git checkout upstream master
2. python ./test/test_docs_coverage.py

AssertionError: Items in the second set but not the first:
'real'
'imag'
'conj'
'angle' : 
The lists of tensor methods documented in tensors.rst and in python are
different. Did you forget to add a new thing to tensors.rst, or whitelist
things you don't want to document?

======================================================================
FAIL: test_torch (__main__.TestDocCoverage)
----------------------------------------------------------------------
Traceback (most recent call last):
  File ""./test/test_docs_coverage.py"", line 73, in test_torch
    don't want to document?''')
AssertionError: Items in the first set but not the second:
'promote_types'
'result_type'
'can_cast'
Items in the second set but not the first:
'quantize_per_tensor'
'quantize_per_channel' : 
The lists of functions documented in torch.rst and in python are different.
Did you forget to add a new thing to torch.rst, or whitelist things you
don't want to document?

----------------------------------------------------------------------
Ran 2 tests in 0.003s

FAILED (failures=2)

## Expected behavior


git checkout pr-fix-doc-test-failure

gottbrath@ubuntu:~/pytorch-for-doc$ python ./test/test_docs_coverage.py 
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK




cc @ezyang. []"
612,10660,0,"Inconsistent output of torch.mm when called in two mathematically equivalent way. Hi,

 I tired to use torch.mm to get matrix multiplication, but found it returned slightly different results when I called it in two equivalent way.

Assume we have two matrix  matrix_a and matrix_b and want to get the matrix multiplication matrix_a@matrix_b
1. First, I use matrix_a and matrix_b as input directly, torch.mm(matrix_a, matrix_b)
2. On the other hand, I call torch.mm with each row of matrix_a together with matrix_b as inputs, and then concatenate the results.

The two results are expected to be exactly the same, but they are still slightly diferent. So can somebody explain the reason?

Thanks,


Here is my test code.



Here is the output.

>  2018-08-18 21:32:11,294 INFO 87997 [test.py:81] difference between two values: tensor(1.00000e-06 *
>        1.3113)
> 2018-08-18 21:32:11,295 INFO 87997 [test.py:83] batch id: 0
> 2018-08-18 21:32:11,295 INFO 87997 [test.py:84] [-0.89934576  0.11556479 -0.48109883 -0.3961889 ]
> 2018-08-18 21:32:11,295 INFO 87997 [test.py:85] [-0.89934576  0.11556476 -0.4810989  -0.39618894]
> 2018-08-18 21:32:11,296 INFO 87997 [test.py:83] batch id: 1
> 2018-08-18 21:32:11,296 INFO 87997 [test.py:84] [ 2.6500921   0.5928108  -2.213797    0.39320117]
> 2018-08-18 21:32:11,296 INFO 87997 [test.py:85] [ 2.6500921   0.59281075 -2.2137969   0.3932012 ]
> 2018-08-18 21:32:11,296 INFO 87997 [test.py:83] batch id: 2
> 2018-08-18 21:32:11,296 INFO 87997 [test.py:84] [ 1.3148142  3.5158207 -2.2286756 -2.1263554]
> 2018-08-18 21:32:11,297 INFO 87997 [test.py:85] [ 1.3148141  3.515821  -2.2286754 -2.1263554]
> 2018-08-18 21:32:11,297 INFO 87997 [test.py:83] batch id: 3
> 2018-08-18 21:32:11,297 INFO 87997 [test.py:84] [-0.25188264  1.0855039   1.4054772  -0.47265998]
> 2018-08-18 21:32:11,297 INFO 87997 [test.py:85] [-0.25188267  1.085504    1.4054773  -0.47265998]
> 2018-08-18 21:32:11,298 INFO 87997 [test.py:83] batch id: 4
> 2018-08-18 21:32:11,298 INFO 87997 [test.py:84] [ 1.250929   3.790292  -1.7040166 -2.443583 ]
> 2018-08-18 21:32:11,298 INFO 87997 [test.py:85] [ 1.250929   3.790292  -1.7040166 -2.443583 ]. ['\r\ntorch.manual_seed(0)\r\n\r\nmatrix_a = torch.randn([5, 4])\r\nmatrix_b = torch.randn([4, 4])\r\nvalues = torch.randn([5, 4])\r\n\r\n# 1. call torch.mm directly on matrix_a and matrix_b.\r\ntorch.mm(matrix_a, matrix_b, out=values)\r\n\r\n# save the result in buffer.\r\nvalues_1 = values.clone()\r\n\r\n# 2. call torch.mm on each row of matrix_a and matrix_b.\r\nbatch_size = matrix_a.size(0)\r\nfor b in range(batch_size):\r\n    torch.mm(matrix_a[b:b+1], matrix_b, out=values[b:b+1])\r\n\r\n# value and value_1 are supposed to be equal. But they are not.\r\nlogger.info(""difference between two values: %s"" % (torch.sum(torch.abs(values - values_1))))\r\nfor b in range(batch_size):\r\n    logger.info(""batch id: %s"" % b)\r\n    logger.info(values_1[b].data.numpy())\r\n    logger.info(values[b].data.numpy())\r\n']"
723,29211,0,"""multinomial_kernel_cuda"" not implemented for 'Half'. It appears that even after the  fixes,  no longer works with  dtypes

## To Reproduce







## Environment


## Additional context
This is not blocking us because we can convert to fp32 before sampling. ['bash\r\npip install -U --pre torch==1.4.0.dev20191104 torchvision -f https://download.pytorch.org/whl/nightly/cu101/torch_nightly.html\r\n', 'python\r\nimport torch\r\n\r\n\r\ndef test_fp16_categorical():\r\n    logits_fp16 = torch.randn(20).cuda().half()\r\n\r\n    # These are fine\r\n    torch.argmax(logits_fp16)\r\n    torch.max(logits_fp16)\r\n\r\n    # This is also fine\r\n    logits_fp32 = logits_fp16.float()\r\n    sample = torch.distributions.Categorical(logits=logits_fp32).sample()\r\n    print(sample)\r\n\r\n    # This fails\r\n    sample = torch.distributions.Categorical(logits=logits_fp16).sample()\r\n    print(sample)\r\n\r\n\r\nif __name__ == ""__main__"":\r\n    test_fp16_categorical()\r\n', ' \r\nFile ""/opt/conda/lib/python3.7/site-packages/torch/distributions/categorical.py"", line 107, in sample\r\n    sample_2d = torch.multinomial(probs_2d, 1, True)\r\nRuntimeError: ""multinomial_kernel_cuda"" not implemented for \'Half\'\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.4.0.dev20191104\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.1\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609\r\nCMake version: version 3.11.1\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration:\r\nGPU 0: Tesla V100-SXM2-16GB\r\nGPU 1: Tesla V100-SXM2-16GB\r\nGPU 2: Tesla V100-SXM2-16GB\r\nGPU 3: Tesla V100-SXM2-16GB\r\nGPU 4: Tesla V100-SXM2-16GB\r\nGPU 5: Tesla V100-SXM2-16GB\r\nGPU 6: Tesla V100-SXM2-16GB\r\nGPU 7: Tesla V100-SXM2-16GB\r\n\r\nNvidia driver version: 418.87.01\r\ncuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.4.2\r\n']"
713,15129,0,"ResNet -101 does not run when converted to sequential (returns dimension mismatch). ## üêõ Bug

I wanted to obtain convolutional features from ResNet-101. I had already figured out how to do it, but I wanted to run a simple test to check if I am applying the correct preprocessing steps, so instead of omitting the last layer, I transformed the whole network into a nn.Sequential(), only to get an error:
RuntimeError: size mismatch, m1: [2048 x 1], m2: [2048 x 1000] at /pytorch/aten/src/TH/generic/THTensorMath.cpp:940

## To Reproduce

Here is the code:


When I run resnet_eval with a valid image path, I get the following output:



Of course, transforming the whole net into a sequential model is non-sense, we can just replace the first line (after the docstring) of resnet_eval with

and get the expected output


Another approach is to remove the final layer, reshape the output tensor and then add the last layer again, like this:

and once again, this works as expected, giving the same output as when running


If I print the tensor values, they are identical in the two last cases. So why do I come accross the mismatch error in the first case (or equivalently, why is the last case valid)?

## Expected behavior

The first case should run smoothly, giving the same output as the second one.

## Environment

Tested with Python3.5 and 
torch==1.0.0
torchvision==0.2.1
. ['python\r\n""""""Test PyTorch ResNet-101.""""""\r\nfrom matplotlib import pyplot as plt\r\nfrom PIL import Image\r\nfrom torch import nn\r\nfrom torchvision import models, transforms\r\n\r\n\r\nclass ResNet101(nn.Module):\r\n    """"""ResNet-101 PyTorch.""""""\r\n\r\n    def __init__(self):\r\n        """"""Initialize network and freeze layers.""""""\r\n        super().__init__()\r\n        self.resnet = nn.Sequential(\r\n            *list(models.resnet101(pretrained=True).children())\r\n        )\r\n        for param in self.resnet.parameters():\r\n            param.requires_grad = False\r\n\r\n    def forward(self, x):\r\n        """"""Forward pass.""""""\r\n        x = self.resnet(x)\r\n        return x\r\n\r\n\r\ndef resnet_eval(img_path):\r\n    """"""Run a simple classification.""""""\r\n    resnet = ResNet101().eval()\r\n    img = Image.open(img_path)\r\n    preprocessing = transforms.Compose([\r\n        transforms.Resize((224, 224)),\r\n        transforms.ToTensor(),\r\n        transforms.Normalize(mean=[0.485, 0.456, 0.406],\r\n                             std=[0.229, 0.224, 0.225])\r\n    ])\r\n    inputs = preprocessing(img).unsqueeze(0)\r\n    print(inputs.shape)\r\n\r\n    outputs = resnet(inputs)\r\n    print(outputs.data.shape)\r\n    # print(outputs)\r\n    print(outputs[0].sort()[1][-1])\r\n    plt.figure()\r\n    plt.imshow(img)\r\n    plt.axis(\'off\')\r\n    plt.show()\r\n', '\r\ntorch.Size([1, 3, 224, 224])\r\nTraceback (most recent call last):\r\n  File ""res.py"", line 58, in <module>\r\n    resnet_eval(folder + img_name)\r\n  File ""res.py"", line 39, in resnet_eval\r\n    outputs = resnet(inputs)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py"", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""res.py"", line 22, in forward\r\n    x = self.resnet(x)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py"", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py"", line 92, in forward\r\n    input = module(input)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py"", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/modules/linear.py"", line 67, in forward\r\n    return F.linear(input, self.weight, self.bias)\r\n  File ""/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py"", line 1354, in linear\r\n    output = input.matmul(weight.t())\r\nRuntimeError: size mismatch, m1: [2048 x 1], m2: [2048 x 1000] at /pytorch/aten/src/TH/generic/THTensorMath.cpp:940\r\n', '\r\nresnet = models.resnet101(pretrained=True).eval()\r\n', '\r\ntorch.Size([1, 3, 224, 224])\r\ntorch.Size([1, 1000])\r\ntensor(546)\r\n', 'python\r\nclass ResNet101(nn.Module):\r\n    """"""ResNet-101 PyTorch.""""""\r\n\r\n    def __init__(self):\r\n        """"""Initialize network and freeze layers.""""""\r\n        super().__init__()\r\n        self.resnet = nn.Sequential(\r\n            *list(models.resnet101(pretrained=True).children())[:-1]\r\n        )\r\n        for param in self.resnet.parameters():\r\n            param.requires_grad = False\r\n        self.linear = list(models.resnet101(pretrained=True).children())[-1]\r\n\r\n    def forward(self, x):\r\n        """"""Forward pass.""""""\r\n        x = self.resnet(x)\r\n        x = x.view(x.shape[0], -1)\r\n        x = self.linear(x)\r\n        return x\r\n', '\r\nresnet = models.resnet101(pretrained=True).eval()\r\n']"
396,5949,0,"Bug Report re-initializing weights after layer initialization . 
Why is this allowed? considering the fact that it changes the entire layer 




This gives a dimension mismatch error
. ['\r\nx = Variable( torch.randn(1,10))\r\nlayer = nn.Linear(10,10,bias=False)\r\nlayer.weight.data = torch.randn(100,100)\r\n', '\r\nprint(layer)\r\nLinear(in_features=10, out_features=10, bias=False) \r\n\r\n', '\r\nx = torch.randn(1,10)\r\nlayer(Variable(x))\r\n']"
722,11121,0,"Running torch.cuda.is_available() before import from torch._C import *. ## Issue description

Using a NFS, sometimes I find myself on machines without _Cuda_, although _PyTorch_ was installed on a _Cuda_ enabled machine. _PyTorch_ fails to load and crashes instead.

## Code example



## System Info

- PyTorch or Caffe2: _PyTorch_
- How you installed PyTorch (conda, pip, source): , on a _Cuda_ enabled machine
- OS: _CentOS_ 7
- PyTorch version: 
- Python version: 
- CUDA/cuDNN version:  or . ['python\r\nIn [1]: import torch\r\n---------------------------------------------------------------------------\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-1-23eb050c9654> in <module>()\r\n----> 1 import torch\r\n\r\n[...]/atcold/anaconda3/lib/python3.6/site-packages/torch/__init__.py in <module>()\r\n     78     pass\r\n     79\r\n---> 80 from torch._C import *\r\n     81\r\n     82 __all__ += [name for name in dir(_C)\r\n\r\nImportError: libcudart.so.9.0: cannot open shared object file: No such file or directory\r\n']"
127,3462,0,"sort() and  topk() behave weirdly when given large numbers. 

In the above, a matrix of large numbers, where every element is the same, is added to a matrix of small numbers (this shouldn't affect the ordering of the small matrix). Hence  should all be the same. However,  is different from the rest, meaning adding a large numbers to the input makes  behave weirdly. So does , presumably for the same reason.

I've been getting weird results with my beam search implementation in PyTorch, and this was the culprit. In beam search you have to sort a list of large negative numbers (log probabilities of candidate translation sentences). Can anyone suggest a quick workaround? Thanks!. ['python\r\nimport torch\r\nimport numpy as np\r\n\r\nbatch_size = 5\r\ndim = 10\r\n\r\n### pytorch\r\na1 = torch.randn(batch_size, dim)\r\nv1, r1 = a1.sort(dim=1)\r\n\r\ninc = torch.ones(batch_size)[:,None]*99999999\r\na2 = inc + a1\r\nv2, r2 = a2.sort(dim=1)\r\n\r\n### numpy\r\na3 = a1.numpy()\r\nr3 = np.argsort(a3, axis=1)\r\n\r\ninc2 = np.ones(batch_size)[:,None]*99999999\r\na4 = inc2 + a3\r\nr4 = np.argsort(a4, axis=1)\r\n']"
226,2677,0,"Require_grad = True, but printed as ""None"". My code is

x = Variable(torch.rand(8, 1, 5, 5), requires_grad=True)
conv = nn.Conv2d(1, 1, 3)
y = conv(x)
final = torch.sum(y)
print('y.grad', y.grad)
final.backward()
print('y.grad', y.grad)
print('y.grad', y.requires_grad)

However, the output is 
y.grad None
y.grad None
y.grad True

If y.requires_grad==True, shouldn't the second y.grad output some gradients instead of None? For x, the gradient showed normally after the backward(). []"
505,19162,0,"Denormalize option in torchvision.utils.save_image(). ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->
A function to denormalize an image based on mean and standard deviation.

## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->
When working with images on NN's trained on a specific dataset (for example ImageNet), an image is first normalized to the mean and standard deviation of that dataset. When we want to save such an image later in the process we can use the function *torchvision.utils.save_image()*. However the image is still normalized and will have a different mean and standard deviation compared to the original image. There is no option to *denormalize* such an image such that the initial normalization is undone and the saved image has the same mean and std.

## Pitch

<!-- A clear and concise description of what you want to happen. -->
A extra parameter to the *torchvision.utils.save_image()* function to denormalize an image based on a mean and standardization array.

## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->
One way to tackle the problem currently is to use the *transforms.Normalize()* function. My current implementation is shown below. One flaw of this implementation is that the image has to be clipped to keep the values between 0 and 1. Thus some information is lost. I am not sure how to do this operation lossless.



. ['python\r\ndef img_denorm(img, mean, std):\r\n    #for ImageNet the mean and std are:\r\n    #mean = np.asarray([ 0.485, 0.456, 0.406 ])\r\n    #std = np.asarray([ 0.229, 0.224, 0.225 ])\r\n\r\n    denormalize = transforms.Normalize((-1 * mean / std), (1.0 / std))\r\n\r\n    res = img.squeeze(0)\r\n    res = denormalize(res)\r\n\r\n    #Image needs to be clipped since the denormalize function will map some\r\n    #values below 0 and above 1\r\n    res = torch.clamp(res, 0, 1)\r\n    \r\nreturn(res)\r\n']"
4,7714,1,"Very slow for gradient penalty!. Gradient penalty (GP) here means we minimize L2 norm of the gradient w.r.t input images.

I work on Ubuntu14.04, Python2.7, CUDA8.0 and CUDNN.
The version of Pytorch is 0.4.0.
I find it is very slow when I apply gradient penalty (GP) for training CIFAR10 with Resnet18.
I test the average running time of each step with and without GP:

4 times slower compared with the standard training!
Here is my code:

Is there better implementation?
Or just as slow as it is? . ['\r\nwithout : 0.065s\r\nwith GP: 0.330s\r\n', 'python\r\nimport torch\r\nfrom torch import nn, autograd\r\nfrom torch.autograd import Variable\r\nfrom models import PreActResNet18\r\nimport time\r\n\r\nnet = PreActResNet18()\r\nnet.cuda()\r\nopt = torch.optim.SGD(net.parameters(), 0.01, momentum=0.9, weight_decay=1e-4)\r\nbatchsize = 128\r\n\r\nGP = True\r\nstart = time.time()\r\n\r\nfor i in range(100):\r\n    x = torch.rand((batchsize, 3, 32, 32)).cuda()\r\n    y = torch.randint(0, 10, (batchsize,)).cuda().long()\r\n    x, y = Variable(x, requires_grad=True), Variable(y)\r\n    opt.zero_grad()\r\n    preds = net(x)\r\n    loss_c = nn.CrossEntropyLoss()(preds, y)\r\n\r\n    if GP:\r\n        grad = autograd.grad(loss_c, x, create_graph=True, retain_graph=True,\r\n                             only_inputs=True)[0]\r\n        loss_g = (grad ** 2).mean() * batchsize\r\n        (loss_c + loss_g).backward()\r\n    else:\r\n        loss_c.backward()\r\n    opt.step()\r\n\r\nend = time.time()\r\nprint(""{:.3f}s for each step"".format((end-start)/100))\r\n']"
45,3863,1,"Considerable slowdown in Adam.step after a number of epochs with multiple losses. I have a model with multiple outputs and, therefore, multiple losses. When training I accumulate the losses using retain_graph. Something along the lines of:



where input, output and target are dictionaries with the respective data for the different inputs and losses.

I am using Adam for the optimization. 
I've noticed that after a number of epochs, the running time of an epoch goes suddenly up from 7sec to 34sec.
I also noticed a slowdown of CPU usage in my computer (I haven't test this yet on the GPU). Memory usage doesn't seem to increase.

I profiled the code and I saw this (output from cProfile):

Normal epoch:

Slow epoch:

I've tested with other adaptive losses like Adagrad, and there I can't see the issue.
It seems to be related to this line of code in Adam.step():

Any ideas about why this is happening? It seems like suddenly the size of the accumulated gradient explodes, but  I can't see why.

cc @vincentqb @VitalyFedyunin @ngimel. ['python\r\nself.zero_grad()\r\nfor output_label, output in self(input, target).items():\r\n    loss = self.loss(output, target[output_label])\r\n    loss.backward(retain_graph=True)\r\nself.optimizer.step()\r\n', ""\r\n       52    0.012    0.000    3.538    0.068 adam.py:30(step)\r\n      624    0.646    0.001    0.646    0.001 {method 'addcdiv_' of 'torch._C.FloatTensorBase' objects}\r\n"", ""\r\n       52    0.013    0.000   24.576    0.473 adam.py:30(step)\r\n      624   21.469    0.034   21.469    0.034 {method 'addcdiv_' of 'torch._C.FloatTensorBase' objects}\r\n"", '\r\np.data.addcdiv_(-step_size, exp_avg, denom)\r\n']"
121,6064,0,"[jit]][script] handling of 'void' returns. Methods returning no values generate weird error messages:

For instance:



produces 


What is expected?

* omitting a return statement should be valid and just return 0 values (someone might just be print debugging at this point and hasn't written the return yet)
*  with no value should work.. ['\r\n    def test_script_module_for(self):\r\n        class M(torch.jit.ScriptModule):\r\n            def __init__(self):\r\n                super(M, self).__init__(False)\r\n               \r\n            @torch.jit.script_method\r\n            def forward(self):\r\n                return\r\n', '\r\nTraceback (most recent call last):\r\n  File ""test/test_jit.py"", line 2059, in test_script_module_for\r\n    class M(torch.jit.ScriptModule):\r\n  File ""test/test_jit.py"", line 2064, in M\r\n    @torch.jit.script_method\r\n  File ""/data/users/zdevito/pytorch/torch/jit/__init__.py"", line 539, in script_method\r\n    return ScriptMethodStub(createResolutionCallback(), get_jit_ast(fn))\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 127, in get_jit_ast\r\n    return build_def(SourceRangeFactory(source), py_ast.body[0])\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 146, in build_def\r\n    [build_stmt(ctx, stmt) for stmt in body])\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 135, in __call__\r\n    return method(ctx, node)\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 207, in build_Return\r\n    return Return(r, [build_expr(ctx, val) for val in values])\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 134, in __call__\r\n    raise UnsupportedNodeError(ctx, node)\r\n  File ""/data/users/zdevito/pytorch/torch/jit/frontend.py"", line 110, in __init__\r\n    source_range = ctx.make_range(offending_node.lineno,\r\nAttributeError: \'NoneType\' object has no attribute \'lineno\'\r\n']"
494,16277,0,"Inconsistency in inception model. ## üêõ Bug

Hi
I was going through the torchvision code to implement c++ API and I noticed an Inconsistency.

In line 298 of inception.py stddev of a class of type BasicConv2d is set to 0.01:



But in line 60 it checks if it's conv2d or linear which a BasicConv2d is none:



I put this code inside the previous if statement:



and it only printed:



so convs inside conv1 BasicConv2d of InceptionAux get initialized with stddev=0.1

is this an error or is it intentional?. [' python\r\nself.conv1.stddev = 0.01\r\n', "" python\r\nif isinstance(m, nn.Conv2d) or isinstance(m, nn.Linear):\r\n   import scipy.stats as stats\r\n   stddev = m.stddev if hasattr(m, 'stddev') else 0.1\r\n"", "" python\r\nif hasattr(m, 'stddev'):\r\n    print(m)\r\n"", '\r\nLinear(in_features=768, out_features=1000, bias=True)\r\n']"
63,28503,1,"Inconsistent behaviour in einsum with fp16. ## üêõ Bug

torch.einsum seems to have inconsistent behavior with half-precision tensors, as illustrated in the snippet below (minimal non-working example):


As we can see in the example above, the results we get in fp16 can be significantly different from the fp32 (all the 0.000) but are also inconsistent for the same computation as highlighted in the comments.

## To Reproduce

**See snipped above.**

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

Running the same computation multiple times should give the same result everytime for the same input.

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): 1.3.0
 - OS (e.g., Linux): Ubuntu 18.04
 - How you installed PyTorch (, , source): conda
 - Build command you used (if compiling from source): N/A
 - Python version: 3.7.4
 - CUDA/cuDNN version: 10.2/7.5
 - GPU models and configuration: Code was run on a single 2080 Ti
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nimport torch\r\nM = torch.rand(8,29495,3,3)\r\np = torch.rand(8,29495,3)\r\nMg = M.to(\'cuda:0\')\r\npg = p.to(\'cuda:0\')\r\nloss = torch.einsum(""bni,bnij,bnj->bn"", p, M, p)\r\nlossg = torch.einsum(""bni,bnij,bnj->bn"", pg, Mg, pg)\r\n\r\nloss\r\nOut[8]:\r\ntensor([[2.1239, 0.9082, 1.4092,  ..., 0.9028, 1.6758, 1.9743],\r\n        [1.6000, 0.0101, 1.7230,  ..., 1.4759, 0.3911, 1.5262],\r\n        [1.0034, 1.1164, 1.5749,  ..., 2.0209, 1.0497, 2.4276],\r\n        ...,\r\n        [0.5796, 2.0528, 0.2507,  ..., 0.0232, 2.2315, 0.5563],\r\n        [0.0189, 2.1756, 1.6934,  ..., 2.5696, 0.6931, 2.1793],\r\n        [1.0421, 0.6458, 1.0652,  ..., 0.2180, 1.9430, 1.5560]])\r\n\r\nlossg\r\nOut[9]:\r\ntensor([[2.1239, 0.9082, 1.4092,  ..., 0.9028, 1.6758, 1.9743],\r\n        [1.6000, 0.0101, 1.7230,  ..., 1.4759, 0.3911, 1.5262],\r\n        [1.0034, 1.1164, 1.5749,  ..., 2.0209, 1.0497, 2.4276],\r\n        ...,\r\n        [0.5796, 2.0528, 0.2507,  ..., 0.0232, 2.2315, 0.5563],\r\n        [0.0189, 2.1756, 1.6934,  ..., 2.5696, 0.6931, 2.1793],\r\n        [1.0421, 0.6458, 1.0652,  ..., 0.2180, 1.9430, 1.5560]],\r\n       device=\'cuda:0\')\r\n\r\n# Recompute the loss in fp32\r\nlossg = torch.einsum(""bni,bnij,bnj->bn"", pg, Mg, pg)\r\nlossg\r\n# Consistent result\r\nOut[11]:\r\ntensor([[2.1239, 0.9082, 1.4092,  ..., 0.9028, 1.6758, 1.9743],\r\n        [1.6000, 0.0101, 1.7230,  ..., 1.4759, 0.3911, 1.5262],\r\n        [1.0034, 1.1164, 1.5749,  ..., 2.0209, 1.0497, 2.4276],\r\n        ...,\r\n        [0.5796, 2.0528, 0.2507,  ..., 0.0232, 2.2315, 0.5563],\r\n        [0.0189, 2.1756, 1.6934,  ..., 2.5696, 0.6931, 2.1793],\r\n        [1.0421, 0.6458, 1.0652,  ..., 0.2180, 1.9430, 1.5560]],\r\n       device=\'cuda:0\')\r\n\r\n# Half-precision\r\nMgh = Mg.half()\r\npgh = pg.half()\r\n\r\nlossgh = torch.einsum(""bni,bnij,bnj->bn"", pgh, Mgh, pgh)\r\nlossgh\r\nOut[15]:\r\ntensor([[2.1250, 0.9087, 1.4092,  ..., 0.9028, 1.6768, 1.9736],\r\n        [1.5996, 0.0101, 1.7236,  ..., 1.4756, 0.3914, 1.5264],\r\n        [1.0029, 1.1162, 1.5742,  ..., 0.0000, 0.0000, 0.0000], # <-- Here\r\n        ...,\r\n        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],\r\n        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],\r\n        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],\r\n       device=\'cuda:0\', dtype=torch.float16)\r\n\r\n# Compute it again\r\nlossgh = torch.einsum(""bni,bnij,bnj->bn"", pgh, Mgh, pgh)\r\nlossgh\r\nOut[17]:\r\ntensor([[ 2.1250,  0.9087,  1.4092,  ...,  0.9028,  1.6768,  1.9736],\r\n        [ 1.5996,  0.0101,  1.7236,  ...,  1.4756,  0.3914,  1.5264],\r\n        [ 1.0029,  1.1162,  1.5742,  ...,  2.0000,  1.7764, -2.0000], # <-- Here\r\n        ...,\r\n        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],\r\n        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],\r\n        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],\r\n       device=\'cuda:0\', dtype=torch.float16)\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
30,26797,1,"Inconsistent gradient from different backend of CTCLoss. ## üêõ Bug

I'm switching to the cudnn backend of CTCLoss since the other is not fully reproducible,
however, it turns out that the exact same model that used to work with pytorch's cuda backend ctc loss now failed.
With some simple example, I found that there's a huge difference in gradient (both direction and magnitude) between two backends.
I'm not sure if the bug is on pytorch or cudnn, but as far as I know, TensorFlow also used CTC from cudnn and there is no similar issue.
Thanks in advance.

## To Reproduce

## Behavior



## Environment




cc @ezyang @gchanan @zou3519. ['\r\nimport torch\r\ntorch.manual_seed(0)\r\ntorch.backends.cudnn.deterministic = True\r\ntorch.backends.cudnn.benchmark = False\r\n\r\nbatch_size = 16\r\nseq_len = 50\r\ntarget_len = seq_len//2\r\nlatent_dim = 128\r\nvocab_size = 50\r\n\r\nx = torch.randn((seq_len,batch_size,latent_dim)).cuda()\r\ny = torch.randint(1,vocab_size,(batch_size*target_len,),dtype=torch.long).cuda()\r\nx_len = seq_len*torch.ones((batch_size,),dtype=torch.long).cuda()\r\ny_len = target_len*torch.ones((batch_size,),dtype=torch.long).cuda()\r\nw = torch.nn.Linear(latent_dim,vocab_size).cuda()\r\n\r\ndef compute_ctc(x,y,x_len,y_len,use_cudnn):\r\n    for p in w.parameters():\r\n        if p.grad is not None:\r\n            p.grad.zero_()\r\n    # Forward\r\n    output = w(x).log_softmax(dim=-1)\r\n    if use_cudnn:\r\n        loss = torch.nn.functional.ctc_loss(output,\r\n                                            y.to(\'cpu\',torch.int32),\r\n                                            x_len.to(\'cpu\',torch.int32),\r\n                                            y_len.to(\'cpu\',torch.int32))\r\n    else:\r\n        loss = torch.nn.functional.ctc_loss(output,y,x_len,y_len)\r\n    # backward\r\n    loss.backward()\r\n    m, b = w.parameters()\r\n    print(\'loss = {}\\ngrad_norm = {}\'.format(loss, m.grad.view(-1).norm()))\r\n    return m.grad.clone()\r\n\r\nprint(""===== Pytorch CTC ====="")\r\ntorch_grad = compute_ctc(x,y,x_len,y_len,False)\r\nprint(""===== Cudnn CTC ====="")\r\ncudnn_grad = compute_ctc(x,y,x_len,y_len,True)\r\nprint(""===== Grad diff. ====="")\r\nprint(""Cos Sim. = "",torch.nn.functional.cosine_similarity(torch_grad.view(-1),cudnn_grad.view(-1),dim=0))\r\nprint(""Magnitude  = "",cudnn_grad.view(-1).norm() / torch_grad.view(-1).norm())\r\n\r\n', ""\r\n===== Pytorch CTC =====\r\nloss = 6.073373794555664\r\ngrad_norm = 0.4746553599834442\r\n===== Cudnn CTC =====\r\nloss = 6.073373794555664\r\ngrad_norm = 10431.4375\r\n===== Grad diff. =====\r\nCos Sim. =  tensor(0.6508, device='cuda:0')\r\nMagnitude  =  tensor(21976.8672, device='cuda:0')\r\n"", '\r\nPyTorch version: 1.2.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.3 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.1.243\r\nGPU models and configuration: \r\nGPU 0: GeForce GTX 1080 Ti\r\nGPU 1: GeForce GTX 1080 Ti\r\n\r\nNvidia driver version: 430.50\r\ncuDNN version: /usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudnn.so.7\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.17.2\r\n[pip3] torch==1.2.0\r\n[pip3] torchaudio==0.3.0\r\n[pip3] torchvision==0.4.0\r\n[conda] Could not collect\r\n\r\n']"
498,24537,0,"Migrate `asin` and `asin_` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
483,31483,0,"undefined symbol: _Py_ZeroStruct. Although I have installed ""pytorch"" and ""text"" with python and python3 using


When I want to text_classification tutorial, I get this error


I don't know what is missing here. Any way to fix that?

cc @ezyang. ['\r\npython setup.py install --user\r\npython3 setup.py install --user\r\n', '\r\n$ python3 main.py\r\nTraceback (most recent call last):\r\n  File ""main.py"", line 1, in <module>\r\n    import torch\r\n  File ""/home/mnaderan/.local/lib/python3.6/site-packages/torch/__init__.py"", line 81, in <module>\r\n    from torch._C import *\r\nImportError: /home/mnaderan/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so: undefined symbol: _Py_ZeroStruct\r\ncorrupted size vs. prev_size\r\nAborted (core dumped)\r\n']"
632,17108,0,"[Running on windows 10] cuda runtime error (30) : unknown error at ..\aten\src\THC\THCGeneral.cpp:87. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)

While trying to run my test.py file on my anaconda prompt I got these messages below:

CUDA‚Ñ¢ is AVAILABLE
Please assign a gpu core (int, <1): 0
THCudaCheck FAIL file=..\aten\src\THC\THCGeneral.cpp line=87 error=30 : unknown error
Traceback (most recent call last):
  File ""VSLcore.py"", line 202, in <module>
    DQNAgent()
  File ""VSLcore.py"", line 87, in DQNAgent
    torch.set_default_tensor_type('torch.cuda.FloatTensor')
  File ""D:\Softwares\Anaconda3\lib\site-packages\torch\__init__.py"", line 158, in set_default_tensor_type
    _C._set_default_tensor_type(t)
  File ""D:\Softwares\Anaconda3\lib\site-packages\torch\cuda\__init__.py"", line 162, in _lazy_init
    torch._C._cuda_init()
RuntimeError: cuda runtime error (30) : unknown error at ..\aten\src\THC\THCGeneral.cpp:87

What should I do?. []"
658,28347,0,"arange sometimes changes dimensionality of output tensor. ## üêõ Bug

Using  with an  target Tensor object, it will sometimes change the dimensionality of the target Tensor.  I'm creating a (1,N) tensor, and sometimes calling  changes it to a (N+1) vector.  Same on cuda or cpu.


## To Reproduce



This will output:



## Expected behavior

 should not change the shape of the target Tensor.

## Environment

PyTorch 1.3, Ubuntu 18.04LTS, py 3.6.9 under Anaconda.  In detail (from ):



## Additional context

I started doing it this way (out= Tensor) because I wanted to make sure the whole thing to happen on GPU, and that was the first thing I figured out.  I see another way to do this now --  which works.  But this seems like a bug.


cc @ezyang @gchanan @zou3519 @jerryzh168. ['python\r\nimport torch\r\n  \r\nfor N in range(45,100):\r\n    print(f""Trying {N}..."")\r\n    line = torch.zeros(size=(1,N))\r\n    print(f""  Before arange shape is {line.shape}"")\r\n    assert len(line.shape) == 2\r\n    torch.arange(-1, 1, 2/N, dtype=torch.float32, out=line)\r\n    print(f""  After arange shape is {line.shape}"")\r\n    assert len(line.shape) == 2\r\n', '\r\nTrying 45...\r\n  Before arange shape is torch.Size([1, 45])\r\n  After arange shape is torch.Size([1, 45])\r\nTrying 46...\r\n  Before arange shape is torch.Size([1, 46])\r\n  After arange shape is torch.Size([1, 46])\r\nTrying 47...\r\n  Before arange shape is torch.Size([1, 47])\r\n  After arange shape is torch.Size([1, 47])\r\nTrying 48...\r\n  Before arange shape is torch.Size([1, 48])\r\n  After arange shape is torch.Size([1, 48])\r\nTrying 49...\r\n  Before arange shape is torch.Size([1, 49])\r\n  After arange shape is torch.Size([50])\r\nTraceback (most recent call last):\r\n  File ""shapebug.py"", line 10, in <module>\r\n    assert len(line.shape) == 2\r\nAssertionError\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.3.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 18.04.3 LTS\r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.1.85\r\nGPU models and configuration: GPU 0: GeForce GTX 1070 with Max-Q Design\r\nNvidia driver version: 418.56\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] facenet-pytorch==0.3.1\r\n[pip] numpy==1.17.2\r\n[pip] torch==1.3.0\r\n[pip] torchvision==0.4.1a0+d94043a\r\n[conda] blas                      1.0                         mkl  \r\n[conda] facenet-pytorch           0.3.1                    pypi_0    pypi\r\n[conda] mkl                       2019.4                      243  \r\n[conda] mkl-service               2.3.0            py36he904b0f_0  \r\n[conda] mkl_fft                   1.0.14           py36ha843d7b_0  \r\n[conda] mkl_random                1.1.0            py36hd6b4f25_0  \r\n[conda] pytorch                   1.3.0           py3.6_cuda10.0.130_cudnn7.6.3_0    pytorch\r\n[conda] torchvision               0.4.1                py36_cu100    pytorch\r\n']"
536,1301,0,"Test failure when running pytorch without cuDNN. ['\r\n# compile pytorch without cudnn\r\n$ python test_nn.py TestNN.test_variable_sequence_cuda\r\n/data/users/alerer/pytorch/pytorch/torch/backends/cudnn/__init__.py:40: UserWarning: PyTorch was compiled without cuDNN support. To use cuDNN, rebuild PyTorch making sure the library is visible to the build system.\r\n======================================================================\r\nFAIL: test_variable_sequence_cuda (__main__.TestNN)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File ""test_nn.py"", line 1501, in test_variable_sequence_cuda\r\n    self._test_variable_sequence(True)\r\n  File ""test_nn.py"", line 1492, in _test_variable_sequence\r\n    self.assertEqual(x_leaf.grad.data, grad_x)\r\n  File ""/data/users/alerer/pytorch/pytorch/test/common.py"", line 158, in assertEqual\r\n    assertTensorsEqual(x, y)\r\n  File ""/data/users/alerer/pytorch/pytorch/test/common.py"", line 150, in assertTensorsEqual\r\n    self.assertLessEqual(max_err, prec, message)\r\nAssertionError: 0.2056929971275647 not less than or equal to 1e-05 :\r\n']"
520,8522,0,"[JIT] Unsupported op descriptor scatter. Don't support scatter in dispatch. Example failure:



Affected tests:
- 
- 
- 
- 
- 
- 
. ['\r\n======================================================================\r\nERROR: test_scatter_dim0 (__main__.TestAutogradGenerated)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File ""test/test_autograd.py"", line 3665, in do_test\r\n    check(name)\r\n  File ""test/test_autograd.py"", line 3587, in check\r\n    check_against_reference(self, create_traced_fn(fn), fn, (self_variable,) + args_variable)\r\n  File ""test/test_autograd.py"", line 3498, in check_against_reference\r\n    outputs_test = func(*nograd_inputs)\r\n  File ""test/test_autograd.py"", line 3446, in traced_fn\r\n    return traced(*inputs_tensors)\r\nRuntimeError: Unsupported op descriptor: scatter-3-dim_i. File a bug report.\r\n']"
353,12609,0,"Request for stripped down / inference only pytorch wheels. ## üöÄ Feature
Creating a precompiled pytorch wheel file that is trimmed down, inference only version.

## Motivation

Right now pytorch wheels are on average ~400MB zipped -> 1.+ GB unzipped, which is not a big deal for training & prototyping as generally the wheels are only installed once - but that's not the case for productionizing using service providers like sagemaker / algorithmia / etc.

## Pitch

If we can create a trimmed down, potentially inference only capable wheel file - we can directly improve the load time performance of these algorithms in serverless algorithm delivery environments, which could directly pytorch's ability to compete in the HPC serverless marketplace.

## Alternatives

We could also provide a clear way for users to create their own wheels, by simplifying and documenting the build process somewhat to enable optional features during the compilation process. 

## Additional context

Full disclosure, I'm an employee at Algorithmia and this change would make my life much easier :smile: 


cc @malfet @seemethere @walterddr. []"
650,17029,0,"Floating Point Exception on PyTorch nightlies. ## üêõ Bug
We are seeing a floating point exception in the nightly containers but not in v1.0.1 container. I believe there is a mkl-dnn patch that needs to be on master?

@soumith . []"
67,19827,1,"Random GPU Operations Hang. ## üêõ Bug

I'm having an issue where certain GPU operations hang. It doesn't appear to be a multi-GPU problem, I can reproduce it on a single GPU. It doesn't seem to reliably effect the same operations but if I change around their order or cache certain results on the GPU to minimize copies it could cause the hang to move to another command. 

## To Reproduce

For my current code I can reproduce the problem fairly reliably with the following command:



e.g. indexing the tensor  which is stored on GPU. I should point out that I was seeing this on other commands, usually copying something onto the GPU, but as I mentioned after changing how i was using the GPU by caching certain results to limit copies and reordering things, it is happening on this line. 

Here is the time taken by this command for several different images:



Here's what the above numbers mean. The first  is telling me which line is printing, so it can be ignored. The next number is how long it took to execute the offending line in seconds. The images are all of comparable size. Newline separates each image.

So you can see the first image executes both lines without problem. The next one, only the first line is slow and it takes over 30s to execute. This trend continues for the rest of the images.


## Environment



## Additional context

My first thought was that this is something to do with garbage collection on the GPU, or something to do with the multi GPU IOMMU problem other people have had, but I'm not so sure anymore, especially since I can reproduce on a single GPU.
. ['\r\nhorizontal_block_difference = ((im[:, :, :, block_horizontal_positions] - im[:, :, :, block_horizontal_positions + 1])**2).sum(3).sum(2).sum(1)\r\nvertical_block_difference = ((im[:, :, block_vertical_positions, :] - im[:, :, block_vertical_positions + 1, :])**2).sum(3).sum(2).sum(1)\r\n', '\r\n0 0.0010721683502197266\r\n0 0.0008690357208251953\r\n\r\n0 37.040807008743286\r\n0 0.0005404949188232422\r\n\r\n0 37.13724493980408\r\n0 0.0004165172576904297\r\n\r\n0 27.397161722183228\r\n0 0.0003788471221923828\r\n\r\n0 37.17257356643677\r\n0 0.00034737586975097656\r\n\r\n0 37.201823234558105\r\n0 0.0002465248107910156\r\n', '\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No             \r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Red Hat Enterprise Linux Server release 7.6 (Maipo)\r\nGCC version: (GCC) 6.3.0\r\nCMake version: version 2.8.12.2\r\n\r\nPython version: 3.5\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration:\r\nGPU 0: Quadro P6000\r\nGPU 1: Quadro P6000\r\nGPU 2: Quadro P6000\r\nGPU 3: Quadro P6000\r\n\r\nNvidia driver version: 410.93\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.16.3\r\n[pip3] torch==1.0.1.post2\r\n[pip3] torchjpeg==0.0.0\r\n[pip3] torchvision==0.2.2.post3\r\n[conda] Could not collect\r\n\r\n']"
628,20697,0,"Indexing by 1-dimension `int64` tensor returns incorrect shape. ## üêõ Bug

Sometimes indexing by a 1-dimension  tensor with a single element returns a tensor with reduced rank.

## To Reproduce

Steps to reproduce the behavior:

<img width=""498"" alt=""Screenshot 2019-05-19 21 41 52"" src=""https://user-images.githubusercontent.com/630490/57996908-ec462a00-7a7e-11e9-8ba2-1a7bf5f71bca.png"">

This bug gets even better:

<img width=""228"" alt=""Screenshot 2019-05-19 21 44 09"" src=""https://user-images.githubusercontent.com/630490/57996986-4515c280-7a7f-11e9-962d-75f60589a4a2.png"">




## Environment

Collecting environment information...
PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0
CMake version: version 3.10.2

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration:
GPU 0: Quadro GP100
GPU 1: Quadro GP100

Nvidia driver version: 410.79
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.16.2
[pip] torch==1.1.0
[pip] torchvision==0.2.2
[conda] mkl                       2019.3                      199
[conda] pytorch                   1.1.0           py3.7_cuda10.0.130_cudnn7.5.1_0    pytorch
[conda] pytorch-nightly           1.1.0.dev20190411 py3.7_cuda10.0.130_cudnn7.4.2_0    pytorch
[conda] torchvision               0.2.2                      py_3    pytorch. [""python\r\nobs.dtype\r\nOut[28]: dtype('float32')\r\nobs.shape\r\nOut[29]: (54, 1, 64, 64)\r\na.shape\r\nOut[30]: torch.Size([2])\r\nobs.shape\r\nOut[31]: (54, 1, 64, 64)\r\nb = torch.tensor([3])\r\nobs[b].shape\r\nOut[33]: (1, 64, 64)\r\na = torch.tensor([3, 3])\r\nobs[a].shape\r\nOut[35]: (2, 1, 64, 64)\r\n""]"
490,7428,0,"libtorch test_jit hangs if an error occurs. Steps to reproduce:
1. Build this commit https://github.com/pytorch/pytorch/pull/7275/commits/8d10a9245e364920e7fdba3af03b3a14ff41f126 with CUDA in pytorch-linux-xenial-cuda9-cudnn7-py3-test (alternately, ezyang/test_jit_hangtest_jitcpp-build/libtorch/bin/test_jit`

Expected result: it terminates

Actual result: it hang:



when I ctrl-c it finally comes back:



CC @lantiga @goldsborough . ['\r\njenkins@033788db9077:~/workspace$ ../cpp-build/libtorch/bin/test_jit \r\n\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ntest_jit is a Catch v2.2.1 host application.\r\nRun with -? for options\r\n\r\n-------------------------------------------------------------------------------\r\njit test CUDA\r\n  graph executor\r\n-------------------------------------------------------------------------------\r\n/var/lib/jenkins/workspace/torch/csrc/jit/test_jit.cpp:914\r\n...............................................................................\r\n\r\n/var/lib/jenkins/workspace/torch/csrc/jit/test_jit.cpp:914: FAILED:\r\ndue to unexpected exception with message:\r\n  cannot initialize CUDA without ATen_cuda library (initCUDA at /var/lib/\r\n  jenkins/workspace/aten/src/ATen/detail/CUDAHooksInterface.h:42)\r\n  frame #0: at::Context::lazyInitCUDA()::{lambda()#1}::operator()() const +\r\n  0x32 (0x63ef90 in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #1: void std::_Bind_simple<at::Context::lazyInitCUDA()::{lambda()#1} ()\r\n  >::_M_invoke<>(std::_Index_tuple<>) + 0x28 (0x690b38 in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #2: std::_Bind_simple<at::Context::lazyInitCUDA()::{lambda()#1} ()>::\r\n  operator()() + 0x2c (0x6808aa in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #3: void std::__once_call_impl<std::_Bind_simple<at::Context::\r\n  lazyInitCUDA()::{lambda()#1} ()> >() + 0x17 (0x66bfbc in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #4: <unknown function> + 0xea99 (0x7fd2b2e22a99 in /lib/x86_64-linux-\r\n  gnu/libpthread.so.0)\r\n  frame #5: ../cpp-build/libtorch/bin/test_jit() [0x5e9e9d]\r\n  frame #6: void std::call_once<at::Context::lazyInitCUDA()::{lambda()#1}>(std:\r\n  :once_flag&, at::Context::lazyInitCUDA()::{lambda()#1}&&) + 0x7f (0x657c67 in\r\n  ../cpp-build/libtorch/bin/test_jit)\r\n  frame #7: at::Context::lazyInitCUDA() + 0x3d (0x63f071 in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #8: at::Context::initCUDAIfNeeded(at::Backend) + 0x21 (0x63f0bb in ../\r\n  cpp-build/libtorch/bin/test_jit)\r\n  frame #9: at::Context::getTypeOpt(at::Backend, at::ScalarType) + 0x23\r\n  (0x63ed79 in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #10: at::Context::getType(at::Backend, at::ScalarType) + 0x4a (0x63ee58\r\n  in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #11: ../cpp-build/libtorch/bin/test_jit() [0x60ebb6]\r\n  frame #12: ../cpp-build/libtorch/bin/test_jit() [0x60ebee]\r\n  frame #13: torch::jit::testGraphExecutor() + 0x79 (0x621eeb in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #14: ../cpp-build/libtorch/bin/test_jit() [0x6251a7]\r\n  frame #15: Catch::TestInvokerAsFunction::invoke() const + 0x16 (0x5fe09c in .\r\n  ./cpp-build/libtorch/bin/test_jit)\r\n  frame #16: Catch::TestCase::invoke() const + 0x29 (0x5fd755 in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #17: Catch::RunContext::invokeActiveTestCase() + 0x38 (0x5f7f1c in ../\r\n  cpp-build/libtorch/bin/test_jit)\r\n  frame #18: Catch::RunContext::runCurrentTest(std::__cxx11::basic_string<char,\r\n  std::char_traits<char>, std::allocator<char> >&, std::__cxx11::basic_string\r\n  <char, std::char_traits<char>, std::allocator<char> >&) + 0x2ce (0x5f7c30 in\r\n  ../cpp-build/libtorch/bin/test_jit)\r\n  frame #19: Catch::RunContext::runTest(Catch::TestCase const&) + 0x240\r\n  (0x5f67ba in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #20: ../cpp-build/libtorch/bin/test_jit() [0x5f9574]\r\n  frame #21: Catch::Session::runInternal() + 0x13d (0x5fa931 in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #22: Catch::Session::run() + 0x57 (0x5fa6b5 in ../cpp-build/libtorch/\r\n  bin/test_jit)\r\n  frame #23: Catch::Session::run(int, char**) + 0x53 (0x5fa655 in ../cpp-build/\r\n  libtorch/bin/test_jit)\r\n  frame #24: main + 0x55 (0x60ea6b in ../cpp-build/libtorch/bin/test_jit)\r\n  frame #25: __libc_start_main + 0xf0 (0x7fd2b0947830 in /lib/x86_64-linux-gnu/\r\n  libc.so.6)\r\n  frame #26: _start + 0x29 (0x5e9d89 in ../cpp-build/libtorch/bin/test_jit)\r\n\r\n\r\n', '\r\n\r\n^C-------------------------------------------------------------------------------\r\njit test CUDA\r\n  fusion\r\n-------------------------------------------------------------------------------\r\n/var/lib/jenkins/workspace/torch/csrc/jit/test_jit.cpp:916\r\n...............................................................................\r\n\r\n/var/lib/jenkins/workspace/torch/csrc/jit/test_jit.cpp:916: FAILED:\r\ndue to a fatal error condition:\r\n  SIGINT - Terminal interrupt signal\r\n\r\n===============================================================================\r\ntest cases:   2 |   1 passed | 1 failed\r\nassertions: 137 | 135 passed | 2 failed\r\n\r\n']"
37,29429,1,"NLLLoss reduce=True returning nan in float16. ## üêõ Bug
**Version**
torch 1.3.1
torchvision 0.4.1

**Notes**
NLLLoss reduce=True doesn't seem to work in float16.
Also, training a model with loss1 in float16 doesn't seem to decrease the loss. (The model trains fine with loss1 in float32)
Possible related to #14878

**Code to reproduce**




. [""\r\n#Input\r\ninput = torch.rand(32,11,256,256).cuda().half()\r\ntarget =torch.LongTensor(32,256,256).random_(0, 10).cuda()\r\nloss1 = nn.NLLLoss(reduce=False).cuda().half()\r\nloss2 = nn.NLLLoss(reduce=True, reduction='mean').cuda().half()\r\nprint(torch.mean(loss1(input,target)) )\r\nprint(loss2(input,target))\r\n"", ""\r\n#Output\r\ntensor(-0.4995, device='cuda:0', dtype=torch.float16)\r\ntensor(nan, device='cuda:0', dtype=torch.float16)\r\n""]"
590,10617,0,"Command ""python setup.py egg_info"" failed with error code 1. Trying to install pytorch on my pyenv python 2.7



Installed other libraries like numpy and pandas which worked fine.
pip list gives:

I am on macOS 10.13.5.. ['\r\npip install torch\r\nCollecting torch\r\n  Using cached https://files.pythonhosted.org/packages/5f/e9/bac4204fe9cb1a002ec6140b47f51affda1655379fe302a1caef421f9846/torch-0.1.2.post1.tar.gz\r\n    Complete output from command python setup.py egg_info:\r\n    Traceback (most recent call last):\r\n      File ""<string>"", line 1, in <module>\r\n      File ""/private/var/folders/32/4_yd4dkj6xj469sw24cmj8_w0000gn/T/pip-install-yfJzlA/torch/setup.py"", line 11, in <module>\r\n        raise RuntimeError(README)\r\n    RuntimeError: PyTorch does not currently provide packages for PyPI (see status at https://github.com/pytorch/pytorch/issues/566).\r\n\r\n    Please follow the instructions at http://pytorch.org/ to install with miniconda instead.\r\n\r\n\r\n    ----------------------------------------\r\nCommand ""python setup.py egg_info"" failed with error code 1 in /private/var/folders/32/4_yd4dkj6xj469sw24cmj8_w0000gn/T/pip-install-yfJzlA/torch/\r\n', '\r\nPackage         Version\r\n--------------- -------\r\ndill            0.2.8.2\r\nez-setup        0.9\r\nnumpy           1.15.0\r\npandas          0.23.4\r\npip             18.0\r\npython-dateutil 2.7.3\r\npytz            2018.5\r\nsetuptools      40.0.0\r\nsix             1.11.0\r\nwheel           0.31.1\r\n']"
167,16646,0,"loss.backward() cause malloc: *** error for object 0x7fb849370210: incorrect checksum for freed object. I build a net: resnet18 + ctc loss, when run loss.backward(), there will be a error:python(17267,0x700007df0000) malloc: *** error for object 0x7fb849370210: incorrect checksum for freed object
i not find any method to resolve it?

note: my training date size is not equal, this mean :the widht of image is variable, and the height of imgage is 32,    the label length is variable

========= my net.py is ===================
# coding=utf-8
import torch
import torch.nn as nn
import torch.nn.functional as F


# Áõ¥Êé•ÂÆö‰πâÂèåÂ±ÇLSTM
class BiLSTM(nn.Module):
    def __init__(self, num_in, num_hidden, num_out):
        super(BiLSTM, self).__init__()
        self.LSTM = nn.LSTM(input_size=num_in, hidden_size=num_hidden, num_layers=2,
                            bidirectional=True, batch_first=False)
        self.embeding = nn.Linear(num_hidden * 2, num_out)

    def forward(self, input):
        n, c, h, w = input.size()
        input = input.permute(0, 3, 2, 1)
        input = input.reshape(n, w, h*c)
        input = input.permute(1, 0, 2)
        recurrent, _ = self.LSTM(input)

        out_put = self.embeding(recurrent)
        return out_put


class ResidualBlock(nn.Module):
    def __init__(self, inchannel, outchannel, stride=(1, 1)):
        super(ResidualBlock, self).__init__()
        self.left = nn.Sequential(
            nn.Conv2d(inchannel, outchannel, kernel_size=3, stride=stride, padding=1, bias=False),
            nn.BatchNorm2d(outchannel),
            nn.ReLU(inplace=True),
            nn.Conv2d(outchannel, outchannel, kernel_size=3, stride=1, padding=1, bias=False),
            nn.BatchNorm2d(outchannel)
        )
        self.shortcut = nn.Sequential()
        if stride != (1, 1) or inchannel != outchannel:
            self.shortcut = nn.Sequential(
                nn.Conv2d(inchannel, outchannel, kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm2d(outchannel)
            )

    def forward(self, x):
        out = self.left(x)
        out += self.shortcut(x)
        out = F.relu(out)
        return out


class ResNet(nn.Module):
    def __init__(self, ResidualBlock, num_classes=10, test=False):
        super(ResNet, self).__init__()
        self.inchannel = 64
        self.conv1 = nn.Sequential(
            nn.Conv2d(3, 64, kernel_size=3, stride=1, padding=1, bias=False),
            nn.BatchNorm2d(64),
            nn.ReLU()
        )
        self.layer1 = self.make_layer(ResidualBlock, 64, 2, stride=(1, 1))
        self.layer2 = self.make_layer(ResidualBlock, 128, 2, stride=(2, 2))
        self.layer3 = self.make_layer(ResidualBlock, 256, 2, stride=(2, 2))
        self.layer4 = self.make_layer(ResidualBlock, 512, 2, stride=(2, 1))

        # self.rnn = nn.Sequential(
        #     BidirectionalLSTM(512, 512, 512),
        #     BidirectionalLSTM(512, 512, num_classes),)
        self.rnn = BiLSTM(512, 512, num_classes)
        # self.fc = nn.Linear(512, num_classes)
        self.test = test

    def make_layer(self, block, channels, num_blocks, stride):
        strides = [stride] + [(1, 1)]*(num_blocks - 1)
        layers = []
        for stride in strides:
            layers.append(block(self.inchannel, channels, stride))
            self.inchannel = channels
        return nn.Sequential(*layers)

    def forward(self, x):
        out = self.conv1(x)
        out = self.layer1(out)
        out = self.layer2(out)
        out = self.layer3(out)
        out = self.layer4(out)
        out = F.avg_pool2d(out, (4, 1))

        if self.test:
            return out

        # out = out.view(out.size(0), -1)
        # out = self.fc(out)
        out = self.rnn(out)
        return out


def resnet18():
    return ResNet(ResidualBlock)



========== my train code is ==========
    def train_batch(self, epoch):
        self.model.train()
        for batch_idx, (img, label, width, lens) in enumerate(self.train_loader):
            self.optimizer.zero_grad()
            preds = self.model(img)
            log_probs = preds.log_softmax(2).detach().requires_grad_()
            loss = self.criterion(log_probs, label, width, lens)
            print(loss)
            loss.backward()
            self.optimizer.step()  # Êõ¥Êñ∞ÂèÇÊï∞
            if (batch_idx+1) % self.log_interval == 0:
                lr = self.scheduler.get_lr()[0]
                src_str = self.label_convert.get_str_from_label(lables=label)
                preds_size = torch.IntTensor([preds.size(0)] * preds.size(1))
                _, preds = preds.max(2)
                preds = preds.squeeze(2)
                preds = preds.transpose(1, 0)
                sim_preds = self.label_convert.decode(preds, preds_size, raw=False)
                n_correct = 0
                for pred, target in zip(sim_preds, src_str):
                    if pred == target:
                        n_correct += 1
                distance_value = util.edit_distance(src_str, sim_preds)
                localtime = datetime.datetime.now().strftime(""%Y-%m-%d %H:%M:%S"")
                print('[%s]\tTrain Epoch: {%d/%d}\tLoss:%.6f, acc: %.2f, error: %.2f, lr = %.4f'
                      % (str(localtime), epoch, batch_idx, loss, n_correct, distance_value, lr))
            if (batch_idx+1) % self.save_interval == 0:
                new_save_name = 'resnet18_%d_%d.pth' % (epoch, batch_idx+1)
                torch.save(self.state, new_save_name)
                util.update_file(self.save_path, new_save_name)
        new_save_name = 'resnet18_%d.pth' % epoch
        torch.save(self.state, new_save_name)
        util.update_file(self.save_path, new_save_name)
. []"
18,29809,1,"Memory leak with Conv1d on CPU. ## üêõ Bug

When training (on CPU) a simple one-layer CNN (with variable-width batches, as it is standard in text classification), the memory usage increases significantly at each  call, and quickly causes an out of memory.

## To Reproduce



When running , I get this OOM error after 30 iterations:


The [memory profiler output](https://github.com/pytorch/pytorch/files/3846948/memory_profiler_output.txt) clearly shows a steady memory increase (and never decrease) at each  call, of **190Mb per call** on average.


## Expected behavior

I would expect the memory usage to increase slightly at the first step, but then stabilize - not increase linearly.

## Environment

PyTorch version: 1.3.1+cpu
Is debug build: No
CUDA used to build PyTorch: None

OS: Ubuntu 18.04.3 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: Could not collect

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.17.4
[pip3] torch==1.3.1+cpu
[conda] Could not collect


## Additional context

Here all the things I tested, following advice in the multiples related issues I found (https://github.com/pytorch/vision/issues/984, https://github.com/pytorch/pytorch/issues/5285 and others):

1. Check that there are no references to a model output kept accross iterations (e.g. loss)

2. Remove anything possible to narrow down the issue (data loader, tqdm, backward, optimization, ...). This is why I only kept the forward pass with dummy data.

3. Use  :
 
Same exact issue happens.

4. With random but fixed-size tensors (replacing  with ), the issue disappears.
However, I am doing CNN on text, so unfortunately, I need batches to have variable width...

5. It I remove the  line, the issue disappears as well, so it is not a problem with the data generation itelf.

6. I tried the following Pytorch versions and had the exact same issue with all of them:
*  from pip ()
*  from pip ()
*  from conda ()

cc @ezyang @gchanan @zou3519 @jerryzh168. ['\r\nimport random\r\nimport torch\r\nfrom torch import nn\r\nfrom memory_profiler import profile\r\n\r\nclass DummyModel(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.embed = nn.Embedding(500000, 100)\r\n        self.conv = nn.Conv1d(100, 200, 3)\r\n\r\n    def forward(self, x):\r\n        x = self.embed(x)\r\n        x = torch.transpose(x, 1, 2)\r\n        x = self.conv(x)\r\n        return torch.mean(x)\r\n\r\n\r\nmodel = DummyModel()\r\n\r\n@profile\r\ndef run():\r\n    x = torch.randint(0, 500000, (300, random.randint(100, 3000)))\r\n    model(x)\r\n\r\nfor i in range(20):\r\n    run()\r\n', ""\r\nRuntimeError: [enforce fail at CPUAllocator.cpp:64] . DefaultCPUAllocator: can't allocate memory: you tried to allocate 633120000 bytes. Error code 12 (Cannot allocate memory)\r\n""]"
657,17489,0,"Windows CPU debug build fails at linking stage. ## üêõ Bug
Hi, 
I can't build Windows Debug CPU version, the build fails during linking. 
I am using the latest source code. At the end of post there are exact commands I execute.
I am really after Libtorch build, I do not care about Python, but because I do not understand the whole thing, I feel obliged to build all.

Thank you,
Slawek

1. First of all an observation, CMakeLists.txt contains this:
set (CMAKE_CXX_FLAGS_DEBUG ""${CMAKE_CXX_FLAGS_DEBUG} -fno-omit-frame-pointer -O0"")
set (CMAKE_LINKER_FLAGS_DEBUG ""${CMAKE_STATIC_LINKER_FLAGS_DEBUG} -fno-omit-frame-pointer -O0"")
which causes endless warnings of unknown options.

Compilation appears successful  (2000 files or so) but then failures happen during linking
2.  

3. And then, another failure

Now, I downloaded and copied python37_d.lib into C:\local\Anaconda3\envs\PytorchDebug\libs and python37_d.dll into C:\local\Anaconda3\envs\PytorchDebug, but it does not help.


## Environment
 - PyTorch Version: 1, latest code
 - OS: Windows 10
 - Build commands:
call c:\local\Anaconda3\scripts\activate PytorchDebug
rem Done before: conda install numpy pyyaml mkl mkl-include setuptools cmake cffi typing
rem Done before, in f:\progs2\PytorchDebug: git clone --recursive https://github.com/pytorch/pytorch
F:
cd progs2\PytorchDebug\pytorch
set ""VS150COMNTOOLS=C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build""
set CMAKE_GENERATOR=Visual Studio 15 2017 Win64
set DISTUTILS_USE_SDK=1
set NO_CUDA=1
set DEBUG=1
call ""%VS150COMNTOOLS%\vcvarsall.bat"" x64 -vcvars_ver=14.11
python setup.py install

 - Python version: 3.7
. ['Creating library lib\\test_api.lib and object lib\\test_api.exp\r\ndataloader.cpp.obj : error LNK2019: unresolved external symbol ""__declspec(dllimport) public: void __cdecl torch::data::samplers::DistributedSampler<class std::vector<unsigned __int64,class std::allocator<unsigned __int64> > >::set_epoch(unsigned __int64)"" (__imp_?set_epoch@?$DistributedSampler@V?$vector@_KV?$allocator@_K@std@@@std@@@samplers@data@torch@@QEAAX_K@Z) referenced in function ""private: virtual void __cdecl DataTest_CanSaveAndLoadDistributedRandomSampler_Test::TestBody(void)"" (?TestBody@DataTest_CanSaveAndLoadDistributedRandomSampler_Test@@EEAAXXZ)\r\ndataloader.cpp.obj : error LNK2019: unresolved external symbol ""__declspec(dllimport) public: unsigned __int64 __cdecl torch::data::samplers::DistributedSampler<class std::vector<unsigned __int64,class std::allocator<unsigned __int64> > >::epoch(void)const "" (__imp_?epoch@?$DistributedSampler@V?$vector@_KV?$allocator@_K@std@@@std@@@samplers@data@torch@@QEBA_KXZ) referenced in function ""private: virtual void __cdecl DataTest_CanSaveAndLoadDistributedRandomSampler_Test::TestBody(void)"" (?TestBody@DataTest_CanSaveAndLoadDistributedRandomSampler_Test@@EEAAXXZ)\r\nbin\\test_api.exe : fatal error LNK1120: 2 unresolved externals\r\n[2/3] Linking CXX shared library bin\\torch_python.dll\r\nFAILED: bin/torch_python.dll lib/torch_python.lib\r\n', 'LINK: command ""C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\HostX64\\x64\\link.exe /nologo caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\DataLoader.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Device.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Dtype.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\DynamicTypes.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Exceptions.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\TypeInfo.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Generator.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Layout.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Module.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\PtrWrapper.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Size.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\Storage.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\api\\src\\python\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\functions\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\generated\\python_functions.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\generated\\python_nn_functions.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\generated\\python_torch_functions.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\generated\\python_variable_methods.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_anomaly_mode.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_cpp_function.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_engine.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_function.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_hook.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_legacy_variable.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_variable.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\autograd\\python_variable_indexing.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\byte_order.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\batched\\BatchTensor.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\passes\\onnx.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\passes\\onnx\\fixup_onnx_loop.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\passes\\onnx\\prepare_division_for_onnx.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\passes\\onnx\\peephole.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\passes\\to_batch.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\python_arg_flatten.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\python_interpreter.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\python_ir.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\python_tracer.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\script\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\script\\lexer.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\script\\module.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\jit\\script\\python_tree_views.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\multiprocessing\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\nn\\THNN.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\onnx\\init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\serialization.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\tensor\\python_tensor.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\cuda_lazy_init.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\invalid_arguments.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\object_ptr.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\python_arg_parser.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_apply.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_dtypes.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_flatten.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_layouts.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_list.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_new.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_numpy.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tensor_types.cpp.obj caffe2\\torch\\CMakeFiles\\torch_python.dir\\csrc\\utils\\tuple_parser.cpp.obj /out:bin\\torch_python.dll /implib:lib\\torch_python.lib /pdb:bin\\torch_python.pdb /dll /version:0.0 /debug /INCREMENTAL:NO /NODEFAULTLIB:LIBCMT.LIB /DEBUG:FULL lib\\torch.lib lib\\shm.lib C:\\local\\Anaconda3\\envs\\PytorchDebug\\libs\\python37.lib lib\\onnx.lib lib\\onnx_proto.lib -WHOLEARCHIVE:F:/progs2/pytorchDebug/pytorch/build/lib/onnx.lib lib\\caffe2.lib lib\\libprotobufd.lib C:\\Program Files (x86)\\IntelSWTools\\compilers_and_libraries\\windows\\mkl\\lib\\intel64_win\\mkl_intel_lp64.lib C:\\Program Files (x86)\\IntelSWTools\\compilers_and_libraries\\windows\\mkl\\lib\\intel64_win\\mkl_intel_thread.lib C:\\Program Files (x86)\\IntelSWTools\\compilers_and_libraries\\windows\\mkl\\lib\\intel64_win\\mkl_core.lib C:\\Program Files (x86)\\IntelSWTools\\compilers_and_libraries\\windows\\compiler\\lib\\intel64_win\\libiomp5md.lib lib\\c10.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:bin\\torch_python.dll.manifest"" failed (exit code 1104) with the following output:\r\nLINK : fatal error LNK1104: cannot open file \'python37_d.lib\'\r\nninja: build stopped: subcommand failed.\r\nTraceback (most recent call last):\r\n  File ""setup.py"", line 709, in <module>\r\n    build_deps()\r\n  File ""setup.py"", line 281, in build_deps\r\n    build_dir=\'build\')\r\n  File ""F:\\progs2\\pytorchDebug\\pytorch\\tools\\build_pytorch_libs.py"", line 243, in build_caffe2\r\n    cwd=build_dir, env=my_env)\r\n  File ""c:\\local\\Anaconda3\\envs\\PytorchDebug\\lib\\subprocess.py"", line 347, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command \'[\'cmake\', \'--build\', \'.\', \'--target\', \'install\', \'--config\', \'Debug\', \'--\', \'-j\', \'11\']\' returned non-zero exit status 1.\r\n']"
326,28515,0,"Get rid of libc10.so. I finally have a good reason to merge libc10.so into libtorch.so (and corresponding libc10_cuda.so into libtorch_cuda.so, etc.): I am trying to devirtualize access to AutogradMeta, but because TensorImpl lives in c10 and AutogradMeta lives in torch, I cannot do this as the destructor would have to cross a dynamic library boundary. By absorbing c10 into torch I will be able to do this.

Some dangers: putting c10 into libtorch might push Windows build over max library size. See https://github.com/pytorch/pytorch/issues/27215

Other alternatives I thought of:
* Move TensorImpl back to ATen/core
* Keep the virtual interface to AutogradMeta

Some alternatives that don't work
* Move AutogradMeta into c10. AutogradMeta must be declared after Tensor as it contains a field Tensor, and we cannot replace that field with an  as the public API of tensor  returns a mutable  reference. (Though, it might be possible to fix this up by just moving TensorImpl out of c10)

cc @ezyang @gchanan @zou3519 @jerryzh168 @dzhulgakov @smessmer . []"
491,923,0,"Build broken on Mac OS X. Building form source for Mac OS X fails. Turns out there is a missing dependency between THPP and THCS, adding this dependency to CMakeLists.txt was sufficient for a successful build.. []"
534,12562,0,"Declarations.yaml cleanup. Based on notes from @ezyang, @zdevito and @gchanan.

We'd like Declarations.yaml to be the single, externally visible API that all consumers, both internal and external, go through. Up until now, it has been designed under the assumption that only internal consumers make use of it, and that we can refactor these consumers when we wish to change Declarations.yaml. However, we have quickly gotten into a state where even our internal consumers are unmaintainable. This issue tracks a list of changes we'd like to apply to Declarations.yaml.

Meta-principle: the metadata for a type primarily consists of the type string (e.g., ). However, there may be some other metadata.

- [x] Stop hard-coding the list of arguments that  expands into. Instead, the list of kwargs a TensorOptions expands into should be specified only once and used everywhere.
- [ ] De-C++-ify our type syntax. This means no more putting  in an input type (so basically, drop  and use  only). Our type system should be C++/Python-agnostic. To determine if something has a reference or not, should be determined if the parameter in question is an input or output parameter, which should be part of the type string.
- [x] Add optional to the type syntax. @wanchaol is working on this
- [ ] Replace  with a simple list of  and/or .
- [x] Eliminate  entirely; once optional is supported, any arguments which have ""complex"" default values can simply specify the argument as optional, and then let the kernel compute the default argument itself
- [x] Unify  and . We think we have two only because TH and native had different paths, accidentally.
- [x] Augment type strings with alias sets, perhaps with exclamation marks. This could be used to remove  annotations. This will be handled by the JIT team.
- [x] Eliminate . @gchanan is working on this
- [ ] Eliminate . These would be replaced as outputs of ""inner"" native functions, which are the actual differentiable functions. Blocked on adding named outputs.
- [x] Add named outputs, ala . This helps the clarity of defining derivatives for multi-return functions.
- [ ] Eliminate , since we have eliminated most broadcasting from Type
- [ ] Eliminate 
- [ ] Eliminate , instead inferring it from the name of a function. Put this inference function in one place and make everyone use it.
- [ ] Eliminate , no one actually needs it anymore. []"
259,14726,0,"[caffe2] Corresponding C++ API for prepare_prediction_net. ## üöÄ Feature
Corresponding C++ API for prepare_prediction_net

## Motivation

We have a python API that is able to load predictor models in MetaNetDef format. https://github.com/pytorch/pytorch/blob/edb88b5f3af03718b443d015f195faa1832ce95b/caffe2/python/predictor/predictor_exporter.py#L127 However, the corresponding C++ API is missing.

## Pitch

In the Python world, we are able to export and load models in MetaNetDef format, however, when we want to productionize the model and load it in C++, the API to do so is missing.

## Alternatives

Right now, the only alternative is to export the init and predict nets seperately as protobufs and load them in C++.. []"
392,21119,0,"One libtorch FindTorch.cmake module to support multi-configs(both debug and release). ## üêõ Bug

Libtorch is excellent to provide cmake for multiple configs on windows. 

  * Download here (Release version): 
    https://download.pytorch.org/libtorch/cu90/libtorch-win-shared-with-deps-latest.zip
  * Download here (Debug version): 
    https://download.pytorch.org/libtorch/cu90/libtorch-win-shared-with-deps-debug-latest.zip

However, it is quite inconvenient. Usually, I need to copy different versions to switch between different configurations, which is annoying during development. Can we support both configs inside **one FindTorch.cmake**?

. []"
156,29246,0,"Replacing convolutional blocks causes exporting to Onnx to fail. ## üêõ Bug

We are trying to export a model created in PyTorch to Onnx. The model is created with function:

and then, one convolutional block of that model is swapped with a different kind of block, like so:

When we try to export this updated model, like so:

an error occurs -  for some reason, PyTorch fails to export the model, that otherwise is fully functional.

If the blocks are not swapped, the network is exported successfully.

## To Reproduce

You can get the code from a temporary repository I've created for this issue:


Run  file, you will get the following error:




## Expected behavior

We expect to have our model exported, even if it has its convolutional blocks swapped with another type of block. Ideally, we would want to swap all the blocks of the model, not just the first one, as in the example given.

## Environment

 - PyTorch Version: 1.2.0
 - OS: Ubuntu 19.04
 - How you installed PyTorch: pip3
 - Python version: 3.7.3
 - CUDA/cuDNN version: No Cuda
 - GPU models and configuration: No


cc @houseroad @spandantiwari @lara-hdr @BowenBao @neginraoof. ['\r\nmodel = WideResNet(40, 2, Conv, BasicBlock)\r\n', '\r\nmodel = update_block(block_number, model, block_type)\r\n', '\r\ntorch.onnx.export(model, torch_input, save_name)\r\n', '\r\nhttps://github.com/kasparas-ban/Exporting-models-to-Onnx.git\r\n', '\r\nTraceback (most recent call last):\r\n  File ""export_model.py"", line 42, in <module>\r\n    torch.onnx.export(model, torch_input, save_name)   # <- GIVES ERROR\r\n  File ""/home/kasparas/.local/lib/python3.7/site-packages/torch/onnx/__init__.py"", line 132, in export\r\n    strip_doc_string, dynamic_axes)\r\n  File ""/home/kasparas/.local/lib/python3.7/site-packages/torch/onnx/utils.py"", line 64, in export\r\n    example_outputs=example_outputs, strip_doc_string=strip_doc_string, dynamic_axes=dynamic_axes)\r\n  File ""/home/kasparas/.local/lib/python3.7/site-packages/torch/onnx/utils.py"", line 329, in _export\r\n    _retain_param_name, do_constant_folding)\r\n  File ""/home/kasparas/.local/lib/python3.7/site-packages/torch/onnx/utils.py"", line 213, in _model_to_graph\r\n    graph, torch_out = _trace_and_get_graph_from_model(model, args, training)\r\n  File ""/home/kasparas/.local/lib/python3.7/site-packages/torch/onnx/utils.py"", line 174, in _trace_and_get_graph_from_model\r\n    raise RuntimeError(""state_dict changed after running the tracer; ""\r\nRuntimeError: state_dict changed after running the tracer; something weird is happening in your model!\r\n']"
404,17163,0,"Support torch.zeros with HalfTensor (half). 

This might be nontrivial to do because zeros is implemented in terms of vectorized fill on CPU, so you'd have to work out how to make that code work for half.. ['\r\n>>> import torch\r\n>>> torch.zeros(2, dtype=torch.half)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nRuntimeError: _th_zero_ is not implemented for type torch.HalfTensor\r\n']"
660,3491,0,"RuntimeError: CUDA error (3): initialization error . 
I run these codes using pytorch 0.2.0, python 3.5 with error


But using cpu( ) woks fine. ['\r\nimport torch\r\nimport torch.multiprocessing as mp\r\n\r\ndef subprocesses(A, B, D, i, j, size):\r\n    D[(j * size):((j + 1) * size), i] = torch.mul(B[:, i], A[j, i])\r\n\r\ndef task(A, B):\r\n\r\n    size1 = A.shape\r\n    size2 = B.shape\r\n    D = torch.zeros([size1[0]*size2[0], size1[1]]).cuda()\r\n    D.share_memory_()\r\n    \r\n    for i in range(1):\r\n        processes = []\r\n        for j in range(size1[0]):  \r\n            p = mp.Process(target=subprocesses, args=(A, B, D, i, j, size2[0]))\r\n            p.start()\r\n            processes.append(p)\r\n        for p in processes:\r\n            p.join()\r\n\r\n    return D\r\n\r\nA = torch.rand(3, 3).cuda()\r\nB = torch.rand(3, 3).cuda()\r\nC = task(A,B)\r\nprint(C)\r\n', '\r\nProcess Process-1:\r\nTraceback (most recent call last):\r\nProcess Process-2:\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 249, in _bootstrap\r\n    self.run()\r\nTraceback (most recent call last):\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 249, in _bootstrap\r\n    self.run()\r\n  File ""<ipython-input-2-cbb040477c37>"", line 3, in subprocesses\r\n    D[(j * size):((j + 1) * size), i] = torch.mul(B[:, i], A[j, i])\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\nRuntimeError: CUDA error (3): initialization error\r\n  File ""<ipython-input-2-cbb040477c37>"", line 3, in subprocesses\r\n    D[(j * size):((j + 1) * size), i] = torch.mul(B[:, i], A[j, i])\r\nRuntimeError: CUDA error (3): initialization error\r\nProcess Process-3:\r\nTraceback (most recent call last):\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 249, in _bootstrap\r\n    self.run()\r\n  File ""/usr/lib/python3.5/multiprocessing/process.py"", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File ""<ipython-input-2-cbb040477c37>"", line 3, in subprocesses\r\n    D[(j * size):((j + 1) * size), i] = torch.mul(B[:, i], A[j, i])\r\nRuntimeError: CUDA error (3): initialization error\r\n']"
541,24583,0,"Migrate `leaky_relu` and `leaky_relu_` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
691,8554,0,"[pytorch][build] ‚ÄòvmsLog2‚Äô was not declared in this scope. I tried to rebase and rebuild torch from source today, but got an error:


See [full gist](https://gist.github.com/elanmart/8fca075c596378bd785abd8079567684).

For future reference, getting rid of old  install in  and updating  via  seems to have solved the issue.

cc @soumith @cpuhrsch . []"
232,30798,0,"How can I implement ""nn.unFold"" on 5D tensor?. ‚ùì How can I implement ""nn.unFold"" on 5D tensor?

I am implementing an operation on 3D image. I found I need ""nn.unFold"" function in my process. But until now, pytorch does not have official implementation in latest release version. 

I want to implement it in official release code form by myself. But I am a little confused by the relationship  between implementation part of c++ and cuda code. 

Could some one give me some suggestions that which files I should refer to corresponding to implementation of ""nn.unFold"" in 4D version.... []"
499,2870,0,"torch.max has extra dimensions on a slice with size 1. 
The size reported at the end should be (32, 1), but is (32, 1, 1). Using torch==0.2.0.post3 both on CPU and GPU.. ['\r\n>>> x = torch.zeros((32, 10, 10))\r\n>>> y = x[:, 2:4, 3:5]\r\n>>> torch.max(y, dim=1, keepdim=False)[0].size()\r\ntorch.Size([32, 2])   # correct\r\n>>> y = x[:, 2:3, 3:4]\r\n>>> torch.max(y, dim=1, keepdim=False)[0].size()\r\ntorch.Size([32, 1, 1])  # wrong\r\n']"
589,2062,0,"Installation error . I am installing pytorch from source using python 2.7. I am getting the following error:

 File ""/scratch0/Softwares/pytorch_new/torch/lib/ATen/gen.py"", line 6, in <module>
    import preprocess_declarations
  File ""/scratch0/Softwares/pytorch_new/torch/lib/ATen/preprocess_declarations.py"", line 3, in <module>
    from function_wrapper import TYPE_FORMAL_GENERIC
  File ""/scratch0/Softwares/pytorch_new/torch/lib/ATen/function_wrapper.py"", line 2, in <module>
    from code_template import CodeTemplate
  File ""/scratch0/Softwares/pytorch_new/torch/lib/ATen/code_template.py"", line 13, in <module>
    class CodeTemplate(object):
  File ""/scratch0/Softwares/pytorch_new/torch/lib/ATen/code_template.py"", line 15, in CodeTemplate
    '(^[^\n\S]*)?\$([^\d\W]\w*|\{,?[^\d\W]\w*\,?})', re.MULTILINE)
  File ""/scratch0/Softwares/virtualpython/env_new/lib64/python2.7/re.py"", line 190, in compile
    return _compile(pattern, flags)
  File ""/scratch0/Softwares/virtualpython/env_new/lib64/python2.7/re.py"", line 242, in _compile
    raise error, v # invalid expression
sre_constants.error: nothing to repeat

CMake Error at CMakeLists.txt:126 (message):
  Failed to get generated_cpp list


-- Configuring incomplete, errors occurred!



. []"
224,5938,0,"RuntimeError: value cannot be converted to type uint8_t without overflow: 10000. I am trying to run the [this code](https://github.com/yunjey/pytorch-tutorial/blob/4b67434961a64ba5e19e63d44f0b9979d2a9aa11/tutorials/01-basics/feedforward_neural_network/main-gpu.py).

The training progress is perfectÔºåbut the accuracy did not print outÔºåand some error came out like thisÔºö

And the code isÔºö


I have tried it before with python3.5 on win10Ôºåit could ran perfectlyÔºåbut somehow couldn't use the cudaÔºåso i turn to the ubuntuÔºåis it the python version problemÔºü

- OS:ubuntu16.04
- PyTorch version:0.4.0a0+7cbbc0b
- How you installed PyTorch (conda, pip, source):source
- Python version:2.7
- CUDA/cuDNN version:9.0
- GCC version (if compiling from source):gcc (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609

I know that this question shouldn't be asked here cause it is not the pytorch's issus, but i can't access the stackoverflow, it is slow on Chinese internet .So it will be very appericated if someone could help me with this.Thx



. ['\r\nEpoch [5/5], Step [200/600], Loss: 0.0404\r\nEpoch [5/5], Step [300/600], Loss: 0.0511\r\nEpoch [5/5], Step [400/600], Loss: 0.0042\r\nEpoch [5/5], Step [500/600], Loss: 0.0464\r\nEpoch [5/5], Step [600/600], Loss: 0.1073\r\nTraceback (most recent call last):\r\n  File ""fnn.py"", line 84, in <module>\r\n    print(\'Accuracy of the network on the 10000 test images: %d %%\' % (100 * correct / total))\r\nRuntimeError: value cannot be converted to type uint8_t without overflow: 10000\r\n', ""\r\n# Test the Model\r\ncorrect = 0\r\ntotal = 0\r\nfor images, labels in test_loader:\r\n    images = Variable(images.view(-1, 28*28))\r\n    outputs = net(images)\r\n    _, predicted = torch.max(outputs.data, 1)\r\n    total += labels.size(0)\r\n    correct += (predicted == labels).sum()\r\n\r\nprint('Accuracy of the network on the 10000 test images: %d %%' % (100 * correct / total))\r\n\r\n""]"
611,1930,0,"Different behavior of sum() in-place on CPU vs GPU. ['\r\nx = torch.randperm(16).resize_(4,4) # create tensor\r\ny = x.cuda() # copy to GPU\r\n# perform same operation on both:\r\nx.sum(dim=0,out=x)\r\ny.sum(dim=0,out=y)\r\nprint(y) # see expected behavior\r\nprint(x) # see zeros instead\r\n']"
750,9499,0,"Move ConstantPadNd into ATen.  is currently implemented in Python at [torch/nn/_functions/padding.py](https://github.com/pytorch/pytorch/blob/master/torch/nn/_functions/padding.py). We'd like it to be implemented as a native function in ATen. Note that you will need to update  in  after porting.

Reading material:

1. How to add a native function: https://github.com/pytorch/pytorch/tree/master/aten/src/ATen/native/
2. Derivatives are added in 

Tips:
  There is no context object in native functions; instead, if something needs to be reused in , 
  + if it is an input argument or output of , you can use it directly in .
  + otherwise, make it an output of the 
. []"
593,25801,0,"[jit] Missing source highlight error. 



cc @suo. ['\r\n@torch.jit.script\r\ndef fn(x):\r\n    # type: (List[int], int) -> bool\r\n    return max(x)\r\n']"
341,27034,0,"RuntimeError:[enforce fail at context.h:48] option.device_type() ==PROTO_CPU. 1vs0. 
Traceback (most recent call last):
File ""/usr/VMZ-master-1/tools/train_net.py"", line 586, in
main()
File ""/usr/VMZ-master-1/tools/train_net.py"", line 581, in main
Train(args)
File ""/usr/VMZ-master-1/tools/train_net.py"", line 404, in Train
workspace.CreateNet(test_model.net)
File ""/root/pytorch/build/caffe2/python/workspace.py"", line 181, in CreateNet
StringifyProto(net), overwrite,
File ""/root/pytorch/build/caffe2/python/workspace.py"", line 215, in CallWithExceptionIntercept
return func(args, kwargs)
RuntimeError: [enforce fail at context.h:48] option.device_type() == PROTO_CPU. 1 vs 0
frame #0: c10::ThrowEnforceNotMet(char const, int, char const, std::__cxx11::basic_string<char, std::char_traits, std::allocator > const&, void const) + 0x78 (0x7fed19c32178 in /usr/local/lib/libc10.so)
frame #1: + 0x2686d70 (0x7fecdcf03d70 in /usr/local/lib/libtorch.so)
frame #2: + 0x2723fec (0x7fecdcfa0fec in /usr/local/lib/libtorch.so)
frame #3: + 0x3aff5ee (0x7fecde37c5ee in /usr/local/lib/libtorch.so)
frame #4: std::_Function_handler<std::unique_ptr<caffe2::OperatorBase, std::default_deletecaffe2::OperatorBase > (caffe2::OperatorDef const&, caffe2::Workspace*), std::unique_ptr<caffe2::OperatorBase, std::default_deletecaffe2::OperatorBase > ()(caffe2::OperatorDef const&, caffe2::Workspace)>::_M_invoke(std::_Any_data const&, caffe2::OperatorDef const&, caffe2::Workspace*&&) + 0x23 (0x7fed1a4b5433 in /root/pytorch/build/caffe2/python/caffe2_pybind11_state_gpu.so)
frame #5: + 0x236c25c (0x7fecdcbe925c in /usr/local/lib/libtorch.so)
frame #6: caffe2::CreateOperator(caffe2::OperatorDef const&, caffe2::Workspace*, int) + 0x328 (0x7fecdcbea528 in /usr/local/lib/libtorch.so)
frame #7: caffe2::dag_utils::prepareOperatorNodes(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x2ad (0x7fecdcbda06d in /usr/local/lib/libtorch.so)
frame #8: caffe2::AsyncNetBase::AsyncNetBase(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x24d (0x7fecdcbb670d in /usr/local/lib/libtorch.so)
frame #9: caffe2::AsyncSchedulingNet::AsyncSchedulingNet(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x9 (0x7fecdcbbb5b9 in /usr/local/lib/libtorch.so)
frame #10: + 0x23410ae (0x7fecdcbbe0ae in /usr/local/lib/libtorch.so)
frame #11: std::_Function_handler<std::unique_ptr<caffe2::NetBase, std::default_deletecaffe2::NetBase > (std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*), std::unique_ptr<caffe2::NetBase, std::default_deletecaffe2::NetBase > ()(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace)>::_M_invoke(std::_Any_data const&, std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*&&) + 0x23 (0x7fecdcbbdf83 in /usr/local/lib/libtorch.so)
frame #12: caffe2::CreateNet(std::shared_ptr<caffe2::NetDef const> const&, caffe2::Workspace*) + 0x4a5 (0x7fecdcbb0495 in /usr/local/lib/libtorch.so)
frame #13: caffe2::Workspace::CreateNet(std::shared_ptr<caffe2::NetDef const> const&, bool) + 0x103 (0x7fecdcc2fe23 in /usr/local/lib/libtorch.so)
frame #14: caffe2::Workspace::CreateNet(caffe2::NetDef const&, bool) + 0x91 (0x7fecdcc30d61 in /usr/local/lib/libtorch.so)
frame #15: + 0x57906 (0x7fed1a4ad906 in /root/pytorch/build/caffe2/python/caffe2_pybind11_state_gpu.so)
frame #16: + 0x57bd2 (0x7fed1a4adbd2 in /root/pytorch/build/caffe2/python/caffe2_pybind11_state_gpu.so)
frame #17: + 0x99e3d (0x7fed1a4efe3d in /root/pytorch/build/caffe2/python/caffe2_pybind11_state_gpu.so)

frame #33: __libc_start_main + 0xe7 (0x7fed1e897b97 in /lib/x86_64-linux-gnu/libc.so.6)

. []"
473,20717,0,"Problem with DataLoader. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce
I have training , validation and test dataset. I have created dataloaders for three of them with training shuffle = True and for valdiation and test shuffle = False . So in one of the code epoch loop contains iterator over train and validation and in another one , epoch loop contains iterator over train , validation and test.

Check the output of the code 1 and 2
1. https://www.kaggle.com/suchith0312/pytorch-dataloader-testing?scriptVersionId=14425205
2. https://www.kaggle.com/suchith0312/pytorch-dataloader-testing?scriptVersionId=14425182

## Expected behavior

The train id's from output of files must be same but they are different. 

## Environment
 - PyTorch Version : 1.0.1.post2
 - Python version: 3.6.6
 - CUDA version : 10.0
- Cudnn version 7.4.2 . []"
270,28882,0,"Support RRef[T].__call__(*args) which invokes T.__call__(*args) on owner. This is a necessary syntax sugar to for the following use case:



We can implement  by sending a message to the owner,
triggering the owner to run  locally, and returning immediately another RRef of the output.

cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. ['python\r\nclass MyModel(nn.Module):\r\n   pass\r\n\r\nmodel = rpc.remote(""worker0"", MyModel)\r\n# The following line should result in an RPC call to worker0 to\r\n# run MyModel constructor\r\noutputs_rref = model(inputs)\r\n']"
248,13850,0,"num_workers > 0 leading to OOM in non-IPython environment. My code works perfectly in an IPython Jupyter Notebook environment. I'm training a GAN while asynchronous loading data with ImageFolder and DataLoader.  behaves as expected.

When I export my code to .py and execute it from VSCode inside my conda environment (where I started the notebook from) my memory quickly goes up until it reaches . (RAM goes to 100% aswell).

I am using this syntax because I'm on windows: 


Using  and  works but then my epoch time increases about 22x. Everything over 1 leads to the aforementioned OOMs.

Theres shouldn't be any issue because I'm just copying my Ipython code to VSCode and then run the .py file from there, why is this happening?


**System information**

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.2

OS: Microsoft Windows 10 Home
GCC version: Could not collect
CMake version: Could not collect

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 9.2.148
GPU models and configuration: GPU 0: GeForce RTX 2070
Nvidia driver version: 416.81
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] Could not collect
[conda] cuda92                    1.0                           0    pytorch
[conda] pytorch                   0.4.1           py37_cuda92_cudnn7he774522_1  [cuda92]  pytorch
[conda] torchvision               0.2.1                     <pip>. [""\r\nimport torch\r\n\r\ndef main()\r\n    for i, data in enumerate(dataloader):\r\n        # do something here\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n""]"
83,17350,1,"torch.nn.CrossEntropyLoss with ""reduction"" sum/mean is not deterministic on segmentation outputs / labels. ## üêõ Bug
torch.nn.CrossEntropyLoss doesn't output deterministic results on segmentation outputs / labels, when using reduction other than 'none'.
Happens only on GPU. CPU does give a consistent behavior. 

## To Reproduce

## Output


## Expected behavior
I believe the expected behavior of the reduction='sum' and 'mean' should be as consistent as the 'none' option (where I use numpy for reduction).

## Environment

## Additional context
Ran on amazon K80 instance (p2.xlarge).
I know it does seem like a very tiny error but the result of this is that two training sessions of my segmentation network (with identical parameters, initialization, order of image-batches, random seed, etc') doesn't produce identical results. That is problematic when I want to investigate a specific training session.
. [""\r\nimport numpy as np\r\nimport torch\r\n\r\noutputs = np.random.rand(16, 1, 256, 256)\r\noutputs = np.hstack((outputs, 1.0 - outputs))\r\ntargets = np.random.randint(2, size=(16, 256, 256))\r\n\r\nseed = 0\r\ntorch.backends.cudnn.deterministic = True\r\ntorch.backends.cudnn.benchmark = False\r\n\r\nfor reduction in ['none', 'sum', 'mean']:\r\n    print(reduction)\r\n\r\n    for i in range(10):\r\n        torch.manual_seed(seed)\r\n        np.random.seed(seed)\r\n\r\n        outputs_t, targets_t = torch.from_numpy(outputs), torch.from_numpy(targets)\r\n        outputs_t, targets_t = outputs_t.cuda(0), targets_t.cuda(0)\r\n\r\n        loss_fn = torch.nn.CrossEntropyLoss(reduction=reduction)\r\n        loss_fn = loss_fn.cuda(0)\r\n\r\n        loss = loss_fn(outputs_t, targets_t)\r\n        loss = loss.detach().cpu().numpy()\r\n        print(i, outputs.sum(), targets.sum(), outputs.mean(), targets.mean(), loss.sum(), loss.mean())\r\n"", '\r\nnone\r\n0 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n1 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n2 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n3 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n4 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n5 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n6 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n7 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n8 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\n9 1048576.0 524341 0.5 0.5000505447387695 769533.4950007759 0.7338843297965774\r\nsum\r\n0 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n1 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n2 1048576.0 524341 0.5 0.5000505447387695 769533.4950007757 769533.4950007757\r\n3 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n4 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n5 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n6 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n7 1048576.0 524341 0.5 0.5000505447387695 769533.4950007754 769533.4950007754\r\n8 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\n9 1048576.0 524341 0.5 0.5000505447387695 769533.4950007756 769533.4950007756\r\nmean\r\n0 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n1 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n2 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n3 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n4 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n5 1048576.0 524341 0.5 0.5000505447387695 0.7338843297965769 0.7338843297965769\r\n6 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n7 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n8 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n9 1048576.0 524341 0.5 0.5000505447387695 0.733884329796577 0.733884329796577\r\n', '\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.4 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: Tesla K80\r\nNvidia driver version: 384.111\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.16.1\r\n[pip3] torch==1.0.1.post2\r\n[conda] mkl                       2018.0.0             hb491cac_4\r\n[conda] mkl-service               1.1.2            py36h17a0993_4\r\n[conda] torch                     0.4.0                     <pip>\r\n']"
258,28306,0,"Torch ONNX export broken for RandomUniform and RandomUniformLike. ## üêõ Bug

 reports issues in exporting models with  and .

## To Reproduce

Steps to reproduce the behavior:

Enable Case 2 or Case 4 and run the example below:



Errors reported by the torch.onnx exporter:

Case 2:


Cases 3 & 4:


## Expected behavior

ONNX RandomUniform export must by supported by torch and onnx model must be generated for all cases in the example script.

## Environment


 - PyTorch Version: 3.6
 - OS (e.g., Linux): Ubuntu 18.04.3 LTS
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source): NA
 - Python version: 3.6
 - CUDA/cuDNN version: cuda 10.1 / cudnn 7.6.3
 - GPU models and configuration: 
GPU 0: GeForce GTX 1070 Ti
GPU 1: TITAN V
 - Any other relevant information:
[pip] torch==1.3.0
[pip] torchvision==0.4.1

## Additional context

NA


cc @houseroad @spandantiwari @lara-hdr @BowenBao @neginraoof. [""python\r\nimport torch\r\nimport torch.nn as nn\r\n\r\nprint(torch.__version__)\r\n\r\nclass test(torch.nn.Module):\r\n\r\n    def __init__(self, vocab_size=10, rnn_dims=512):\r\n        super().__init__()\r\n\r\n    def forward(self, x):\r\n        # CASE 1) RandomNormalLike - Works\r\n        # mask = torch.randn_like(x).to(torch.float32)\r\n\r\n        # CASE 2) RandomUniformLike - Broken\r\n        # mask = torch.rand_like(x).to(torch.float32)\r\n\r\n        # CASE 3) RandomNormal - Broken\r\n        # mask = torch.randn(x.size()).to(torch.float32)\r\n\r\n        # CASE 4) RandomUniform - Broken\r\n        mask = torch.rand(x.size()).to(torch.float32)\r\n\r\n        return mask\r\n\r\n\r\n# PyTorch model\r\nmodel = test()\r\n\r\ninput = torch.ones((1,256)).to(torch.float32).cuda()\r\noutput = model(input)\r\ntorch.onnx.export(model,\r\n                  input,\r\n                  'test_rand.onnx',\r\n                  example_outputs=output)\r\n"", '\r\nUserWarning: ONNX export failed on ATen operator rand_like because torch.onnx.symbolic_opset9.rand_like does not exist\r\n', '\r\nTypeError: i_(): incompatible function arguments. The following argument types are supported: 1. (self: torch._C.Node, arg0: str, arg1: int) -> torch._C.Node\r\n']"
356,7773,0,"[feature request] Add Local Contrast Normalization . ## Issue description
As mentioned in this paper  :- http://yann.lecun.com/exdb/publis/pdf/jarrett-iccv-09.pdf
I noticed that Local Response Norm is present. This is will be a good addition too.
I have an implementation ready and can create a PR soon, if approved.


cc @albanD @mruberry. []"
466,4573,0,"Documentation for ""char_rnn_classification_tutorial"" has wrong output cell calculation. @soumith Looks like [this tutorial](http://pytorch.org/tutorials/intermediate/char_rnn_classification_tutorial.html) has a bug in this code:      

    

Looks like the output of the forward pass is done on the input and NOT on the processed data as computed by the RNN cell (ie: self.i2h(combined))   

So, this:    
   
Should become:    

  
If you guys agree, I'm happy to make that minor (but frustrating if you don't know what's going on) change to the docs.   . ['python   \r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\n\r\nclass RNN(nn.Module):\r\n    def __init__(self, input_size, hidden_size, output_size):\r\n        super(RNN, self).__init__()\r\n\r\n        self.hidden_size = hidden_size\r\n\r\n        self.i2h = nn.Linear(input_size + hidden_size, hidden_size)\r\n        self.i2o = nn.Linear(input_size + hidden_size, output_size)\r\n        self.softmax = nn.LogSoftmax(dim=1)\r\n\r\n    def forward(self, input, hidden):\r\n        combined = torch.cat((input, hidden), 1)\r\n        hidden = self.i2h(combined)\r\n        output = self.i2o(combined)\r\n        output = self.softmax(output)\r\n        return output, hidden\r\n\r\n    def initHidden(self):\r\n        return Variable(torch.zeros(1, self.hidden_size))\r\n\r\nn_hidden = 128\r\nrnn = RNN(n_letters, n_hidden, n_categories)\r\n', 'python    \r\n    def forward(self, input, hidden):\r\n        combined = torch.cat((input, hidden), 1)\r\n        hidden = self.i2h(combined)\r\n        output = self.i2o(combined)\r\n        output = self.softmax(output)\r\n        return output, hidden\r\n', 'python    \r\n    def forward(self, input, hidden):\r\n        combined = torch.cat((input, hidden), 1)\r\n        hidden = self.i2h(combined)\r\n        output = self.i2o(hidden) # this line needs to be changed    \r\n        output = self.softmax(output)\r\n        return output, hidden\r\n']"
349,11389,0,"[distributions] Torch distribution samplers slow on expanded parameters. ## Issue description
We use expanded tensors as distribution parameters in many cases where we dynamically broadcast the parameters at runtime. While working on a related (https://github.com/pytorch/pytorch/pull/11341) PR, I noticed that sampling can be slow when using expanded tensors as distribution parameters. I have narrowed this slowdown to the native torch samplers.

While this is likely expected behavior, it raises the question of:
 (a) whether we should be doing anything inside of distributions to ensure that parameter tensors are contiguous, and if so,
 (b) under what conditions should we ensure contiguity - always by default, or have it be controllable by the user via an optional keyword argument. If we use the same instance to draw multiple samples, it is worth the one time cost of calling  on the distribution parameters (I think, given the relatively low overhead of , we can probably make it the default). 

## Profiling code


cc. @fritzo, @vishwakftw 


cc @fritzo @neerajprad @alicanb @vishwakftw @nikitaved. ['python\r\nIn [36]: m1, s1 = torch.ones(2, 10, 10000), torch.ones(2, 10, 10000)\r\n\r\nIn [37]: m2, s2 = torch.ones(10000).expand([2, 10, 10000]), torch.ones(10, 10000).expand([2, 10, 10000])\r\n\r\nIn [38]: m3, s3 = m2.contiguous(), s2.contiguous()\r\n\r\nIn [39]: m1.is_contiguous(), m2.is_contiguous(), m3.is_contiguous()\r\nOut[39]: (True, False, True)\r\n\r\nIn [40]: %timeit -n 1000 -r 10 torch.normal(m1, s1)\r\n1.53 ms ¬± 47 ¬µs per loop (mean ¬± std. dev. of 10 runs, 1000 loops each)\r\n\r\nIn [41]: %timeit -n 1000 -r 10 torch.normal(m2, s2)\r\n1.98 ms ¬± 18 ¬µs per loop (mean ¬± std. dev. of 10 runs, 1000 loops each)\r\n\r\nIn [42]: %timeit -n 1000 -r 10 torch.normal(m3, s3)\r\n1.5 ms ¬± 36.6 ¬µs per loop (mean ¬± std. dev. of 10 runs, 1000 loops each)\r\n\r\nIn [43]: %timeit m2.contiguous()\r\n134 ¬µs ¬± 1.25 ¬µs per loop (mean ¬± std. dev. of 7 runs, 10000 loops each)\r\n']"
583,947,0,"thpp Tensor templatized over Device (and maybe Density, e.g sparse vs dense). Right now, THPP exposes four templatized classes:



I propose to consolidate these into a single class, like so:

We can then do the following:

and so on.

In this fashion, nothing about the current API would change (and so all current code that uses THPP would all work the same), but users of THPP would be able to choose what level of templatization they want. If there are some current methods that are only in some subset of the classes, we can either do template class specialization, or simply make those methods part of all the classes.

I am interested in this because I am using THPP in a separate project, in which it would be cleaner to have the Tensor class to be templatized over at least the Device (in addition to the Type), as it is in most other frameworks (e.g MXNet).

I am happy to do this and submit a PR if the developers are interested, otherwise I will just make those changes locally.. ['\r\nTorchTensor<Type,Device,Density> (or at least, <Type,Device>).\r\n', '\r\ntemplate <typename T>\r\nusing THTensor = TorchTensor<T,CPU,Dense>\r\n\r\ntemplate <typename T>\r\nusing THCTensor = TorchTensor<T,GPU,Dense>\r\n']"
309,13711,0,"In eval(),  BatchNorm running_mean is different between different GPUs. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
After train , when test the model, the BatchNorm is different between different GPUs, it does not do broadcast in eval()?

## To Reproduce

Steps to reproduce the behavior:

1.
1.
1.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0):
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
346,6265,0,"[Caffe2] mobile_exporter init_net has code calling information. **The init_net file generated from the mobile_exporter function has code calling information,**
There is fragment information in my generated init_net file:

‚ñ†146 ""GivenTensorFill*	
shape0*
values-6}‚ñ†?-
{‚ïì>-$‚îî?R‚îê  File ""Style_torch.py"", line 186, in <module>
    init_net, predict_net = mobile_exporter.Export(c2_workspace, c2_model, c2_model.external_input)
  File ""/home/wguo/lib/temp1/caffe2/build/caffe2/python/predictor/mobile_exporter.py"", line 86, in Export
    add_tensor(init_net, blob_name, blob)
  File ""/home/wguo/lib/temp1/caffe2/build/caffe2/python/predictor/mobile_exporter.py"", line 53, in add_tensor
    utils.MakeArgument(""values"", values),
*  . []"
387,17397,0,"How does pytorch count batch size in SGD with multiGPU when it does Batch Norm?. ## ‚ùì Questions and Help
When pytorch does the batch normalization in SGD, what batch size it use? Per GPU batch size, or total batch size over all GPUs?
For example, suppose I set the per-GPU batch size as 32, and I use 8 GPUs. When Pytorch does batch normalization, what batch size it use, 32 or 32 x 8?
My concern comes from a facebook's paper ""Accurate, Large Minibatch SGD: Training ImageNet in 1 Hour"". If Pytorch's implementation is the same with what this paper describes, I can modify the parameters of my model accordingly; if not, I need to know. Thanks!
. []"
627,5917,0,"type object 'Embedding' has no attribute 'from_pretrained'. - OS: Ubuntu 14.04 LTS
- PyTorch version: 0.4.0
- How you installed PyTorch (conda, pip, source): pip
- Python version: 2.7.6
- CUDA/cuDNN version: 8
- GPU models and configuration: Tesla K20
- GCC version (if compiling from source): 4.8.4

. []"
531,27680,0,"1>E:\software\libtorch\include\torch/csrc/utils/variadic.h(195): error C2951: Ê®°Êùø Â£∞ÊòéÂè™ËÉΩÂú®ÂÖ®Â±Ä„ÄÅÂëΩÂêçÁ©∫Èó¥ÊàñÁ±ªËåÉÂõ¥ÂÜÖ‰ΩøÁî®. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1.
1.
1.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0):
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
128,15620,0,cuda.  cuda runtime error(11):invalid argumen at /pytorch/torch/lib/THC/generic/THCTensorCopy.c:70. []
685,2670,0,"Adding an attribute as a buffer should throw in error. We had a bug in OpenNMT where we first created an attribute  and then tried to add  as a buffer. This behavior will cause  to exist, but not be cast with . We think this behavior is counter-intuitive, and it should throw an error. 

@jianyuzhan 

. []"
179,22050,0,"RuntimeError: cuDNN error: CUDNN_STATUS_INTERNAL_ERROR in 1.1.0 . I am currently using Windows 7, Pytorch version 1.1.0, 
It seems from what I have read this error should have been fixed
in 1.1.0?

Here is the environment:

Collecting environment information...
PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 9.0

OS: Microsoft Windows 7 Professional
GCC version: (tdm64-1) 5.1.0

CMake version: version 3.7.0-rc1


Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration: GPU 0: GeForce GTX 1070
Nvidia driver version: 411.31
cuDNN version: C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\bin\cudnn64_7.dll

Versions of relevant libraries:
[pip3] numpy==1.16.4

[pip3] torch==1.1.0

[pip3] torchsummary==1.5.1

[pip3] torchvision==0.3.0
[conda] Could not collect


Here is the traceback:





I have multiple versions of CUDA installed for compatibility
with Tensorflow, Keras and Pytorch.


Thank you. 



The script I am running is the  script using 


https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html




. []"
540,30331,0,"[v1.4.0] Release Tracker. The branch v1.4.0 has been cut.

If you need any particular patches onto this branch, please comment below and send a PR to v1.4.0 branch (instead of master).

---

[Current PRs open against the v1.4.0 branch](https://github.com/pytorch/pytorch/pulls?utf8=%E2%9C%93&q=is%3Apr+is%3Aopen+base%3Av1.4.0)
. []"
355,28472,0,"at::Tensor::data() is deprecated but no other way is suggested for cpp extensions. ## üêõ Bug

Even the official [docs for cpp extensions](https://pytorch.org/tutorials/advanced/cpp_extension.html) use  but I get deprecation warning.

## To Reproduce

>  warning: ‚ÄòT* at::Tensor::data() const [with T = float]‚Äô is deprecated [-Wdeprecated-declarations]                                                                                                                               /home/ehazar/miniconda3/envs/py3_night/lib/python3.6/site-packages/torch/include/ATen/core/TensorBody.h:312:1: note: declared here                                                                                                                                                 T * data() const {


## Expected behavior

Provide a non-deprecated way for cpp extensions. Similarly, no alternative to / nor  is provided for cpp extensions.

## Environment

Collecting environment information...
PyTorch version: 1.4.0.dev20191018
Is debug build: No
CUDA used to build PyTorch: 10.0

OS: Ubuntu 16.04.6 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: version 3.14.0

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: GeForce GTX 1070
Nvidia driver version: 418.40.04
cuDNN version: /usr/local/lib/libcudnn.so.5.1.10

Versions of relevant libraries:
[pip] numpy==1.17.2
[pip] torch==1.4.0.dev20191018
[pip] torchvision==0.5.0a0+155c504
[conda] Could not collect


cc @yf225. []"
444,25859,0,"TORCH_WARN must not take out GIL (should buffer warnings). At the moment, we have an attractively named  macro which you can use to report warnings from C++. What if I told you... that using this function could cause your code to take out a lock and all sorts of performance nastiness like that? Well, that's exactly what this macro does, because it calls a custom warning handler that, in the case of our Python extension, calls into Python code to file a Python warning. This is bad bad bad, for both performance reasons, and also because it could cause a deadlock (as to file a Python warning, we must acquire the GIL).

A better strategy is our Python handler must buffer warnings, and then when we (normally) return back to Python and acquire the GIL, actually report the warnings. The correct place to add this logic is probably where we also handle catching C++ exceptions and converting them into Python exceptions.. []"
556,4858,0,"CUDA multinomial with replacement can select zero-probability events. I'm running Ubuntu 16.04.3 on an AWS P3.2xlarge, with the NVIDIA libcuda1-384 package, version 384.111-0ubuntu0.16.04.1, and pytorch version 0.3.0.post4 and cuda90, installed via conda.

In some circumstances, the CUDA multinomial sampler with  can sample an event with zero probability.

The script below reproduces this. I haven't tried to reduce the distribution to a minimal case.  The output is below the script.

I've attached [the RNG state](https://github.com/pytorch/pytorch/files/1665704/failed_state.pt.gz) just prior to the failure. Reproduction from this state is demonstrated in the script.

Bests regards,
Alex

{SAVE_PATH}failed_state.pt. ['\r\n\r\n']"
453,31554,0,"RuntimeError: Error in dlopen or dlsym: libcaffe2_nvrtc.so: cannot open shared object file: No such file or directory. RuntimeError: Error in dlopen or dlsym: libcaffe2_nvrtc.so: cannot open shared object file: No such file or directory

Environment: 
1. Pytorch 1.3.1
2. Linux
3. Pycharm

. []"
717,19807,0,"Create Extension Error: Pytorch 0.4.0. Hi everyone,

I am trying to user FFI extensions in order to add some CUDA compiled functions. The error I encountered is as follows;

cffi.CDefError: cannot parse ""#include <THC/THC.h>""
<cdef source string>:29:1: Directives not supported yet

My environmental configuration is as follows;

Cuda Compilation Tool Version: 9.0, v9.0.176
pycparser version 2.18
PyTorch Version: 0.4.0

Could you please provide assitance about this issue?
Thanks.. []"
538,9167,0,"Redundant code in distributed. It seems like the  is not used at all. Could someone tell me why don't directly  to ?

https://github.com/pytorch/pytorch/blob/4b2b6907929093634c1e452aa2a5a85e4dd9a793/torch/csrc/distributed/Module.cpp#L786. []"
495,18354,0,Port SpatialReflectionPadding and TemporalReflectionPadding to ATen. Large. []
304,13636,0,"Conv3d with cudnn error. When I use **torch.backends.cudnn.benchmark = True** in Conv3d, it returned error 
**RuntimeError: cuDNN error: CUDNN_STATUS_INTERNAL_ERROR**

I tired **re -rf ~/.nv** but it doesn't work. The error only disappears when **torch.backends.cudnn.benchmark = False**.

Ubuntu 16.04.4 LTS Tesla P100 Cuda 9.0 cudnn 7.1 
pytorch 1.0.0a0+d03c6ba from source and 0.4.1 from pip both tried.. []"
169,1114,0,"Sequential to support better slicing. 

Would be nice in absence of [remove_module](https://github.com/pytorch/pytorch/issues/358), but probably low-priority.. ['python\r\nimport torch.nn as nn\r\n\r\na = nn.Sequential(nn.Linear(1, 1), nn.Linear(1, 1))\r\n\r\na[0] # works\r\nnn.Sequential(*a[:-1]) # blows\r\nnn.Sequential(*list(a)[:-1]) # works\r\n']"
367,28549,0,"Expose DifferentiableGraphBackward to python. ## üöÄ Feature

Currently, there is no easy way of visualizing the graph generated by autodiff in jit. We want something that could do



## Additional context

In autograd, the  for  of a JIT graph is defined as

 
in 

This class does not have python correspondence, therefore python only views it as a general . We need to create a Python class for it so that we could access additional information.

**Please confirm if this feature sounds useful and if yes, assign me to this issue and I will work on it.**

cc @suo @ezyang @SsnL @albanD @zou3519 @gqchen. ['python\r\nimport torch\r\n\r\n@torch.jit.script\r\ndef f(a):\r\n    return (a + 100) * 5\r\n\r\na = torch.tensor(0., requires_grad=True)\r\nresult = f(a)\r\n\r\nprint(result.grad_fn.graph)\r\n', '\r\nstruct DifferentiableGraphBackward : public autograd::Node\r\n']"
85,3021,1,"CPU scaling issue. Platform: c4.4xlarge EC2 instance (16 vCPUs)
OS: Fedora cloud 26-1.5
Version: PyTorch v0.2.0

Description:
Running 4 workloads on all cores is x8 slower than pinning each workload to 4 different cpus.

How-to reproduce:


The following yields 220 ms/sequence (while not utilizing the CPUs fully):


The following yields 1850 ms/sequence:

And moreover, all the CPUs are 100% utilized...

Motivation:
I wanted to scale training on multi-core systems, a single workload not utilized the cpus fully, so I thought about utilizing the rest of the resources by running multiple workloads.. ['\r\ngit clone git@github.com:loudinthecloud/pytorch-ntm.git\r\ngit checkout d08291fac4dccaa3c8d081bad06802d9e4d737ea\r\nsudo pip3 install -r requirements\r\n', '\r\ntaskset -c 0-3 ./train.py --seed 5 --checkpoint-interval 0\r\ntaskset -c 4-7 ./train.py --seed 50 --checkpoint-interval 0\r\ntaskset -c 8-11 ./train.py --seed 500 --checkpoint-interval 0\r\ntaskset -c 12-15 ./train.py --seed 5000 --checkpoint-interval 0\r\n', '\r\n./train.py --seed 5 --checkpoint-interval 0\r\n./train.py --seed 50 --checkpoint-interval 0\r\n./train.py --seed 500 --checkpoint-interval 0\r\n./train.py --seed 5000 --checkpoint-interval 0\r\n']"
582,8393,0,"[jit][script] Can't allocate zero gradients for a value without a type. See also https://github.com/pytorch/pytorch/issues/8410

Example:


output:



Operator level tests that fail with this:

- 
- 
- 
- 
- 
- 
- 
- 
- 
- 
- 
- 
- 
. ['\r\nimport torch\r\n@torch.jit.script\r\ndef unsqueezel(x):\r\n    return x.unsqueeze(dim=-1)\r\nx = torch.randn((2, 2), requires_grad=True)\r\nunsqueezel(x)\r\n', '\r\nTraceback (most recent call last):\r\n  File ""dim.py"", line 6, in <module>\r\n    unsqueezel(x)\r\nRuntimeError: torch/csrc/jit/autodiff.cpp:199: createZerosLike: can\'t allocate zero gradient for a value without a type\r\n']"
550,3914,0,"Broken ByteTensor indexing of Variables (still works for Tensors). In PyTorch master 0.4 709fcfd, variables cannot be indexed.



This used to work in PyTorch 0.2 f964105:
. ['py\r\nimport torch\r\nfrom torch.autograd import Variable\r\nprint(torch.__version__)\r\n# 0.4.0a0+709fcfd\r\n\r\nx = Variable(torch.Tensor([0]))\r\nx.data[x.data == 1]\r\n# [torch.DoubleTensor with no dimension]\r\nx[x == 1]\r\n# *** RuntimeError: dimension out of range (expected to be in range of [-1, 0], but got 1)\r\n', 'py\r\nimport torch\r\nfrom torch.autograd import Variable\r\nprint(torch.__version__)\r\n# 0.2.0+f964105\r\n\r\nx = Variable(torch.Tensor([0]))\r\nx.data[x.data == 1]\r\n# [torch.FloatTensor with no dimension]\r\nx[x == 1]\r\n# Variable containing:[torch.FloatTensor with no dimension]\r\n']"
233,1128,0,"Pad a list of tensors. Taking in a list of tensors, can we have a function to pad them? This is a useful feature to process sequences of different lengths and process mini batches. 

I think the documentation of pad_packed_sequence and torch.nn.utils.rnn.pack_padded_sequence are a little confusing http://pytorch.org/docs/nn.html?highlight=pad_packed#torch.nn.utils.rnn.pad_packed_sequence maybe adding some examples could help the explanation. . []"
330,24600,0,"Migrate `multi_margin_loss` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
288,21015,0,"How to use Infiniband for cpu-cluster with backend gloo?. Now I'm trying to build pytorch from source for my cpu-cluster with backend gloo.
After installing pytorch, I got this information from install summay:

In my cluster, the network interface ""eno1"" represents Ethernet, and ""ib0"" represents Infiniband.
I set the environment variable , and distributed pytorch works fine. But when I set , it will cause some error.

What should I do?
Thanks.. ['\r\n --   USE_DISTRIBUTED       : True\r\n --     USE_MPI             : ON\r\n --     USE_GLOO            : ON\r\n --     USE_GLOO_IBVERBS    : 1\r\n']"
271,30413,0,"nn.functional should maintain API parity with nn where possible. ## üöÄ Feature
 should provide a functional alternative to every stateful component in  that supports it.

Some, like  were deprecated in  because they're now the same as those in .

## Motivation

People usually import modules and submodules that are used often under short intuitive names.

One such name I've often encountered is , in the same vein as importing .

The current plan to move some math functions permanently away from  somewhat awkwardly splits the API.

1. Every operation that has a  has its name in  (to my knowledge).
2. Almost every operation (s) in  that can be exposed cleanly in a functional manner has a name in . But some don't.

## Pitch

Move all 'mathy' functions with class counterparts from  to  and expose aliases to the basic/fundamental ones in .

Here we get into ugly territory; I don't know how exactly I'd argue for some methods currently under , but ,  and co definitely belong in .

## Alternatives

Flip the implementation/re-exporting tale with the impls in  and the re-exports in .

## Additional context

E.g.
https://github.com/pytorch/pytorch/issues/6245 : Deprecate torch.nn.functional.tanh?
. []"
686,17615,0,"Long tensor to Float tensor slicing assignment fails. ## üêõ Bug
Assigning a Long tensor to a Float tensor silently fails.

## To Reproduce

## Expected behavior
The tensor should be correctly copied or an error message should be raised.

## Environment

. ['\r\nimport torch\r\nS = 10\r\nx = torch.rand(S) # float\r\n\r\ny = torch.zeros(S) # float\r\ny[:] = x[:] # float assignment works correctly\r\nprint(y.tolist())\r\n\r\ny = torch.zeros(S, dtype=torch.long) # long\r\ny[:] = x[:] # assignment from long tensor to float tensor silently fails.\r\nprint(y.tolist())\r\n', '\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.4 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration:\r\nGPU 0: Tesla V100-SXM2-16GB\r\nGPU 1: Tesla V100-SXM2-16GB\r\nGPU 2: Tesla V100-SXM2-16GB\r\nGPU 3: Tesla V100-SXM2-16GB\r\n\r\nNvidia driver version: 387.26\r\ncuDNN version: Probably one of the following:\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.5.1.10\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.1\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy==1.15.4\r\n[pip] numpydoc==0.8.0\r\n[pip] torch==1.0.1.post2\r\n[conda] blas                      1.0                         mkl\r\n[conda] mkl                       2019.1                      144\r\n[conda] mkl-service               1.1.2            py37he904b0f_5\r\n[conda] mkl_fft                   1.0.6            py37hd81dba3_0\r\n[conda] mkl_random                1.0.2            py37hd81dba3_0\r\n[conda] pytorch                   1.0.1           py3.7_cuda9.0.176_cudnn7.4.2_2    pytorch\r\n']"
105,22120,0,"convert pth to onnx. ## üêõ Bug


print(torch.__version__)
1.1.0

print(torch.version.cuda)
9.0.176

OS: linux 18.04

 - How you installed PyTorch (, , source): i try both of them, and try to compile from source.
 - Python version: 3.6
 - CUDA/cuDNN version: 7.6.0

Hi, im try to convert .pth weights from yolact project to onnx, im running the following code:



and get the following error:
. ['python\r\nweights_path = \'/home/ws/DL/yolact/weights/yolact_im700_54_800000.pth\'\r\n\r\nimport torch\r\nimport torch.onnx\r\nimport yolact\r\nimport torchvision\r\n\r\nmodel = yolact.Yolact()\r\n\r\n# state_dict = torch.load(weights_path)\r\n# model.load_state_dict(state_dict)\r\n\r\nmodel.load_weights(weights_path)\r\n\r\ndummy_input = torch.randn(1, 3, 640, 480)\r\n\r\ntorch.onnx.export(model, dummy_input, ""onnx_model_name.onnx"")\r\n', '\r\n/home/ws/DL/yolact/yolact.py:256: TracerWarning: Converting a tensor to a Python index might cause the trace to be incorrect. We can\'t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  for j, i in product(range(conv_h), range(conv_w)):\r\n/home/ws/DL/yolact/yolact.py:279: TracerWarning: torch.Tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.\r\n  self.priors = torch.Tensor(prior_data).view(-1, 4)\r\n/home/ws/DL/yolact/yolact.py:279: TracerWarning: Converting a tensor to a Python float might cause the trace to be incorrect. We can\'t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  self.priors = torch.Tensor(prior_data).view(-1, 4)\r\n/home/ws/DL/yolact/layers/functions/detection.py:74: TracerWarning: Converting a tensor to a Python index might cause the trace to be incorrect. We can\'t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  for batch_idx in range(batch_size):\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-2-a796dc0eef97> in <module>\r\n     13 dummy_input = torch.randn(1, 3, 700, 700)\r\n     14 \r\n---> 15 torch.onnx.export(model, dummy_input, ""onnx_model_name.onnx"")\r\n\r\n~/.local/lib/python3.6/site-packages/torch/onnx/__init__.py in export(*args, **kwargs)\r\n     23 def export(*args, **kwargs):\r\n     24     from torch.onnx import utils\r\n---> 25     return utils.export(*args, **kwargs)\r\n     26 \r\n     27 \r\n\r\n~/.local/lib/python3.6/site-packages/torch/onnx/utils.py in export(model, args, f, export_params, verbose, training, input_names, output_names, aten, export_raw_ir, operator_export_type, opset_version, _retain_param_name, do_constant_folding, strip_doc_string)\r\n    129             operator_export_type=operator_export_type, opset_version=opset_version,\r\n    130             _retain_param_name=_retain_param_name, do_constant_folding=do_constant_folding,\r\n--> 131             strip_doc_string=strip_doc_string)\r\n    132 \r\n    133 \r\n\r\n~/.local/lib/python3.6/site-packages/torch/onnx/utils.py in _export(model, args, f, export_params, verbose, training, input_names, output_names, operator_export_type, export_type, example_outputs, propagate, opset_version, _retain_param_name, do_constant_folding, strip_doc_string)\r\n    361                                                         output_names, operator_export_type,\r\n    362                                                         example_outputs, propagate,\r\n--> 363                                                         _retain_param_name, do_constant_folding)\r\n    364 \r\n    365         # TODO: Don\'t allocate a in-memory string for the protobuf\r\n\r\n~/.local/lib/python3.6/site-packages/torch/onnx/utils.py in _model_to_graph(model, args, verbose, training, input_names, output_names, operator_export_type, example_outputs, propagate, _retain_param_name, do_constant_folding, _disable_torch_constant_prop)\r\n    264             model.graph, tuple(args), example_outputs, False, propagate)\r\n    265     else:\r\n--> 266         graph, torch_out = _trace_and_get_graph_from_model(model, args, training)\r\n    267         state_dict = _unique_state_dict(model)\r\n    268         params = list(state_dict.values())\r\n\r\n~/.local/lib/python3.6/site-packages/torch/onnx/utils.py in _trace_and_get_graph_from_model(model, args, training)\r\n    223     # training mode was.)\r\n    224     with set_training(model, training):\r\n--> 225         trace, torch_out = torch.jit.get_trace_graph(model, args, _force_outplace=True)\r\n    226 \r\n    227     if orig_state_dict_keys != _unique_state_dict(model).keys():\r\n\r\n~/.local/lib/python3.6/site-packages/torch/jit/__init__.py in get_trace_graph(f, args, kwargs, _force_outplace, return_inputs)\r\n    229     if not isinstance(args, tuple):\r\n    230         args = (args,)\r\n--> 231     return LegacyTracedModule(f, _force_outplace, return_inputs)(*args, **kwargs)\r\n    232 \r\n    233 \r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    491             result = self._slow_forward(*input, **kwargs)\r\n    492         else:\r\n--> 493             result = self.forward(*input, **kwargs)\r\n    494         for hook in self._forward_hooks.values():\r\n    495             hook_result = hook(self, input, result)\r\n\r\n~/.local/lib/python3.6/site-packages/torch/jit/__init__.py in forward(self, *args)\r\n    292         try:\r\n    293             trace_inputs = _unflatten(all_trace_inputs[:len(in_vars)], in_desc)\r\n--> 294             out = self.inner(*trace_inputs)\r\n    295             out_vars, _ = _flatten(out)\r\n    296             torch._C._tracer_exit(tuple(out_vars))\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             hook(self, input)\r\n    490         if torch._C._get_tracing_state():\r\n--> 491             result = self._slow_forward(*input, **kwargs)\r\n    492         else:\r\n    493             result = self.forward(*input, **kwargs)\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in _slow_forward(self, *input, **kwargs)\r\n    479         tracing_state._traced_module_stack.append(self)\r\n    480         try:\r\n--> 481             result = self.forward(*input, **kwargs)\r\n    482         finally:\r\n    483             tracing_state.pop_scope()\r\n\r\n~/DL/yolact/yolact.py in forward(self, x)\r\n    615                 pred_outs[\'conf\'] = F.softmax(pred_outs[\'conf\'], -1)\r\n    616 \r\n--> 617             return self.detect(pred_outs)\r\n    618 \r\n    619 \r\n\r\n~/DL/yolact/layers/functions/detection.py in __call__(self, predictions)\r\n     73 \r\n     74             for batch_idx in range(batch_size):\r\n---> 75                 decoded_boxes = decode(loc_data[batch_idx], prior_data)\r\n     76                 result = self.detect(batch_idx, conf_preds, decoded_boxes, mask_data, inst_data)\r\n     77 \r\n\r\nRuntimeError: isTensor() ASSERT FAILED at /pytorch/aten/src/ATen/core/ivalue.h:209, please report a bug to PyTorch. (toTensor at /pytorch/aten/src/ATen/core/ivalue.h:209)\r\nframe #0: std::function<std::string ()>::operator()() const + 0x11 (0x7f721e0ac441 in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libc10.so)\r\nframe #1: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x2a (0x7f721e0abd7a in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libc10.so)\r\nframe #2: <unknown function> + 0x979ad2 (0x7f721d130ad2 in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #3: torch::jit::tracer::getNestedValueTrace(c10::IValue const&) + 0x41 (0x7f721d3939a1 in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #4: <unknown function> + 0xa7651b (0x7f721d22d51b in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #5: <unknown function> + 0xa766db (0x7f721d22d6db in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #6: <unknown function> + 0x457942 (0x7f725d6d2942 in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)\r\nframe #7: <unknown function> + 0x130cfc (0x7f725d3abcfc in /home/ws/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)\r\nframe #8: _PyCFunction_FastCallDict + 0x35c (0x56204c in /usr/bin/python3)\r\nframe #9: /usr/bin/python3() [0x5a1501]\r\nframe #10: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #11: /usr/bin/python3() [0x5136c6]\r\nframe #12: _PyObject_FastCallKeywords + 0x19c (0x57ec0c in /usr/bin/python3)\r\nframe #13: /usr/bin/python3() [0x4f88ba]\r\nframe #14: _PyEval_EvalFrameDefault + 0x467 (0x4f98c7 in /usr/bin/python3)\r\nframe #15: _PyFunction_FastCallDict + 0xf5 (0x4f4065 in /usr/bin/python3)\r\nframe #16: /usr/bin/python3() [0x5a1481]\r\nframe #17: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #18: /usr/bin/python3() [0x513601]\r\nframe #19: _PyObject_FastCallKeywords + 0x19c (0x57ec0c in /usr/bin/python3)\r\nframe #20: /usr/bin/python3() [0x4f88ba]\r\nframe #21: _PyEval_EvalFrameDefault + 0x467 (0x4f98c7 in /usr/bin/python3)\r\nframe #22: /usr/bin/python3() [0x4f6128]\r\nframe #23: _PyFunction_FastCallDict + 0x2fe (0x4f426e in /usr/bin/python3)\r\nframe #24: /usr/bin/python3() [0x5a1481]\r\nframe #25: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #26: _PyEval_EvalFrameDefault + 0x1851 (0x4facb1 in /usr/bin/python3)\r\nframe #27: /usr/bin/python3() [0x4f6128]\r\nframe #28: _PyFunction_FastCallDict + 0x2fe (0x4f426e in /usr/bin/python3)\r\nframe #29: /usr/bin/python3() [0x5a1481]\r\nframe #30: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #31: _PyEval_EvalFrameDefault + 0x1851 (0x4facb1 in /usr/bin/python3)\r\nframe #32: /usr/bin/python3() [0x4f6128]\r\nframe #33: _PyFunction_FastCallDict + 0x2fe (0x4f426e in /usr/bin/python3)\r\nframe #34: /usr/bin/python3() [0x5a1481]\r\nframe #35: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #36: /usr/bin/python3() [0x513601]\r\nframe #37: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #38: _PyEval_EvalFrameDefault + 0x1851 (0x4facb1 in /usr/bin/python3)\r\nframe #39: /usr/bin/python3() [0x4f6128]\r\nframe #40: _PyFunction_FastCallDict + 0x2fe (0x4f426e in /usr/bin/python3)\r\nframe #41: /usr/bin/python3() [0x5a1481]\r\nframe #42: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #43: _PyEval_EvalFrameDefault + 0x1851 (0x4facb1 in /usr/bin/python3)\r\nframe #44: /usr/bin/python3() [0x4f6128]\r\nframe #45: _PyFunction_FastCallDict + 0x2fe (0x4f426e in /usr/bin/python3)\r\nframe #46: /usr/bin/python3() [0x5a1481]\r\nframe #47: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #48: /usr/bin/python3() [0x513601]\r\nframe #49: PyObject_Call + 0x3e (0x57c2fe in /usr/bin/python3)\r\nframe #50: _PyEval_EvalFrameDefault + 0x1851 (0x4facb1 in /usr/bin/python3)\r\nframe #51: /usr/bin/python3() [0x4f6128]\r\nframe #52: /usr/bin/python3() [0x4f7d60]\r\nframe #53: /usr/bin/python3() [0x4f876d]\r\nframe #54: _PyEval_EvalFrameDefault + 0x1260 (0x4fa6c0 in /usr/bin/python3)\r\nframe #55: /usr/bin/python3() [0x4f7a28]\r\nframe #56: /usr/bin/python3() [0x4f876d]\r\nframe #57: _PyEval_EvalFrameDefault + 0x467 (0x4f98c7 in /usr/bin/python3)\r\nframe #58: /usr/bin/python3() [0x4f6128]\r\nframe #59: /usr/bin/python3() [0x4f7d60]\r\nframe #60: /usr/bin/python3() [0x4f876d]\r\nframe #61: _PyEval_EvalFrameDefault + 0x467 (0x4f98c7 in /usr/bin/python3)\r\nframe #62: /usr/bin/python3() [0x4f6128]\r\nframe #63: /usr/bin/python3() [0x4f7d60]\r\n']"
33,12501,1,"C++: Calling Workspace::RunNet for a prediction on a different thread each time causes a GPU memory leak. ## üêõ Bug
Hi, 
I am trying to obtain a model prediction (on GPU) while running another piece of code in parallel (on CPU). Since I am streaming data, I instantiate a separate std::thread (or std::async) every time to call Workspace::RunNet, this causes a GPU memory leak which is not noticeable unless you are streaming data. However, if the thread used is maintained (a worker thread with the same thread_id), the leak does not occur.
Thank you,
<!-- A clear and concise description of what the bug is. -->

## To Reproduce
Steps to reproduce the behavior:
1. Given a pre-trained model, please use the following sample code to reproduce the issue:
<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->


## Expected behavior
Not expecting a memory leak when executing on threads with different thread ids.
<!-- A clear and concise description of what you expected to happen. -->

## Environment

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\n// Network setup\r\n\r\ncaffe2::NetDef init_net;\r\ncaffe2::NetDef predict_net;\r\nReadProtoFromFile(init_file, &init_net);\r\nReadProtoFromFile(predict_file, &predict_net);\r\nauto  workspace = std::make_unique<caffe2::Workspace>();\r\nconst auto cuda_device = caffe2::TypeToProto(caffe2::CUDA);\r\npredict_net.mutable_device_option()->set_device_type(cuda_device);\r\ninit_net.mutable_device_option()->set_device_type(cuda_device);\r\nworkspace->CreateBlob(predict_net_.external_input(0));\r\nworkspace->RunNetOnce(init_net);\r\nworkspace->CreateNet(predict_net);\r\n\r\n// Tensors setup\r\n\r\nauto input_host_tensor = std::make_unique<caffe2::TensorCPU>(dims, caffe2::CPU);\r\ninput_host_tensor->ShareExternalPointer(some_buffer);  // some_buffer will be filled with the input data\r\nauto input_device_tensor = std::make_unique<caffe2::TensorCUDA>(dims, caffe2::CUDA);\r\nworkspace->GetBlob(predict_net_.external_input(0))->Reset(input_device_tensor.get());\r\n \r\n// Prediction\r\n\r\nwhile(true) {\r\n   FetchData(some_buffer);\r\n   input_device_tensor->CopyFrom(*input_host_tensor);\r\n\r\n  // This is where the leak occurs\r\n   std::thread my_thread(&caffe2::Workspace::RunNet, workspace.get(), predict_net.name());\r\n\r\n  //\r\n  // some host code\r\n  //\r\n\r\n  my_thread.join();\r\n}\r\n\r\n', '\r\nLinux=Ubuntu 16.04.4 LTS\r\ncmake 3.5.1\r\ngcc 5.4.0\r\nNVIDIA CUDA 8.0\r\nNVIDIA cuDNN v6.0\r\nPytorch built from source (version to date is v1.0rc1)\r\n']"
731,20794,0,"pytorch1.1.0 windows than one operator "" "" matches these operands. When I compile the c++ extension on windows with pytorch1.1.0. I get the following error.
How to resolve the question? Thanks!
E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(190 than one operator ""<"" matches these operands:
            built-in operator ""arithmetic < arithmetic""
            function ""operator<(const __half &, const __half &)""
            operand types are: c10::Half < c10::Half

E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(191 than one operator ""<="" matches these operands:
            built-in operator ""arithmetic <= arithmetic""
            function ""operator<=(const __half &, const __half &)""
            operand types are: c10::Half <= c10::Half

E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(192 than one operator "">"" matches these operands:
            built-in operator ""arithmetic > arithmetic""
            function ""operator>(const __half &, const __half &)""
            operand types are: c10::Half > c10::Half

E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(193 than one operator "">="" matches these operands:
            built-in operator ""arithmetic >= arithmetic""
            function ""operator>=(const __half &, const __half &)""
            operand types are: c10::Half >= c10::Half

E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(194 than one operator ""=="" matches these operands:
            built-in operator ""arithmetic == arithmetic""
            function ""operator==(const __half &, const __half &)""
            operand types are: c10::Half == c10::Half

E:/Program Files/Python35/lib/site-packages/torch/include\THC/THCNumerics.cuh(196 than one operator ""!="" matches these operands:
            built-in operator ""arithmetic != arithmetic""
            function ""operator!=(const __half &, const __half &)""
            operand types are: c10::Half != c10::Half. []"
519,371,0,"nn.Embedding CUDA ""too many resources requested for launch"". Looks like nn.Embedding backwards doesn't work when the batch size is >1024. I think it switches sorting algorithms to something that runs out of registers.

Here's a repro:


Running it on K40:


cc @wickedfoo. ['\r\nimport torch\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\n\r\nlut = nn.Embedding(10000, 10).cuda()\r\nout = lut(Variable(torch.range(1,1024).long().cuda())).sum()\r\nout.backward()\r\nprint(""1024 worked"")\r\nout = lut(Variable(torch.range(1,1025).long().cuda())).sum()\r\nout.backward()\r\nprint(""1025 worked"")\r\n', '\r\n1024 worked\r\nTHCudaCheck FAIL file=/home/alerer/local/pytorch/pytorch/torch/lib/THC/generated/../generic/THCTensorSort.cu line=153 error=7 : too many resources requested for launch\r\nTraceback (most recent call last):\r\n  File ""memtest.py"", line 10, in <module>\r\n    out.backward()\r\n  File ""/data/users/alerer/pytorch/pytorch/torch/autograd/variable.py"", line 99, in backward\r\n    self._execution_engine.run_backward((self,), (gradient,), retain_variables)\r\n  File ""/data/users/alerer/pytorch/pytorch/torch/nn/functions/thnn/sparse.py"", line 86, in backward\r\n    1\r\nRuntimeError: cuda runtime error (7) : too many resources requested for launch at /home/alerer/local/pytorch/pytorch/torch/lib/THC/generated/../generic/THCTensorSort.cu:153\r\n']"
429,4872,0,"Memory leak CUDNN 7003. I updated pytorch to 0.3 using conda. I realized that there is a memory leak in RAM in my experiments. Later, I tried to compile from source python with CUDNN 6... and 7005, other versions of CUDNN solved the problem. Is it possible to update CUDNN (from 7003 to 7005) in conda/pip packages? 

. []"
338,27406,0,"[jit] String frontend doesn't support default arg values. 

cc @suo. []"
522,23222,0,"Maybe there is a problem when using random.shuffle(). ## üêõ Bug

When I applied the random.shuffle to a 1-D tensor, the num in the tensor was changed.

## To Reproduce

Steps to reproduce the behavior:
1.Do as follows:
->a = torch.arange(10)
->random.shuffle(a)

## Expected behavior
Expected: 
  tensor([1, 8, 5, 3, 9, 0, 2, 6, 4, 7])
but I got:
  tensor([0, 1, 2, 1, 4, 5, 1, 5, 7, 4])

I am not sure whether it's a bug.

## Environment

Python 3.7.0
torch 1.1.0
. []"
425,4048,0,"Feature request: ModuleDict, like ModuleList. Self-explanatory. Currently there is no easy way to maintain a dictionary as an attribute of a Module whose values are themselves Modules that need to be registered. Introducing a ModuleDict class that functions the same as a ModuleList, except it exposes a dictionary interface, would resolve this. This has the following practical benefits for users:

1) Checkpointing is much better with a ModuleDict that has strings as keys and Modules as values than a ModuleList. I have personally run into problems when I change the order of modules in my ModuleList and try to load old checkpoints, because the checkpoint key names are order-dependent with ModuleLists, so it breaks my code.

2) It combines the advantages of a ModuleList (dynamic assignment of Modules to a class) with the advantages of using named attributes (documentation / readability / sane module names in checkpoints).

Another pro is that this is very simple to implement. Here is a first pass, if there is support for this feature I will clean it up and submit this as a PR:

. ['python\r\nclass ModuleDict(Module):\r\n    r""""""Holds submodules in a dict.\r\n    ModuleDict can be indexed like a regular Python dict, but modules it\r\n    contains are properly registered, and will be visible by all Module methods.\r\n    Arguments:\r\n        modules (dict, optional): a list of modules to add\r\n    Example::\r\n        TODO.\r\n    """"""\r\n\r\n    def __init__(self, modules=None):\r\n        super(ModuleDict, self).__init__()\r\n        if modules is not None:\r\n            self.update(modules)\r\n\r\n    def __getitem__(self, key):\r\n        return self._modules[key]\r\n\r\n    def __setitem__(self, key, module):\r\n        return setattr(self, key, module)\r\n\r\n    def __len__(self):\r\n        return len(self._modules)\r\n\r\n    def __iter__(self):\r\n        return iter(self._modules)\r\n\r\n    def keys(self):\r\n        return self._modules.keys()\r\n\r\n    def items(self):\r\n        return self._modules.items()\r\n\r\n    def values(self):\r\n        return self._modules.values()\r\n\r\n    def get(self, key, default=None):\r\n        if default is not None:\r\n            return self._modules.get(key, default)\r\n        return self._modules.get(key)\r\n\r\n    def update(self, modules):\r\n        r""""""Updates modules from a Python dict.\r\n        Arguments:\r\n            modules (dict): dict of modules to append\r\n        """"""\r\n        if not isinstance(modules, dict):\r\n            raise TypeError(""ModuleDict.update should be called with a ""\r\n                            ""dict, but got "" + type(modules).__name__)\r\n        for key, module in modules.items():\r\n            self.add_module(key, module)\r\n        return self\r\n']"
638,671,0,"Conv3d needs a no-bias option. Right now, VolumetricConvolution in THNN doesn't mark or handle bias=NULL cases. []"
27,20125,1,"NCCL hang in PyTorch Distributed Data Parallel for Mixed Precision Training. ## üêõ Bug

On an AWS p3.16xlarge machine, I'm using the mixed precision training from https://github.com/NVIDIA/Megatron-LM checked in at https://github.com/cybertronai/transformer-xl
When I run with [adaptive softmax](https://github.com/cybertronai/transformer-xl/blob/master/mem_transformer.py#L477) with 8 GPUs and [apex mixed precision](https://github.com/cybertronai/transformer-xl/blob/master/fp16_opt.py), NCCL hangs. When I remove , it works as expected (after reducing batch size to avoid OOM). If I remove  it also works fine, so it's definitely a mixed precision issue.

Sorry if this is a dup of #11672 but I haven't been able to figure it out.

## To Reproduce

Steps to reproduce the behavior:
On a p3.16xlarge


In the [logs](https://github.com/NVIDIA/nccl/files/3144052/combined.txt) I found this:

How do I figure out where this is coming from?  Is this something my code should account for or is it a bug in DDP or apex?

## Expected behavior
Doesn't hang silently.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).


## Additional context

. ['sh\r\ngit clone https://github.com/cybertronai/transformer-xl\r\ncd transformer-xl\r\npip install -r requirements.txt\r\n# Download dataset to ./data/wikitext-103/ then\r\nNCCL_DEBUG_FILE=log.%h.%p NCCL_DEBUG_SUBSYS=COLL NCCL_DEBUG=INFO NCCL_MIN_NRINGS=16 NCCL_MAX_NRINGS=16  python -m tor\r\nch.distributed.launch --nproc_per_node=8 --nnodes=1 --node_rank=0 --master_addr=172.31.20.228 --master_port=6016 train.py --seed 1111 --data data/wikitext-103\r\n --dataset wt103 --adaptive --log_interval 100 --eval_interval 500 --max_tokens 1500000000 --logdir /ncluster/runs/ben-no-bpe.13 --distributed --lr 0.0005 --b\r\natch_size 4 --eta_min 5e-05 --n_layer 18 --d_model 1024 --n_head 16 --d_head 64 --d_inner 4096 --dropout 0.2 --dropatt 0.2 --optim lamb --warmup_tokens 300000\r\n0 --tgt_len 128 --mem_len 128 --eval_tgt_len 128 --fp16 --dynamic_loss_scale  --init_std 0.005 --div_val 4 \r\n', '\r\nip-172-31-20-228:22326:22707 [3] NCCL INFO AllReduce: opCount 5 sendbuff 0x7fcf6b400000 recvbuff 0x7fcf6b400000 count 1322459 datatype 6 op 0 root 0 comm 0x7f\r\ncfc403a800 [nranks=8] stream 0x563efa445460\r\nip-172-31-20-228:22327:22327 [4] NCCL INFO AllReduce: opCount 5 sendbuff 0x7fb11f71c200 recvbuff 0x7fb11f71c200 count 1 datatype 4 op 0 root 0 comm 0x7fb09c03\r\na800 [nranks=8] stream 0x55c779123600\r\n', '\r\nPyTorch version: 1.0.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 16.04.6 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609\r\nCMake version: version 3.12.2\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration:\r\nGPU 0: Tesla V100-SXM2-16GB\r\nGPU 1: Tesla V100-SXM2-16GB\r\nGPU 2: Tesla V100-SXM2-16GB\r\nGPU 3: Tesla V100-SXM2-16GB\r\nGPU 4: Tesla V100-SXM2-16GB\r\nGPU 5: Tesla V100-SXM2-16GB\r\nGPU 6: Tesla V100-SXM2-16GB\r\nGPU 7: Tesla V100-SXM2-16GB\r\n\r\nNvidia driver version: 410.104\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.15.4\r\n[conda] blas                      1.0                         mkl\r\n[conda] cuda100                   1.0                           0    pytorch\r\n[conda] mkl                       2019.3                      199\r\n[conda] mkl-include               2019.3                      199\r\n[conda] mkl-service               1.1.2            py36he904b0f_5\r\n[conda] mkl_fft                   1.0.10           py36ha843d7b_0\r\n[conda] mkl_random                1.0.2            py36hd81dba3_0\r\n[conda] pytorch                   1.0.1           py3.6_cuda10.0.130_cudnn7.4.2_0    pytorch\r\n[conda] pytorch-lamb              0.0.0                     <pip>\r\n[conda] pytorch-pretrained-bert   0.6.2                     <pip>\r\n[conda] torchvision               0.2.1                      py_2    pytorch\r\n']"
109,7480,0,"[caffe2] How to use multiple CPUs?. I want to run a caffe2 model on multiple CPUs (evaluation).

Is there a way to do that directly? Maybe it requires OpenBLAS?

I don't think is it possible to use multiprocessing and call RunNet on different workspaces.. []"
195,11907,0,"Please rename package pytorch to stay consistent with entire python world. Hi,
 Like many, I installed pytorch, which says it is installing the package 'pytorch' and yet it is called 'torch' when you attempt to import it from python.

This cuts against the standard practices of the entire python world. Please remedy.

thanks!. []"
707,10041,0,"[JIT] Support torch.distributions.utils.broadcast_all(). ## Problem

The main blocker to using torch.distributions in the JIT is the  function that is used in every distribution's  method. Currently  calls  under the hood, which results in a JIT error

An expensive workaround is to replace the non-jittable  invocation with a  which is jittable, roughly


## Proposed solution

@soumith and @neerajprad suggested implementing a C++ version of , which would have the added benefit of speeding up non-jitted code.. ['\r\nRuntimeError: expected int at position 0, but got: Tensor\r\n', 'diff\r\n- broadcast_shape = torch.Size()\r\n- for i in tensor_idxs:\r\n-     broadcast_shape = torch._C._infer_size(values[i].shape, broadcast_shape)\r\n+ broadcast_shape = sum(values).shape    # expensive workaround\r\n']"
223,1357,0,"ConvNd C implementation doesn't check tensor types. the error only happens in very specific conditions. (change the view of input tensor and use weight converted from numpy array.)
 
The output of functional conv2d is far off in scale (e12 or so.) . ['\r\nimport torch\r\nimport torch.nn as nn\r\nimport numpy as np\r\nfrom torch.autograd import Variable\r\nfilter_size = 5\r\na = torch.randn(3,3,64,64) \r\nweights = np.random.rand(25).reshape(5,5)\r\nweights = torch.from_numpy(weights.reshape(1,1,5,5)) \r\nout1 = nn.functional.conv2d(Variable(a.view(9,1,64,64)), Variable(weights)) \r\npsi = nn.Conv2d(1,1, filter_size, bias=True) \r\npsi.weight.data.copy_(weights) \r\npsi.bias.data.fill_(0)\r\nout2 = psi(Variable(a.view(9,1,64,64))) \r\nprint(out1.mean())\r\nprint(out2.mean()) \r\n']"
391,6518,0,"[PyTorch] torch.Tensor and torch.Tensor.dtype have confusing repr. 
I expect to at least see  print  by default.

cc @gchanan . [""python\r\n>>> torch.Tensor\r\n<class 'torch.Tensor'>\r\n>>> torch.Tensor.dtype\r\n<attribute 'dtype' of 'torch._C._TensorBase' objects>\r\n""]"
144,30015,0,"JIT fails for multihead attention. ## üêõ Bug

I can run the model before torchscript while the torchscripted model fails in running time for the multihead attention @driazati

## To Reproduce

The following code sample:


## Expected behavior



## Environment

bento classyvision env


cc @suo. ['python\r\nimport torch\r\nimport torch.nn as nn\r\n\r\ndef _lengths2mask(lengths: torch.Tensor, seq_len: int, lt=torch.tensor(True)) -> torch.Tensor:\r\n    """"""\r\n    Input lengths is a tensor of shape (batch_size) with value in [0, seq_len],\r\n    Return a tensor of shape (batch_size x seq_len) with binary value\r\n    """"""\r\n    if lt:\r\n        return torch.lt(\r\n            torch.arange(seq_len, device=lengths.device)[None, :],\r\n            lengths[:, None].long(),\r\n        )\r\n    else:\r\n        return torch.ge(\r\n            torch.arange(seq_len, device=lengths.device)[None, :],\r\n            lengths[:, None].long(),\r\n        )\r\n\r\nclass AttentionMultihead(nn.Module):\r\n    def __init__(self, dim_in, method, use_variable_lengths=False, num_heads=1):\r\n        super(AttentionMultihead, self).__init__()\r\n\r\n        # choose from supported attention methods\r\n        assert method in (""multihead"")\r\n        self.method = method\r\n        self.use_variable_length = use_variable_lengths\r\n        \r\n        self.attention = nn.MultiheadAttention(\r\n            embed_dim=dim_in, num_heads=num_heads\r\n        )\r\n\r\n        # record output dim\r\n        self.dim_out = dim_in\r\n\r\n    def forward(self, data: torch.Tensor, lengths: torch.Tensor):\r\n        assert data.dim() == 3, ""Require input shape (batch_size x seq_len x embed_dim)""\r\n        \r\n        if self.use_variable_length is True:\r\n            mask = _lengths2mask(lengths.clamp(min=1), data.size(1), torch.tensor(False))\r\n        else:\r\n            mask = None\r\n\r\n        data = data.transpose(0, 1)\r\n        attn_output, attn_weights = self.attention(\r\n            data, data, data, key_padding_mask=mask, need_weights=True, attn_mask=None\r\n        )\r\n        # transpose output data to (batch_size, seq_length, embed_dim)\r\n        attn_output = attn_output.transpose(0, 1)\r\n        \r\n        return attn_output, lengths, attn_weights\r\n\r\n    \r\nclass DeployAttentionMultihead(torch.nn.Module):\r\n    def __init__(self, dim_in=100, length=torch.tensor([300])[0]):\r\n        super(DeployAttentionMultihead, self).__init__()\r\n        self.length = length\r\n        self.use_variable_length = True\r\n        self.attention = AttentionMultihead(dim_in=dim_in, method=""multihead"", use_variable_lengths=True, num_heads=5)\r\n        \r\n    def forward(self, data: torch.Tensor, lengths: torch.Tensor) -> torch.Tensor:\r\n        attn_output, lengths, attn_weights = self.attention(data, lengths)\r\n        return attn_output\r\n    \r\nmodel = DeployAttentionMultihead()\r\n\r\nts_model_multihead = torch.jit.script(model)\r\nprint(ts_model_multihead.code)\r\n\r\n# run ts model of multihead\r\n\r\nvue_clip_emb = [0.0840825,5.65534,2.23576,2.21367,1.5883,0.493749,0,1.49034,1.54749,1.15795,0.118591,2.54162,2.70971,2.10865,0.115242,0.0115912,5.39253,2.83803,1.96323,0.935772,1.33328,1.16219,0.15678,1.33033,0,2.80253,0.258661,1.19186,0.429935,1.14404,4.58615,0.11558,2.31151,3.45441,0.117317,2.62973,2.57802,3.12865,0.632287,0.280647,1.08333,4.14262,3.5503,0.67525,0.889924,0.128302,3.943,0.825888,3.11752,2.46894,4.05448,3.0315,5.9825,2.54857,0.390271,0.105513,1.76064,3.53628,0.496927,0.850136,3.52684,1.92267,1.50376,3.43571,2.36993,0.0011008,0.101535,0.324544,0.875401,1.6104,0.497361,1.72176,4.01326,1.31662,0.262011,0.837993,0.622429,2.66528,1.13911,1.21707,1.56516,6.33717,1.5675,0.136495,0.355789,1.48718,0.108055,3.47766,1.0657,0.00356666,1.77421,3.86285,1.42049,0.819946,0.340235,0.109702,0.867129,2.71539,0.206769,2.02203,0.0292637,5.49686,1.74569,2.19925,1.51534,0.46074,0.0161071,1.24292,1.44666,0.562175,0.104977,2.05992,2.41354,2.51859,0.165397,0.011803,4.64355,4.19187,2.1993,1.15172,1.72702,1.62523,0.343265,1.45464,0,2.05193,0.619562,0.983955,0.432762,1.09673,4.58744,0.209633,2.02799,3.54795,0.156958,2.19384,2.25872,2.84524,0.120264,0.432246,0.800701,3.83577,3.56383,0.501572,0.458101,0.0500416,3.77406,0.618967,2.51559,2.57312,3.63771,4.04265,5.3371,2.427,0.555011,0.393777,1.45245,4.48355,0.642099,1.48505,3.90371,2.12527,1.10275,3.13394,2.88107,0,0.0938793,0.432923,1.40834,1.47035,0.199206,0.899871,4.19796,1.37373,0.108242,0.541182,0.60768,2.56032,1.05987,1.05486,2.31946,6.57515,1.71218,0.191091,0.523715,0.562181,0.163343,3.41128,1.90795,0.103194,2.18321,4.01785,1.40121,0.712813,0.40542,0.0130574,0.482167,3.61689,0.541964,1.54621,0.00721372,3.53875,1.99706,2.16941,2.30858,0.139537,0.0292894,0.59817,1.67502,1.06869,0.15484,1.32557,2.84414,1.81534,0.0359029,0.155307,4.85468,3.37413,1.90302,1.30877,0.734729,1.76238,0.150899,0.547858,0.0230488,2.15477,0.665912,2.1411,0.486219,0.981247,4.02336,0.340909,2.64124,1.94704,0.127592,2.22661,3.51697,2.28332,0.23371,0.0208469,0.71869,3.26233,3.37803,0.440662,0.510871,0.00753081,5.16184,0.492385,2.8764,2.53306,2.73119,3.92737,4.78175,3.25056,0.738502,0.171556,1.14462,4.28251,0.983006,1.13122,3.53485,1.87881,0.758899,3.47704,3.11202,0.00754782,0.223614,0.554179,2.12652,1.15958,0.225096,1.4953,3.90192,1.51579,0.0205165,1.09822,0.339162,3.14576,2.58463,0.766622,2.68842,5.81371,1.30858,0.0567763,0.362448,0.427235,0.103554,1.55612,1.40707,0.327143,2.06921,3.1817,1.11314,0.293359,0.491569,0.0237787,0.335975,1.49355,0.080589,0.798883,0.0042814,4.00296,1.46194,1.97508,2.93223,0.369621,0.114972,1.43744,0.953024,1.51951,0.0664168,1.36838,1.12008,2.37583,0.0656217,0.0550487,5.11532,3.41184,2.20438,1.50039,1.4365,1.97503,0.0544394,1.24929,0.00753079,1.44055,0.312355,1.65135,0.778141,0.717496,3.53737,0.872259,1.93065,2.75865,0.0802059,2.52429,2.25681,2.45514,0.0332121,0.272185,1.78893,4.1729,3.72535,0.296955,0.977887,0.0917793,5.16411,0.227299,2.63355,2.93526,3.32066,3.49133,3.54922,3.74034,0.651864,0.379803,1.49085,4.07919,0.729488,0.412124,3.82536,0.844314,0.661833,2.39382,2.20183,0.0319286,0.20516,0.6255,1.46891,1.14456,0.44578,1.54798,4.63112,1.32129,0,0.868121,0.800939,4.08268,1.32296,0.520707,3.65064,6.09133,0.723082,0.158022,0.261037,0.397029,0.0556116,2.45283,1.20808,0.051552,1.35081,3.32664,0.930835,0.830775,0.637906,0.00174865,0.0430316,1.45825,0.147698,1.924,0.00532853,3.77304,1.63318,1.94748,2.129,0.0999379,0.0187992,0.764959,1.12453,0.710663,0.221404,1.04146,2.84609,2.1028,0.0512187,0.0633501,4.60868,4.72056,1.81119,1.71785,1.46575,1.1067,0.22531,1.22568,0.0114571,1.80884,0.322822,1.30182,0.343267,0.780105,4.02635,0.468035,2.11109,2.30884,0.225344,1.73228,3.32626,2.14921,0.0652682,0.179686,0.794495,4.04693,3.94471,0.479574,0.372132,0.0392945,5.12383,0.643861,3.05057,2.2246,3.45714,4.82734,4.22932,3.33674,0.602254,0.160737,1.20358,5.0604,0.894768,1.28898,4.45525,1.44087,0.816369,1.96161,3.89633,0.0192901,0.130743,0.526546,0.911684,0.790611,0.290481,0.535833,3.96858,0.660851,0.183099,1.0221,0.527058,2.76179,2.45929,0.418104,1.77804,6.29833,1.67065,0.412998,0.493972,0.239688,0.143934,2.45849,2.14727,0.0778733,2.5178,3.35156,1.2997,0.506005,0.775292,0.0188194,0.447015,2.64902,0.5688,1.19909,0.0417836,3.4061,2.37674,1.87274,1.59598,0.440209,0.0390666,0.459501,1.47975,2.99328,0.293728,3.44896,2.98324,0.377933,0.136621,0.0858318,3.94416,2.30151,1.82907,2.10093,0.403424,1.47967,0.348227,1.58975,0.0860919,1.47215,0.111787,3.21831,2.28628,1.27021,2.6389,0.099854,2.80626,1.31564,0.256794,2.7791,3.04503,3.35439,0.637234,0.873176,1.78056,1.96819,3.70617,0.573749,0.86824,0.0227969,4.80532,1.19482,4.30919,3.18403,2.90808,3.55253,5.32479,2.20803,0.292511,0.917928,0.917466,3.6687,1.65847,1.24795,2.66524,0.583895,1.36363,3.3847,3.8937,0.104704,0.242911,1.92325,1.26514,1.42388,0.702984,2.26055,4.22127,0.507518,0.104398,1.00863,1.40142,2.62522,3.89506,0.304073,1.87341,4.88558,0.57671,0.101682,0.376967,0.151231,0.302362,0.964678,0.314604,0.357943,2.24616,3.35078,0.934013,0.87141,0.291341,0.00906326,0.116968,0.5981,0.0642974,0.59632,0.070716,3.52079,2.46395,2.44951,2.9654,0.663779,0.298566,0.532495,0.605621,1.02062,1.23134,2.30953,2.70189,0.311687,0.250861,0.157656,2.54278,1.19941,1.6287,1.38798,0.378133,1.65116,0.462127,2.0553,0.183922,1.911,0.26869,2.17268,1.65513,1.10857,1.4878,0.285458,3.24843,1.04712,1.4921,2.49815,3.25619,2.89996,0.615719,1.52029,1.29669,0.594365,3.33981,0.7246,0.386914,0.18093,3.73587,1.15124,4.20692,2.63089,4.41739,4.75388,4.79367,1.61047,0.177007,1.5846,2.15091,2.80859,2.03466,1.22181,1.88013,0.966551,1.62572,2.95286,3.22257,0.171248,0.0488555,1.50401,0.564802,1.11984,1.97094,1.09832,4.79174,1.00213,0.0561535,1.06735,2.31487,3.13783,3.00876,0.280711,1.51538,4.03358,0.577055,0.256786,0.520065,0.197432,1.37471,1.67807,0.111243,1.28862,3.27064,3.1356,0.810865,0.226676,0.090544,0.923369,0.273451,0.463472,0.740315,0.466818,0.0792522,3.41677,1.65213,1.87478,2.9709,0.649614,0.287107,0.742373,2.44696,1.98299,0.362439,3.38517,3.0017,1.15386,0.123824,0.71546,3.2347,2.01491,1.11258,2.1084,1.17668,1.4841,0.585114,2.00054,0.0496953,1.25047,0.316964,2.6968,1.75643,0.580133,1.54092,0.0531415,2.72435,1.84557,0.622192,2.4177,3.2615,2.47776,0.355572,1.18969,2.80585,1.48045,2.73792,1.27207,1.31757,0.00647418,5.56059,0.929273,2.86031,2.55737,3.45009,1.33754,4.2221,2.44413,0.265876,1.38801,0.652557,2.74723,2.27915,1.15483,2.48536,0.862942,1.00924,2.87263,2.60592,0.341337,0.789075,2.61353,1.51038,1.42327,0.692666,1.54161,4.74268,2.04178,0.52153,1.57625,1.82753,2.29875,2.95661,0.794998,2.05961,4.72058,1.10073,0.154321,0.499115,0.0518899,0.51693,0.409915,0.405275,0.53946,2.23644,2.72192,0.94019,1.03312,0.339981,0.0105235,0.0286632,0.641563,0.176992,1.62913,0.173662,2.71067,1.12456,0.980614,1.26853,0.502585,0.0405315,0.0835886,0.801681,2.17712,0.600408,2.7253,3.26336,1.98236,0.19047,0.160637,4.27236,4.15545,0.692021,2.13214,1.37671,1.35437,1.51932,0.632685,0,2.57451,0.0496026,3.45484,0.800954,1.08736,2.65716,0.288336,3.76113,0.877107,0.343407,1.93358,3.87112,3.22765,0.771835,0.544815,2.16071,3.16342,1.80419,0.929744,2.37628,0.0166744,5.67011,0.584775,4.03636,2.40968,1.96826,2.96728,4.39782,2.26301,1.22459,0.56253,0.861167,3.46662,0.947368,1.0488,3.56452,1.12366,1.08122,3.01743,2.8018,0.545803,0.861587,0.610711,1.44031,0.526162,0.620491,1.9175,3.08667,0.663501,0.35154,1.79684,0.938363,2.92849,2.60115,0.880397,2.2393,5.30998,0.792989,0.532533,0.38656,0.475731,0.0857692,0.487966,1.6554,0.17406,3.03141,2.42888,2.00751,0.879513,0.731286,0.102841,0.637661,0.50266,0,1.66406,0.0403251,2.60657,1.94436,0.987926,2.60567,0.490878,0.00202899,0.331029,2.03788,2.20193,1.82084,3.72021,3.44797,0.278736,0.0147163,0.169737,3.7098,2.93405,1.24039,2.8275,0.505545,1.41782,0.345053,1.34328,0.0294194,2.0961,0.0848584,3.29406,1.32525,2.41475,3.38123,0.0721113,2.92625,0.847645,0.420569,1.33231,3.7629,2.30329,0.388465,1.12179,2.35953,1.66306,2.70488,0.503543,0.822229,0,4.34317,0.605498,5.77145,1.83385,1.98237,3.45013,5.29985,2.02454,0.0475114,0.395792,2.11374,3.54273,0.528591,1.56819,3.8756,0.558113,0.941327,2.41993,3.57062,0.187795,0.31701,1.55603,0.604092,0.648071,0.516138,1.93505,3.75648,0.439664,0.0350492,1.06238,2.00205,3.3981,4.43062,0.284624,1.01425,4.71788,0.761708,0.0611976,1.14644,0.125763,0.42916,0.839016,0.331764,0.328137,3.00843,3.59455,1.00545,0.717833,0.128019,0.00645771,0.328582,0.54553,0.188525,0.895525,0.0408872,3.24783,2.71351,2.49815,2.20143,0.676868,0.0287524,0.661264,1.41991,1.15123,0.467025,1.38601,2.40322,0.770031,0.00989118,0.386181,3.90587,4.04182,1.06631,1.77359,1.07598,1.38183,0.577455,1.14628,0.0020014,2.77807,0,2.90588,0.480905,1.61046,3.46837,0.355569,0.968912,1.83375,0.248112,2.19061,3.11325,2.65638,0.0367746,0.0603686,1.67572,2.31816,3.60933,1.29633,0.11909,0.0600984,5.61985,0.720068,2.48464,2.86905,2.13853,1.98833,3.15317,2.22118,0.639354,1.25785,0.281851,2.72698,0.921203,2.52241,1.82059,0.669081,0.100118,1.23264,3.06482,0.0135905,0.641079,0.403843,0.999941,1.04065,2.18396,1.00285,1.85417,0.877147,0.144436,2.53481,0.977721,1.64681,3.45587,0.818207,2.53121,4.49658,0.887782,0.234846,1.14279,0.659315,0.109713,1.36542,0.899438,0.175104,2.23193,2.60381,1.32821,0.915714,0.445052,0.00288133,0.163356,0.982402,0.0125229,0.666454,0.0555231,2.31373,1.38932,2.6543,1.35873,0.143295,0,0.226475,1.68297,0.660947,0.487611,1.4304,4.92722,1.75121,0,0.143175,3.02567,3.35532,0.272801,1.61775,0.645526,0.531874,0.614343,1.03124,0.0053275,3.25492,0.00264338,2.77116,0.430088,0.649697,2.29188,0.722446,2.50275,0.544916,0.204628,1.21149,3.88391,2.39757,0.000352105,0.212974,0.0384491,4.97835,2.7165,1.15199,0.413043,0.0146025,4.46414,0.0112177,2.61585,0.861757,2.28923,3.35354,5.43353,1.99584,1.30369,0.10671,0.500256,5.71459,0.963861,3.3774,3.52604,0.217327,0.0892254,3.19477,4.90951,0.10896,0.394621,0.600351,0.810254,0.513302,0.580245,1.14567,1.09709,0.362707,0.198018,1.85646,0.661291,3.34353,3.2775,0.385556,0.675552,6.33126,1.56004,0.641665,0.847008,1.38089,0.0555137,1.03894,1.94796,0.00552486,3.4941,3.26301,1.9274,0.253463,1.10076,0.0425154,0.904492,2.41034,0.0463368,1.52589,0.0862676,2.75297,1.88521,2.06296,1.15305,0.212366,0,0.394245,1.78298,0.888924,0.672979,1.35533,4.45294,1.48784,0.0605392,0.176757,4.75529,3.85554,0.844591,2.16973,0.272653,1.32838,0.688873,1.4805,0.00044684,2.74095,0.0685647,2.77912,1.24349,1.33388,3.78668,0.0939944,2.98083,1.01641,0.336904,2.41045,3.56117,2.63229,0.0388405,0.126486,0.872781,4.13501,2.94543,1.10456,0.801741,0,4.4144,0.153719,4.29423,1.82199,2.28633,3.094,5.33176,2.21881,0.693673,0.156806,1.09274,4.26824,0.379416,2.21975,3.53672,1.08108,0.89244,3.1856,4.76257,0.0451743,0.0949684,0.228956,0.373762,0.289384,1.2531,1.81112,2.30036,0.625152,0.00985754,1.77277,0.283007,3.30557,3.30533,0.619986,1.35398,6.38698,1.73076,0.126091,0.871414,0.356507,0.174712,1.66457,1.17135,0.0491385,2.67154,4.05349,2.17985,0.523685,0.576262,0.157504,0.308839,1.56192,0.0512652,0.95207,0.0805058,2.48621,1.37535,2.45468,1.87533,0.468265,0.122033,0.321863,1.33016,0.549338,0.494591,0.874955,2.63495,0.740472,0.0438563,0.141534,3.29394,3.68166,1.18674,1.08292,0.244218,1.11172,0.828344,1.42215,0.00554828,1.77962,0.189551,2.12145,0.546716,1.04505,3.95568,0.3655,2.37688,1.71594,0.224391,2.74793,3.33626,2.97977,0.122376,0.0632366,0.972671,2.11059,2.25442,0.85038,0.124168,0.0187264,4.50107,0.534927,3.1567,2.6244,2.49565,3.01174,4.25579,1.62496,0.592326,1.05417,0.562298,3.77764,1.02897,1.90008,2.77085,1.05659,0.747173,2.30213,3.18592,0.0147369,0.023573,0.207013,1.03249,0.925702,0.932221,1.22497,2.04939,0.744914,0.328359,1.31802,0.387632,1.70093,2.47217,1.20024,1.79619,5.47078,1.69118,0.165774,0.794053,0.341791,0.129126,1.44495,1.19076,0.0475776,2.66236,3.06191,2.4638,0.453825,0.488893,0.0543923,0.0634928,1.52558,0.22285,0.553228,0.221582,2.48304,1.022,1.56536,2.29826,0.209171,0.138548,0.309978,1.81818,1.4621,1.09224,2.08636,2.86538,0.603495,0.366823,0.329206,3.08912,2.58224,0.700127,2.0108,0.0986592,2.0601,0.895608,1.33536,0.101057,1.51155,0.290049,2.36485,1.46373,1.06817,3.15438,0.0736844,2.95347,1.35243,0.867988,2.56145,3.61033,1.72861,0.562523,0.60729,1.96837,1.20481,4.01519,1.00243,1.17049,0.0626663,4.00606,0.959066,4.73986,3.9961,2.07039,1.85597,4.51874,2.15147,0.0866293,0.160415,0.776263,3.42877,1.5827,1.208,3.27742,1.12566,1.38087,2.50217,2.11579,0.168926,0.47073,0.789089,1.18347,0.692235,0.859697,2.53243,2.11629,0.874951,0,1.84621,1.05134,2.79519,4.17778,2.43341,1.46079,4.95973,0.990473,0.00451488,0.498543,0.136919,0.747515,1.02114,0.164363,0.20047,2.40017,2.5119,2.07164,1.25656,0.222824,0.0637718,0.0677823,0.407466,0.0305444,1.12243,0.191263,2.95274,0.788903,2.04562,0.821009,0.390528,0.106878,0.290616,0.74644,1.30808,0.7783,2.74388,3.67038,3.43589,0.0119235,0.327381,4.70921,3.99718,0.309318,1.34281,0.799294,0.795629,2.50191,0.502497,0.0563869,3.90016,0.16275,2.25545,0.906753,0.884097,3.51065,0.653698,3.58473,1.43594,0.368113,3.07226,3.27478,2.61307,0.0926574,0.20586,1.01696,3.96841,1.73393,1.60189,1.61205,0.332741,5.6585,0.151749,3.11497,1.19252,2.06011,2.88685,5.18958,1.93425,1.74641,0.143624,0.980521,3.32435,0.240595,2.76726,3.43182,0.829861,0.513481,3.03082,3.14267,0.450467,0.384188,0.203941,1.57999,0.0863299,1.05067,1.62805,2.49849,0.624522,0.0210923,3.38103,0.0787131,3.06627,3.05254,0.724761,2.51799,5.99396,1.44315,0.48246,0.460933,1.27126,0.178611,0.842834,2.41634,0.0746336,2.28044,1.60962,1.77188,0.850597,1.19109,0.296519,0.604338,1.35025,0,0.855787,0.24927,2.99181,2.2486,2.37542,1.3126,0.350791,0.024723,0.201999,1.45714,1.48941,1.53887,2.55214,5.06456,0.994865,0.0734257,0.083538,3.51118,2.41169,0.631832,2.0792,0.115151,2.3912,0.772408,2.02382,0,3.3883,0,2.83265,1.07762,1.06044,3.32062,0.152621,3.1467,0.999532,0.691353,2.18066,4.07433,3.76381,0.564451,0.288695,1.46631,1.80245,3.96539,0.75673,1.25008,0.209399,4.06395,0.238434,5.02981,2.71844,2.61667,2.93738,5.24963,1.91154,0.472515,0.478448,1.34589,4.0873,1.01529,1.9998,4.08209,1.06896,1.46918,4.13979,3.46283,0.222857,0.165366,0.435843,1.03564,0.934988,0.827622,2.30924,2.56759,1.11041,0.339095,2.17876,0.246572,3.56566,2.52839,1.91746,1.52709,7.18276,1.46865,0.0681596,0.578342,0.243158,0.224508,1.52765,0.580382,0.030582,2.47407,4.58363,2.31677,0.465353,0.39472,0.587289,0.213973,0.600313,0.120027,0.89201,0.185326,3.94036,1.52176,2.62566,1.78063,0.208037,0,0.558397,1.04916,0.900976,0.483306,1.48558,3.60931,1.59509,0.0638275,0.0647773,3.8862,3.17611,0.8943,0.841184,0.323702,1.04602,0.258091,1.67474,0,1.82776,0.0908958,1.57279,0.929668,1.49998,4.81248,0.228259,2.91749,2.00505,0.0470934,2.84799,3.22272,3.68171,0.0594875,0.0733745,0.54319,3.34397,2.55439,0.507932,0.75085,0.108581,4.24962,0.145146,3.65904,2.06542,2.62613,3.56953,5.05274,1.96623,0.779482,0.634575,0.948498,4.4603,0.50401,1.81869,3.3978,1.04111,0.447499,2.99711,3.06425,0.0197619,0.0390933,0.276516,0.752591,0.459888,0.672086,2.00618,2.43392,0.363539,0.0871918,1.12805,0.738331,2.49416,1.82035,1.00751,2.02311,6.0054,1.90343,0.143459,0.798544,0.837159,0.103327,1.35308,1.02193,0.0155476,2.08821,4.37539,1.69243,0.628235,0.612107,0.0970055,0.407801,1.79539,0.123628,0.747089,0.163579,2.35004,0.852999,0.910148,1.80315,0.59716,0,0.851198,0.778011,2.19988,0.402101,0.933004,2.09489,3.05333,0.0252962,0.0977166,2.9703,1.6115,1.0476,0.400364,0.66365,0.440661,0.829402,1.43691,0.796235,1.38266,0.161254,0.934144,0.411609,1.29833,2.81847,0.583717,1.70186,2.00263,0.344199,3.56151,1.28074,1.83579,0.0387559,0.0243303,1.23755,4.48576,1.36396,2.05456,0.473,0,3.95411,0.00469383,1.32001,0.745603,1.49426,1.90903,2.37102,0.920934,2.45122,0.736415,0.664711,3.55602,2.10916,0.70585,2.62348,1.12938,0.956224,1.17342,2.17879,1.02419,0.309579,0.363046,1.38165,0.74992,0.428322,1.58538,1.77151,0.166842,1.10562,1.36608,0.289836,1.93779,1.48751,0.142338,1.41565,4.64051,1.12845,1.44624,0.618646,1.53882,0.55646,0.11152,1.63253,0.13781,3.06238,1.53316,2.18355,0.44066,1.92378,0.46227,0.37104,1.70604,0.23205,1.86809,0.102674,3.19703,2.5658,1.93422,2.27114,0.657241,0.0382914,0.290383,1.35741,1.49755,0.741304,2.09531,2.14157,1.03596,0.0978403,0.203721,4.29982,4.3951,1.17579,2.35823,0.722298,1.5228,1.03373,1.08911,0.0532115,1.63872,0.00680868,1.80044,0.4208,2.52569,3.74694,0.2112,1.57353,2.23563,0.457424,3.61216,4.27956,1.83665,0.107581,0.134045,1.37063,2.4452,2.30221,1.81058,1.01463,0.0911855,5.20949,0.789669,4.47411,2.57445,1.41898,1.25783,3.56169,1.19806,0.501017,0.323389,0.956781,1.86047,0.423411,2.34943,2.48705,0.592364,0.878147,1.79065,2.40255,0.415444,0.630449,1.11744,0.658741,0.73657,1.44287,1.21421,2.56012,1.30955,0.0461261,2.81246,0.494368,2.01135,3.04064,1.15881,1.88349,3.73473,0.919362,0.107721,1.49636,0.617467,0.305044,0.784687,1.16902,0.0493862,2.54482,2.76247,1.1756,1.09797,1.07768,0.0691202,0.0770139,0.696618,0.0298994,0.735747,0.0129393,1.88335,0.905986,1.03496,2.101,0.597856,0,0.19022,1.55955,1.9505,1.45855,2.44006,3.13068,0.374842,0.109704,0.0564849,4.41647,3.26477,0.885778,2.43465,0.350469,1.09961,0.447687,1.88259,0.0782037,1.40383,0.0368739,2.70133,1.89626,1.92466,3.58989,0.122527,3.11725,1.05007,0.51717,2.40146,3.33289,1.93742,0.252541,1.02291,2.0183,1.3077,2.65496,1.15508,1.23102,0.000266209,4.37571,1.61635,5.65003,1.84072,1.86486,3.17868,5.39525,1.75413,0.261276,0.306518,0.943247,3.54729,0.883223,1.44945,3.65783,0.709348,1.23866,3.18681,3.92327,0.106278,0.093275,1.28177,0.542254,0.68957,0.528313,1.24936,2.35226,0.303834,0.0594064,1.31486,1.1578,2.43625,4.4125,0.904337,1.00147,4.81197,1.31189,0.0296455,1.11495,0.724461,0.520235,1.25262,0.250807,0.0281229,2.57911,2.92775,2.22562,0.75527,0.242219,0.118131,0.363648,0.497668,0.0814463,1.30973,0.0366483,3.00148,1.25068,1.63096,1.52441,0.621856,0.00641068,0.230657,1.73529,1.45144,0.646578,2.25007,3.25211,0.563205,0.0751726,0.0163225,3.54842,3.84219,1.02355,1.92965,0.817386,1.16032,0.510203,1.44918,0.094062,2.12093,0.18292,2.18219,0.247555,1.35479,3.45437,0.0852659,2.62705,0.895785,0.287165,2.27176,3.76671,2.21876,0.34165,1.02308,1.78778,1.66692,2.17194,0.78184,0.405094,0.0208693,4.54682,0.971125,3.88979,2.00045,2.23424,2.78853,5.28522,2.13774,0.237709,0.150786,0.456535,3.60444,0.698361,1.24292,3.25507,1.02311,0.797662,2.94663,3.29284,0.155182,0.0697566,0.439491,0.730536,0.809481,0.477256,1.35965,2.22005,0.560803,0.0364263,1.49128,0.700289,2.63805,3.72576,0.408458,0.932113,4.24421,1.17882,0.134419,0.657352,0.368504,0.184188,1.30552,0.460816,0.028444,2.41779,2.85773,2.01615,0.72293,0.287015,0.0462368,0.160295,0.856651,0.098313,0.130786,0.046435,2.05407,1.54281,2.34828,2.53102,0.442987,0.0561916,0.268094,1.58142,0.8853,1.28698,2.50667,3.04347,0.423114,0.0185859,0.262836,3.83576,3.57948,0.914873,2.57641,0.271825,1.59572,0.423181,1.84506,0.0146318,1.08426,0.0235161,3.13197,0.697155,1.7896,3.38426,0.0901369,2.18545,1.48666,0.392883,2.32617,3.22082,2.32532,0.0902337,0.145137,1.08237,1.66407,2.63171,1.45994,0.131882,0.0723601,5.2952,0.436551,4.01131,2.07321,1.4268,2.99351,4.44962,1.59591,0.584692,0.999917,0.741395,3.61155,1.21488,2.08004,3.2875,1.06792,0.701226,2.57786,3.9834,0.0356573,0.0402862,0.258593,0.57421,1.35641,0.611022,1.26718,1.16932,1.30904,0.0148628,1.97011,0.861008,1.83741,3.52019,0.66894,1.38401,4.86006,0.991134,0.0453428,0.595723,0.376409,0.243376,1.10378,0.772661,0.104803,2.20183,2.70189,1.8724,0.874469,0.276714,0.0854222,0.109846,0.469759,0.0341609,0.822008,0.0663278,2.82431,1.98922,2.58916,2.33014,0.36916,0.000405256,0.440166,1.42747,2.06229,0.839913,2.56837,3.54221,0.806237,0.0238713,0.0986123,4.16513,3.2629,1.11632,2.24042,0.744196,1.76337,0.456146,1.41652,0.0272024,2.58901,0.167701,2.60603,1.09688,1.16621,3.30133,0.272464,2.55796,1.90589,0.180866,2.41701,3.38609,3.11584,0.191306,0.749476,1.46686,1.90682,2.87457,0.694,0.343411,0.0147392,4.91275,0.464997,3.85381,1.65685,1.67556,3.0329,4.73798,2.09576,0.312937,0.517346,1.04992,3.59476,1.26293,1.085,3.32468,1.59134,1.01859,3.35532,3.53533,0.084303,0.0628613,0.648484,1.09515,1.50538,0.17028,1.40541,2.64826,1.06457,0.100404,2.33836,0.694368,2.53434,3.55765,0.68602,1.77681,5.59932,1.25979,0.0556799,0.505265,0.470065,0.221458,1.14363,0.721429,0.0939817,2.04274,3.13907,1.29704,0.464239,0.875146,0.118063,0.167729,0.691054,0.0293266,0.611965,0.0768707,2.41301,1.51695,1.93647,2.18609,0.344321,0.0389794,0.454889,1.37358,1.48123,0.780079,2.11202,3.10542,0.999507,0.0394063,0.204987,4.05465,3.69151,0.976356,1.60781,0.698079,1.13738,0.537282,1.42179,0.00870474,1.36949,0.023588,2.30823,1.14589,1.14334,3.29495,0.192186,2.55375,1.98119,0.272244,2.98279,3.39615,2.60981,0.0805932,0.603192,1.68799,1.85609,2.74516,0.505839,0.325397,0.0708398,5.28361,0.430745,3.53773,2.20675,1.66348,2.58096,4.62437,2.74623,0.222936,0.392539,1.03132,3.74876,1.04139,1.11657,3.41723,0.882675,0.70088,2.92961,3.14528,0.0404496,0.197252,0.654779,1.25583,0.600679,0.254489,1.76305,2.48888,0.957629,0.0304134,1.98809,0.68718,2.4288,3.55978,0.906977,2.39657,4.87962,1.07763,0.0113303,0.629885,0.284732,0.307247,0.693691,0.863577,0.0309877,1.49964,2.85926,1.40856,0.633111,0.401133,0.0182732,0.0368716,0.753268,0.00673428,0.534558,0.00958632,2.73017,2.39266,2.17597,2.33269,0.836123,0.0222678,0.178695,1.06635,1.69794,1.20227,2.49672,4.13729,0.191926,0.0308835,0.0363431,4.61121,3.23564,1.00583,2.72539,0.298151,2.01082,0.769828,1.96608,0.0858546,2.23029,0.0122647,2.23588,0.633349,1.20338,3.37658,0.0692665,2.29815,1.05922,0.480622,2.08249,4.0234,2.28867,0.415034,0.983109,1.92329,1.10093,1.73856,1.04592,0.487978,0.0242384,4.47649,0.681652,5.14066,1.34459,2.59875,3.29062,4.8603,1.86614,0.227459,0.307617,1.15525,2.771,0.254383,2.10122,3.77412,0.778152,1.06289,3.55692,4.12524,0.0866851,0.039943,0.282242,0.490172,1.49075,0.340438,1.89202,3.13522,0.571204,0.0840356,1.08281,0.748803,2.67685,3.2724,0.322296,1.01903,5.3433,1.32265,0.079348,0.697845,0.370772,0.0963784,1.51029,0.731301,0.0519211,3.12523,3.5217,1.55013,0.490105,0.309106,0.152689,0.126233,0.900529,0.0508995,0.470179,0.0570541,2.93815,1.03723,1.31152,1.88639,0.53211,0.0120982,0.19104,1.59915,0.789835,1.25294,2.21089,3.76776,0.442896,0.0824799,0.0142063,4.1578,3.41276,0.872557,2.83429,0.41081,1.12326,0.520284,2.29224,0.034131,2.31664,0.0527101,1.93802,0.23192,1.07679,3.58917,0.103749,2.88465,0.943151,0.274026,1.80946,4.21325,1.81319,0.25273,0.727642,1.31808,1.68266,2.21464,0.861174,0.387389,0.0198225,3.8402,0.379294,4.60951,1.26635,1.76706,3.3753,4.86082,1.96672,0.269316,0.196363,1.33864,3.62479,0.627859,2.09711,3.85491,0.609686,0.881531,2.71234,3.77832,0.0278493,0.0952197,0.350846,0.639852,0.512732,0.316809,1.29115,2.19078,0.408391,0.0650802,1.27545,0.848432,2.89082,3.46501,0.429315,0.532971,4.65582,1.2727,0.0419573,0.771441,0.57798,0.189393,1.16264,0.666373,0.011883,2.61725,2.62028,2.10185,0.367404,0.307311,0.375864,0.115727,1.16286,0.145557,0.639334,0.0189169,2.85532,1.43457,1.51701,1.08727,0.655423,0,0.39513,1.46804,1.47166,0.837551,2.10679,3.85416,0.534801,0.0470078,0.124029,3.15903,3.37361,0.818388,2.83651,0.451094,0.913231,0.778017,1.86247,0.0487507,2.85288,0.0583686,2.2793,0.732785,1.39704,2.60797,0.122074,2.77161,1.1196,0.590158,2.21509,3.73356,2.73063,0.499842,0.927976,1.42161,2.06318,2.38936,0.891494,0.883829,0.209371,4.37902,0.608832,3.81845,2.51543,2.54147,3.3838,4.15177,1.59683,0.192216,0.537215,0.455513,3.93832,1.0829,1.92547,2.39969,1.00714,0.802947,2.15678,3.95803,0.20991,0.124253,0.479957,1.0012,0.444251,0.969963,1.81434,2.18901,0.321689,0.0278072,1.64864,0.651427,2.12086,4.46436,0.998611,1.1613,4.08807,1.39377,0.127706,0.700906,0.552711,0.515313,1.00938,1.48769,0.0935584,3.28137,2.79706,1.85369,0.296472,0.487268,0.0317496,0.19594,1.23039,0.0388062,0.67017,0.0934113,2.86187,1.86251,1.88909,1.87347,0.596602,0.00377345,0.192182,1.35662,1.60304,1.6355,2.39665,4.20327,0.978054,0.0436493,0.0764731,3.90868,3.21256,0.552857,2.17574,0.720971,1.57867,1.00832,1.66714,0.0796119,1.50929,0.0632518,3.0211,0.78774,1.44251,3.49814,0.0800848,2.00075,1.36371,0.743488,2.33431,2.60721,2.96996,0.278091,0.484778,1.58918,2.23393,1.81321,0.76124,1.05518,0.180481,5.67809,1.19608,4.3703,2.42004,1.21932,3.44784,4.91669,1.31593,0.246808,0.215084,0.619059,3.59653,0.725094,1.33354,2.42733,1.78544,1.59301,2.10466,3.41312,0.251837,0.0452664,0.893701,0.983479,0.592334,0.906095,1.89089,2.11333,0.918553,0,1.45872,0.963036,1.41516,4.55745,0.836861,2.22682,4.22401,0.894384,0.0436534,1.00384,0.145187,0.258983,1.36973,1.11032,0.156456,2.41609,2.70471,2.1322,0.526215,0.252542,0.0258043,0.349993,0.35663,0.104863,0.225369,0.24749,3.35109,0.963801,1.10813,0.800809,0.467626,0.107116,0.0552091,2.47139,2.62246,1.78614,3.4856,5.1379,2.94626,0.0129506,0.137714,4.38971,4.69919,0.188566,2.24813,0.520747,0.79837,1.95592,0.550285,0.00599656,3.57328,0.080133,2.81194,0.483219,1.56046,3.52163,0.658864,3.26069,1.05765,1.0118,2.94407,4.80952,1.89636,0.259329,0.0739332,1.2724,3.2216,1.86089,1.15171,1.37013,0.828185,6.12156,0.314778,3.56917,0.780318,1.08123,4.30628,4.93581,2.55729,1.14319,0.0388253,0.890784,3.77139,0.236146,3.92972,3.29398,1.21922,0.728362,2.22584,3.33834,0.835542,0.443234,0.266086,1.38535,0.148491,1.23911,1.60022,1.91213,0.431745,0.0798277,3.92146,0.100696,2.10039,5.02391,0.322355,2.43659,4.82507,0.601774,0.46191,0.594377,1.27198,0.325763,0.846408,2.22323,0.0822376,3.12431,1.4243,2.1481,1.00837,0.604639,0.100744,0.806879,0.668582,0,0.35246,0.0494527,2.93895,0.883624,1.23582,1.33622,0.579971,0.00303413,0.12075,1.26554,0.868126,0.683931,2.13174,3.34147,0.507017,0.034596,0.407799,3.14334,3.45889,0.514382,2.67469,0.30144,0.566191,0.578803,1.58267,0.0177247,1.72527,0.00918701,2.09903,0.249594,1.94982,3.16641,0.119972,2.91085,1.27837,0.211139,2.1288,3.62004,1.90441,0.0502565,0.314473,1.26084,2.53492,2.32336,1.24451,0.584151,0.09295,3.83199,0.583287,4.35442,2.26039,2.16336,3.10987,4.73173,1.53667,0.242611,0.268393,0.520367,3.39473,0.656522,2.33191,2.41795,0.737193,0.88631,1.90878,3.36651,0.160806,0.30254,0.598468,1.03497,0.637035,1.40763,1.29467,1.22339,0.127561,0.0349597,1.86225,0.668291,2.26833,4.25181,0.515916,0.231848,3.73252,1.58088,0.390363,1.09529,0.602876,0.307385,1.07234,1.07695,0.00450348,3.96513,2.2456,2.13224,0.583686,0.3779,0.0323832,1.12609,0.944197,0.0601499,0.516288,0.0505858,3.97665,1.66554,1.54787,2.25417,0.843666,0.109033,0.411015,0.34539,0.718933,0.611431,2.28845,2.05871,0.923705,0.216646,0.0154038,3.44349,2.49335,0.979974,1.59057,0.453513,1.40971,0.303805,1.07996,0.0104552,2.15765,0.575598,1.24831,0.146673,0.647196,3.51472,0.223764,2.36423,2.38342,0.979161,2.10142,3.73741,2.76451,0.864586,0.278941,1.18661,2.21592,2.22132,1.20689,1.51193,0.020477,3.30165,0.550168,2.83984,2.15062,4.65036,4.78363,3.84807,1.75357,0.539525,1.41835,1.5899,3.9677,0.71811,1.18531,4.55276,0.925562,1.40166,2.73467,3.21768,0.090259,0.000825712,0.866169,2.0545,0.279414,0.582492,1.44524,3.59893,0.470387,0.00659904,0.221317,1.14851,2.84489,2.55217,0.285621,1.01121,5.44992,1.04718,0.384958,0.209347,0.269595,0.214903,1.98371,0.982846,0.446999,3.39738,2.89421,1.69827,0.18654,0.0606241,0.572584,0.845817,0.83125,0.142304,0.511877,0.101747,3.0588,1.25144,1.19462,1.74543,0.190779,0.00891978,0.442403,0.66589,0.917971,0.111052,1.06662,2.67585,1.32598,0.0668443,0.0650987,3.3711,3.52265,1.85074,1.12053,0.144353,0.746337,0.826837,2.03384,0.0279713,1.60881,0.160879,1.02235,1.06167,1.20357,4.12033,0.136176,2.46433,2.25091,0.329999,3.34333,2.89288,2.42422,0.0518891,0.154113,0.650573,3.72507,2.40731,0.693673,0.657181,0.0400677,4.00169,0.610979,3.20096,2.30301,3.29098,3.8978,4.15155,2.06398,0.739552,0.580522,0.728652,4.44951,1.04893,2.03725,3.53141,0.726454,0.643724,1.8834,3.04606,0.0857924,0.340497,0.160281,1.16203,0.133217,0.954035,1.35878,1.93417,0.0825962,0.0565659,0.919205,0.37644,2.29047,3.81102,0.682563,1.71354,6.10332,1.62584,0.381732,0.857583,0.478908,0.310714,1.69634,1.53788,0.093128,2.65451,3.03056,2.00864,0.622983,0.242817,0.0446907,0.31917,2.12676,0.584698,0.508028,0.312854,3.57535,1.01957,1.76515,2.32122,0.309599,0.0135759,0.426861,0.866511,1.5532,0.567531,1.69692,3.17837,1.28109,0.138402,0.0340985,4.34716,3.71548,1.77937,2.15931,0.173799,0.726289,0.202157,2.69981,0.0611559,1.09466,0.21049,1.1993,1.28511,1.93591,5.0003,0.160311,3.53014,1.60281,0.552014,2.56209,3.43234,3.58124,1.18037,0.927042,2.41542,2.06958,1.71808,1.0145,0.981867,0,4.76112,1.02332,4.90183,2.32996,3.75912,4.43126,3.90499,1.79408,0.407988,0.975094,1.80331,3.76273,0.680769,1.02908,4.06174,1.33209,1.37562,3.4585,3.2734,0.0544218,0.048771,0.182318,0.83412,0.339921,1.93744,1.76138,3.12507,0.333666,0.603001,0.910121,1.11202,1.64939,2.83296,0.878977,1.53331,5.16968,2.19303,0.26282,0.56399,0.559927,0.339195,1.69228,0.502092,0.0285549,2.2546,4.01991,1.49154,0.449443,0.216892,0.285517,0.116664,1.16992,0.968088,0.554891,0.372601,4.17086,0.611138,1.43107,0.835574,0.497291,0.0541932,0.0318258,1.75179,3.45455,2.30135,4.44617,5.07075,4.09356,0.168165,0.118873,3.71805,5.38558,0.359948,1.17537,0.401529,1.74139,3.03928,0.641873,0.0452245,3.51162,0.225924,1.38501,0.975901,1.95064,3.55211,0.409476,3.11961,2.09502,0.283407,3.57552,3.27555,2.12664,0.34929,0.474149,2.16918,3.38105,0.957036,1.66978,2.51291,1.40494,5.48474,0.223458,5.07802,0.565896,1.52222,3.37747,5.36741,2.40689,1.75742,0.177935,1.56984,2.99916,0.108959,3.20956,2.76626,1.30163,0.704933,4.24807,1.97075,2.02187,0.711818,0.606899,0.713849,0.580595,1.98833,1.63021,3.92626,1.18241,0.0354319,4.58759,0.332903,2.27938,5.06359,0.173173,3.92383,4.6605,1.06388,0.556589,0.171921,1.86755,0.878197,1.36928,0.658514,0.0190993,3.09929,2.0158,2.27263,1.96783,0.792823,0.213694,1.07014,0.38616,0.0420136,0.121149,0.419845,2.73868,1.23557,1.6829,1.17198,0.422408,0,0.212392,2.15687,1.06676,0.841352,3.33135,5.16731,2.13337,0.220289,0.325544,2.79493,2.97439,0.37262,1.64285,0.181783,1.72529,1.00698,1.78506,0.0236844,2.2001,0.10197,1.8321,1.11312,1.18017,2.91984,0.108672,3.7586,0.671367,0.93762,3.10085,3.06066,1.9627,0.179142,0.317111,1.18516,2.57359,2.41962,1.47094,1.01224,0.000268379,4.35446,0.484724,4.49661,1.5371,1.99019,2.96908,6.3332,0.812003,1.23299,0.243958,0.250655,3.52692,1.45084,2.45594,2.48154,0.441547,0.970346,4.3034,3.72199,0.833116,0.0537236,0.949839,1.43612,0.538444,0.225747,1.98101,2.63878,0.72098,0.148604,2.18236,0.28725,2.9508,3.88237,1.00137,0.888707,6.01463,2.11074,0.386278,0.708657,0.847301,0.235339,1.14889,0.734926,0.0110711,4.25795,3.09755,2.88656,0.214374,0.615552,0.0784606,0.794541,1.4357,0.00623513,0.514883,0.03413,3.33517,0.812137,1.2248,1.74864,0.315777,0.013393,0.210911,1.90697,1.91836,0.767752,1.65758,3.16942,1.14282,0.0459913,0.220999,4.17401,4.52362,0.804498,2.51992,0.268469,0.642483,0.851914,1.99326,0,2.50734,0.0381192,2.03101,0.542559,2.1662,4.10502,0.0503313,2.32466,1.89728,0.167142,3.0341,3.65051,1.81492,0.173916,0.377965,0.68109,2.95184,1.96136,1.56334,0.696108,0.00445108,4.07859,0.114465,4.67323,1.05034,1.61055,3.35983,4.21886,1.91939,0.436332,0.254994,0.68775,2.84131,0.521681,2.10881,3.26495,1.07813,0.664651,1.33711,3.38636,0.0436841,0.419039,0.227035,0.94118,0.196337,1.36326,1.60736,1.10145,0.0341857,0,2.58226,0.202405,2.20619,4.68477,0.452925,0.957097,4.00319,1.80225,0.122734,1.26034,0.979403,0.635432,0.928647,1.13046,0.0393081,2.84849,2.48059,2.28962,1.31035,0.412608,0.0703817,0.296971,0.897599,0.0375367,0.294765,0.160068,2.55941,1.3605,1.34182,3.14562,0.427241,0.0111013,0.150922,1.19132,1.69642,1.51754,3.49422,2.81836,0.123653,0.0371704,0.242947,3.68749,3.71244,1.78137,3.2637,0.947374,1.67937,0.796561,2.51693,0.134468,1.68809,0.116397,1.39079,1.24835,1.9665,3.59129,0.0179134,2.62591,0.670484,0.865052,3.07211,3.2161,1.61743,0.771014,0.855325,1.22421,0.375836,1.87587,1.42771,0.939178,0.00956868,4.43019,1.83368,6.28362,2.02937,2.98059,3.77094,4.369,0.936155,0.152694,1.12217,1.54499,2.27825,0.381153,1.99007,2.66481,0.41185,1.30618,2.36695,3.4729,0.175739,0.0572974,0.920726,0.575249,1.12185,0.886291,1.77656,3.09869,0.271949,0.42442,0.827352,1.61262,2.53005,4.59954,0.966383,0.271037,3.76151,1.69681,0.196308,0.92964,0.292832,1.10383,0.979889,0.0910277,0.456767,4.02827,3.03481,0.945839,0.690891,0.159811,0.335634,0.407737,0.668719,0.211333,0.512295,0.0159793,3.84225,0.861139,1.66746,2.88913,1.05076,0.017604,0.28309,1.60989,1.0752,0.338429,1.99783,1.83507,0.453097,0.152038,0.072195,3.54355,4.65087,1.40336,1.6848,0.314609,1.67955,0.824161,2.18883,0.240514,1.77434,0.279308,1.42163,1.27125,1.40641,4.79524,0.0708822,2.12524,1.796,0.135306,1.86181,3.34326,2.62422,0.273251,0.466707,1.28652,1.4584,1.91578,1.2838,0.758845,0.0115877,4.82758,1.02023,4.63398,2.57347,3.50164,3.95303,3.70157,1.64042,0.440699,0.761368,0.495789,1.64867,0.70766,1.93985,2.99937,0.903021,0.935193,1.87404,3.39784,0.0792058,0.0470492,0.257649,0.60916,0.915243,1.18901,1.08066,1.89791,0.142627,0.186183,1.73326,1.11931,2.12438,3.13803,0.993114,1.108,4.62309,2.45593,0.0847078,1.31495,0.32682,0.559858,1.30904,0.349134,0.0207973,2.69449,2.65408,1.76183,0.526198,0.360282,0.0162377,0.452695,1.67969,0.786978,0.738353,0.0760599,2.98748,0.974157,1.96799,1.90436,0.93187,0.0125455,0.144638,1.44335,0.501522,0.782217,1.49275,3.55478,0.51408,0.0272756,0.00305018,3.47825,4.65626,0.926729,1.82176,0.461906,0.700576,1.0538,1.82246,0.0129438,3.10561,0.129999,2.23367,0.193773,1.35113,4.37293,0.408169,2.48598,1.12841,0.26154,2.01435,3.85373,3.28516,0.033117,0.569275,1.23854,1.83767,1.66214,1.18243,0.607491,0.127385,4.84697,0.817407,3.33022,2.42144,2.63031,3.68531,4.49616,1.40106,0.68475,0.911053,0.511081,3.96689,0.497705,2.66518,3.59399,0.693997,0.303797,2.3589,3.17979,0.120173,0.0840141,0.0773957,1.22968,0.873476,0.766364,0.745777,1.11064,0.114887,0.175923,2.15218,0.573491,1.95948,3.04424,0.916047,1.46429,4.72096,1.51816,0.327772,1.1236,0.827795,0.180154,0.970699,0.992361,0.0485862,3.01936,2.58218,1.8066,0.349257,0.142384,0.0494521,0.425016,1.76525,0.178625,0.188875,0.0699539,4.07327,0.691051,1.58693,2.37945,0.216532,0,1.81234,1.15422,0.581613,0.271597,0.473457,2.50652,2.63144,0.181997,0.0424526,2.76629,2.03107,0.867031,0.152904,0.0139542,0.236293,0.0618427,2.29404,0.0216631,1.18051,0.0467634,0.860408,0.57037,0.724652,4.19656,0.0281417,2.31023,1.71416,0.147774,3.36904,2.19917,2.46426,0.0893236,0.077964,1.17619,3.83219,2.2351,0.284899,0.717847,0.00192396,4.0828,0.0221865,2.47903,1.85622,2.79813,3.13349,3.78653,2.18643,1.42026,0.848296,1.66738,4.36045,2.32377,0.300671,2.82945,0.368193,0.19111,1.17597,2.81472,0.231004,0.0665675,0.404295,1.22482,0.0443175,0.790282,1.99073,2.7893,0.349134,0.273168,0.396511,0.449771,2.04238,1.17213,0.0075335,1.75189,4.58506,1.10772,0.211991,0.926428,0.222057,0.110032,0.107369,0.978691,0.0444489,1.09031,3.1166,1.84598,0.23379,0.0729769,0.087661,0.16739,2.09003,0.564941,0.553636,0.98773,3.2317,2.84104,1.344,1.61252,0.924333,0.390287,0.523503,0.745252,1.81386,0.3759,0.961302,0.74361,1.92746,0.0367375,0.254657,4.22352,3.2171,0.928905,0.551574,1.87886,0.820247,1.85763,1.40116,0.460056,1.42202,0.0111928,0.189119,0.220919,1.58414,4.81054,1.16823,0.408528,2.59343,0.0531654,2.90222,2.50481,0.482151,0.0355503,1.4243,0.97523,5.23268,1.0987,1.421,1.03101,0.0672638,3.65836,0.717889,2.82239,2.06995,2.53594,1.60664,1.07846,2.54499,0.898502,0.0471799,0.700152,1.64357,0.0399906,0.482931,2.05672,0.797772,1.13379,0.274555,0.707143,0.234836,1.07659,0.178635,0.615385,0.297467,0.860431,0.110594,2.59657,0.600154,0.479032,0.296133,0.993862,2.26152,1.45347,0.364953,0.894827,2.17797,2.07657,0.611407,0.822876,1.5875,0.144002,1.58942,1.88468,0.114159,1.42093,0.818327,1.9349,0.802866,0.243312,0.301177,0.429983,1.43563,0.656302,0.0938108,0.430553,4.81325,0.0807951,1.46824,2.15321,1.30366,0.0564281,0.156204,2.13588,1.46877,0.472374,0.611697,1.42164,1.90515,0.231403,0.129641,2.6591,2.61479,0.637518,0.904208,2.13806,0.372701,1.13394,1.90304,0.58043,1.33959,0.553732,1.06007,0.985018,0.543808,3.25897,0.206441,1.39186,0.804308,0.384461,0.844792,2.90573,0.300399,0.213936,0.998085,1.63261,3.31909,1.73901,1.18092,0.349687,0.109669,3.74661,1.23421,2.04492,2.26541,2.26596,1.53822,2.52296,2.75313,0.220269,0.019697,0.46049,1.82769,0.388736,1.27916,3.24384,0.741025,0.487426,0.531523,2.76641,0.0748161,0.547243,0.837052,1.31265,1.02772,1.34277,1.34924,1.00636,0.103381,0.0574457,0.980765,0.820282,0.887506,3.20173,0.046969,0.528082,2.77855,1.84989,1.00946,1.86239,0.608829,0.516535,2.2498,0.342212,0.0634859,1.29077,1.86591,2.0693,0.417948,0.261626,0.13938,0.409343,2.22424,1.9599,0.663104,0.11887,6.45383,0.38252,4.04982,1.77296,0.789522,0.227368,0.340924,3.34547,2.93424,1.29059,1.17446,1.97037,1.24899,0.574112,0.254942,2.74412,2.74275,0.509385,0.330373,1.52191,0.451901,2.00786,2.16086,1.21977,1.45518,0.822138,1.62224,2.1564,0.630753,2.69039,0.0497901,1.52492,1.13065,0.222982,1.43297,1.86954,0.621498,0.639015,1.63963,2.85328,2.43762,1.38037,0.973973,1.20674,0.148073,4.70571,3.20529,2.91054,0.694522,3.6054,2.29621,3.79459,0.683008,0.239141,0.2356,0.30097,1.11056,1.80002,1.15592,2.84758,0.432422,0.857427,1.14139,1.32843,0.153965,0.989956,0.686348,0.316861,0.115731,1.02845,3.41758,2.12211,1.2383,0.485448,2.75098,1.07798,1.46718,3.1013,0.249525,1.36975,3.21075,1.94395,0.38638,1.62883,0.523149,2.01228,1.84046,0.501834,0.593366,1.46181,3.40543,1.10476,1.44816,1.1251,0.0295201,0.133602,3.52492,2.39285,0.594473,0.67307,7.33662,0.312076,2.17701,1.45173,0.573155,0.34617,0.487049,3.08279,2.93026,0.649512,1.89446,1.756,0.609289,1.22079,0.398642,2.5188,1.94528,0.986859,0.457446,0.847528,0.412541,0.976149,1.2117,0.705849,1.9876,0.722498,1.24018,2.55111,0.489519,2.72867,0.0291009,2.35459,0.235688,0.316869,1.69132,1.35021,1.12745,0.435903,1.41336,2.33648,2.03596,1.68084,0.584443,1.15148,0.0612399,4.65578,1.55388,4.58667,0.963235,4.25159,2.54535,3.56805,0.892973,0.33514,0.181146,1.26509,1.56171,1.0552,1.02058,2.56878,0.821836,0.81548,2.27766,2.08943,0.648175,0.884804,0.96172,1.02797,0.711759,1.21395,2.56594,3.44538,0.760028,0.0488547,1.48262,0.799258,1.08438,3.27935,0.0382538,1.45882,3.31775,2.27778,0.715653,1.53316,0.778512,1.63186,1.1993,0.220446,0.778951,2.07157,3.78488,0.823545,0.834017,0.654665,0.0800226,0.337342,1.8533,2.51725,0.702393,0.102364,7.71211,0.286745,2.43409,2.67686,0.619262,0.335597,0.0531147,3.60267,2.38416,0.416732,2.09647,1.71686,0.757883,0.930876,0.0560811,1.97866,3.51794,0.56192,0.535995,0.996723,0.851703,0.930008,2.42682,0.615996,1.27864,1.03836,1.36461,1.88232,0.572575,1.65992,0.166636,1.97775,0.721565,0.134376,1.03473,1.5387,0.73856,0.193663,1.30164,2.81109,2.61607,2.13191,1.14167,1.21546,0,4.85786,1.71485,3.11446,0.752463,4.40693,1.40171,4.11217,1.04395,0.399484,0.80766,0.345108,1.13839,0.892735,1.10168,3.1794,0.556764,0.76763,1.86924,1.66639,0.354613,0.812082,1.13795,0.466964,0.466748,2.14874,3.45943,3.79036,0.872065,0.592503,2.39201,2.14517,1.32333,3.32057,0.065606,1.8166,3.61239,1.98733,1.4363,1.76843,0.745389,1.04846,1.55632,0.433596,0.657589,2.06524,3.66612,0.766329,1.20404,0.482788,0.039347,0.568658,3.09411,3.26962,1.34813,0.10506,5.60434,0.0889655,2.88713,2.08657,1.16381,0,0.320336,3.15232,2.11339,0.581482,0.599109,1.64684,0.136905,0.509498,0.0594996,3.93309,3.1175,0.723839,1.43198,1.64233,1.06164,1.62169,1.82454,1.04357,1.74279,0.442203,2.06128,2.01575,0.252877,3.43121,0.0215486,1.07699,0.155145,0.312614,0.946017,1.93533,0.400249,0.157762,2.43273,2.4283,2.45243,2.85849,1.08282,0.64019,0.0445874,4.83998,2.06011,3.49755,0.916848,3.19959,1.67709,2.80862,2.02959,0.462559,0.40393,0.567347,1.60233,0.82948,1.03516,4.08745,0.758877,0.558853,0.81449,2.77149,0.020525,0.424165,0.548064,1.4836,1.51395,1.17532,2.14801,2.16371,0.536734,0.20805,2.26247,0.393927,1.15546,3.80855,0.062539,0.560503,3.57414,1.74579,0.403144,1.8321,0.521171,0.281189,2.58205,0.165068,0.21593,1.33553,2.64503,1.22495,0.95273,0.758475,0.0459459,0.0536204,2.62278,3.09329,0.743081,0.355141,3.07225,0.99825,0.949002,1.12931,1.44038,0.223063,0.0110416,2.39146,1.64444,0.935833,1.60383,0.529734,1.10079,0.362805,0.828244,2.59053,4.22452,0.686707,0.93297,3.42002,0.0990215,0.910626,0.453031,0.468966,2.71115,0.0979038,0.878076,0.580586,1.66404,2.94335,1.24273,1.59951,1.76682,0.486193,2.11952,2.20781,0.287483,0.00329437,3.36734,0.745545,4.66653,0.703305,3.2894,3.1307,0.324362,2.55482,0.777873,1.86771,1.24968,1.76596,0.422246,2.00153,3.43406,0.229743,0.130489,1.09743,2.68829,0.149078,0.925941,3.05519,2.28496,0.148349,1.08481,0.311612,0.871743,1.85163,0.623889,2.28469,1.59312,2.77352,0.738557,1.06193,0.625584,0.341742,2.5183,2.62624,2.89115,3.69003,0.861826,0.267442,1.87515,2.30547,0.962704,0.719618,1.73405,0.0303122,1.83939,2.17335,0.257229,1.65153,1.09087,0.755912,1.62221,1.2047,0.0661021,0.732646,2.63772,0.807986,0.478311,1.44167,3.3315,1.92262,1.10396,2.1373,2.94314,0.605313,0.589089,3.41747,1.81504,1.43408,0.91407,1.51313,1.78559,0.543597,0.0665963,0.848016,4.45425,0.375745,2.11154,2.0208,0.331684,0.872671,0.837342,1.35013,3.21238,0.285412,0.122489,0.0346207,1.26419,2.99989,0.387741,0.275004,0.779306,1.11022,0.949502,1.27925,0.00285642,0.139194,3.4054,0.815279,1.51069,0.314028,2.58728,0.931934,0.0288647,0.85859,1.04216,2.46264,0.431734,0.340156,0.22502,2.04931,2.61658,0.785478,0.0418276,2.72806,0.686128,0.114332,0.593864,0.881908,1.11965,0.0711848,0.935166,0.3465,1.27528,0.173925,0.981481,3.06613,1.73727,2.21345,0.102727,0.694715,0.258337,0.0755219,1.85269,3.1383,2.03729,2.63149,0.560199,0.010192,0.823945,1.67051,2.69149,0.669242,1.35486,1.68324,0.539925,1.1993,0.0525289,0.577206,0.48674,1.16002,0.269629,0.6042,0.215148,0.47513,1.01106,0.912632,0.722549,0.141901,6.56804,0.332258,1.45423,1.84598,1.82717,0.607185,0.573186,2.45562,1.12138,0.721186,1.19955,2.16764,2.1298,0.463881,0.178236,1.82724,3.83526,0.128018,0.762716,0.459628,0.192741,1.12438,1.60296,0.963624,0.888673,0.645426,0.701608,0.815011,0.682288,1.60415,0.127339,1.19198,0.86594,0.288694,1.62697,1.99353,0.0730802,0.0582204,1.01377,1.65823,1.42085,3.36974,1.82254,0.886563,0.110572,3.70404,1.13102,2.06875,2.42856,1.66822,0.726381,3.11729,1.03275,0.200753,0.104538,0.586497,0.485197,0.89011,1.04055,3.76498,0.289018,0.173404,0.913941,0.603713,0.771254,1.16629,1.70345,0.877945,0.199141,1.21614,2.2545,1.42328,0.443216,0.0665258,2.377,1.73775,2.94043,4.8777,0.528893,0.166291,2.38448,2.42238,1.55654,0.459104,0.535974,1.50026,1.24673,0.8198,0.0119287,1.99609,3.31431,2.55657,0.570893,1.3003,0.0539923,0.52299,1.41024,1.28207,0.630163,0.105739,5.2302,0.227859,1.18988,1.75374,2.91697,0.386402,0.277785,2.83866,2.86109,0.331147,1.23632,2.39778,1.80306,0.259275,0.0913708,2.5227,3.94372,0.183673,1.56848,2.52969,0.532227,1.35426,1.27724,0.66081,1.88493,0.0528896,0.384378,0.398594,1.99346,2.60009,0.319524,0.562004,0.493854,0.701511,1.39409,3.22114,0.00298254,0.000888258,2.58557,1.696,3.47152,1.68618,1.24888,1.71971,0.0914841,3.61332,1.02518,2.04624,0.821979,1.69475,0.152026,2.5869,3.31264,0.179382,0.226419,0.27463,0.567847,0.686924,0.527543,2.87715,0.480118,0.376092,0.896157,0.540858,0.364544,1.60616,1.842,2.10057,0.225728,1.059,1.49925,1.6298,0.26304,0.268784,3.2952,1.58951,2.43822,4.05653,0.189399,0.416057,1.68345,1.14149,0.173652,1.17457,1.47797,0.139466,1.87393,1.34337,0.0421757,1.9166,2.95541,1.46175,1.41858,0.866783,0,0.0498921,2.34725,2.31223,1.62391,0.375117,4.67734,1.96945,1.1104,0.41031,2.23528,0.0241686,0.108533,3.11117,1.68433,0.227382,1.86509,2.15314,0.75385,0.14333,0.0874208,2.50929,3.98529,0.110356,1.13896,1.43417,0.313859,1.31874,0.309791,1.05315,1.39793,0.283745,0.876908,0.435468,1.45572,4.32967,0.356555,1.59968,0.916453,0.208693,0.985789,2.3605,0.577597,0.0338435,2.86926,1.3007,4.79799,0.899941,0.919981,1.93226,0.287895,4.67877,1.19555,2.69553,1.09768,1.7825,1.0552,3.7481,1.68595,1.15395,0.121583,0.967309,1.42674,0.24203,1.80173,2.21328,0.455632,0.0445802,2.03796,0.194335,0.623538,0.673932,3.03886,1.03398,0.341118,0.814646,1.06452,2.10121,0.458083,0.307486,2.18301,2.82394,2.79605,4.71776,0.0169554,0.514094,1.82997,0.227555,1.4776,1.54838,1.73153,0.134113,0.53203,1.91166,1.06839,2.55417,2.87113,0.928262,0.717707,1.47587,0.0368642,0.395106,2.57313,2.36082,0.21963,0.323391,5.03808,0.082217,1.79875,1.31236,3.24022,0.0172295,0.314153,2.91945,3.53399,0.424727,2.75348,2.03163,2.58717,0.19609,0.163325,1.67908,4.54266,0.128016,1.19594,4.72996,0.151521,2.57415,0.585961,0.137761,3.29643,0.257186,0.867165,0.450505,1.81,2.83961,0.772029,0.758587,1.41232,0.355646,1.14016,2.61898,0.0082014,0,2.93451,1.90219,3.77763,1.32164,1.4126,2.36852,0.146113,2.66697,1.39908,2.6182,0.160965,1.32218,0.233872,4.31484,3.86704,0.212293,0.0289287,0.211306,0.948793,0.0361328,2.27068,2.3723,0.391514,0.132712,1.97043,0.661183,0.168071,1.03141,1.16468,1.77397,0.436936,1.85067,1.08954,1.75647,0.943836,0.312196,3.22857,2.07949,2.32178,4.79149,0.109242,1.39368,1.99084,0.881735,0.252822,1.66833,2.07736,0.235665,1.47536,2.16852,0.126876,1.65064,1.7142,1.02378,1.67983,0.853408,0.000578408,0.429056,1.95147,2.63166,0.514809,0.292234,6.86733,0.708982,1.07439,2.01243,1.70541,0.0322334,0.125035,2.63003,3.71278,0.252346,1.74815,1.72679,2.06691,0.478085,0.00483701,3.22095,4.07958,0.0830733,0.856439,1.46784,0.161831,1.89061,0.873866,0.556582,2.05569,0.800068,0.749068,1.25719,1.60501,1.70926,0.275427,1.74127,1.1998,0.342481,1.02666,2.29009,0.0140432,0.00846901,1.14974,2.9381,2.94817,1.66574,0.967391,2.07723,0.00166173,4.34336,1.6463,4.26598,0.295507,2.75264,0.581208,2.98656,1.74961,0.267475,0.00369199,0.515228,0.689112,0.215311,2.00409,1.85591,0.100661,0.215568,1.28994,0.443553,0.628079,1.4706,1.66099,0.469097,0.0821688,2.06333,1.43894,3.49428,1.17021,0.0637752,2.23233,1.96668,1.91407,4.57395,0.201747,1.19394,1.94423,1.59399,0.4392,1.26067,1.52161,0.432527,0.68314,0.536641,0.0698201,2.35767,2.47381,1.03315,0.914498,0.835524,0.00987089,1.05986,2.03397,2.89699,0.325294,0.00119871,6.21996,0.00835778,2.5288,2.36303,0.318735,0.496379,0.934812,3.41399,3.82237,0.600501,1.72741,1.0386,1.41984,0.81225,0.117677,3.28885,4.08034,1.41401,1.32952,2.14254,0.730038,0.948184,2.88913,1.35151,1.5385,1.24999,1.30351,2.03615,0.644665,1.51591,0.0244568,0.981655,0.301641,0.643772,1.83247,1.88254,0.108825,0.131312,1.1616,1.51908,2.31524,2.62664,1.71108,1.12073,0.00699734,4.42007,0.975613,2.27487,0.766412,2.54045,0.633935,3.36548,2.42673,1.16776,0.927902,0.710297,1.08234,2.17219,1.42854,3.42324,0.489319,0.301125,0.260754,1.54756,0.0837248,1.38027,0.686394,0.481088,0.567501,1.99992,3.4116,2.68451,1.27092,0.627177,2.89755,1.2995,0.600107,3.28343,0.0155647,0.63508,3.19827,3.25178,0.778291,1.28901,1.18572,1.21674,1.48707,0.20439,0.127491,2.70604,3.09741,1.14486,1.68527,0.38197,0.0627786,0.381863,2.5112,3.71608,1.92274,0.573895,3.72506,2.36487,0.619444,3.19856,3.11657,0.189383,0.180706,3.70595,0.91928,1.20836,1.04514,2.23861,0.245261,0.174829,0.00154734,1.3084,5.75153,1.18626,2.96441,1.93846,0.390841,0.375997,1.0069,0.364289,2.65606,0.102186,0.147101,0.00865398,2.66011,5.33546,1.41967,0.488059,0.293369,1.84573,2.50777,3.20392,0,0.0109018,1.09469,1.82154,2.8126,2.0021,1.60885,0.630014,0,2.09139,1.30937,3.7491,0.664126,0.123373,0.11209,1.19551,1.35644,0.606804,0.187993,1.10878,0.810724,0.0113032,1.7821,1.91432,0.149821,0.293472,0.222547,0.215981,0.556262,0.414154,2.70669,3.63663,2.35668,2.95834,0.267524,1.63889,0.187753,0.12711,3.3947,1.63793,1.35076,2.79242,0.86852,0,0.567694,0.799586,1.22088,2.3433,1.85411,0.88546,0.820162,0.647504,0.123085,0.758855,0.639487,0.812279,0.49055,0.598673,0.366934,0.603286,1.46246,0.445609,0.898841,0.586868,8.73982,1.02971,1.20077,1.94829,1.83092,0.0220182,0.261601,3.15512,3.30329,0.551034,2.94538,1.72373,1.97993,0.779542,0.0822677,2.9852,3.75193,0.144997,0.836988,1.69875,0.504745,2.41732,1.30603,0.608154,1.05779,1.73576,0.36456,1.38593,2.02989,2.08777,0.164489,1.48814,1.37225,0.809428,0.972248,2.35817,0.251876,0.0687024,0.744842,3.6117,3.38709,1.54124,2.41988,2.61364,0.361874,6.00888,1.67688,4.14727,0.158881,2.55793,0.111752,2.84868,1.40215,0.489402,0.271234,0.513271,0.497959,0.11324,3.00346,1.56173,0.205529,0.497307,2.00518,0.614836,0.908684,1.41282,3.29453,0.969603,0.547435,2.81178,2.94911,4.6194,1.27235,0.716387,3.19781,1.2433,0.992348,3.85399,0.407022,1.57019,2.38822,0.998639,0.221525,2.03134,1.33124,0.617507,1.30361,0.708646,0.759568,2.45856,3.54255,0.812994,0.204393,0.436802,0.0270976,1.53677,1.46702,3.65913,0.466971,0.251133,6.95959,0.0333794,1.40907,2.13019,1.31999,0.292266,0.181486,3.14676,2.28961,0.490431,1.35744,1.39209,0.084761,0.816483,0.0671694,2.58854,3.1498,0.61749,1.58415,1.30812,0.149177,1.0595,2.15829,0.968012,2.30158,1.45327,1.81182,2.29565,0.689341,2.11324,0.112973,1.12802,0.219814,0.877145,0.537364,2.30229,0.153106,0.00261487,0.789265,2.10999,1.36101,1.68151,1.41636,1.05213,0.0044397,4.59925,0.991876,3.37134,0.220099,3.13481,1.31909,2.52578,1.33094,0.627478,1.09398,0.353905,0.799904,1.02119,2.29109,3.5297,0.463236,0.436492,1.10343,2.8353,0.123138,0.790711,1.18252,0.823587,1.04403,1.73025,2.1707,3.33867,1.07313,1.18701,3.20581,1.10758,0.958429,3.31983,0.0549896,1.10189,2.74074,2.45557,1.44002,2.93435,0.970824,0.895067,0.71077,0.124661,0.765065,1.71309,3.49349,0.65441,0.672074,0.354003,0.0919241,0.506844,1.93992,3.61502,0.446271,0.3745,4.5924,1.23532,0.241716,1.43527,1.75488,0.539591,1.15005,2.69045,1.74025,0.110312,1.61856,1.47826,0.826395,0.502828,0.422565,3.59079,3.1942,1.72556,0.845413,0.360287,0.274238,0.797396,1.93063,1.06382,1.0984,1.65286,0.27872,0.481458,2.84992,2.61509,0.0257836,0.255934,1.07027,0.218782,3.23025,3.41362,0.0452738,0.0335229,0.955382,1.47124,4.39593,1.03073,2.08899,0.991484,0,2.82603,0.44292,2.68303,1.31588,0.534263,0.0979332,1.1765,1.88004,1.33126,0.51734,1.27743,0.82657,0.43469,1.03023,1.61289,0.637126,0.246193,0.66784,0.261125,0.202319,2.98351,1.77656,1.7038,0.869062,2.82035,0.667508,1.84661,0.584493,0.0369572,2.16519,1.93956,0.818924,2.80943,0.160816,0.135175,0.51689,0.825145,1.074,3.13664,1.27932,0.117167,0.531846,0.91422,0.00876264,0.795256,2.56697,1.44093,1.00984,0.455143,0.0774129,0.100801,1.35025,1.91794,0.257685,0.174504,6.99856,0.132885,2.00133,1.88682,1.80335,0.785178,1.18023,3.76684,3.1939,0.565615,2.31022,2.75415,1.73442,0.41269,0.291212,3.30776,3.32774,0.126696,0.606345,1.4245,0.384673,1.15666,1.35154,0.979975,0.766484,2.00923,2.16857,2.27555,0.398939,1.1732,0.138618,1.23992,0.447373,0.616605,1.00978,3.01147,0.0924396,0.0674492,1.66365,4.12297,1.79219,1.82543,1.29482,2.48605,0.0176754,5.19097,0.986877,2.57266,1.57903,3.02494,0.390604,4.12094,1.05613,0.470683,1.23008,0.247726,1.68997,1.28396,1.19812,3.29264,0.0823708,0.131314,1.13449,1.04483,0.462526,1.5643,2.42756,0.356194,0.295758,2.51568,4.19365,3.52803,1.47537,0.420603,3.22312,2.51929,3.17259,3.80346,1.02889,0.487563,3.3617,1.2777,0.312199,1.22358,0.259978,0.480599,1.02987,0.188222,0.151817,1.71614,3.593,2.10357,0.849569,0.942012,0.042104,0.509642,1.40164,3.83614,0.184156,0.221195,5.11221,1.0615,1.43651,1.90652,1.32315,0.0532484,0.439429,1.16011,1.90052,0.532259,1.15372,1.07451,0.656496,0.354654,0.384508,4.31573,2.85546,0.325853,0.566785,2.11056,1.70249,2.32448,0.330881,0.140268,1.50035,0.0365847,0.707865,1.58583,0.280018,3.56375,0.158765,2.68258,0.408648,1.22888,1.0269,1.02123,0.407549,0.233926,1.51785,3.37066,2.94239,1.27334,1.87556,3.5836,0.133146,5.41036,1.91804,3.84347,0.619772,2.98138,0.331498,2.28954,1.83127,0.710477,0.604542,1.88388,1.43014,0.224193,0.667574,3.3583,0.680597,0.304905,1.52853,0.296768,0.588059,1.01646,3.68636,2.01778,0.569689,0.464187,2.63521,5.09287,0.647101,0.151575,1.0164,0.403723,0.650813,1.84017,0.0552277,2.31462,2.00682,1.79648,0.236092,1.40605,2.18151,0.082038,0.504618,0.31107,0.398998,1.36783,3.16728,1.43395,0.365569,1.51801,0.0374257,0.849416,0.351533,2.94804,0.974565,0.861189,5.25728,1.02628,0.873751,2.13586,2.61117,0.703581,0.0308287,2.81073,1.29858,1.12471,0.25401,1.83754,1.22727,1.3554,0.0133957,0.857975,3.37658,0.100097,0.995698,0.856568,0.0534877,1.25937,0.299307,0.51188,1.93843,0.844398,0.459178,0.082004,1.25152,1.87234,0.852074,1.10209,0.0674482,1.17181,0.702495,1.02526,0.0325532,0.026385,2.39219,0.415488,1.07483,0.60647,1.98251,0.304612,0.022602,2.08917,1.07849,1.73861,0.589407,0.532113,0.741026,2.9143,1.63904,0.408422,0.097312,0.769933,0.521111,0.45975,0.5108,0.961989,0.21067,0.00781904,0.431027,1.33048,1.45045,0.258897,0.41484,2.11862,1.19518,1.78641,0.192141,0.124088,0.00156289,0.125198,1.91346,2.21974,1.95588,3.44095,0.166916,0.00183741,1.91274,1.71632,2.48322,0.294634,0.865751,2.8646,0.642169,1.80255,0.098533,0.583954,0.872587,1.32031,0.517327,0.975735,0.0171696,0.60458,0.940533,1.24504,0.663863,0.111222,3.36156,0.589114,0.958669,1.90041,2.92993,0.261462,0.312009,2.1037,2.22552,0.867818,2.59185,1.03615,1.82114,0.324595,0.457084,2.42399,4.60721,0.708082,1.73009,4.23178,0.44775,2.33453,0.453969,0.344531,2.91467,0.121897,0.114587,0.0283162,2.26917,3.26856,0.847829,0.408003,1.85722,0.238222,2.36447,2.69791,0.0400725,0.0149142,2.89335,0.929881,4.48752,0.794999,2.79169,2.13796,0.270315,2.84102,0.44938,1.6643,0.504644,0.379103,0.457211,2.70984,4.60011,0.656926,0.192714,0.40539,1.16158,0.0783707,2.54728,3.43145,1.0045,0.1937,1.56081,1.80243,0.372579,1.26293,1.02895,2.1259,2.32369,2.18291,0.625517,1.5817,0.675317,0.897016,3.24683,1.99096,2.37221,3.13066,0.00317319,0.286411,2.29131,1.21139,1.66276,0.589232,1.81656,0.144804,2.01761,2.55133,0.0883723,0.728125,0.771948,0.999863,1.90504,1.11528,0.352635,1.09363,2.05708,1.93355,0.253309,0.116556,4.68634,0.223883,1.67129,1.93171,1.97933,0.00383753,0.280216,1.40586,3.09517,0.213545,1.66106,2.13006,2.98515,0.271883,0.0522383,3.09997,3.51699,0.141877,0.651085,2.91886,0.343161,2.02151,1.13365,1.30164,2.875,1.17437,1.1995,0.855122,1.28774,2.12559,0.458248,2.22088,1.93161,0.952154,2.20498,3.26444,0.250488,0.00407381,1.85257,2.29864,2.46343,0.561894,1.62252,2.49955,0.309508,2.61178,1.33307,3.72915,0.643366,3.51015,0.562023,3.57493,3.10522,0.328935,0.119799,0.897191,1.89314,0.119459,2.02567,2.35492,1.34613,0.383373,2.32709,1.71177,0.134538,0.375472,0.889519,1.85584,1.17967,1.46707,1.70745,2.37053,0.720302,0.472549,2.28538,2.25924,3.50832,5.28705,0.84084,0.875018,3.52472,1.67576,0.387816,0.449753,2.36395,0.0993472,1.84713,1.42916,0.0308633,2.50824,1.53989,1.30368,0.730894,0.759442,0.111097,1.70707,1.80198,2.37097,0.812136,0.120098,4.86855,1.24059,2.86626,2.44454,0.765356,0.204651,1.52859,1.3326,0.527706,0.962032,0.919145,2.30383,1.64707,0.193598,0.293331,2.66928,2.69068,0.708493,0.227696,1.3636,1.16759,0.13128,2.24242,0.647674,1.27019,0.198226,0.660604,0.416808,1.01276,3.12247,0.387053,1.73044,2.10827,0.6178,0.565228,1.56219,0.447435,0.4185,0.961366,2.13676,2.59692,2.04515,0.937313,0.196836,0.00168212,2.53829,0.734472,2.94557,0.865219,3.53086,4.39869,3.41571,3.60505,0.38702,0.440112,2.58771,2.84441,0.811425,2.02781,3.80813,0.565964,0.126715,0.61499,2.82767,0.0637746,0.335573,0.393531,0.976523,0.75281,0.915117,1.70388,1.42754,0.468946,0.0694357,1.1903,2.43293,2.69881,2.03315,0.0570462,1.02948,6.27247,3.65036,0.71304,1.27246,0.271345,0.530685,1.8314,0.463416,0.141136,2.70229,2.4328,1.15523,0.550393,0.0891806,0.0283122,0.325709,2.4861,2.15164,0.898232,0.210259,3.1975,0.997738,0.191175,1.55085,1.71338,0.0577143,2.03634,0.873271,1.88994,0.713991,0.665725,0.109941,1.71841,0.186993,0.268377,3.74585,2.38165,0.328973,0.538873,2.25382,1.36053,4.35583,0.320201,0.641422,1.44763,0.416863,1.08291,0.267269,0.679639,1.50867,0.542548,0.490702,1.41823,0.432038,1.9593,1.10792,0.105017,0.0269861,4.09409,0.96845,6.05413,0.186122,3.53427,1.90091,0.421887,1.95093,0.348475,1.01732,2.2948,1.17767,0.642385,1.31366,2.82119,1.42115,0.539733,2.13342,2.80341,1.1287,0.10518,1.32477,1.47408,0.525935,0.423997,1.4702,0.819589,0.996782,0.507418,0.792482,0.117183,1.16909,0.60062,0.798,1.19358,0.211437,2.14669,0.834304,2.43454,2.85052,0.211237,0.51729,2.33352,0.254928,0.25645,0.38028,1.65891,0.0968816,1.5055,1.407,0.0182651,1.11253,0.616646,1.46619,1.64317,0.659965,0.00739392,0.163936,1.33386,1.29004,2.11317,1.03964,3.65167,1.30471,2.29612,1.38089,2.01531,0.0406192,0.331822,1.60388,1.93104,0.812058,1.03308,1.75459,0.86162,0.152441,0.2124,1.42098,2.72777,0.214831,0.677203,2.25576,0.731401,2.00064,1.31908,1.27204,1.79025,0.149946,0.0791397,0.266467,1.14631,3.07066,1.06992,0.606958,0.239376,0.956309,2.76435,1.11536,0.000791357,0.0550667,2.86583,1.17624,6.24452,1.18306,1.69543,1.13793,0.320872,3.57882,1.89732,0.935178,0.783058,1.5818,1.3382,2.74709,1.92389,2.03014,0.229265,1.39986,1.77446,0.403916,1.45285,2.01894,0.317412,0.105496,1.13236,0.569124,0.535925,1.0535,1.46998,1.68174,0.253648,0.816185,1.05546,1.41445,1.19722,0.0818693,2.06625,0.997922,0.737934,2.35428,0.0058167,0.145901,1.48014,1.18936,1.02932,1.85306,1.51759,0.428515,1.52003,0.803402,0,1.38276,1.61682,1.30886,1.18338,0.586477,0.0902724,0.831467,3.56661,1.31524,0.876652,0.0631791,4.7749,1.07338,1.69869,1.58828,0.25187,0,0.947262,1.35063,1.7544,0.335397,0.602412,1.81719,0.83498,0.0757302,0.0206605,1.9908,2.08454,0.59629,0.108872,0.0560465,0.0712629,0.71132,1.64435,0.262862,1.37295,0.0695136,0.742151,0.55555,1.31163,4.53364,0.144293,1.48394,0.706466,0.220706,0.92508,2.26944,0.495825,0.0551027,0.185759,1.27448,4.2655,2.43653,0.900594,0.135071,0.0394816,4.60703,0.308671,2.70279,1.00552,2.895,2.59958,2.97339,3.17499,1.61685,0.646072,0.582307,3.176,1.11632,0.462667,2.5227,0.720804,0.0654785,1.10443,3.22618,0.166501,0.0845012,0.269973,0.851177,0.141087,1.16259,0.60383,1.48998,0.0792487,0.130158,0.53897,0.779274,1.28965,1.09309,0.00114253,0.760716,3.85795,0.544777,0.670001,1.39091,1.41372,0.537886,1.09387,1.16429,0.00110852,1.36474,1.96186,1.17676,1.34232,0.392489,0.0028248,0.820288,3.33081,1.9707,0.141534,1.32752,4.32412,1.36519,0.7822,1.24212,1.29921,0.00449213,2.96646,0.890678,0.947418,0.524281,1.01502,1.19485,2.00927,0.140004,0.0336756,3.82305,2.6648,0.808076,0.175849,0.379751,1.27281,1.64596,0.85119,0.304467,1.05965,0.88702,0.673684,0.412961,1.16726,5.23773,0.181942,1.30786,2.51306,0.0140293,1.52968,1.47284,1.31953,0.115669,1.00374,2.17982,7.58773,1.60782,2.21347,1.31729,0.489387,2.94165,0.132097,1.60515,0.845589,1.8837,2.59501,1.74942,3.93922,2.10887,0.885373,1.38633,3.0048,0.850073,0.156651,2.41793,1.78144,0.102717,1.45141,2.25859,0.553741,0.352278,1.39596,0.605364,0.722566,2.26311,0.989234,3.1654,1.32028,0.131032,0.430185,0.63604,1.89814,0.840887,0.0145833,1.12403,3.63153,0.461552,0.338114,1.41944,1.2121,0.0547536,1.15151,2.13569,0.183726,1.35507,2.37558,0.880525,2.10045,0.313574,0.158706,0.819517,2.97787,1.5779,0.617671,0.468382,4.2573,2.68184,0.405576,1.66272,2.19618,0.454411,0.112507,2.0079,0.605678,0.0785262,0.808339,0.763635,0.514089,0.251851,0.199175,2.23691,3.86687,1.66287,1.84195,1.37314,0.902038,0.777063,1.49601,0.37944,1.16528,0.189918,0.0748914,0.0220248,2.78947,5.58867,1.3001,0.0293565,1.03021,0.822084,2.649,3.1179,0.0243542,0.0170031,2.31794,2.32811,4.56341,1.56396,2.14732,0.507619,0.0942021,1.91325,0.484128,3.22408,2.23196,0.548829,0.251454,0.504564,1.64646,1.11299,0.448078,0.00928187,1.99006,0.222099,0.00566369,2.7882,0.721351,0.716473,1.48018,0.348745,0.0468219,1.15817,1.77556,1.69238,1.53411,2.84495,0.437648,1.22891,0.149386,0.50927,1.36986,0.939152,4.01539,1.81847,0.116702,0.0480713,0.592695,0.635974,0.522637,1.95381,1.00631,0.00983327,2.25001,0.568138,0,0.0477794,0.946258,1.89782,2.10002,0.680816,0.118034,0.289923,0.534844,1.14276,0.17787,0.0671842,3.74189,0.598143,1.46102,1.59229,0.573945,0.0248033,0.18219,2.10823,0.628571,0.277635,0.55642,1.37147,0.189093,0.304289,0.021872,0.766755,3.72452,0.849935,0.742728,0.336274,0.727936,0.875328,1.5026,0.148357,1.73686,0.0130925,1.14383,0.142981,0.537176,3.29533,0.0895149,2.22682,0.590893,0.123592,0.956116,1.90591,0.335271,0.144899,0.965926,0.810877,3.06673,2.55084,0.898227,0.188399,0.218642,4.21891,0.949401,2.19536,2.56585,2.28743,1.50976,4.43636,2.14383,1.21491,0.238991,0.119743,3.13956,0.7063,0.698713,1.79337,0.713203,0.239497,1.12453,2.11674,0.215012,0.148944,0.371673,0.688459,0.584677,0.668979,1.1467,1.24969,0.365664,0.00402623,0.913581,1.31169,0.679478,3.68138,0.128535,0.452051,2.87009,0.942447,0.473775,0.990575,0.495187,0.543496,1.7609,0.644544,0.352128,2.7088,1.69498,2.96797,0.55632,0.00166314,0.037931,0.867557,2.67301,1.17689,0.590685,0.0582472,4.19662,0.179836,1.69836,1.31358,1.49582,0.406852,1.29723,1.39667,0.477145,0.447816,1.19232,2.0995,1.4763,0.0372801,0.558062,2.76918,3.73471,0.308949,1.57176,0.553801,0.365138,1.15407,2.44019,0.297839,0.90976,0.615724,0.813148,0.463448,0.654772,2.71199,0.237753,0.909471,1.26044,0.74914,1.39616,2.38322,0.167203,0.0126121,0.225377,1.5502,2.26877,2.24333,0.973906,0.709005,0.0451798,3.05034,0.189501,2.54107,1.02928,2.93998,1.85342,3.96938,2.19005,0.321954,0.162484,0.813151,2.76814,1.26534,2.03445,3.33698,0.651145,0.120352,1.04319,2.61028,0.264721,0.305187,0.897256,1.02103,0.58373,1.0037,1.71082,1.52767,0.668524,0.0208841,1.75831,1.83232,3.35193,4.0909,0.294792,0.394428,3.74717,3.01426,0.839781,1.40738,0.364597,0.526923,1.33506,0.342368,0.0127373,2.4178,2.62937,2.66246,0.298979,0.372313,0.149647,0.286726,2.90082,1.18625,0.520868,0.100791,3.63484,0.177705,1.7658,2.12389,0.915643,0.0530187,0.868138,1.60942,0.807279,0.734285,1.02882,2.66665,1.09878,0.207759,0.0152958,1.39496,2.98445,0.345051,1.99615,1.6004,0.905284,0.662348,2.13196,0.395938,2.09453,0.133119,2.15142,0.367175,0.262221,2.86103,0.118603,1.45757,0.690362,0.78626,2.20591,2.73903,0.103179,0.00699327,0.469433,1.13614,1.86629,2.94935,0.47088,0.0390566,0.00386581,4.85439,0.915615,1.80378,1.58185,2.70266,1.99958,3.65516,2.39768,0.321273,0.287234,0.443654,3.43264,0.878042,1.2525,4.4268,0.624393,0.499974,0.693653,3.4787,0.0673157,0.22458,1.16722,2.52149,0.631295,0.267162,1.50803,0.86045,0.36575,0.0676028,1.27223,0.49721,1.87069,4.34851,0.0029013,0.405826,3.7857,3.4135,0.674171,1.74218,0.42268,0.708406,1.79269,0.464328,0.139114,2.36464,1.41014,2.57096,0.355134,0.604991,0.391504,0.319167,2.55726,0.739781,1.02642,0.205901,3.9757,1.18295,1.24104,1.63107,1.51492,0.0216242,0.0775006,2.32664,2.68503,0.487947,1.85133,1.7975,1.55172,0.089643,0.0868945,2.00716,3.74157,0.401673,1.4517,2.23622,0.503565,0.864392,0.640068,0.360182,2.73337,0.0533497,0.796302,0.0789252,0.493384,3.57012,0.750832,0.837013,1.6331,0.361186,0.937966,3.20455,0.354754,0,1.34457,2.48876,3.36057,1.98883,0.920533,0.856483,0.0131143,3.56402,0.398756,3.64401,0.859795,2.60172,0.820675,3.51612,3.01152,0.256439,0.0793038,0.217291,2.4773,0.0733517,1.59288,2.78761,0.257391,0.0951554,0.812235,1.26376,0.108545,0.287873,1.1668,1.39608,1.13534,1.01982,1.83664,2.25875,0.785398,0.145803,0.978086,1.04681,3.51331,4.46406,0.338991,0.440636,2.46854,0.93062,0.387732,0.645399,2.80796,0.110147,2.04517,2.49583,0.257262,0.930653,0.876773,1.16229,1.00568,0.579815,0.02377,0.9081,1.58965,1.33536,0.390522,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]\r\ndata = torch.Tensor(vue_clip_emb).view(1, -1, 100)\r\nlengths = torch.tensor([74])\r\noutput = ts_model_multihead.forward(data=data, lengths=lengths)\r\nprint(output)\r\n', '\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-66-6d725915459d> in <module>\r\n     53 data = torch.Tensor(vue_clip_emb).view(1, -1, 100)\r\n     54 lengths = torch.tensor([74])\r\n---> 55 output = ts_model_multihead.forward(data=data, lengths=lengths)\r\n     56 print(output)\r\n\r\nRuntimeError: \r\n\r\n\r\nnew_type INTERNAL ASSERT FAILED at caffe2/torch/csrc/jit/passes/shape_analysis.cpp:280, please report a bug to PyTorch. \r\nThe above operation failed shape propagation in this context:\r\nat /mnt/xarfuse/uid-156246/70539c06-ns-4026531840/torch/nn/functional.py:3312:12\r\n                                                  dtype=attn_mask.dtype,\r\n                                                  device=attn_mask.device)], dim=1)\r\n            if key_padding_mask is not None:\r\n            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...  <--- HERE\r\n                key_padding_mask = torch.cat(\r\n                    [key_padding_mask, torch.zeros((key_padding_mask.size(0), 1),\r\n\r\nThe above operation failed shape propagation in this context:\r\nat /mnt/xarfuse/uid-156246/70539c06-ns-4026531840/torch/nn/functional.py:3303:4\r\n    q = q * scaling\r\n\r\n    if bias_k is not None and bias_v is not None:\r\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...  <--- HERE\r\n        if static_k is None and static_v is None:\r\n            k = torch.cat([k, bias_k.repeat(1, bsz, 1)])\r\n\r\nThe above operation failed shape propagation in this context:\r\nat <ipython-input-60-415a6b53c56b>:127:8\r\n          L is the target sequence length, S is the source sequence length.\r\n        """"""\r\n        if not self._qkv_same_embed_dim:\r\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...  <--- HERE\r\n            return nn.functional.multi_head_attention_forward(\r\n                query, key, value, self.embed_dim, self.num_heads,\r\n']"
374,24645,0,"Migrate `thnn_conv2d_forward` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
59,17738,1,"Inconsistent results of torch.argmax with tensors that have duplicated values. ## üêõ Bug
Inconsistent results of torch.argmax with tensors that have duplicated values
<!-- A clear and concise description of what the bug is. -->

## To Reproduce



When I did the same on another machine(pytorch 0.4.1, CUDA 9.0)

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior
torch.argmax returns the same value for tensors that have same data in it, regardless of devices(or other factors).
<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: 0.4.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration:
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti

Nvidia driver version: 410.79
cuDNN version: /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so.7.3.1

Versions of relevant libraries:
[pip3] msgpack-numpy==0.4.4.1
[pip3] numpy==1.15.0
[pip3] torch==0.4.1.post2
[pip3] torchtext==0.3.1
[pip3] torchvision==0.2.1
[conda] blas                      1.0                         mkl
[conda] mkl                       2018.0.3                      1
[conda] mkl_fft                   1.0.4            py36h4414c95_1
[conda] mkl_random                1.0.1            py36h4414c95_1
[conda] mxnet-mkl                 1.3.0.post0               <pip>
[conda] pytorch                   0.4.1           py36_py35_py27__9.0.176_7.1.2_2    pytorch
[conda] torchtext                 0.3.1                     <pip>
[conda] torchvision               0.2.1                    py36_0


## Additional context
It would be helpful if  the documentation describes if torch.argmax returns the last or the first index if a tensor holds duplicated values.
<!-- Add any other context about the problem here. -->
. [""\r\ncpu = torch.LongTensor([[2,3,0,3,3], [1,3,1,3,1]])\r\ncpu.argmax(dim=1) # tensor([4, 3])\r\ncuda = torch.cuda.LongTensor([[2,3,0,3,3], [1,3,1,3,1]])\r\ncuda.argmax(dim=1) #tensor([4, 1], device='cuda:0')\r\n"", ""\r\ncpu = torch.LongTensor([[2,3,0,3,0], [1,3,1,3,1]])\r\ncpu.argmax(dim=1) # tensor([4, 1]). \r\ncuda = torch.cuda.LongTensor([[2,3,0,3,0], [1,3,1,3,1]])\r\ncuda.argmax(dim=1) # tensor([1, 1, device='cuda:0')\r\n""]"
445,10004,0,"Detaching gradients instead of using no_grad in spectral_norm. Looking at [this](https://github.com/pytorch/pytorch/blob/3609977d7f4629f75dd1f8d904ddd5b52388124f/torch/nn/utils/spectral_norm.py#L53) code I've noticed that there is an easy way to make ,  differentiable wrt  (it is useful as normalizing constant  depends on ,  and ,  depend on ). 
If we  starting point of power iteration  we avoid cumulating gradients problem while allowing gradients pass through power iteration. As it adds some computational overhead it can be optional.
. []"
587,15589,0,"unable to load python-trained model with libtorch c++ api in Windows. version: stable 1.0.0
get from the url
https://download.pytorch.org/libtorch/cu90/libtorch-win-shared-with-deps-latest.zip

test code

#include <torch/torch.h>
#include <torch/script.h>

#include<fstream>
#include <iostream>
using namespace std;

int main(int argc, const char* argv[]) {

  at::Tensor tensor = torch::rand({2, 3}).to(at::kCUDA);
  std::cout << tensor << std::endl;


  /**/
  string model_name = ""model.pt"";
  try {
	  
	  std::ifstream in(model_name, std::ios_base::binary);

	  if (in.fail()) {
		  cout << ""failed to open model"" << endl;
	  }
	  else {
		  cout << ""successed to open model"" << endl;
	  }

	  AT_CHECK(!in.fail(), ""load: could not open file "", model_name);

	  cout << ""parsed checking"" << endl;
	   

	  std::shared_ptr<torch::jit::script::Module> module = torch::jit::load(model_name);
	  module->to(at::kCUDA);

	  assert(module != nullptr);
	  std::cout << ""ok\n"";

	  std::vector<torch::jit::IValue> inputs;
	  inputs.push_back(torch::ones({ 1, 3, 224, 224 }).to(at::kCUDA));

	  // Execute the model and turn its output into a tensor.
	  at::Tensor output = module->forward(inputs).toTensor();

	  std::cout << output.slice(/*dim=*/1, /*start=*/0, /*end=*/5) << '\n';
	 
  }
  catch (exception & err) {
	  cout << err.what() << endl;
  }
   
  

  cout << ""finished"" << endl;



}


output:

D:\learn\cv\lab\example-app\build6\Debug>example-app.exe  model.pt
 0.6020  0.1421  0.9155
 0.6821  0.7416  0.7934
[ Variable[CUDAFloatType]{2,3} ]
load: could not open file  (load at ..\torch\csrc\jit\import.cpp:250)
(no backtrace available)
finished

the model is the python trained,with the following code
import torch
import torchvision

# An instance of your model.
model = torchvision.models.resnet18()

# An example input you would normally provide to your model's forward() method.
example = torch.rand(1, 3, 224, 224)

# Use torch.jit.trace to generate a torch.jit.ScriptModule via tracing.
traced_script_module = torch.jit.trace(model, example)

# save
traced_script_module.save(""model.pt"")


it should be in the right position, as the check code shows.. []"
539,7072,0,"JIT fails on GPU !=0. ## Issue description

Run the test case code below on a system with 2 or more GPUs and you will get this stack trace:

Traceback (most recent call last):
  File ""testnet.py"", line 51, in <module>
    r = net(V)
RuntimeError: arguments are located on different GPUs at /home/tester/pytorch/aten/src/THC/generic/THCTensorMathPairwise.cu:250

## Code example

. ['python\r\nimport torch\r\nfrom torch import jit\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\nimport torch.optim as optim........\r\n\r\ntorch.backends.cudnn.benchmark = True\r\n\r\n@torch.jit.compile(nderivs=1)\r\nclass TestNet(nn.Module):\r\n    def __init__(self):\r\n        super(TestNet, self).__init__()\r\n        self.net1 = nn.Linear(100, 200)\r\n        self.net2 = nn.Linear(200, 1)\r\n        self.bn = nn.BatchNorm1d(200)\r\n        self.sigmoid = nn.Sigmoid()\r\n        self.ReLU = nn.ReLU(inplace=False)\r\n        self.drop = nn.Dropout(0.5)\r\n...............\r\n    def forward(self, V):\r\n#        return self.sigmoid(self.net2(self.drop(self.ReLU(self.bn(self.net1(V)))))).squeeze().\r\n        return self.sigmoid(self.net2(self.ReLU(self.bn(self.net1(V))))).squeeze().\r\n\r\n\r\nuse_cuda = True\r\nGPU = 1\r\nnet = TestNet()\r\ncriterion = nn.BCELoss()\r\nif use_cuda:\r\n    net.cuda(GPU)\r\n    criterion.cuda(GPU)\r\n    V = Variable(torch.randn(100, 100)).cuda(GPU)\r\n    label = Variable(torch.randn(100)).cuda(GPU)\r\nelse:\r\n    V = Variable(torch.randn(100, 100))\r\n    label = Variable(torch.randn(100))\r\n\r\n\r\noptim_betas = (0.9, 0.999)\r\noptimizer = optim.Adam(filter(lambda p: p.requires_grad, net.parameters()), lr=0.01, betas=optim_betas)\r\ncriterion = nn.BCELoss()\r\n\r\nnet.train()\r\nfor i in range(0,1000000):\r\n    net.zero_grad()\r\n    r = net(V)\r\n    err = criterion(r, label)\r\n    err.backward()...\r\n\r\n']"
210,6968,0,"[feature request] Implement torch.stack() / _cat() for also for torch.HalfTensor. ## Issue Description
It seems that stacking is currently (PyTorch 0.4) is not supported for tensors of type ; see code example. 

I don't know if this is intentional for some reason (hence I didn't label this issue as a bug), but I couldn't find any issue or documentation pointing to that. Since some methods, like , depend on  (in this case implicitly through the  method), it would be great if either stacking for HalfTensors could get implemented, or the documentation could be updated to contain some kind of hint.

## Code Example


On PyTorch 0.3.1, one gets basically the same error when one tries to do the same thing:
. [""\r\nPython 3.6.5 (default, Mar 30 2018, 06:41:49)\r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 6.3.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import torch\r\n\r\nIn [2]: torch.__version__\r\nOut[2]: '0.4.0'\r\n\r\nIn [3]: tensor_1_float = torch.tensor([1, 2, 3], dtype=torch.float)\r\n\r\nIn [4]: tensor_2_float = torch.tensor([4, 5, 6], dtype=torch.float)\r\n\r\nIn [5]: torch.stack([tensor_1_float, tensor_2_float])\r\nOut[5]:\r\ntensor([[ 1.,  2.,  3.],\r\n        [ 4.,  5.,  6.]])\r\n\r\nIn [6]: tensor_1_half = torch.tensor([1, 2, 3], dtype=torch.half)\r\n\r\nIn [7]: tensor_2_half = torch.tensor([4, 5, 6], dtype=torch.half)\r\n\r\nIn [8]: torch.stack([tensor_1_half, tensor_2_half])\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-8-10f49aa85ea5> in <module>()\r\n----> 1 torch.stack([tensor_1_half, tensor_2_half])\r\n\r\nRuntimeError: _cat is not implemented for type torch.HalfTensor\r\n"", ""\r\nTypeError: Type torch.HalfTensor doesn't implement stateless method cat\r\n""]"
603,23589,0,"ValueError: only one element tensors can be converted to Python scalars. So I have tried the script in the issue **ValueError: only one element tensors can be converted to Python scalars #22674** with the newest Pytorch Version, but it seems doesn't work. Do you have any idea about this

The configuration im using:
Pytorch version: 1.1.0
Python version:3.7.3
torchvision: 0.3.0. []"
626,2656,0,"AttributeError: 'module' object has no attribute 'data' . import os                                                                                                                                                                                                   
import numpy as np
import cPickle
import torch
import torchvision
import gzip
class YT8M(torch.utils.data.Dataset):
  def __init__(self, data_dir):
    self.data_dir = data_dir
    self.file_list = os.listdir(data_dir)

AttributeError: 'module' object has no attribute 'data' 

Why is there no attribute 'data'?
. []"
640,2404,0,"Advanced Indexing issues. There seem to be issues with corner cases where  or  fails if  is 2 or 1 dimensional resp. In other words, an unnecessary trailing  causes failures, while it doesn't in numpy.

MWE is here: https://gist.github.com/arunmallya/23457765e37faf8932da9276e2b449a8. []"
562,566,0,"rebuild pip wheels with manylinux. For install instructions please go to http://pytorch.org

This is needed to work across many different linux distros, new and old.

manylinux will build the wheel on a CentOS5 (yes!) Docker machine.. []"
138,31095,0,"pin_memory stuck in DDP/Reducer constructor. ### Problem

@baobablyh  @pietern and I are working on PR #28883. We are trying to create pinned memory tensors in Reducer constructor:


https://github.com/pytorch/pytorch/blob/4902a08e44e1e8dbcced99b9c18321cf9bb644d5/torch/csrc/distributed/c10d/reducer.cpp#L113-L116

However, we observed that, one of the process created the pinned memory tensor successfully, but another process stuck at the line above. More specifically, it stuck when creating the pinned memory storage (stack traces are attached at the end)

https://github.com/pytorch/pytorch/blob/4902a08e44e1e8dbcced99b9c18321cf9bb644d5/aten/src/ATen/native/Memory.cpp#L24

@baobablyh also discovered that, when adding 3 seconds sleep time after the Reducer constructioin, this problem disappear. So, the symptom likes like something is not ready. It might be caused by invoking async copy in one process while another process has an unready the pinned memory tensor (not sure).

@ngimel @mruberry Do you know what could cause this problem? Or is there any way to synchronize until the pinned memory is ready?

### Reproduce

1. fetch #28883
2. comment out the  in 
 https://github.com/pytorch/pytorch/blob/4902a08e44e1e8dbcced99b9c18321cf9bb644d5/torch/nn/parallel/distributed.py#L308-L310
3. run 

### Trace

Process 1



Process 2



### Environment



cc @ezyang @gchanan @zou3519 @ngimel @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. ['\r\n#0  0x00007ffc203cf9dd in clock_gettime ()\r\n#1  0x00007f9191fffc6d in clock_gettime () from /lib64/libc.so.6\r\n#2  0x00007f9152050ace in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#3  0x00007f91520e5b73 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#4  0x00007f915203ac93 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#5  0x00007f915203ade9 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#6  0x00007f9151f52707 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#7  0x00007f915209a232 in cuStreamSynchronize () from /usr/lib64/nvidia/libcuda.so.1\r\n#8  0x00007f9164fa4dc0 in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#9  0x00007f9164fdcb1d in cudaStreamSynchronize () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#10 0x00007f9168fb9050 in at::native::copy_kernel_cuda(at::TensorIterator&, bool) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#11 0x00007f9169dc863d in void at::native::DispatchStub<void (*)(at::TensorIterator&, bool), at::native::copy_stub>::operator()<at::TensorIterator&, bool&>(c10::DeviceType, at::TensorIterator&, bool&) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#12 0x00007f9169dc593d in at::native::copy_impl(at::Tensor&, at::Tensor const&, bool) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#13 0x00007f9169dc7744 in at::native::copy_(at::Tensor&, at::Tensor const&, bool) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#14 0x00007f916c5afe9b in torch::autograd::VariableType::copy_(at::Tensor&, at::Tensor const&, bool) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#15 0x00007f9168b294e5 in at::Tensor::copy_(at::Tensor const&, bool) const () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#16 0x00007f916a028d42 in at::native::to_impl(at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#17 0x00007f916a02999e in at::native::to(at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#18 0x00007f916a33c2ba in at::TypeDefault::to(at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#19 0x00007f916bf1d77c in torch::autograd::VariableType::(anonymous namespace)::to(at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#20 0x00007f916a3864d2 in c10::detail::wrap_kernel_functor_unboxed_<c10::detail::WrapRuntimeKernelFunctor_<at::Tensor (*)(at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>), at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat> > >, at::Tensor (at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>)>::call(c10::OperatorKernel*, at::Tensor const&, c10::TensorOptions const&, bool, bool, c10::optional<c10::MemoryFormat>) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#21 0x00007f917c0eb3de in torch::autograd::dispatch_to(at::Tensor const&, c10::Device, bool, bool, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch_python.so\r\n#22 0x00007f917c20bb2c in torch::autograd::THPVariable_to(_object*, _object*, _object*) () from /data/users/shenli/pytorch/torch/lib/libtorch_python.so\r\n#23 0x000056527b9716e4 in _PyMethodDef_RawFastCallKeywords (method=0x56527d110a60, self=0x7f9152df0678, args=0x7f9152e3acc0, nargs=<optimized out>, \r\n    kwnames=<optimized out>) at /tmp/build/80754af9/python_1553721932202/work/Objects/call.c:690\r\n#24 0x000056527b97186f in _PyMethodDescr_FastCallKeywords (descrobj=0x7f91536d8438, args=0x7f9152e3acb8, nargs=4, kwnames=0x0)\r\n    at /tmp/build/80754af9/python_1553721932202/work/Objects/descrobject.c:288\r\n#25 0x000056527b9cd07c in call_function (kwnames=0x0, oparg=4, pp_stack=<synthetic pointer>) at /tmp/build/80754af9/python_1553721932202/work/Python/ceval.c:4593\r\n#26 _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at /tmp/build/80754af9/python_1553721932202/work/Python/ceval.c:3110\r\n#27 0x000056527b90edb9 in _PyEval_EvalCodeWithName (_co=0x7f91534aac90, globals=<optimized out>, locals=<optimized out>, args=<optimized out>, \r\n    argcount=<optimized out>, kwnames=0x0, kwargs=0x5652aea29f70, kwcount=0, kwstep=1, defs=0x0, defcount=0, kwdefs=0x0, closure=0x7f9152ddaf30, name=0x7f918a95fa78, \r\n    qualname=0x7f91534a92b0) at /tmp/build/80754af9/python_1553721932202/work/Python/ceval.c:3930\r\n#28 0x000056527b970a27 in _PyFunction_FastCallKeywords (func=<optimized out>, stack=0x5652aea29f68, nargs=1, kwnames=<optimized out>)\r\n    at /tmp/build/80754af9/python_1553721932202/work/Objects/call.c:433\r\n#29 0x000056527b9c8846 in call_function (kwnames=0x0, oparg=<optimized out>, pp_stack=<synthetic pointer>)\r\n    at /tmp/build/80754af9/python_1553721932202/work/Python/ceval.c:4616\r\n', '\r\n#0  0x00007f9151f5b8f9 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#1  0x00007f91520a1e1b in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#2  0x00007f91520a2947 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#3  0x00007f9151f5c29a in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#4  0x00007f9151f5cbb3 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#5  0x00007f9152186a9a in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#6  0x00007f9152186c52 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#7  0x00007f9152186cf7 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#8  0x00007f91520178dd in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#9  0x00007f91520186e8 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#10 0x00007f91520152a8 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#11 0x00007f9152032349 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#12 0x00007f9151f7a15d in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#13 0x00007f9151f7a470 in ?? () from /usr/lib64/nvidia/libcuda.so.1\r\n#14 0x00007f9164fbc1e7 in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#15 0x00007f9164fb62a0 in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#16 0x00007f9164fc2616 in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#17 0x00007f9164fc5031 in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#18 0x00007f9164fb823e in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#19 0x00007f9164fa47de in ?? () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#20 0x00007f9164fd9684 in cudaEventDestroy () from /usr/local/cuda/lib64/libcudart.so.9.2\r\n#21 0x00007f916c88cfff in THCCachingHostAllocator::allocate(unsigned long) const () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#22 0x00007f916a02d96a in at::native::empty_cpu(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#23 0x00007f916a24c6bb in at::CPUType::(anonymous namespace)::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#24 0x00007f916a2944b7 in c10::detail::wrap_kernel_functor_unboxed_<c10::detail::WrapRuntimeKernelFunctor_<at::Tensor (*)(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>), at::Tensor, c10::guts::typelist::typelist<c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat> > >, at::Tensor (c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>)>::call(c10::OperatorKernel*, c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#25 0x00007f916c236778 in torch::autograd::VariableType::(anonymous namespace)::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#26 0x00007f916a2944b7 in c10::detail::wrap_kernel_functor_unboxed_<c10::detail::WrapRuntimeKernelFunctor_<at::Tensor (*)(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>), at::Tensor, c10::guts::typelist::typelist<c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat> > >, at::Tensor (c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>)>::call(c10::OperatorKernel*, c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#27 0x00007f916a035731 in at::empty () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#28 0x00007f916a03a755 in at::native::zeros(c10::ArrayRef<long>, c10::TensorOptions const&) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#29 0x00007f916a342093 in at::TypeDefault::zeros(c10::ArrayRef<long>, c10::TensorOptions const&) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#30 0x00007f916c02c026 in torch::autograd::VariableType::(anonymous namespace)::zeros(c10::ArrayRef<long>, c10::TensorOptions const&) ()\r\n   from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n#31 0x00007f916a3855f9 in c10::detail::wrap_kernel_functor_unboxed_<c10::detail::WrapRuntimeKernelFunctor_<at::Tensor (*)(c10::ArrayRef<long>, c10::TensorOptions const&), at::Tensor, c10::guts::typelist::typelist<c10::ArrayRef<long>, c10::TensorOptions const&> >, at::Tensor (c10::ArrayRef<long>, c10::TensorOptions const&)>::call(c10::OperatorKernel*, c10::ArrayRef<long>, c10::TensorOptions const&) () from /data/users/shenli/pytorch/torch/lib/libtorch.so\r\n', '\r\nPyTorch version: 1.4.0a0+cbf7f8b\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.2\r\nOS: CentOS Linux 7 (Core)\r\nGCC version: (GCC) 7.3.1 20180303 (Red Hat 7.3.1-5)\r\nCMake version: version 3.14.2\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.2.88\r\nGPU models and configuration:\r\nGPU 0: Tesla M40\r\nGPU 1: Tesla M40\r\nNvidia driver version: 396.69\r\ncuDNN version: Could not collect\r\nVersions of relevant libraries:\r\n[pip] numpy==1.17.2\r\n[pip] torch==1.4.0a0+cbf7f8b\r\n[conda] blas                      1.0                         mkl\r\n[conda] magma-cuda90              2.5.0                         1    pytorch\r\n[conda] mkl                       2019.4                      243\r\n[conda] mkl-include               2019.4                      243\r\n[conda] mkl-service               2.3.0            py37he904b0f_0\r\n[conda] mkl_fft                   1.0.14           py37ha843d7b_0\r\n[conda] mkl_random                1.1.0            py37hd6b4f25_0\r\n[conda] torch                     1.4.0a0+cbf7f8b           dev_0    <develop>\r\n']"
408,15544,0,"python api ok but c++ api bad. ## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)

i build pytorch v1 source code in a docker container without gpu, but has cuda.
commit and save to a docker image.
run this docker image on another machine with GPU, occur below:
 pytorch python api is ok:
![image](https://user-images.githubusercontent.com/17922949/50450451-20526e80-0969-11e9-8158-029ae2700ff5.png)
but pytorch c++ api is bad:
![image](https://user-images.githubusercontent.com/17922949/50450462-32cca800-0969-11e9-9701-fea278df8f1f.png)


gcc version : 4.8.4
cuda : 9.0.176
nvidia driver : 384.81
cudnn : 7.0.3

why ? hope to get help!

  


. []"
122,17484,0,"Parameter not registering if .to(device) is used. ## üêõ Bug

During instantiation of a custom module, parameters do not register if they are initialized with a .to('cuda') function call on the parameter level. 

## To Reproduce



On the other hand, if the .to('cuda') is called on the wrapped tensor, everything works as expected.




OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: Could not collect

Python version: 3.5
Is CUDA available: N/A
CUDA runtime version: 7.5.17
GPU models and configuration: GPU 0: GeForce GTX 1070
Nvidia driver version: 384.130
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] msgpack-numpy==0.4.1
[pip] numpy==1.13.3
[pip] torch==1.0.0
[pip] torchvision==0.2.1
[conda] Could not collect

. [""\r\nclass A(torch.nn.Module):\r\n    def __init__(self):\r\n        super(A, self).__init__()\r\n        self.par = torch.nn.Parameter(torch.rand(5)).to('cuda')\r\n    def forward(self):\r\n        pass\r\n    \r\na= A()\r\na.state_dict()\r\nOut[8]: OrderedDict()\r\n"", ""\r\nclass A(torch.nn.Module):\r\n    def __init__(self):\r\n        super(A, self).__init__()\r\n        self.par = torch.nn.Parameter(torch.rand(5, device='cuda'))\r\n    def forward(self):\r\n        pass\r\n    \r\na = A()\r\na.state_dict()\r\nOut[13]: \r\nOrderedDict([('par',\r\n              tensor([0.0247, 0.8373, 0.2540, 0.9849, 0.5181], device='cuda:0'))])\r\n""]"
65,18786,1,"tensor.cuda() is slow after invoking model(input) and loss.backward(). ## ‚ùì Questions and Help

### I'm trying to test the costing of time in the main procedures in train-step, in order to accelerate my training. Then I found that  become slow after executing  and 
Here are the codes and the results with only load batch from dataloader and convert it to cuda:

    for i, (b, target) in enumerate(train_loader):
        start = time.time()
        target_cuda = target.cuda()
        input = b.cuda().half()
        now = time.time()
        cost = now - start
        print(cost)
        # output = model(input)
        # loss = criterion(output[0], target_cuda)
        # loss.backward()model(input)loss.backward()torch.cuda.synchronize().cuda()backward().`
- [Discussion Forum](https://discuss.pytorch.org/)
. []"
81,22961,1,"performance much worse on 2080ti than 1080ti. ## üêõ Bug

I have a model that I have historically trained on 1080ti, and recently I discovered that the training speed is much worse (almost 2x slower) on 2080ti. The rest of the setup (nvidia driver  + cpu + networking) is the same between the two.

I profiled my script using , and discovered that on the 2080ti, way too much time (~70%) is spent in this function:


Any ideas what the problem could be?
I have attached the two profiles in case they are helpful.
[1080ti.log](https://github.com/pytorch/pytorch/files/3400744/1080ti.log)
[2080ti.log](https://github.com/pytorch/pytorch/files/3400745/2080ti.log)

 - PyTorch Version (e.g., 1.0): 1.1.0
 - OS (e.g., Linux): Ubuntu 16.04
 - How you installed PyTorch (, , source): pip
 - Build command you used (if compiling from source):
 - Python version: 3.6
 - CUDA/cuDNN version: 10.0 / 7.4
 - GPU models and configuration: 1080ti + 2080ti, nvidia driver 410.78
 - Any other relevant information:
. ['void cudnn::detail::convolveNd_wgrad_engine<float, int=3, int=512, int=6, int=5, int=3, int=3, int=3, bool=1>(int, int, int, float const *, int, cudnn::detail::convolveNd_wgrad_engine<float, int=3, int=512, int=6, int=5, int=3, int=3, int=3, bool=1>*, float const , kernel_gradNd_params, int, float, int)']"
605,28795,0,"Getting Build Error. I am building PyTorch and I am getting the following error. Would be great to know how to fix it.

Thank you

. ['\r\n[10/699] Building CXX object caffe2/CMakeFiles/torch.dir/operators/spatial_batch_norm_gradient_op.cc.o\r\nninja: build stopped: subcommand failed.\r\nTraceback (most recent call last):\r\n  File ""setup.py"", line 751, in <module>\r\n    build_deps()\r\n  File ""setup.py"", line 310, in build_deps\r\n    cmake=cmake)\r\n']"
314,10170,0,"build error. ## Issue description
Failed to build the caffe2

## Code example

CMake 3.11.3

## System Info
- Caffe2:

******** Summary ********
General:
  CMake version         : 3.11.3
  CMake command         : C:/Program Files/CMake/bin/cmake.exe
  Git version           : v0.1.11-9628-gf908b2b91-dirty
  System                : Windows
  C++ compiler          : C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/x86_amd64/cl.exe
  C++ compiler version  : 19.0.24215.1
  BLAS                  : Eigen
  CXX flags             : /DWIN32 /D_WINDOWS /W3 /GR /EHsc -DONNX_NAMESPACE=onnx_c2 /MP /bigobj
  Build type            : Release
  Compile definitions   : 
  CMAKE_PREFIX_PATH     : 
  CMAKE_INSTALL_PREFIX  : C:/dev/pytorch/build/install

  BUILD_CAFFE2          : ON
  BUILD_ATEN            : OFF
  BUILD_BINARY          : ON
  BUILD_CUSTOM_PROTOBUF : ON
    Link local protobuf : ON
  BUILD_DOCS            : OFF
  BUILD_PYTHON          : OFF
  BUILD_SHARED_LIBS     : ON
  BUILD_TEST            : OFF
  USE_ASAN              : OFF
  USE_ATEN              : OFF
  USE_CUDA              : ON
    CUDA static link    : OFF
    USE_CUDNN           : ON
    CUDA version        : 8.0
    cuDNN version       : 7.0.5
    CUDA root directory : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0
    CUDA library        : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cuda.lib
    cudart library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cudart_static.lib
    cublas library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cublas.lib;C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cublas_device.lib
    cufft library       : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cufft.lib
    curand library      : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/curand.lib
    cuDNN library       : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/cudnn.lib
    nvrtc               : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/lib/x64/nvrtc.lib
    CUDA include path   : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/include
    NVCC executable     : C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v8.0/bin/nvcc.exe
    CUDA host compiler  : $(VCInstallDir)bin
    USE_TENSORRT        : OFF
  USE_ROCM              : OFF
  USE_EIGEN_FOR_BLAS    : ON
  USE_FFMPEG            : OFF
  USE_GFLAGS            : ON
  USE_GLOG              : ON
  USE_GLOO              : OFF
  USE_LEVELDB           : OFF
  USE_LITE_PROTO        : OFF
  USE_LMDB              : OFF
  USE_METAL             : OFF
  USE_MKL               : 
  USE_MOBILE_OPENGL     : OFF
  USE_MPI               : OFF
  USE_NCCL              : OFF
  USE_NERVANA_GPU       : OFF
  USE_NNPACK            : OFF
  USE_OBSERVERS         : OFF
  USE_OPENCL            : OFF
  USE_OPENCV            : OFF
  USE_OPENMP            : OFF
  USE_PROF              : OFF
  USE_REDIS             : OFF
  USE_ROCKSDB           : OFF
  USE_ZMQ               : OFF
  Public Dependencies  : Threads::Threads;gflags;glog::glog
  Private Dependencies : cpuinfo;onnxifi_loader
Configuring done
Generating done
. []"
728,10690,0,"non-blocking cuda2cpu copy shouldn't require contiguity. ['\r\n>>> x = torch.rand(2,3).cuda()\r\nx.>>> x.t().cpu()\r\ntensor([[0.6202, 0.0882],\r\n        [0.1994, 0.1465],\r\n        [0.5524, 0.7550]])\r\n>>> x.t().to(\'cpu\')\r\ntensor([[0.6202, 0.0882],\r\n        [0.1994, 0.1465],\r\n        [0.5524, 0.7550]])\r\n>>> x.t().to(\'cpu\', non_blocking=True)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nRuntimeError: invalid argument 3: Source tensor must be contiguous at /private/home/ssnl/sftp/pytorch/aten/src/THC/generic/THCTensorCopy.cpp:141\r\n']"
373,14996,0,"as_tensor does not use the device of the default tensor type. ## üêõ Bug

According to the [doc](https://pytorch.org/docs/stable/torch.html?highlight=torch%20as_tensor#torch.as_tensor) for , the input should be copied to a cuda device if the default tensor type is a cuda tensor. 

> Default: if None, uses the current device for the default tensor type (see torch.set_default_tensor_type()). device will be the CPU for CPU tensor types and the current CUDA device for CUDA tensor types.

It does copy to cuda device if the input is a numpy array, but not if the input is a cpu tensor. 

## To Reproduce

Steps to reproduce the behavior:



## Expected behavior

The device should be the 'cuda' device in both cases.

## Environment

PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: version 3.10.2

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration:
GPU 0: GeForce GTX 1070
GPU 1: GeForce GTX 1080

Nvidia driver version: 390.77
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] Could not collect
[conda] blas                      1.0                         mkl
[conda] mkl                       2018.0.3                      1
[conda] mkl_fft                   1.0.6            py37h7dd41cf_0
[conda] mkl_random                1.0.1            py37h4414c95_1
[conda] pytorch                   1.0.0           py3.7_cuda9.0.176_cudnn7.4.1_1    pytorch
[conda] torchvision               0.2.1                      py_2    pytorch



cc @ngimel @jlin27 @mruberry. [""\r\nIn [1]: import torch\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: torch.set_default_tensor_type(torch.cuda.FloatTensor)\r\n\r\nIn [4]: torch.as_tensor(np.random.randn(4)).device\r\nOut[4]: device(type='cuda', index=0)\r\n\r\nIn [5]: torch.as_tensor(torch.randn(4, device='cpu')).device\r\nOut[5]: device(type='cpu')\r\n""]"
158,18671,0,"[jit] crash in unpickler code. See this test result: https://fburl.com/testinfra/6yuycydh

. [""\r\ntest_cumprod_zeros_dim2_neg0 (test_jit.TestJitGeneratedAutograd) ... ../fbcode/third-party-buck/gcc-5-glibc-2.23/build/libgcc/include/c++/5.5.0/bits/stl_iterator.h:810:45: runtime error: pointer index expression with base 0x000000000000 overflowed to 0xfffffffffffffff0\r\n    #0 0x7fdca4075dd8 in __gnu_cxx::__normal_iterator<c10::IValue*, std::vector<c10::IValue, std::allocator<c10::IValue> > >::operator-(long) const ../fbcode/third-party-buck/gcc-5-glibc-2.23/build/libgcc/include/c++/5.5.0/bits/stl_iterator.h:810\r\n    #1 0x7fdca483d2e4 in std::vector<c10::IValue, std::allocator<c10::IValue> >::back() ../fbcode/third-party-buck/gcc-5-glibc-2.23/build/libgcc/include/c++/5.5.0/bits/stl_vector.h:882\r\n    #2 0x7fdca4e9027b in torch::jit::Unpickler::readInstruction() caffe2/torch/csrc/jit/pickler.cpp:342\r\n    #3 0x7fdca4e8db77 in torch::jit::Unpickler::run() caffe2/torch/csrc/jit/pickler.cpp:324\r\n    #4 0x7fdca4e8d0b2 in torch::jit::Unpickler::parse_ivalue_list() caffe2/torch/csrc/jit/pickler.cpp:294\r\n    #5 0x7fdca4af3128 in torch::jit::(anonymous namespace)::ScriptModuleDeserializer::loadAttributeTable() caffe2/torch/csrc/jit/import.cpp:157\r\n    #6 0x7fdca4aeee51 in torch::jit::(anonymous namespace)::ScriptModuleDeserializer::deserialize(std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, c10::optional<c10::Device>, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&) caffe2/torch/csrc/jit/import.cpp:135\r\n    #7 0x7fdca4aed3c0 in torch::jit::import_ir_module(std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::istream&, c10::optional<c10::Device>, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&) caffe2/torch/csrc/jit/import.cpp:293\r\n    #8 0x7fdca8bd94c7 in torch::jit::script::initJitScriptBindings(_object*)::$_35::operator()(std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&) const caffe2/torch/csrc/jit/script/init.cpp:1080\r\n    #9 0x7fdca8bd8d04 in void pybind11::detail::argument_loader<std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&>::call_impl<void, torch::jit::script::initJitScriptBindings(_object*)::$_35&, 0ul, 1ul, 2ul, 3ul, pybind11::detail::void_type>(torch::jit::script::initJitScriptBindings(_object*)::$_35&&&, std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul>, pybind11::detail::void_type&&) third-party-buck/gcc-5-glibc-2.23/build/pybind11/889256a/include/pybind11/cast.h:1860\r\n    #10 0x7fdca8bd8acc in std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&>::call<void, pybind11::detail::void_type, torch::jit::script::initJitScriptBindings(_object*)::$_35&>(torch::jit::script::initJitScriptBindings(_object*)::$_35&&&) && third-party-buck/gcc-5-glibc-2.23/build/pybind11/889256a/include/pybind11/cast.h:1842\r\n    #11 0x7fdca8bd86dd in void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_35, void, std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&, pybind11::name, pybind11::scope, pybind11::sibling>(torch::jit::script::initJitScriptBindings(_object*)::$_35&&, void (*)(std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::operator()(pybind11::detail::function_call&) const third-party-buck/gcc-5-glibc-2.23/build/pybind11/889256a/include/pybind11/pybind11.h:154\r\n    #12 0x7fdca8bd82f8 in void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_35, void, std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&, pybind11::name, pybind11::scope, pybind11::sibling>(torch::jit::script::initJitScriptBindings(_object*)::$_35&&, void (*)(std::function<std::shared_ptr<torch::jit::script::Module> (std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&)>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, pybind11::object, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >&), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) third-party-buck/gcc-5-glibc-2.23/build/pybind11/889256a/include/pybind11/pybind11.h:131\r\n""]"
300,5157,0,"BCELoss - weight parameter shape incorrect. The  parameter of  seems to be incorrectly defined when using a multi-dimensional input and target. Related [forum thread](https://discuss.pytorch.org/t/binary-cross-entropy-weights/13299).

The documentation defines  as:
> If given, has to be a Tensor of size ‚Äúnbatch‚Äù.

However, this example throws an error:


A workaround is to  the  tensor to match the number of dimensions:


Internally,  is called and fails in the first code snippet.
The second code snippet applied a weighting for each batch element, which is fine.

Should we automatically unsqueeze the weight tensor, if input and target are multi-dimensional?

Also, how should we handle class weighting?
If we just pass 2 weights as the  tensor, the code successfully runs, but does not apply class weighting, which might mislead some users:


A workaround would be:


What is wanted behavior of the  parameter in : class or batch weighting?
Both cases have some issues at the moment in my opinion.
I would like to fix this issue, but I would like to hear some opinions on the right behavior.
Class weighting would be consistent with other loss functions like , but maybe batch weighting is a more common use case for .

PyTorch version:  (installed from source)

. ['\r\nx = Variable(torch.randn(4, 2, 2))\r\ny = Variable(torch.Tensor(4, 2, 2).random_(2))\r\noutput = F.sigmoid(x)\r\n\r\n# Create weight according to doc in BCELoss\r\nweight = torch.randn(4)\r\ncriterion_weighted = nn.BCELoss(weight=weight)\r\nloss_weighted = criterion_weighted(output, y) # Error!\r\n', '\r\n# Unsqueeze weight tensor\r\nweight = torch.randn(4, 1, 1)\r\ncriterion_weighted = nn.BCELoss(weight=weight)\r\nloss_weighted = criterion_weighted(output, y)\r\n', ""\r\n# Create class weights\r\nweight = torch.FloatTensor([0.1, 0.9]) \r\n\r\n# Internally, weight is expanded as\r\nsize = _infer_size(weight.size(), y.size())\r\nweight_expanded = weight.expand(size) \r\nprint(weight_expanded) # This is not, what we wanted as class weights!\r\n\r\ncriterion_weighted = nn.BCELoss(weight=weight)\r\nloss_weighted = criterion_weighted(output, y)\r\ncriterion_nonreduced = nn.BCELoss(reduce=False)\r\nloss_unreduced = criterion_nonreduced(output, y)\r\nloss_weighted_manual = (Variable(weight_expanded) * loss_unreduced).mean()\r\n\r\nif loss_weighted == loss_weighted_manual:\r\n    print('Class weighting failed')\r\n"", '\r\nweight_ = weight[y.data.view(-1).long()].view_as(y)\r\ncriterion = nn.BCELoss(reduce=False)\r\nloss = criterion(output, y)\r\nloss_class_weighted = loss * Variable(weight_)\r\n']"
369,20323,0,"Support size to `torch.normal`. This would be more consistent with numpy.



cc @mruberry @rgommers @heitorschueroff. ['python\r\ntorch.normal(0.0, 4.0, size=5)\r\n']"
680,15166,0,"BUG:torch.nn.functional.multi_margin_loss. pytorch1.0
BUG:torch.nn.functional.multi_margin_loss
example:
import torch 
import torch.nn.functional as F
a=[[1.,2.,3.,4.]]
b=[2]
input=torch.tensor(a,requires_grad=True)
target = torch.tensor(b)
k = torch.tensor(c)
output = F.multi_margin_loss(input,target,p=1.,margin=1.,reduce=False,size_average=False)
print(output)
--------------------------
tensor([0.5000], grad_fn=<MultiMarginLossBackward>)
. []"
694,3238,0,"Dimension issue with `softmax` and related functions for 1D tensors. There seems to be an erroneous dimension calculation for any function that uses the  private function. If the input is a 1D tensor, the implicit dimension computed is 1, which is a problem since  is invalid for a 1D tensor.

Minimal reproducible example:

This produces the error:

I'm running pytorch installed from source, from  (off of commit dc6510f7). [' python\r\nimport torch\r\nfrom torch.nn.functional import softmax\r\nfrom torch.autograd import Variable\r\ns = softmax(Variable(torch.zeros(3)))\r\n', ""\r\n/<..>/.virtualenvs/pytorch/bin/ipython:1: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.\r\n  #!/<...>/.virtualenvs/pytorch/bin/python2.7\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-6-82ccfcf6f7ce> in <module>()\r\n----> 1 softmax(Variable(torch.Tensor([1,2,3])))\r\n\r\n/<...>/.virtualenvs/pytorch/lib/python2.7/site-packages/torch/nn/functional.pyc in softmax(input, dim, _stacklevel)\r\n    658     if dim is None:\r\n    659         dim = _get_softmax_dim('softmax', input.dim(), _stacklevel)\r\n--> 660     return torch._C._nn.softmax(input, dim)\r\n    661 \r\n    662 \r\n\r\nRuntimeError: invalid argument 4: dim out of range (got 1, but input has 1 dims) at /<...>/pytorch/torch/lib/THNN/generic/SoftMax.c:19\r\n""]"
29,5801,1,"KLDivLoss behaves differently on CPU/GPU. Pytorch Version: '0.3.0'

Code:


Without cuda, both the gradients and the loss are the same:


With cuda the gradients returned by KLDivLoss are scaled down by the number of class, while the loss is the same. 
. ['\r\nimport torch\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\nimport sys\r\n\r\nbatchsize = 8\r\nnclass = 5\r\n\r\nif sys.argv[1] == ""cuda"":\r\n    cuda = True\r\nelse:\r\n    cuda = False\r\n\r\nprint(""Cuda: "" + str(cuda))\r\n\r\ndef make_prob():\r\n    if cuda:\r\n        pr = torch.cuda.FloatTensor(batchsize, nclass)\r\n    else:\r\n        pr = torch.FloatTensor(batchsize, nclass)\r\n    pr.uniform_()\r\n    pr /= pr.sum(dim=1).view(batchsize, 1)\r\n    return pr\r\n\r\ndef loss_kl(pi, targets):\r\n    pi_var = Variable(pi, requires_grad=True)\r\n    logsoftmax = nn.LogSoftmax(dim=1)\r\n    kl = nn.KLDivLoss()\r\n\r\n    if cuda:\r\n        logsoftmax.cuda()\r\n        kl.cuda()\r\n\r\n    logpi = logsoftmax(pi_var)\r\n    return kl(logpi, Variable(targets)) * logpi.size(1), pi_var\r\n\r\ndef loss_plain(pi, targets):\r\n    pi_var = Variable(pi, requires_grad=True)\r\n    targets_var = Variable(targets)\r\n    logsoftmax = nn.LogSoftmax(dim=1)\r\n\r\n    if cuda:\r\n        logsoftmax.cuda()\r\n\r\n    logpi = logsoftmax(pi_var)\r\n    loss = - (logpi * targets_var).sum(dim=1).mean() + (targets_var * targets_var.log()).sum(dim=1).mean()\r\n    return loss, pi_var\r\n\r\ntargets = make_prob()\r\npi = make_prob()\r\n\r\nloss1, pi_var1 = loss_kl(pi, targets)\r\nprint(loss1)\r\nloss1.backward()\r\nprint(pi_var1.grad)\r\n\r\nloss2, pi_var2 = loss_plain(pi, targets)\r\nprint(loss2)\r\nloss2.backward()\r\nprint(pi_var2.grad)\r\n', '\r\n$ python3 ~/test_kl.py nocuda\r\nCuda: False\r\nVariable containing:\r\n 0.1930\r\n[torch.FloatTensor of size 1]\r\n\r\nVariable containing:\r\n1.00000e-02 *\r\n  1.9849 -1.7913 -0.1536  0.1435 -0.1834\r\n -2.1244  2.5148  0.9348  0.5213 -1.8464\r\n  0.3656  0.1773 -0.1752 -0.1085 -0.2591\r\n -1.7945 -0.2471  1.9382  1.0904 -0.9869\r\n  1.6413  2.5043 -1.3458 -3.3194  0.5196\r\n  0.0206 -1.2024  0.4363  0.8926 -0.1471\r\n -0.4564  2.5605  0.2420 -1.0382 -1.3080\r\n  1.9253  1.7758 -1.0304 -0.5174 -2.1532\r\n[torch.FloatTensor of size 8x5]\r\n\r\nVariable containing:\r\n 0.1930\r\n[torch.FloatTensor of size 1]\r\n\r\nVariable containing:\r\n1.00000e-02 *\r\n  1.9849 -1.7913 -0.1536  0.1435 -0.1834\r\n -2.1244  2.5148  0.9348  0.5213 -1.8464\r\n  0.3656  0.1773 -0.1752 -0.1085 -0.2591\r\n -1.7945 -0.2471  1.9382  1.0904 -0.9869\r\n  1.6413  2.5043 -1.3458 -3.3194  0.5196\r\n  0.0206 -1.2024  0.4363  0.8926 -0.1471\r\n -0.4564  2.5605  0.2420 -1.0382 -1.3080\r\n  1.9253  1.7758 -1.0304 -0.5174 -2.1532\r\n[torch.FloatTensor of size 8x5]\r\n', '\r\n$ python3 ~/test_kl.py cuda\r\nCuda: True\r\nVariable containing:\r\n 0.1756\r\n[torch.cuda.FloatTensor of size 1 (GPU 0)]\r\n\r\nVariable containing:\r\n1.00000e-03 *\r\n -1.2566 -3.5917 -0.8016  2.9373  2.7126\r\n -0.0264  2.3321 -1.3892  1.0676 -1.9841\r\n  0.1204  4.5507 -2.2642 -3.7239  1.3170\r\n  0.5667 -2.7765  4.3564 -4.8917  2.7452\r\n  2.3703 -2.4578  2.7945  1.8861 -4.5931\r\n -0.2237 -0.2954  1.7677  1.7757 -3.0243\r\n -3.9952 -7.2011  2.1794  3.3324  5.6845\r\n -0.2814  0.0368 -2.2764 -0.2955  2.8164\r\n[torch.cuda.FloatTensor of size 8x5 (GPU 0)]\r\n\r\nVariable containing:\r\n 0.1756\r\n[torch.cuda.FloatTensor of size 1 (GPU 0)]\r\n\r\nVariable containing:\r\n1.00000e-02 *\r\n -0.6283 -1.7959 -0.4008  1.4686  1.3563\r\n -0.0132  1.1661 -0.6946  0.5338 -0.9920\r\n  0.0602  2.2753 -1.1321 -1.8619  0.6585\r\n  0.2833 -1.3883  2.1782 -2.4459  1.3726\r\n  1.1852 -1.2289  1.3972  0.9430 -2.2966\r\n -0.1119 -0.1477  0.8838  0.8879 -1.5121\r\n -1.9976 -3.6006  1.0897  1.6662  2.8423\r\n -0.1407  0.0184 -1.1382 -0.1477  1.4082\r\n[torch.cuda.FloatTensor of size 8x5 (GPU 0)]\r\n']"
501,7525,0,"tqdm install is failing with ValueError: bad marshal data (unknown type code). Sample failing CI build: https://ci.pytorch.org/jenkins/job/pytorch-builds/job/pytorch-linux-trusty-pynightly-test/6167//console

I did some investigation, and the error only happens if you use  directly (e.g., if you use , and it goes away if you use a newer Python 3.7 nightly (e.g., from deadsnakes). So it might be a bug in Python 3.7 (slash setuptools) which was subsequently fixed.

Unfortunately, preinstall tqdm isn't sufficient to avoid the problem. But  on torchvision might be enough. I am giving it a try.. []"
663,26834,0,"FakeQuantize params not rendering correctly. the parameters for the FakeQuantize function aren't showing up right. 
<img width=""897"" alt=""Screen Shot 2019-09-25 at 1 12 06 PM"" src=""https://user-images.githubusercontent.com/45861273/65636145-99353400-df96-11e9-9e0f-4c6b79b7ac91.png"">
. []"
41,18175,1,"[Caffe2] Does Caffe2 support distributed training with only CPU?. I found this sentence on https://caffe2.ai/docs/distributed-training.html:
""We‚Äôre assuming that you‚Äôve successfully built Caffe2 and that you have a system with at least one GPU, but preferably more to test out the distributed features.""

Since I have to do some experiments about CPU performance, I wonder if I can use distributed training with CPU only cluster?. []"
368,6171,0,"Compute csr representation on torch.sparse.Tensor.coalesce for faster sparse matrix multiplication . On the code on sparse matrix-dense matrix multiplication
https://github.com/pytorch/pytorch/blob/master/aten/src/THS/generic/THSTensorMath.c#L305
and 
https://github.com/pytorch/pytorch/blob/master/aten/src/THCS/generic/THCSTensorMath.cu#L58 , 
it first computes csr representation, then perform sparse matrix-dense matrix multiplication based on that representation, then destroy the csr representation. 
If we repeatedly perform matrix multiplication on the same sparse matrix, computing csr representation is redundant. This could be resolved by computing csr representation only once when coalescing  and save it as a member of  or  ( https://github.com/pytorch/pytorch/blob/master/aten/src/THS/generic/THSTensor.cpp#L428 and
https://github.com/pytorch/pytorch/blob/master/aten/src/THCS/generic/THCSTensor.cu#L38 ). This would enhance speed of sparse matrix-dense matrix multiplication.

Will this be a good modification? Shall I try to make a pull request on this one?



cc @vincentqb @aocsa @nikitaved @pearu @mruberry. []"
649,7989,0,"[documentation request] 'clone' needs better documentation. [The current documentation for  is](https://pytorch.org/docs/stable/tensors.html?highlight=clone#torch.Tensor.clone):

> Returns a copy of the  tensor. The copy has the same size and data type as .

This documentation fails to elucidate the fact that any gradient propagating through the cloned tensor will propagate to the original tensor. This is critical to the functionality of clone (and is why the method isn't called ""copy""), and is just begging for newcomers to make hard-to-find mistakes. . []"
665,22549,0,"How to programmatically check PyTorch version. ## üìö Documentation

[Minor minor detail]
In the reproducibility section of the docs or in the FAQ, I would add a simple subsection/snippet of code to show how to programmatically check the running version of PyTorch. 
This can also encourage users to take into account heterogeneity of PyTorch versions in their code.

By the way, a simple regex on  is enough (this assuming version numbering will not change).

. [""python\r\nimport torch\r\nimport re\r\nif int(re.search(r'([\\d.]+)', torch.__version__).group(1).replace('.', '')) < 100:\r\n    raise ImportError('Your PyTorch version is not supported. '\r\n                      'Please download and install PyTorch 1.x')\r\n""]"
442,2490,0,"libquadmath is repeated in TH/CMakeLists.txt. in file 'torch/lib/TH/CMakeLists.txt', line 473 ~ 477,



libquadmath is repeated.
. ['\r\nInstall_Required_Library(${BLAS_openblas_LIBRARY})\r\nInstall_Required_Library(""${libpath}/libquadmath"")   \r\nInstall_Required_Library(""${libpath}/libgfortran"")   \r\nInstall_Required_Library(""${libpath}/libquadmath"")   \r\nInstall_Required_Library(""${libpath}/libgcc"")\r\n']"
295,12646,0,"Caffe2 Installation inside Pytorch. i am getting this error message (please see the attached) after run the command ""python setup.py install"":
![pytorch_question](https://user-images.githubusercontent.com/8035201/46946663-b2551580-d0a2-11e8-9f9e-afd34fd2454d.png). 
I followed this office guide of pytorch: https://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=compile.
But the weird thing is I can print the coffee2 sucessfully
![coffe2](https://user-images.githubusercontent.com/8035201/46946767-03fda000-d0a3-11e8-8de5-4ccbba7c3d36.png)

i would like to ask if does anybody knows how to fix this?

. []"
261,14685,0,"[Caffe2] Exception when creating gradient for [Cast] SquaredL2Distance as output layer of CNN network. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

I am getting the following error when I use the SquaredL2Distance operator as the output layer of my CNN network **(1st attempt)**:



28train_net

Then I tried to fix the error converting  to float (even though it is already float32, see below) using the Cast operator **(2nd attempt)**

However, I got the following error:



Furthermore, I created the LMDB training dataset which stores the image data as uint8 and the label as a multivalue of float64:
**key: 00000001
image_data: shape: (210, 280, 3) type: uint8
indicators:    shape: (14,)              type: float64**

**How can I fix the error?**

## To Reproduce

Steps to reproduce the behavior:

1. **Project consists in two files: a trainer and a creator. Run the trainer which calls the train function of the creator.**

Trainer.py:


CNNCreator_dpnet_dpnet.py:



<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

Execute SquaredL2Distance as the output layer of the CNN network

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): **Caffer2 tag v0.4.0**
 - OS (e.g., Linux): **Ubuntu 16.04**
 - How you installed PyTorch (conda, pip, source): **Build from source (tag v0.4.0)**
 - Build command you used (if compiling from source):
 - Python version: **Python 2.7**
 - CUDA/cuDNN version: **8.0/7.0.5**
 - GPU models and configuration: **GTX 1050**
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. [""\r\ndist = model.net.SquaredL2Distance([label, fc9_], 'dist')\r\npredictions = dist.AveragedLoss([], ['predictions'])\r\n"", ""\r\nlabel_float = model.Cast(label, None, to=core.DataType.FLOAT)\r\ndist = model.net.SquaredL2Distance([label_float, fc9_], 'dist')\r\npredictions = dist.AveragedLoss([], ['predictions'])\r\n"", '\r\ncarlos@carlos-ubuntu:~/Documents/git/Caffe2_scripts/caffe2_torcs_predictor$ python CNNTrainer_dpnet_dpnet.py \r\nGPU mode selected\r\nTraceback (most recent call last):\r\n  File ""CNNTrainer_dpnet_dpnet.py"", line 24, in <module>\r\n    stepsize=8000\r\n  File ""/home/carlos/Documents/git/Caffe2_scripts/caffe2_torcs_predictor/CNNCreator_dpnet_dpnet.py"", line 153, in train\r\n    self.add_training_operators(train_model, predictions, label, device_opts, opt_type, base_learning_rate, policy, stepsize, epsilon, beta1, beta2, gamma, momentum)\r\n  File ""/home/carlos/Documents/git/Caffe2_scripts/caffe2_torcs_predictor/CNNCreator_dpnet_dpnet.py"", line 103, in add_training_operators\r\n    model.AddGradientOperators([loss])\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/model_helper.py"", line 335, in AddGradientOperators\r\n    self.grad_map = self.net.AddGradientOperators(*args, **kwargs)\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/core.py"", line 1840, in AddGradientOperators\r\n    self._net.op[skip:], ys)\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/core.py"", line 1107, in GetBackwardPass\r\n    return ir.GetBackwardPass(ys)\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/core.py"", line 982, in GetBackwardPass\r\n    forward_op_idx, all_input_to_grad)\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/core.py"", line 932, in _GenerateGradientsForForwardOp\r\n    forward_op, g_output)\r\n  File ""/home/carlos/Documents/git/pytorch/build/caffe2/python/core.py"", line 1080, in GetGradientForOp\r\n    format(op.type, e, str(op))\r\nException: Exception when creating gradient for [Cast]:[enforce fail at cast_op.cc:139] argsHelper.HasSingleArgumentOfType<string>(""from_type"") || argsHelper.HasSingleArgumentOfType<int>(""from_type""). Argument \'from_type\' of type int or string is required to get the gradient of CastOp .\r\nOp: \r\ninput: ""label""\r\noutput: ""train_net/Cast""\r\nname: """"\r\ntype: ""Cast""\r\narg {\r\n  name: ""to""\r\n  i: 1\r\n}\r\ndevice_option {\r\n  device_type: 1\r\n  cuda_gpu_id: 0\r\n}\r\n', '\r\nimport logging\r\nimport CNNCreator_dpnet_dpnet\r\n\r\nif __name__ == ""__main__"":\r\n    logging.basicConfig(level=logging.DEBUG)\r\n    logger = logging.getLogger()\r\n    handler = logging.FileHandler(""train.log"", ""w"", encoding=None, delay=""true"")\r\n    logger.addHandler(handler)\r\n\r\n    dpnet_dpnet = CNNCreator_dpnet_dpnet.CNNCreator_dpnet_dpnet()\r\n    dpnet_dpnet.train(\r\n        num_epoch=100,\r\n        batch_size=32,\r\n        context=\'gpu\',\r\n        opt_type=\'sgd\',\r\n        base_learning_rate=0.01,\r\n        policy=\'step\',\r\n        stepsize=8000\r\n    )\r\n\r\n', '\r\nfrom caffe2.python import workspace, core, model_helper, brew, optimizer\r\nfrom caffe2.python.predictor import mobile_exporter\r\nfrom caffe2.proto import caffe2_pb2\r\nimport numpy as np\r\nimport logging\r\nimport os\r\nimport sys\r\nimport lmdb\r\nimport leveldb\r\n\r\nclass CNNCreator_dpnet_dpnet:\r\n\r\n    module = None\r\n    _current_dir_ = os.path.join(\'./\')\r\n    _data_dir_    = os.path.join(_current_dir_, \'data\', \'dpnet_dpnet\')\r\n    _model_dir_   = os.path.join(_current_dir_, \'model\', \'dpnet_dpnet\')\r\n\r\n    INIT_NET    = os.path.join(_model_dir_, \'init_net.pb\')\r\n    PREDICT_NET = os.path.join(_model_dir_, \'predict_net.pb\')\r\n\r\n    def add_input(self, model, batch_size, db, db_type, device_opts):\r\n        with core.DeviceScope(device_opts):\r\n            # load the data\r\n            data_uint8, label = brew.db_input(\r\n                model,\r\n                blobs_out=[""data_uint8"", ""label""],\r\n                batch_size=batch_size,\r\n                db=db,\r\n                db_type=db_type,\r\n            )\r\n            # cast the data to float\r\n            data = model.Cast(data_uint8, ""data"", to=core.DataType.FLOAT)\r\n\r\n            # scale data from [0,255] down to [0,1]\r\n            data = model.Scale(data, data, scale=float(1./256))\r\n\r\n            # don\'t need the gradient for the backward pass\r\n            data = model.StopGradient(data, data)\r\n\r\n            return data, label\r\n\r\n    def create_model(self, model, data, label, device_opts):\r\n    \twith core.DeviceScope(device_opts):\r\n\r\n    \t\tdata = data\r\n    \t\t# data, output shape: {[3,210,280]}\r\n      \t\tconv1_ = brew.conv(model, data, \'conv1_\', dim_in=3, dim_out=96, kernel=11, stride=4, pad_t=5, pad_b=4, pad_l=4, pad_r=3) #legacy_pad=1)\r\n    \t\t# conv1_, output shape: {[96,53,70]}\r\n    \t\trelu1_ = brew.relu(model, conv1_, conv1_)\r\n    \t\tpool1_ = brew.max_pool(model, relu1_, \'pool1_\', kernel=3, stride=2, pad_t=1, pad_b=1, pad_l=1, pad_r=0) #legacy_pad=1)\r\n    \t\t# pool1_, output shape: {[96,27,35]}\r\n      \t\tconv2_ = brew.conv(model, pool1_, \'conv2_\', dim_in=96, dim_out=256, kernel=5, stride=4, pad_t=1, pad_b=1, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# conv2_, output shape: {[256,7,9]}\r\n    \t\trelu2_ = brew.relu(model, conv2_, conv2_)\r\n    \t\tpool2_ = brew.max_pool(model, relu2_, \'pool2_\', kernel=3, stride=2, pad_t=1, pad_b=1, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# pool2_, output shape: {[256,4,5]}\r\n      \t\tconv3_ = brew.conv(model, pool2_, \'conv3_\', dim_in=256, dim_out=384, kernel=3, stride=1, pad_t=1, pad_b=1, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# conv3_, output shape: {[384,4,5]}\r\n    \t\trelu3_ = brew.relu(model, conv3_, conv3_)\r\n      \t\tconv4_ = brew.conv(model, relu3_, \'conv4_\', dim_in=384, dim_out=384, kernel=3, stride=1, pad_t=1, pad_b=1, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# conv4_, output shape: {[384,4,5]}\r\n    \t\trelu4_ = brew.relu(model, conv4_, conv4_)\r\n      \t\tconv5_ = brew.conv(model, relu4_, \'conv5_\', dim_in=384, dim_out=256, kernel=3, stride=1, pad_t=1, pad_b=1, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# conv5_, output shape: {[256,4,5]}\r\n    \t\trelu5_ = brew.relu(model, conv5_, conv5_)\r\n    \t\tpool5_ = brew.max_pool(model, relu5_, \'pool5_\', kernel=3, stride=2, pad_t=1, pad_b=0, pad_l=1, pad_r=1) #legacy_pad=1)\r\n    \t\t# pool5_, output shape: {[256,2,3]}\r\n    \t\tfc5_ = brew.fc(model, pool5_, \'fc5_\', dim_in=256 * 2 * 3, dim_out=4096)\r\n    \t\t# fc5_, output shape: {[4096,1,1]}\r\n    \t\trelu6_ = brew.relu(model, fc5_, fc5_)\r\n    \t\tdropout6_ = brew.dropout(model, relu6_, \'dropout6_\', ratio=0.5, is_test=False)\r\n    \t\tfc6_ = brew.fc(model, dropout6_, \'fc6_\', dim_in=4096, dim_out=4096)\r\n    \t\t# fc6_, output shape: {[4096,1,1]}\r\n    \t\trelu7_ = brew.relu(model, fc6_, fc6_)\r\n    \t\tdropout7_ = brew.dropout(model, relu7_, \'dropout7_\', ratio=0.5, is_test=False)\r\n    \t\tfc7_ = brew.fc(model, dropout7_, \'fc7_\', dim_in=4096, dim_out=256)\r\n    \t\t# fc7_, output shape: {[256,1,1]}\r\n    \t\trelu8_ = brew.relu(model, fc7_, fc7_)\r\n    \t\tdropout8_ = brew.dropout(model, relu8_, \'dropout8_\', ratio=0.5, is_test=False)\r\n    \t\trelu9_ = brew.relu(model, dropout8_, dropout8_)\r\n    \t\tfc9_ = brew.fc(model, relu9_, \'fc9_\', dim_in=256, dim_out=14)\r\n    \t\t# fc9_, output shape: {[14,1,1]}\r\n\r\n            # FIRST ATTEMPT. Error got:  Tensor type mismatch, caller expects elements to be float while tensor contains double Error from operator\r\n            dist = model.net.SquaredL2Distance([label, fc9_], \'dist\')\r\n    \t\tpredictions = dist.AveragedLoss([], [\'predictions\'])\r\n\r\n            \'\'\'\r\n            # SECOND ATTEMPT: Error got:\r\n    \t\tlabel_float = model.Cast(label, None, to=core.DataType.FLOAT)\r\n    \t\tdist = model.net.SquaredL2Distance([label_float, fc9_], \'dist\')\r\n    \t\tpredictions = dist.AveragedLoss([], [\'predictions\'])\r\n            \'\'\'\r\n\r\n    \t\treturn predictions\r\n\r\n    # this adds the loss and optimizer\r\n    def add_training_operators(self, model, output, label, device_opts, opt_type, base_learning_rate, policy, stepsize, epsilon, beta1, beta2, gamma, momentum) :\r\n    \twith core.DeviceScope(device_opts):\r\n    \t\txent = model.LabelCrossEntropy([output, label], \'xent\')\r\n    \t\tloss = model.AveragedLoss(xent, ""loss"")\r\n\r\n    \t\tmodel.AddGradientOperators([loss])\r\n\r\n    \t\tif opt_type == \'adam\':\r\n    \t\t    if policy == \'step\':\r\n    \t\t        opt = optimizer.build_adam(model, base_learning_rate=base_learning_rate, policy=policy, stepsize=stepsize, beta1=beta1, beta2=beta2, epsilon=epsilon)\r\n    \t\t    elif policy == \'fixed\' or policy == \'inv\':\r\n    \t\t        opt = optimizer.build_adam(model, base_learning_rate=base_learning_rate, policy=policy, beta1=beta1, beta2=beta2, epsilon=epsilon)\r\n    \t\t    print(""adam optimizer selected"")\r\n    \t\telif opt_type == \'sgd\':\r\n    \t\t    if policy == \'step\':\r\n    \t\t        opt = optimizer.build_sgd(model, base_learning_rate=base_learning_rate, policy=policy, stepsize=stepsize, gamma=gamma, momentum=momentum)\r\n    \t\t    elif policy == \'fixed\' or policy == \'inv\':\r\n    \t\t        opt = optimizer.build_sgd(model, base_learning_rate=base_learning_rate, policy=policy, gamma=gamma, momentum=momentum)\r\n    \t\t    print(""sgd optimizer selected"")\r\n    \t\telif opt_type == \'rmsprop\':\r\n    \t\t    if policy == \'step\':\r\n    \t\t        opt = optimizer.build_rms_prop(model, base_learning_rate=base_learning_rate, policy=policy, stepsize=stepsize, decay=gamma, momentum=momentum, epsilon=epsilon)\r\n    \t\t    elif policy == \'fixed\' or policy == \'inv\':\r\n    \t\t        opt = optimizer.build_rms_prop(model, base_learning_rate=base_learning_rate, policy=policy, decay=gamma, momentum=momentum, epsilon=epsilon)\r\n    \t\t    print(""rmsprop optimizer selected"")\r\n    \t\telif opt_type == \'adagrad\':\r\n    \t\t    if policy == \'step\':\r\n    \t\t        opt = optimizer.build_adagrad(model, base_learning_rate=base_learning_rate, policy=policy, stepsize=stepsize, decay=gamma, epsilon=epsilon)\r\n    \t\t    elif policy == \'fixed\' or policy == \'inv\':\r\n    \t\t        opt = optimizer.build_adagrad(model, base_learning_rate=base_learning_rate, policy=policy, decay=gamma, epsilon=epsilon)\r\n    \t\t    print(""adagrad optimizer selected"")\r\n\r\n    def add_accuracy(self, model, output, label, device_opts, eval_metric):\r\n        with core.DeviceScope(device_opts):\r\n            if eval_metric == \'accuracy\':\r\n                accuracy = brew.accuracy(model, [output, label], ""accuracy"")\r\n            elif eval_metric == \'top_k_accuracy\':\r\n                accuracy = brew.accuracy(model, [output, label], ""accuracy"", top_k=3)\r\n            return accuracy\r\n\r\n    def train(self, num_epoch=1000, batch_size=64, context=\'gpu\', eval_metric=\'accuracy\', opt_type=\'adam\', base_learning_rate=0.001, weight_decay=0.001, policy=\'fixed\', stepsize=1, epsilon=1E-8, beta1=0.9, beta2=0.999, gamma=0.999, momentum=0.9) :\r\n        if context == \'cpu\':\r\n            device_opts = core.DeviceOption(caffe2_pb2.CPU, 0)\r\n            print(""CPU mode selected"")\r\n        elif context == \'gpu\':\r\n            device_opts = core.DeviceOption(caffe2_pb2.CUDA, 0)\r\n            print(""GPU mode selected"")\r\n\r\n    \tworkspace.ResetWorkspace(self._model_dir_)\r\n\r\n    \targ_scope = {""order"": ""NHWC""}\r\n    \t# == Training model ==\r\n    \ttrain_model= model_helper.ModelHelper(name=""train_net"", arg_scope=arg_scope)\r\n    \tdata, label = self.add_input(train_model, batch_size=batch_size, db=os.path.join(self._data_dir_, \'torcs-train-nchw-lmdb\'), db_type=\'lmdb\', device_opts=device_opts)\r\n    \tpredictions = self.create_model(train_model, data, label, device_opts=device_opts)\r\n    \tself.add_training_operators(train_model, predictions, label, device_opts, opt_type, base_learning_rate, policy, stepsize, epsilon, beta1, beta2, gamma, momentum)\r\n    \tself.add_accuracy(train_model, predictions, label, device_opts, eval_metric)\r\n    \twith core.DeviceScope(device_opts):\r\n    \t\tbrew.add_weight_decay(train_model, weight_decay)\r\n\r\n    \t# Initialize and create the training network\r\n    \tworkspace.RunNetOnce(train_model.param_init_net)\r\n    \tworkspace.CreateNet(train_model.net, overwrite=True)\r\n\r\n    \t# Main Training Loop\r\n    \tprint(""== Starting Training for "" + str(num_epoch) + "" epochs =="")\r\n    \tfor i in range(num_epoch):\r\n            workspace.RunNet(train_model.net)\r\n\r\n            if i % 50 == 0:\r\n            \tprint \'Iter \' + str(i) + \': \' + \'Loss \' + str(workspace.FetchBlob(""loss"")) + \' - \' + \'Accuracy \' + str(workspace.FetchBlob(\'accuracy\'))\r\n    \tprint(""Training done"")\r\n\r\n    \t# == Deployment model. ==\r\n    \t# We simply need the main AddModel part.\r\n    \tdeploy_model = model_helper.ModelHelper(name=""deploy_net"", arg_scope=arg_scope, init_params=False)\r\n    \tself.create_model(deploy_model, ""data"", label, device_opts)\r\n\r\n    \tprint(""Saving deploy model"")\r\n    \tself.save_net(self.INIT_NET, self.PREDICT_NET, deploy_model)\r\n\r\n    def save_net(self, init_net_path, predict_net_path, model):\r\n\r\n    \tinit_net, predict_net = mobile_exporter.Export(\r\n    \t\tworkspace,\r\n    \t\tmodel.net,\r\n    \t\tmodel.params\r\n    \t)\r\n\r\n        try:\r\n            os.makedirs(self._model_dir_)\r\n        except OSError:\r\n            if not os.path.isdir(self._model_dir_):\r\n                raise\r\n\r\n    \tprint(""Save the model to init_net.pb and predict_net.pb"")\r\n    \twith open(predict_net_path, \'wb\') as f:\r\n    \t\tf.write(model.net._net.SerializeToString())\r\n    \twith open(init_net_path, \'wb\') as f:\r\n    \t\tf.write(init_net.SerializeToString())\r\n\r\n    \tprint(""Save the model to init_net.pbtxt and predict_net.pbtxt"")\r\n\r\n    \twith open(init_net_path.replace(\'.pb\',\'.pbtxt\'), \'w\') as f:\r\n    \t\tf.write(str(init_net))\r\n    \twith open(predict_net_path.replace(\'.pb\',\'.pbtxt\'), \'w\') as f:\r\n    \t\tf.write(str(predict_net))\r\n    \tprint(""== Saved init_net and predict_net =="")\r\n\r\n    def load_net(self, init_net_path, predict_net_path, device_opts):\r\n        if not os.path.isfile(init_net_path):\r\n            logging.error(""Network loading failure. File \'"" + os.path.abspath(init_net_path) + ""\' does not exist."")\r\n            sys.exit(1)\r\n        elif not os.path.isfile(predict_net_path):\r\n            logging.error(""Network loading failure. File \'"" + os.path.abspath(predict_net_path) + ""\' does not exist."")\r\n            sys.exit(1)\r\n\r\n        init_def = caffe2_pb2.NetDef()\r\n    \twith open(init_net_path, \'rb\') as f:\r\n    \t\tinit_def.ParseFromString(f.read())\r\n    \t\tinit_def.device_option.CopyFrom(device_opts)\r\n    \t\tworkspace.RunNetOnce(init_def.SerializeToString())\r\n\r\n    \tnet_def = caffe2_pb2.NetDef()\r\n    \twith open(predict_net_path, \'rb\') as f:\r\n    \t\tnet_def.ParseFromString(f.read())\r\n    \t\tnet_def.device_option.CopyFrom(device_opts)\r\n    \t\tworkspace.CreateNet(net_def.SerializeToString(), overwrite=True)\r\n    \tprint(""== Loaded init_net and predict_net =="")\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
159,15567,0,"Improve error messages for pack_padded_sequence(..., enforced_sorted=True). Right now it errors out saying that sequences must be sorted. Users may not be aware that they can pass in  to the function to avoid the sorting requirement if they do not intend to do ONNX export; it would be great if the error message suggested that instead.. []"
266,11532,0,"[JIT][tracer] Slicing shape is specialized to tensor rank. Example:






these  calls we emit (e.g. ) are specialized to the rank of the tensor we called  on. ['\r\nimport torch\r\n\r\ndef fill_row_zero(x):\r\n    x = torch.cat((torch.rand(1, *x.shape[1:]), x[1:]), dim=0)\r\n    return x\r\n\r\ntraced = torch.jit.trace(fill_row_zero, (torch.rand(3, 4),))\r\nprint(traced.graph)\r\ntraced(torch.rand(3, 4, 5))\r\n', '\r\ngraph(%0 : Float(3, 4)) {\r\n  %4 : int = prim::Constant[value=1]()\r\n  %5 : int = aten::size(%0, %4)\r\n  %6 : Long() = prim::NumToTensor(%5)\r\n  %7 : int = prim::TensorToNum(%6)\r\n  %8 : int = prim::Constant[value=1]()\r\n  %9 : int[] = prim::ListConstruct(%8, %7)\r\n  %10 : int = prim::Constant[value=6]()\r\n  %11 : int = prim::Constant[value=0]()\r\n  %12 : int[] = prim::Constant[value=[0, -1]]()\r\n  %13 : Float(1, 4) = aten::rand(%9, %10, %11, %12)\r\n  %14 : int = prim::Constant[value=0]()\r\n  %15 : int = prim::Constant[value=1]()\r\n  %16 : int = prim::Constant[value=9223372036854775807]()\r\n  %17 : int = prim::Constant[value=1]()\r\n  %18 : Float(2, 4) = aten::slice(%0, %14, %15, %16, %17)\r\n  %19 : Dynamic[] = prim::ListConstruct(%13, %18)\r\n  %20 : int = prim::Constant[value=0]()\r\n  %21 : Float(3, 4) = aten::cat(%19, %20)\r\n  return (%21);\r\n}\r\n']"
565,4119,0,"CI with DEBUG=1. Turning on DEBUG=1 turns off inlining. However, if you declare a function as , it won't get object code generated for it, which means there will be undefined symbol errors. You might not notice this with a release build, since everything gets inlined away.

We can catch errors like this by doing CI with DEBUG=1. Probably just pick one platform and run that only.. []"
116,7764,0,"Incorrect compilation instructions for Mac. The instructions at https://github.com/pytorch/pytorch#from-source for compiling from source say to use the following command on macOS:



Why I try to compile with that command, it fails with the following error:



I was able to get it to compile by using the following command instead:



## System Info

- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): Source
- Build command you used (if compiling from source): See above
- OS: macOS 10.13.4
- PyTorch version: Latest code from repository
- Python version: 3.6.1
. ['\r\nMACOSX_DEPLOYMENT_TARGET=10.9 CC=clang CXX=clang++ python setup.py install\r\n', ""\r\ntorch/csrc/distributed/Module.cpp:4:10: fatal error: 'unordered_map' file not\r\n      found\r\n#include <unordered_map>\r\n"", '\r\nMACOS_DEPOYMENT_TARGET=10.9 CC=clang CXX=clang++ CPPFLAGS=""-stdlib=libc++"" python setup.py install\r\n']"
457,8039,0,"RuntimeError: cuda runtime error (30) : unknown error at /pytorch/aten/src/THC/THCGeneral.cpp:70. ## Issue description



## Code example



## System Info



 does not detect  even though it's installed:



. ['\r\n$ python pytorch.py \r\nTHCudaCheck FAIL file=/pytorch/aten/src/THC/THCGeneral.cpp line=70 error=30 : unknown error\r\nTraceback (most recent call last):\r\n  File ""pytorch.py"", line 3, in <module>\r\n    a = torch.ones(3,3).to(\'cuda\')\r\n  File ""/usr/lib/python3.6/site-packages/torch/cuda/__init__.py"", line 161, in _lazy_init\r\n    torch._C._cuda_init()\r\nRuntimeError: cuda runtime error (30) : unknown error at /pytorch/aten/src/THC/THCGeneral.cpp:70\r\n', ""\r\nimport torch\r\n\r\na = torch.ones(3,3).to('cuda')\r\nb = torch.ones(3,3).to('cuda')\r\n\r\nprint(a + b)\r\n"", '\r\n$ python collect_env.py \r\nCollecting environment information...\r\nPyTorch version: 0.4.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.1.85\r\n\r\nOS: Arch Linux\r\nGCC version: (GCC) 8.1.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: No\r\nCUDA runtime version: 9.2.88\r\nGPU models and configuration: GPU 0: GeForce GTX 970\r\nNvidia driver version: 396.24\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy (1.14.3)\r\n[pip3] numpydoc (0.7.0)\r\n[pip3] torch (0.4.0)\r\n[pip3] torchvision (0.2.1)\r\n[conda] Could not collect\r\n', ""\r\n# pacman -Q | egrep 'cud(a|nn)'\r\ncuda 9.2.88.1-2\r\ncudnn 7.1.3-1\r\npycuda-headers 2017.1.1-5\r\npython-pycuda 2017.1.1-5\r\npython-tensorflow-opt-cuda 1.8.0-2\r\n""]"
201,1626,0," Modules/gcmodule.c:380: visit_decref: Assertion `((gc)->gc.gc_refs >> (1)) != 0' failed.. Continued from: https://github.com/pytorch/pytorch/issues/1624 (running tests on a debug build of python3.6.1.

The following tests in TestNN failed with gc problems:

test_variable_sequence_cuda
test_cuda_rnn_fused
test_rnn_initial_hidden_state
test_RNN_cpu_vs_cudnn_no_dropout
test_RNN_cpu_vs_cudnn_with_dropout
test_RNN_dropout_state
test_RNN_change_dropout

Error is:
((gc)->gc.gc_refs >> (1)) != 0' failed.

#0  0x00007ffff712c1d7 in raise () at /lib64/libc.so.6
#1  0x00007ffff712d8c8 in abort () at /lib64/libc.so.6
#2  0x00007ffff7125146 in __assert_fail_base () at /lib64/libc.so.6
#3  0x00007ffff71251f2 in  () at /lib64/libc.so.6
#4  0x0000000000435f63 in visit_decref (op=0x7fffc006e4f8, data=<optimized out>) at Modules/gcmodule.c:380
#5  0x00007fffecd7c20d in THPVariable_traverse(THPVariable*, visitproc, void*) (self=self@entry=0x7fffc00781f0, visit=visit@entry=0x435efd <visit_decref>, arg=arg@entry=0x0)
    at torch/csrc/autograd/python_variable.cpp:92
#6  0x00000000004a86ce in subtype_traverse (self=0x7fffc00781f0, visit=0x435efd <visit_decref>, arg=0x0) at Objects/typeobject.c:1021
#7  0x00000000004356ee in subtract_refs (containers=containers@entry=0x885d20 <generations>) at Modules/gcmodule.c:399
#8  0x0000000000436809 in collect (generation=generation@entry=0, n_collected=n_collected@entry=0x7fffffff96b8, n_uncollectable=n_uncollectable@entry=0x7fffffff96b0, nofail=nofail@entry=0)
    at Modules/gcmodule.c:956
#9  0x0000000000436c47 in collect_with_callback (generation=0) at Modules/gcmodule.c:1128
#10 0x0000000000436d3f in collect_generations () at Modules/gcmodule.c:1151
#11 0x0000000000436eac in _PyObject_GC_Alloc (use_calloc=use_calloc@entry=0, basicsize=basicsize@entry=72) at Modules/gcmodule.c:1726
#12 0x0000000000437382 in _PyObject_GC_Malloc (basicsize=basicsize@entry=72) at Modules/gcmodule.c:1736
#13 0x00000000004a8443 in PyType_GenericAlloc (type=0x7fffed9eb400 <THPSizeType>, nitems=2) at Objects/typeobject.c:936
#14 0x00007fffecd3083f in THPSize_New(int, long*) (dim=2, sizes=0x4547f5c0) at torch/csrc/Size.cpp:16
#15 0x00007fffed1c2102 in THCPDoubleTensor_size(_object*, _object*, _object*) (self=<optimized out>, args=0x7ffff7fa0058, kwargs=0x0)
    at /data/users/gchanan/pytorch6/torch/csrc/generic/TensorMethods.cpp:650
#16 0x00000000004950a9 in _PyCFunction_FastCallDict (func_obj=func_obj@entry=0x7fffc28df328, args=args@entry=0x4547e598, nargs=nargs@entry=0, kwargs=kwargs@entry=0x0) at Objects/methodobject.c:231
#17 0x000000000049545a in _PyCFunction_FastCallKeywords (func=func@entry=0x7fffc28df328, stack=stack@entry=0x4547e598, nargs=nargs@entry=0, kwnames=kwnames@entry=0x0) at Objects/methodobject.c:295
#18 0x0000000000530f41 in call_function (pp_stack=pp_stack@entry=0x7fffffff9908, oparg=oparg@entry=0, kwnames=kwnames@entry=0x0) at Python/ceval.c:4798
#19 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#20 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x4547e3e8, throwflag=throwflag@entry=0) at Python/ceval.c:718
#21 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=0x7fffc2406e80, globals=<optimized out>, locals=locals@entry=0x0, args=args@entry=0x7fffc008c480, argcount=4, kwnames=kwnames@entry=0x0, kwargs=kwargs@entry=0x8, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=defs@entry=0x0, defcount=defcount@entry=0, kwdefs=kwdefs@entry=0x0, closure=closure@entry=0x0, name=name@entry=0x0, qualname=qualname@entry=0x0) at Python/ceval.c:4128
#22 0x0000000000531168 in PyEval_EvalCodeEx (_co=<optimized out>, globals=<optimized out>, locals=locals@entry=0x0, args=args@entry=0x7fffc008c480, argcount=<optimized out>, kws=kws@entry=0x0, kwcount=kwcount@entry=0, defs=defs@entry=0x0, defcount=defcount@entry=0, kwdefs=0x0, closure=0x0) at Python/ceval.c:4149
#23 0x000000000047386f in function_call (func=0x7fffc23a6840, arg=0x7fffc008c458, kw=0x0) at Objects/funcobject.c:604
#24 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7fffc23a6840, args=args@entry=0x7fffc008c458, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2246
#25 0x00000000005316b0 in PyEval_CallObjectWithKeywords (func=0x7fffc23a6840, args=0x7fffc008c458, kwargs=kwargs@entry=0x0) at Python/ceval.c:4718
#26 0x0000000000444c69 in PyObject_CallObject (o=<optimized out>, a=<optimized out>) at Objects/abstract.c:2172
#27 0x00007fffecd74eb3 in THPFunction_apply(_object*, _object*) (cls=0x11c9178, _inputs=0x7fffc1da3418) at torch/csrc/autograd/python_function.cpp:722
#28 0x00000000004950b8 in _PyCFunction_FastCallDict (func_obj=func_obj@entry=0x7fffc28d61c0, args=args@entry=0x4547bf70, nargs=nargs@entry=3, kwargs=kwargs@entry=0x0) at Objects/methodobject.c:234
#29 0x000000000049545a in _PyCFunction_FastCallKeywords (func=func@entry=0x7fffc28d61c0, stack=stack@entry=0x4547bf70, nargs=nargs@entry=3, kwnames=kwnames@entry=0x0) at Objects/methodobject.c:295
#30 0x0000000000530f41 in call_function (pp_stack=pp_stack@entry=0x7fffffff9e58, oparg=oparg@entry=3, kwnames=kwnames@entry=0x0) at Python/ceval.c:4798
#31 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#32 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x4547bdc8, throwflag=throwflag@entry=0) at Python/ceval.c:718
#33 0x00000000005301ec in _PyFunction_FastCall (co=co@entry=0x7fffc31e2640, args=0x7fffffffa038, args@entry=0x7fffffffa020, nargs=nargs@entry=3, globals=globals@entry=0x7fffc31e1e68)
    at Python/ceval.c:4880
---Type <return> to continue, or q <return> to quit---
#34 0x000000000053c110 in _PyFunction_FastCallDict (func=func@entry=0x7fffc23f61c8, args=args@entry=0x7fffffffa020, nargs=nargs@entry=3, kwargs=kwargs@entry=0x0) at Python/ceval.c:4982
#35 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffc23f61c8, args=args@entry=0x7fffffffa020, nargs=nargs@entry=3, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2295
#36 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffc23f61c8, obj=0x7fffc0085e28, args=0x7fffc22eb988, kwargs=0x0) at Objects/abstract.c:2358
#37 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#38 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7fffc23963d8, args=args@entry=0x7fffc22eb988, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2246
#39 0x00000000004af68e in call_method (o=<optimized out>, nameid=nameid@entry=0x8a5740 <PyId___setitem__>, format=format@entry=0x635a54 ""(OO)"") at Objects/typeobject.c:1453
#40 0x00000000004af814 in slot_mp_ass_subscript (self=<optimized out>, key=<optimized out>, value=<optimized out>) at Objects/typeobject.c:5944
#41 0x00000000004444f0 in PyObject_SetItem (o=o@entry=0x7fffc0085e28, key=key@entry=0x7fffc22eb838, value=value@entry=0x7fffc0089b80) at Objects/abstract.c:180
#42 0x00000000005345cc in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:1727
#43 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x4547ed58, throwflag=throwflag@entry=0) at Python/ceval.c:718
#44 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=0x7fffc1f6b700, globals=<optimized out>, locals=locals@entry=0x0, args=<optimized out>, argcount=1, kwnames=0x0, kwargs=0x307b1470, kwcount=0, kwstep=kwstep@entry=1, defs=0x7fffc1f69d18, defcount=defcount@entry=1, kwdefs=kwdefs@entry=0x0, closure=closure@entry=0x0, name=name@entry=0x7fffefef55e0, qualname=qualname@entry=0x7fffefef55e0)
    at Python/ceval.c:4128
#45 0x0000000000530da7 in fast_function (func=func@entry=0x7fffc1f8a110, stack=<optimized out>, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4939
#46 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffa4e8, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#47 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#48 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307b1208, throwflag=throwflag@entry=0) at Python/ceval.c:718
#49 0x00000000005301ec in _PyFunction_FastCall (co=<optimized out>, args=0x7fffc231ff18, nargs=nargs@entry=2, globals=<optimized out>) at Python/ceval.c:4880
#50 0x0000000000530cf7 in fast_function (func=func@entry=0x7fffc1dc39b0, stack=<optimized out>, nargs=nargs@entry=2, kwnames=kwnames@entry=0x0) at Python/ceval.c:4915
#51 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffa6e8, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#52 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#53 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x7fffc231fd78, throwflag=throwflag@entry=0) at Python/ceval.c:718
#54 0x00000000005301ec in _PyFunction_FastCall (co=<optimized out>, args=0x307b0898, nargs=nargs@entry=1, globals=<optimized out>) at Python/ceval.c:4880
#55 0x0000000000530cf7 in fast_function (func=func@entry=0x7fffc1dc3b20, stack=<optimized out>, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4915
#56 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffa8e8, oparg=oparg@entry=0, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#57 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#58 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307b0698, throwflag=throwflag@entry=0) at Python/ceval.c:718
#59 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede08340, globals=globals@entry=0x7fffede77670, locals=locals@entry=0x0, args=args@entry=0x7fffffffab20, argcount=argcount@entry=2, kwnames=kwnames@entry=0x7ffff7fa0080, kwargs=kwargs@entry=0x7ffff7fa0088, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x7fffede0ff88, defcount=1, kwdefs=0x0, closure=0x0, name=0x7fffede06860, qualname=0x7fffede054a0) at Python/ceval.c:4128
#60 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd4f280, args=args@entry=0x7fffffffab20, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e09b8) at Python/ceval.c:5031
#61 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd4f280, args=args@entry=0x7fffffffab20, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e09b8) at Objects/abstract.c:2295
#62 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd4f280, obj=0x7fffc00d0e28, args=0x7fffc00e1ae8, kwargs=0x7fffc00e09b8) at Objects/abstract.c:2358
#63 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#64 0x0000000000444e8c in PyObject_Call (func=0x7fffeff04838, args=0x7fffc00e1ae8, kwargs=0x7fffc00e09b8) at Objects/abstract.c:2246
#65 0x000000000052f6b9 in do_call_core (func=func@entry=0x7fffeff04838, callargs=callargs@entry=0x7fffc00e1ae8, kwdict=kwdict@entry=0x7fffc00e09b8) at Python/ceval.c:5067
#66 0x000000000053aad1 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3366
#67 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x7fffc0064250, throwflag=throwflag@entry=0) at Python/ceval.c:718
#68 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede084c0, globals=globals@entry=0x7fffede77670, locals=locals@entry=0x0, args=args@entry=0x7fffffffaec0, argcount=argcount@entry=2, kwnames=kwnames@entry=0x0, kwargs=kwargs@entry=0x8, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x0, defcount=0, kwdefs=0x0, closure=0x0, name=0x7ffff7fa3270, qualname=0x7fffede04ce8)
    at Python/ceval.c:4128
---Type <return> to continue, or q <return> to quit---
#69 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd4f3f0, args=args@entry=0x7fffffffaec0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Python/ceval.c:5031
#70 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd4f3f0, args=args@entry=0x7fffffffaec0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2295
#71 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd4f3f0, obj=0x7fffc00d0e28, args=0x7fffc00e1b50, kwargs=0x0) at Objects/abstract.c:2358
#72 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#73 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7fffede3c6e8, args=args@entry=0x7fffc00e1b50, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2246
#74 0x00000000004b1e1d in slot_tp_call (self=<optimized out>, args=0x7fffc00e1b50, kwds=0x0) at Objects/typeobject.c:6167
#75 0x00000000004450b1 in _PyObject_FastCallDict (func=func@entry=0x7fffc00d0e28, args=args@entry=0x307af060, nargs=nargs@entry=1, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2316
#76 0x00000000004456e5 in _PyObject_FastCallKeywords (func=func@entry=0x7fffc00d0e28, stack=0x307af060, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Objects/abstract.c:2480
#77 0x0000000000531011 in call_function (pp_stack=pp_stack@entry=0x7fffffffb0c8, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4822
#78 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#79 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307aee98, throwflag=throwflag@entry=0) at Python/ceval.c:718
#80 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede1e880, globals=globals@entry=0x7fffedeaad78, locals=locals@entry=0x0, args=args@entry=0x7fffffffb300, argcount=argcount@entry=2, kwnames=kwnames@entry=0x7ffff7fa0080, kwargs=kwargs@entry=0x7ffff7fa0088, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x7fffedd4d5c8, defcount=1, kwdefs=0x0, closure=0x0, name=0x7fffede06860, qualname=0x7fffedd50970) at Python/ceval.c:4128
#81 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd54eb8, args=args@entry=0x7fffffffb300, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e0a30) at Python/ceval.c:5031
#82 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd54eb8, args=args@entry=0x7fffffffb300, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e0a30) at Objects/abstract.c:2295
#83 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd54eb8, obj=0x7fffc00e1400, args=0x7fffc00e1cf0, kwargs=0x7fffc00e0a30) at Objects/abstract.c:2358
#84 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#85 0x0000000000444e8c in PyObject_Call (func=0x7ffff064cf38, args=0x7fffc00e1cf0, kwargs=0x7fffc00e0a30) at Objects/abstract.c:2246
#86 0x000000000052f6b9 in do_call_core (func=func@entry=0x7ffff064cf38, callargs=callargs@entry=0x7fffc00e1cf0, kwdict=kwdict@entry=0x7fffc00e0a30) at Python/ceval.c:5067
#87 0x000000000053aad1 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3366
#88 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x7fffc00d9e20, throwflag=throwflag@entry=0) at Python/ceval.c:718
#89 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede14a00, globals=globals@entry=0x7fffedeaad78, locals=locals@entry=0x0, args=args@entry=0x7fffffffb6a0, argcount=argcount@entry=2, kwnames=kwnames@entry=0x0, kwargs=kwargs@entry=0x8, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x0, defcount=0, kwdefs=0x0, closure=0x0, name=0x7ffff7fa3270, qualname=0x7fffedd55838)
    at Python/ceval.c:4128
#90 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd54d48, args=args@entry=0x7fffffffb6a0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Python/ceval.c:5031
#91 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd54d48, args=args@entry=0x7fffffffb6a0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2295
#92 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd54d48, obj=0x7fffc00e1400, args=0x7fffc00d0e90, kwargs=0x0) at Objects/abstract.c:2358
#93 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#94 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7fffedee0288, args=args@entry=0x7fffc00d0e90, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2246
#95 0x00000000004b1e1d in slot_tp_call (self=<optimized out>, args=0x7fffc00d0e90, kwds=0x0) at Objects/typeobject.c:6167
#96 0x00000000004450b1 in _PyObject_FastCallDict (func=func@entry=0x7fffc00e1400, args=args@entry=0x307ae830, nargs=nargs@entry=1, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2316
#97 0x00000000004456e5 in _PyObject_FastCallKeywords (func=func@entry=0x7fffc00e1400, stack=0x307ae830, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Objects/abstract.c:2480
#98 0x0000000000531011 in call_function (pp_stack=pp_stack@entry=0x7fffffffb8a8, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4822
#99 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#100 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307ae668, throwflag=throwflag@entry=0) at Python/ceval.c:718
#101 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede1e880, globals=globals@entry=0x7fffedeaad78, locals=locals@entry=0x0, args=args@entry=0x7fffffffbae0, argcount=argcount@entry=2, kwnames=kwnames@entry=0x7ffff7fa0080, kwargs=kwargs@entry=0x7ffff7fa0088, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x7fffedd4d5c8, defcount=1, kwdefs=0x0, closure=0x0, name=0x7fffede06860, qualname=0x7fffedd50970) at Python/ceval.c:4128
#102 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd54eb8, args=args@entry=0x7fffffffbae0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e0058) at Python/ceval.c:5031
#103 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd54eb8, args=args@entry=0x7fffffffbae0, nargs=nargs@entry=2, kwargs=kwargs@entry=0x7fffc00e0058) at Objects/abstract.c:2295
---Type <return> to continue, or q <return> to quit---
#104 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd54eb8, obj=0x7fffc00d0dc0, args=0x7fffc00d0ae8, kwargs=0x7fffc00e0058) at Objects/abstract.c:2358
#105 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#106 0x0000000000444e8c in PyObject_Call (func=0x7fffede3c7c8, args=0x7fffc00d0ae8, kwargs=0x7fffc00e0058) at Objects/abstract.c:2246
#107 0x000000000052f6b9 in do_call_core (func=func@entry=0x7fffede3c7c8, callargs=callargs@entry=0x7fffc00d0ae8, kwdict=kwdict@entry=0x7fffc00e0058) at Python/ceval.c:5067
#108 0x000000000053aad1 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3366
#109 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x7fffc00d9c28, throwflag=throwflag@entry=0) at Python/ceval.c:718
#110 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffede14a00, globals=globals@entry=0x7fffedeaad78, locals=locals@entry=0x0, args=args@entry=0x7fffffffbe80, argcount=argcount@entry=2, kwnames=kwnames@entry=0x0, kwargs=kwargs@entry=0x8, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=0x0, defcount=0, kwdefs=0x0, closure=0x0, name=0x7ffff7fa3270, qualname=0x7fffedd55838)
    at Python/ceval.c:4128
#111 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedd54d48, args=args@entry=0x7fffffffbe80, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Python/ceval.c:5031
#112 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedd54d48, args=args@entry=0x7fffffffbe80, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2295
#113 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedd54d48, obj=0x7fffc00d0dc0, args=0x7fffc00d0bb8, kwargs=0x0) at Objects/abstract.c:2358
#114 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#115 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7ffff0655e58, args=args@entry=0x7fffc00d0bb8, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2246
#116 0x00000000004b1e1d in slot_tp_call (self=<optimized out>, args=0x7fffc00d0bb8, kwds=0x0) at Objects/typeobject.c:6167
#117 0x00000000004450b1 in _PyObject_FastCallDict (func=func@entry=0x7fffc00d0dc0, args=args@entry=0x307ad4b0, nargs=nargs@entry=1, kwargs=kwargs@entry=0x0) at Objects/abstract.c:2316
#118 0x00000000004456e5 in _PyObject_FastCallKeywords (func=func@entry=0x7fffc00d0dc0, stack=0x307ad4b0, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Objects/abstract.c:2480
#119 0x0000000000531011 in call_function (pp_stack=pp_stack@entry=0x7fffffffc088, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4822
#120 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#121 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307ad298, throwflag=throwflag@entry=0) at Python/ceval.c:718
#122 0x00000000005301ec in _PyFunction_FastCall (co=<optimized out>, args=0x307acf50, nargs=nargs@entry=2, globals=<optimized out>) at Python/ceval.c:4880
#123 0x0000000000530cf7 in fast_function (func=func@entry=0x7fffedca1110, stack=<optimized out>, nargs=nargs@entry=2, kwnames=kwnames@entry=0x0) at Python/ceval.c:4915
#124 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffc288, oparg=oparg@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#125 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#126 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307acda8, throwflag=throwflag@entry=0) at Python/ceval.c:718
#127 0x00000000005301ec in _PyFunction_FastCall (co=<optimized out>, args=0x307a77b8, nargs=nargs@entry=1, globals=<optimized out>) at Python/ceval.c:4880
#128 0x0000000000530cf7 in fast_function (func=func@entry=0x7fffedca1a68, stack=<optimized out>, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0) at Python/ceval.c:4915
#129 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffc488, oparg=oparg@entry=0, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#130 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#131 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x307a75b8, throwflag=throwflag@entry=0) at Python/ceval.c:718
#132 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7fffedceb400, globals=globals@entry=0x7fffedd4c9b8, locals=locals@entry=0x0, args=args@entry=0x7fffffffc6c0, argcount=argcount@entry=1, kwnames=kwnames@entry=0x7fffc22e5e10, kwargs=kwargs@entry=0x7fffc22e5e18, kwcount=2,
    kwcount@entry=1, kwstep=kwstep@entry=2, defs=0x7fffedca12a8, defcount=11, kwdefs=0x7fffedcefd78, closure=0x0, name=0x7ffff7fa3430, qualname=0x7fffedcef478) at Python/ceval.c:4128
#133 0x000000000053c29d in _PyFunction_FastCallDict (func=func@entry=0x7fffedca1338, args=args@entry=0x7fffffffc6c0, nargs=nargs@entry=1, kwargs=kwargs@entry=0x7fffc00d5238) at Python/ceval.c:5031
#134 0x0000000000445042 in _PyObject_FastCallDict (func=func@entry=0x7fffedca1338, args=args@entry=0x7fffffffc6c0, nargs=nargs@entry=1, kwargs=kwargs@entry=0x7fffc00d5238) at Objects/abstract.c:2295
#135 0x0000000000445345 in _PyObject_Call_Prepend (func=0x7fffedca1338, obj=0x7fffc00d09b0, args=0x7ffff7fa0058, kwargs=0x7fffc00d5238) at Objects/abstract.c:2358
#136 0x000000000045ee6b in method_call (method=<optimized out>, args=<optimized out>, kwargs=<optimized out>) at Objects/classobject.c:317
#137 0x0000000000444e8c in PyObject_Call (func=func@entry=0x7ffff064ce58, args=args@entry=0x7ffff7fa0058, kwargs=kwargs@entry=0x7fffc00d5238) at Objects/abstract.c:2246
#138 0x00000000004b1a5c in slot_tp_init (self=<optimized out>, args=0x7ffff7fa0058, kwds=0x7fffc00d5238) at Objects/typeobject.c:6380
#139 0x00000000004ada4d in type_call (type=0xb5e1c8, args=0x7ffff7fa0058, kwds=0x7fffc00d5238) at Objects/typeobject.c:915
#140 0x00000000004450b1 in _PyObject_FastCallDict (func=func@entry=0xb5e1c8, args=args@entry=0x3079d738, nargs=nargs@entry=0, kwargs=kwargs@entry=0x7fffc00d5238) at Objects/abstract.c:2316
---Type <return> to continue, or q <return> to quit---
#141 0x00000000004456e5 in _PyObject_FastCallKeywords (func=func@entry=0xb5e1c8, stack=0x3079d738, nargs=nargs@entry=0, kwnames=kwnames@entry=0x7fffc1f43260) at Objects/abstract.c:2480
#142 0x0000000000531011 in call_function (pp_stack=pp_stack@entry=0x7fffffffc900, oparg=<optimized out>, kwnames=kwnames@entry=0x7fffc1f43260) at Python/ceval.c:4822
#143 0x000000000053a6d4 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3300
#144 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0x3079d588, throwflag=throwflag@entry=0) at Python/ceval.c:718
#145 0x00000000005301ec in _PyFunction_FastCall (co=<optimized out>, args=0xa1a588, nargs=nargs@entry=0, globals=<optimized out>) at Python/ceval.c:4880
#146 0x0000000000530cf7 in fast_function (func=func@entry=0x7fffc1d9e3f0, stack=<optimized out>, nargs=nargs@entry=0, kwnames=kwnames@entry=0x0) at Python/ceval.c:4915
#147 0x0000000000530ffe in call_function (pp_stack=pp_stack@entry=0x7fffffffcaf8, oparg=oparg@entry=0, kwnames=kwnames@entry=0x0) at Python/ceval.c:4819
#148 0x000000000053a5b6 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3284
#149 0x0000000000530124 in PyEval_EvalFrameEx (f=f@entry=0xa1a3f8, throwflag=throwflag@entry=0) at Python/ceval.c:718
#150 0x0000000000530b4b in _PyEval_EvalCodeWithName (_co=_co@entry=0x7ffff0a6c4c0, globals=globals@entry=0x7ffff7eaac88, locals=locals@entry=0x7ffff7eaac88, args=args@entry=0x0, argcount=argcount@entry=0, kwnames=kwnames@entry=0x0, kwargs=kwargs@entry=0x8, kwcount=kwcount@entry=0, kwstep=kwstep@entry=2, defs=defs@entry=0x0, defcount=defcount@entry=0, kwdefs=kwdefs@entry=0x0, closure=closure@entry=0x0, name=name@entry=0x0, qualname=qualname@entry=0x0) at Python/ceval.c:4128
#151 0x0000000000531168 in PyEval_EvalCodeEx (_co=_co@entry=0x7ffff0a6c4c0, globals=globals@entry=0x7ffff7eaac88, locals=locals@entry=0x7ffff7eaac88, args=args@entry=0x0, argcount=argcount@entry=0, kws=kws@entry=0x0, kwcount=kwcount@entry=0, defs=defs@entry=0x0, defcount=defcount@entry=0, kwdefs=kwdefs@entry=0x0, closure=closure@entry=0x0) at Python/ceval.c:4149
#152 0x00000000005311b2 in PyEval_EvalCode (co=co@entry=0x7ffff0a6c4c0, globals=globals@entry=0x7ffff7eaac88, locals=locals@entry=0x7ffff7eaac88) at Python/ceval.c:695
#153 0x00000000004231c4 in run_mod (mod=mod@entry=0xab1fe0, filename=filename@entry=0x7ffff0b5f660, globals=globals@entry=0x7ffff7eaac88, locals=locals@entry=0x7ffff7eaac88, flags=flags@entry=0x7fffffffcea0, arena=arena@entry=0x7ffff0b94520) at Python/pythonrun.c:980
#154 0x0000000000425a44 in PyRun_FileExFlags (fp=fp@entry=0x9501a0, filename_str=filename_str@entry=0x7ffff7efaeb0 ""test/test_nn.py"", start=start@entry=257, globals=globals@entry=0x7ffff7eaac88, locals=locals@entry=0x7ffff7eaac88, closeit=closeit@entry=1, flags=flags@entry=0x7fffffffcea0) at Python/pythonrun.c:933
#155 0x0000000000425ddb in PyRun_SimpleFileExFlags (fp=fp@entry=0x9501a0, filename=<optimized out>,
    filename@entry=0x7ffff7efaeb0 ""test/test_nn.py"", closeit=closeit@entry=1, flags=flags@entry=0x7fffffffcea0) at Python/pythonrun.c:396
#156 0x0000000000425f37 in PyRun_AnyFileExFlags (fp=fp@entry=0x9501a0, filename=0x7ffff7efaeb0 ""test/test_nn.py"", closeit=closeit@entry=1, flags=flags@entry=0x7fffffffcea0) at Python/pythonrun.c:80
#157 0x00000000004349d9 in run_file (fp=fp@entry=0x9501a0, filename=filename@entry=0x917300 L""test/test_nn.py"", p_cf=p_cf@entry=0x7fffffffcea0) at Modules/main.c:338
#158 0x0000000000435583 in Py_Main (argc=argc@entry=3, argv=argv@entry=0x916010) at Modules/main.c:809
#159 0x000000000041d21a in main (argc=3, argv=0x7fffffffd018) at ./Programs/python.c:69
`

Other tests from test/run_test.sh pass, although I didn't run the MAGMA tests because I haven't installed it outside of a conda environment.. ['\r\n\r\nRunning it through gdb on ""test_variable_sequence_cuda"" yields the following stack trace:\r\n']"
102,7342,0,"[feature request] [PyTorch] More flexible optimizer API. Currently, there is no easy way to change the decay / momentum / lr for a parameter after constructing the optimizer. For example, it is hard to stop a parameter from being decayed in an iteration.

Maybe we should support a getter/setter API like .

cc @vincentqb. []"
177,27037,0,"`padding_mode` support for `functional.unfold`. ## üöÄ Feature
Add  support for  operation.

## Motivation
 is a very useful function for window operations other than convolution. In its current implementation, it only supports the ""constant"" padding mode, and automatically fills the margins with zeros. I have a use case where I need to use the ""edge"" padding mode. 

## Pitch

I want to  to have the  argument exactly like the convolution operation. This would also make the API more coherent.

## Alternatives

I guess the alternative is to manually copy cell values to the padded area.
. []"
114,11982,0,"[feature request] Publish wheels with debug symbols. It would be great if wheels of pytorch with debug symbols were published (or at least made available via https://ci.pytorch.org), so that users can investigate native crashes without going through the whole (error prone) process of building pytorch themselves.

For reference, I asked [the question on the forums first, but got no answer](https://discuss.pytorch.org/t/pytorch-wheel-with-debug-symbols/25169).

cc @ezyang @seemethere @malfet @walterddr. []"
480,15016,0,"torch.tril does not support 0-sized dims. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:



<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior



## Environment

PyTorch version: 1.0.0a0+54b5dd9
Is debug build: No
CUDA used to build PyTorch: 9.2.88

OS: CentOS Linux 7 (Core)
GCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-28)
CMake version: version 3.12.2

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: Tesla M40
GPU 1: Tesla M40

Nvidia driver version: 396.26
cuDNN version: Probably one of the following:
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.5.0.5
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.5.1.3
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.6.0.20
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.6.0.21
/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn_static.a
/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn.so.7.1.2
/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn.so.7.4.1
/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn_static.a
/usr/local/fbcode/gcc-5-glibc-2.23/lib/libcudnn.so.6
/usr/local/fbcode/gcc-5-glibc-2.23/lib/libcudnn.so.6.0.20
/usr/local/fbcode/gcc-5-glibc-2.23/lib/libcudnn.so.6.0.21
/usr/local/fbcode/gcc-5-glibc-2.23/lib/libcudnn.so.7.1.2
/usr/local/fbcode/gcc-5-glibc-2.23/lib/libcudnn.so.7.1.4
/usr/local/fbcode/platform007/lib/libcudnn.so.7.1.4

Versions of relevant libraries:
[pip] Could not collect
[conda] magma-cuda92              2.4.0                         1    pytorch
[conda] torch                     1.0.0a0+54b5dd9           <pip>

. ['python\r\n>>> import torch\r\n>>> torch.ones(0, 3)\r\ntensor([], size=(0, 3))\r\n>>> torch.ones(0, 3).tril(0)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nRuntimeError: invalid argument 1: expected a matrix at ../aten/src/TH/generic/THTensorMoreMath.cpp:1255\r\n>>> torch.ones(1, 3).tril(0)\r\ntensor([[1., 0., 0.]])\r\n', 'python\r\n>>> import numpy as np\r\n>>> np.tril(np.ones((0, 3)))\r\narray([], shape=(0, 3), dtype=float64)\r\n']"
73,20355,1,"Backwards hangs. Training is hanging during a call to backwards - I might be wrong but it looks like it hangs while one of the threads tries to acquire a lock.

The setup is the following:
 - pytorch version is 1.0.0post2
 - start 4 python processes on same machine (using multiprocessing spawn, but same happens with Popen)
 - each process uses a different gpu and different data (all data is loaded into memory prior to start training)
 - use torch.distributed (nccl) to synchronise training; all communication between different processes happens via nccl

What I observe is that at random times, one of the processes hangs - and the others then wait for it in the call to all_reduce.

Unfortunately, it is hard to reproduce, and it can take an arbitrary amount of time to hang - sometimes it hangs after 10min, sometimes it hangs after 10h+.

Any help is appreciated - thanks.

At the moment where it hangs, the threads of the frozen process are in this state:
> (gdb) info threads
  Id   Target Id         Frame
  16   Thread 0x7f22711b9700 (LWP 23578) ""python"" 0x00007f22d64fff0d in poll () from /lib64/libc.so.6
  15   Thread 0x7f2270943700 (LWP 23614) ""python"" 0x00007f22d650c03f in accept4 () from /lib64/libc.so.6
  14   Thread 0x7f2265fff700 (LWP 23644) ""python"" 0x00007f22d64fff0d in poll () from /lib64/libc.so.6
  13   Thread 0x7f22617fe700 (LWP 30293) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  12   Thread 0x7f22609ed800 (LWP 30294) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  11   Thread 0x7f22605eb880 (LWP 30295) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  10   Thread 0x7f224dffe900 (LWP 30296) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  9    Thread 0x7f224dbfc980 (LWP 30297) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  8    Thread 0x7f224d7faa00 (LWP 30298) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  7    Thread 0x7f224d3f8a80 (LWP 30299) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  6    Thread 0x7f221aee5700 (LWP 68788) ""python"" 0x00007f22d70f851d in __lll_lock_wait () from /lib64/libpthread.so.0
  5    Thread 0x7f221a6e4700 (LWP 68789) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  4    Thread 0x7f2219ee3700 (LWP 68790) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  3    Thread 0x7f22196e2700 (LWP 68791) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  2    Thread 0x7f2218ee1700 (LWP 68792) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
  1    Thread 0x7f22d750f740 (LWP 23478) ""python"" 0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0

The stack trace per thread is below.

Thread 1:
>#0  0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x00007f22bfb9656f in __gthread_cond_wait (__mutex=<optimized out>, __cond=<optimized out>)
    at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/build/build-cc-gcc-final/x86_64-conda_cos6-linux-gnu/libstdc++-v3/include/x86_64-conda_cos6-linux-gnu/bits/gthr-default.h:877
#2  std::condition_variable::wait (this=<optimized out>, __lock=...) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/condition_variable.cc:53
#3  0x00007f2278eb08e3 in torch::autograd::Engine::execute(std::vector<torch::autograd::Edge, std::allocator<torch::autograd::Edge> > const&, std::vector<torch::autograd::Variable, std::allocator<torch::autograd::Variable> > const&, bool, bool, std::vector<torch::autograd::Edge, std::allocator<torch::autograd::Edge> > const&) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#4  0x00007f22bc696a0c in torch::autograd::python::PythonEngine::execute(std::vector<torch::autograd::Edge, std::allocator<torch::autograd::Edge> > const&, std::vector<torch::autograd::Variable, std::allocator<torch::autograd::Variable> > const&, bool, bool, std::vector<torch::autograd::Edge, std::allocator<torch::autograd::Edge> > const&) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so
#5  0x00007f22bc69722c in THPEngine_run_backward(THPEngine*, _object*, _object*) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so
...

Threads 2-5:
>#0  0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x00007f22bfb9656f in __gthread_cond_wait (__mutex=<optimized out>, __cond=<optimized out>)
    at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/build/build-cc-gcc-final/x86_64-conda_cos6-linux-gnu/libstdc++-v3/include/x86_64-conda_cos6-linux-gnu/bits/gthr-default.h:877
#2  std::condition_variable::wait (this=<optimized out>, __lock=...) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/condition_variable.cc:53
#3  0x00007f2278eac92b in torch::autograd::ReadyQueue::pop() () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#4  0x00007f2278eaf083 in torch::autograd::Engine::thread_main(torch::autograd::GraphTask*) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#5  0x00007f2278eaba77 in torch::autograd::Engine::thread_init(int) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#6  0x00007f22bc6968aa in torch::autograd::python::PythonEngine::thread_init(int) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so
#7  0x00007f22bfb9a678 in std::execute_native_thread_routine_compat (__p=<optimized out>) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/thread.cc:94
#8  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#9  0x00007f22d650abad in clone () from /lib64/libc.so.6

Thread 6:
>#0  0x00007f22d70f851d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007f22d70f61a0 in pthread_cond_broadcast@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#2  0x00007f22bfb96594 in __gthread_cond_broadcast (__cond=<optimized out>)
    at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/build/build-cc-gcc-final/x86_64-conda_cos6-linux-gnu/libstdc++-v3/include/x86_64-conda_cos6-linux-gnu/bits/gthr-default.h:865
#3  std::condition_variable::notify_all (this=<optimized out>) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/condition_variable.cc:73
#4  0x00007f2278eaf167 in torch::autograd::Engine::thread_main(torch::autograd::GraphTask*) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#5  0x00007f2278eaba77 in torch::autograd::Engine::thread_init(int) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch.so.1
#6  0x00007f22bc6968aa in torch::autograd::python::PythonEngine::thread_init(int) () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so
#7  0x00007f22bfb9a678 in std::execute_native_thread_routine_compat (__p=<optimized out>) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/thread.cc:94
#8  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#9  0x00007f22d650abad in clone () from /lib64/libc.so.6

Thread 7-13:
>#0  0x00007f22d70f5995 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x00007f22cb364725 in __kmp_suspend_64 () from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#2  0x00007f22cb2d5e4e in bool _INTERNAL_25_______src_kmp_barrier_cpp_3dc39ea5::__kmp_wait_template<kmp_flag_64, 1, false, true>(kmp_info*, kmp_flag_64*, void*) ()
   from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#3  0x00007f22cb2d9398 in _INTERNAL_25_______src_kmp_barrier_cpp_3dc39ea5::__kmp_hyper_barrier_release(barrier_type, kmp_info*, int, int, int, void*) () from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#4  0x00007f22cb2df4d2 in __kmp_fork_barrier(int, int) () from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#5  0x00007f22cb320d8e in __kmp_launch_thread () from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#6  0x00007f22cb360571 in _INTERNAL_26_______src_z_Linux_util_cpp_51eec780::__kmp_launch_worker(void*) () from /opt/anaconda3/lib/python3.7/site-packages/numpy/../../../libiomp5.so
#7  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#8  0x00007f22d650abad in clone () from /lib64/libc.so.6

Thread 14:
>#0  0x00007f22d64fff0d in poll () from /lib64/libc.so.6
#1  0x00007f22beb8a323 in ?? () from /lib64/libcuda.so.1
#2  0x00007f22bebecacd in ?? () from /lib64/libcuda.so.1
#3  0x00007f22beb8c988 in ?? () from /lib64/libcuda.so.1
#4  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#5  0x00007f22d650abad in clone () from /lib64/libc.so.6

Thread 15:
>#0  0x00007f22d650c03f in accept4 () from /lib64/libc.so.6
#1  0x00007f22beb8b2ca in ?? () from /lib64/libcuda.so.1
#2  0x00007f22beb7d8dd in ?? () from /lib64/libcuda.so.1
#3  0x00007f22beb8c988 in ?? () from /lib64/libcuda.so.1
#4  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#5  0x00007f22d650abad in clone () from /lib64/libc.so.6

Thread 16:
>#0  0x00007f22d64fff0d in poll () from /lib64/libc.so.6
#1  0x00007f22bca13879 in c10d::TCPStoreDaemon::run() () from /opt/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so
#2  0x00007f22bfb9a678 in std::execute_native_thread_routine_compat (__p=<optimized out>) at /opt/conda/conda-bld/compilers_linux-64_1534514838838/work/.build/x86_64-conda_cos6-linux-gnu/src/gcc/libstdc++-v3/src/c++11/thread.cc:94
#3  0x00007f22d70f1e25 in start_thread () from /lib64/libpthread.so.0
#4  0x00007f22d650abad in clone () from /lib64/libc.so.6. []"
284,28206,0,"torch.utils.tensorboard.SummaryWriter.add_graph do not support non-tensor inputs. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1.Run my script below:


and you can see the trace(take bug 3 as an example):

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->
writer.add_graph should run normally.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 Collecting environment information...
PyTorch version: 1.3.0
Is debug build: No
CUDA used to build PyTorch: None
OS: Mac OSX 10.14.6
GCC version: Could not collect
CMake version: Could not collect
Python version: 3.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA
Versions of relevant libraries:
[pip] numpy==1.17.2
[pip] torch==1.3.0
[pip] torchvision==0.4.1
[conda] torch                     1.3.0                    pypi_0    pypi
[conda] torchvision               0.4.1                    pypi_0    pypi

## Additional context

<!-- Add any other context about the problem here. -->
1.TensorboardX.SummaryWriter.add_graph has the same bug as torch.utils.tensorboard
2.Besides this bug, I hope add_graph could accept not only a tuple as positional arguments, but also a dict as keyword arguments for the model.forward()'s input. ['python\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nfrom torch.utils.tensorboard import SummaryWriter\r\n# from tensorboardX import SummaryWriter\r\n\r\n# bug 1: bool type inputs\r\nclass Net_1(nn.Module):\r\n    def __init__(self, dropout=0.5):\r\n        super(Net_1, self).__init__()\r\n        self.fc1 = nn.Linear(120, 84)\r\n        self.fc2 = nn.Linear(84, 10)\r\n        self.dropout = nn.Dropout(dropout)\r\n\r\n    def forward(self, x, use_dropout=False):\r\n        x = F.relu(self.fc1(x))\r\n        if use_dropout:\r\n            x = self.dropout(x)  # or other operations ....\r\n        x = F.relu(self.fc2(x))\r\n        return x\r\n\r\nwith SummaryWriter(""bugs"") as w:\r\n    net = Net_1()\r\n    input_x = torch.randn((2,120))\r\n    w.add_graph(net, (input_x, True))\r\n\r\n\r\n# bug 2: None type inputs (might be argument\'s default value)\r\nclass Net_2(nn.Module):\r\n    def __init__(self):\r\n        super(Net_2, self).__init__()\r\n        self.fc1 = nn.Linear(120, 84)\r\n        self.fc2 = nn.Linear(120, 84)\r\n        self.fc3 = nn.Linear(120, 84)\r\n        self.fc4 = nn.Linear(84, 10)\r\n\r\n    def forward(self, x, y=None, z=None):\r\n        x = F.relu(self.fc1(x))\r\n        if y is not None:\r\n            y = F.relu(self.fc2(y))\r\n            x = x + y\r\n        if z is not None:\r\n            z = F.relu(self.fc3(z))\r\n            x = x + z\r\n        x = F.relu(self.fc4(x))\r\n        return x\r\n\r\nwith SummaryWriter(""bugs"") as w:\r\n    net = Net_2()\r\n    input_x = torch.randn((2,120))\r\n    input_y = None\r\n    input_z = torch.randn((2,120))\r\n    w.add_graph(net, (input_x, input_y, input_z))\r\n\r\n\r\n# bug 3: List type inputs (dict, or other python build-in types like int,str,... may also meet this question)\r\nclass Net_3(nn.Module):\r\n    def __init__(self):\r\n        super(Net_3, self).__init__()\r\n        self.fc_list = [nn.Linear(120, 120) for _ in range(10)]\r\n        self.fc_n = nn.Linear(120, 10)\r\n\r\n    def forward(self, x, index:list=None):\r\n        if index is not None:\r\n            for i in index:\r\n                x = F.relu(self.fc_list[i](x))\r\n        x = F.relu(self.fc_n(x))\r\n        return x\r\n\r\nwith SummaryWriter(""bugs"") as w:\r\n    net = Net_3()\r\n    input_x = torch.randn((2, 120))\r\n    index = [1, 5, 1, 7, 0]\r\n    w.add_graph(net, (input_x, index))\r\n\r\n', '\r\nError occurs, No graph saved\r\nTraceback (most recent call last):\r\n  File ""<input>"", line 1, in <module>\r\n  File ""/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_bundle/pydev_umd.py"", line 197, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File ""/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_imps/_pydev_execfile.py"", line 18, in execfile\r\n    exec(compile(contents+""\\n"", file, \'exec\'), glob, loc)\r\n  File ""/Users/wangyuanzheng/Downloads/xxxxxxx/project/albert_pytorch/dev/add_graph_bug.py"", line 25, in <module>\r\n    w.add_graph(net, (input_x, True))\r\n  File ""/Users/wangyuanzheng/anaconda3/envs/CCFBigData-torch/lib/python3.7/site-packages/torch/utils/tensorboard/writer.py"", line 682, in add_graph\r\n    self._get_file_writer().add_graph(graph(model, input_to_model, verbose))\r\n  File ""/Users/wangyuanzheng/anaconda3/envs/CCFBigData-torch/lib/python3.7/site-packages/torch/utils/tensorboard/_pytorch_graph.py"", line 239, in graph\r\n    raise e\r\n  File ""/Users/wangyuanzheng/anaconda3/envs/CCFBigData-torch/lib/python3.7/site-packages/torch/utils/tensorboard/_pytorch_graph.py"", line 234, in graph\r\n    trace = torch.jit.trace(model, args)\r\n  File ""/Users/wangyuanzheng/anaconda3/envs/CCFBigData-torch/lib/python3.7/site-packages/torch/jit/__init__.py"", line 858, in trace\r\n    check_tolerance, _force_outplace, _module_class)\r\n  File ""/Users/wangyuanzheng/anaconda3/envs/CCFBigData-torch/lib/python3.7/site-packages/torch/jit/__init__.py"", line 997, in trace_module\r\n    module._c._create_method_from_trace(method_name, func, example_inputs, var_lookup_fn, _force_outplace)\r\nRuntimeError: Type \'Tuple[Tensor, bool]\' cannot be traced. Only Tensors and (possibly nested) Lists, Dicts, and Tuples of Tensors can be traced (toTraceableIValue at ../torch/csrc/jit/pybind_utils.h:298)\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 135 (0x110c479e7 in libc10.dylib)\r\nframe #1: torch::jit::toTraceableIValue(pybind11::handle) + 1280 (0x110246740 in libtorch_python.dylib)\r\nframe #2: torch::jit::toTypedStack(pybind11::tuple const&) + 31 (0x1102e7edf in libtorch_python.dylib)\r\nframe #3: void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_16, void, torch::jit::script::Module&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, pybind11::function, pybind11::tuple, pybind11::function, bool, pybind11::name, pybind11::is_method, pybind11::sibling>(torch::jit::script::initJitScriptBindings(_object*)::$_16&&, void (*)(torch::jit::script::Module&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, pybind11::function, pybind11::tuple, pybind11::function, bool), pybind11::name const&, pybind11::is_method const&, pybind11::sibling const&)::\'lambda\'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) + 147 (0x11031e4e3 in libtorch_python.dylib)\r\nframe #4: pybind11::cpp_function::dispatcher(_object*, _object*, _object*) + 3372 (0x10fe57d3c in libtorch_python.dylib)\r\n<omitting python frames>\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
730,16181,0,"[Feature Request] Add `__getitem__()` to `nn.Module`. ## üöÄ Feature

Enable to call each layer in nn.Module like python dict.

 or 
-> 


## How

Add bellow function to  .
- reference: [chainer.Chain](https://github.com/chainer/chainer/blob/v5.1.0/chainer/link.py#L871-L873)



## Motivation

Access each layer in network easily (Especially for beginners).

#### old



#### new




Maybe this is different from the concept of PyTorch?. ['python\r\n    def __getitem__(self, name):\r\n        """"""Equivalent to getattr.""""""\r\n        return getattr(self, name)\r\n', ""python\r\nclass Net(nn.Module):\r\n    def __init__(self):\r\n        super(Net, self).__init__()\r\n        ...\r\n\r\n    def forward(self, x):\r\n        ...\r\n        # Apply each conv<number>_1, conv<number>_2\r\n        for i in range(10, 11 + 1):\r\n            output_tmp = outputs[-1]\r\n            output_tmp = F.relu(getattr(self, f'conv{i:d}_1')(output_tmp))\r\n            output_tmp = F.relu(getattr(self, f'conv{i:d}_2')(output_tmp))\r\n            outputs.append(output_tmp)\r\n        return outputs\r\n"", ""python\r\nclass Net(nn.Module):\r\n    def __init__(self):\r\n        super(Net, self).__init__()\r\n        ...\r\n\r\n    def forward(self, x):\r\n        ...\r\n        # Apply each conv<number>_1, conv<number>_2\r\n        for i in range(10, 11 + 1):\r\n            output_tmp = outputs[-1]\r\n            output_tmp = F.relu(self[f'conv{i:d}_1'](output_tmp))\r\n            output_tmp = F.relu(self[f'conv{i:d}_2'](output_tmp))\r\n            outputs.append(output_tmp)\r\n        return outputs\r\n""]"
310,30987,0,"Remove `.data`. Even though it is not documented, many users still use it. And it leads to many bugs in user code.
So we should remove it completely to prevent this.
The expected steps are:
- [ ] Add a new api to make a shallow copy that does not share version? Or a cat + unbind function that does not share version counter if that is enough.
- [ ] Remove the use of .data in all our internal code
  - [ ] 
  - [ ]  and 
  - [ ] 
  - [ ]  Blocky by https://github.com/pytorch/pytorch/pull/30258#issuecomment-558344600 (not blocked ones were done in #31479)
  - [ ]  Use that requires the new api mentioned above.
  - [x]  #31480 
  - [ ]  Simple ones done in #31481 and #31482
  - [ ] 
  - [ ] 
  - [ ] 
  - [x] *ignored* 
- [ ] Add warning to every call to 
- [ ] Actually remove  ?


cc @ezyang @SsnL @albanD @zou3519 @gqchen. []"
384,215,0,"missing tensor constructors. Missing while writing docs

- (size, stride)
- (storage, storageOffset, size, stride). []"
13,28761,1,"torch.tensor() is very slow when it is passed an h5py Dataset.. ## üêõ Bug

 is very slow when it is passed an h5py Dataset.

## To Reproduce

Create a new HDF5 file with a 1000x1000 float32 dataset:



Then load it back into a Tensor:



It's very slow. However, if the dataset is converted into a NumPy array first, it performs much faster:



The resulting tensors are equal. Perhaps the manual NumPy array conversion avoids an expensive conversion to a Python nested list of floats.


cc @VitalyFedyunin @ngimel. [""python\r\nimport h5py\r\nimport numpy as np\r\nimport torch\r\n\r\ntestfile = h5py.File('testfile.h5', 'w')\r\ntestfile['data'] = torch.eye(1000)\r\n"", ""\r\n>>> %timeit torch.tensor(testfile['data'])\r\n421 ms ¬± 28.2 ms per loop (mean ¬± std. dev. of 7 runs, 1 loop each)\r\n"", ""\r\n>>> %timeit torch.tensor(np.array(testfile['data']))\r\n2.84 ms ¬± 162 ¬µs per loop (mean ¬± std. dev. of 7 runs, 100 loops each)\r\n""]"
15,25690,1,"Dropout behaves differently on different devices. I have two machines. One has a P100 and another has 4 K80s.
I found the following code output differently on the two machines.
It means seeding doesn't make the output of dropout reproducible on different devices. 
Is it by design?
If we can not make the output reproducible on different devices, it may be a trouble of comparing different models.

The output of P100 machine is always

The output of K80 machine is always


. [""\r\n#!/bin/bash python\r\nimport torch\r\nimport numpy as np \r\nimport random \r\nseed = 0\r\ntorch.manual_seed(seed)\r\ntorch.cuda.manual_seed(seed)\r\ntorch.cuda.manual_seed_all(seed)  \r\nnp.random.seed(seed)  \r\nrandom.seed(seed)  \r\ntorch.manual_seed(seed)\r\ntorch.backends.cudnn.benchmark = False\r\ntorch.backends.cudnn.deterministic = True\r\na = torch.ones(1000,1000).to('cuda:0')\r\ndropout = torch.nn.Dropout(0.5)\r\nb = dropout(a)\r\nprint(torch.sum(torch.abs(b)))\r\n""]"
60,847,1,"the loss is not decreasing. Hi,
I have created a simple model consisting of two 1-layer nn competing each other. So, I have my own loss function based on those nn outputs.  It is very similar to GAN. The problem is that for a very simple test sample case, the loss function is not decreasing. For now I am using non-stochastic optimizer to eliminate randomness.  Here is the pseudo code with explanation

n1_model = Net1(Dimension_in_n1, Dimension_out) # 1-layer nn with sigmoid
n2_model =Net2(Dimension_in_n2, Dimension_out) # 1-layer nn with sigmoid

n1_optimizer = torch.optim.LBFGS(n1_model.parameters(), lr=0.01,max_iter = 50)
n2_optimizer = torch.optim.LBFGS(n2_model.parameters(), lr=0.01, max_iter = 50)

for t in range(iter):
    x_n1 = Variable(torch.from_numpy(...)) #load input of nn1 in batch size
    x_n2 = Variable(torch.from_numpy(...)) #load input of nn2 in batch size

    def closure():
       reset_grad(n1_model.parameters())
       reset_grad(n2.parameters())
        y_n1 = n1_model(x_n1)
        y_n2 = n2_model(x_n2)
        n1_params =getParams(n1_model)
        n2_param =getParams(n2_model)
        loss = my_loss_function(y_n1, y_n2, n1_params, n2_param) # my loss function, mean square error + regularizer
        loss.backward(retain_variables=True)
        return loss

    n1_optimizer.step(closure)


    def clos():
       reset_grad(n1_model.parameters())
       reset_grad(n2_model.parameters())
        y_n1 = n1_model(x_n1)
        y_n2 = n2_model(x_n2)
        n1_params =getParams(n1_model)
        n2_param =getParams(n2_model)
        loss = my_loss_function(y_n1, y_n2, n1_params, n2_param) # my loss function, mean square error + regularizer
        loss.backward()
        return loss

    n2_optimizer.step(clos)


and here is the definition of my loss function:

def my_loss_function(n1_output, n2_output, n1_parm, n2_param):
    sm = torch.pow(n1_output - n2_output, 2)
    reg = torch.norm(n1_parm,2) + torch.norm(n2_param,2)
    y = torch.sum(sm) + 1 * reg
    return y

when I plot loss function, it has oscillation; I expect it to decrease during training.
. []"
93,4081,1,"20% more gpu memory usage on resnet. Been testing with resnet 50 when I noticed that a batch of 128 / gpu no longer fits in multi-gpu. I'm seeing around 20% more gpu memory being used now (see below).

'old version' commit hash https://github.com/pytorch/pytorch/commit/50009144c02155be6afd4570e93f453e73904a8e
'new version' commit hash https://github.com/pytorch/pytorch/commit/7ddcb91c7f84c3da8cc9f7fba28a3ae9ecd6cc45

. ['\r\nresnet50    | batch 16/gpu | batch 32/gpu | batch 64/gpu\r\nold version | 2.96 GiB     | 4.52 GiB     | 7.97 GiB\r\nnew version | 3.55 GiB     | 5.60 GiB     | 9.81 GiB\r\n']"
421,24006,0,"result random. abosolutely same pytorch code:
when I use 1 gpu to train the model, every time results are same
But when i use mutli gpus to train the model, every time result are random, 
pazzled!. []"
709,12540,0,"[RFC] Removing Nervana GPU. NervanaGPU is currently included as a [third-party module](https://github.com/pytorch/pytorch/tree/c2a57d082d36f30f32d5c4cc7147ab57ce2c3097/third_party). However the repository is not under active development anymore and has not been modified since 3 years ago.

Checking the commit that added it, it was [this one](https://github.com/pytorch/pytorch/commit/9201cdd029aa820ebc92c71bd4f6d4105163ca80) for the optimized GEMM kernel that was developed at Nervana.

There are 2 kernels of interest in Nervana's work:

### Nervana GEMM

While Nervana GEMM is extremely tuned for Maxwell Architecture, but with Volta and Turing, GPUs are now offering Tensor Cores that are much faster. I expect that Nvidia tuned their GEMM implementation since then.

Alternatives:
- CuBLAS
- [Nervana Maxas](https://github.com/NervanaSystems/maxas) which isolated the GEMM kernel and is a much smaller library than the full NervanaGPU, so it's probably possible to clone and maintain it.
- Honorary mention: [Nvidia Cutlass](https://github.com/NVIDIA/cutlass), which achieves 90% speed of CuBLAS and supports Tensor cores without assembly.
- Nvidia's TensorRT for inference.

### Nervana convolution kernel

(If used, but i don't think it is)

The main appeal is the winograd kernel [discussed extensively here](https://github.com/soumith/convnet-benchmarks/issues/93) but it's [not even in NervanaGPU repo but in Neon repo.](https://github.com/NervanaSystems/nervanagpu/issues/25#issuecomment-203168418).
Furthermore it has been integrated into CuDNN with torch NCHW layout instead of Neon's CHWN layout and convolution was probably one of Nvidia focus in the past 2 years.

### Conclusion

Should the benchmarks show that alternatives to Nervana achieves the same speed on current GPU for a wide range of input size (as tensor cores are currently very restrictive), I think NervanaGPU code should be dropped to save on code, maintenance, dependencies and build options.


. []"
567,25971,0,"Outdated exception message, ""Call init_rpc(name) first."". ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Call


got


cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera. ['\r\ndist.rpc(...)\r\n', '\r\n    raise RuntimeError(""RPC has not been initialized. ""\r\nRuntimeError: RPC has not been initialized. Call init_rpc(name) first.\r\n']"
655,3214,0,"Cannot directly use lr_scheduler in current pip-install package. When I install pytorch using pip, I found lr_scheduler.py is in , but this line is missing:
https://github.com/pytorch/pytorch/blob/d89d9d74bdd0b64c119980003aa29195a61f93a9/torch/optim/__init__.py#L18
Thus user should manually add  to use torch.optim.lr_scheduler.
I hope it will be updated in the next version.. []"
148,22296,0,"Support data parallel for heterogeneous GPU. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->
Hopefully,  can support data parallel on multiple heterogeneous GPU.


## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->
I'm currently working on a big model and would like to use  to speed up training. However, I use two different GPU on my computer, i.e, GTX 1060 and GTX 1080, when I train the model, 1060 becomes a bottleneck and slows down the whole training process.


## Pitch
It will be great that  can automatically assign tasks according to computation power or support manually specifying mini-batch size on each GPU.
<!-- A clear and concise description of what you want to happen. -->

. []"
668,3388,0," recipe for target 'CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o' failed. [""\r\n   ^\r\n/home/ruikun/anaconda/include/THPP/tensors/THTensor.hpp:38:3: note:   candidate expects 0 arguments, 1 provided\r\n/home/ruikun/anaconda/include/THPP/tensors/THTensor.hpp:27:8: note: candidate: constexpr thpp::THTensor<signed char>::THTensor(const thpp::THTensor<signed char>&)\r\n struct THTensor : public interface_traits<real>::tensor_interface_type {\r\n        ^\r\n/home/ruikun/anaconda/include/THPP/tensors/THTensor.hpp:27:8: note:   no known conversion for argument 1 from ‚ÄòTHCharTensor*‚Äô to ‚Äòconst thpp::THTensor<signed char>&‚Äô\r\nCMakeFiles/THD.dir/build.make:158: recipe for target 'CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o' failed\r\nmake[2]: *** [CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/THD.dir/all' failed\r\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\r\nMakefile:129: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\n""]"
24,9873,1,"Pytorch is slow when only using CPU, and cannot utilize multicore of CPU. When I testing the acceleration effect on CPU by decomposing convolution layers, I found pytorch is slow  and cannot utilize multicores of CPU. 




Output is that while cpu usage is 100%-200%
> 147.48149728775024 16.699654817581177

![pytorch](https://user-images.githubusercontent.com/10665923/43258302-eca30248-9104-11e8-8045-49d8d63819a4.PNG)

However, Keras (TF  back-end)  is faster and multi-threaded.

Output is that while cpu usage is 800%-1600%
> 26.393059253692627 13.783706188201904

![keras](https://user-images.githubusercontent.com/10665923/43258314-f57cf11c-9104-11e8-8cfd-c094a798df48.PNG)

## System Info
Pytorch 0.4
Ubuntu 16.04



cc @VitalyFedyunin @ngimel. ['\r\n# To blind GPU\r\nos.environ[""CUDA_VISIBLE_DEVICES""] = \'  \'\r\n# Generate input data\r\nt = np.random.randn(50,128,128,64).astype(np.float32)\r\n', '\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\n\r\nx = torch.from_numpy(t).permute(0,3,1,2)\r\n\r\nmodel1 = nn.Sequential(\r\n    nn.Conv2d(64, 128, 3, stride=1, padding=1, dilation=1),\r\n    nn.Conv2d(128, 256, 3, stride=1, padding=1, dilation=1),\r\n)\r\n\r\nmodel2 = nn.Sequential(\r\n    nn.Sequential(\r\n        nn.Conv2d(64, 16, kernel_size=(1, 1)),\r\n        nn.Conv2d(16, 16, kernel_size=(3, 1), padding=(1, 0)),\r\n        nn.Conv2d(16, 16, kernel_size=(1, 3), padding=(0, 1)),\r\n        nn.Conv2d(16, 128, kernel_size=(1, 1)),\r\n    ),\r\n    nn.Sequential(\r\n        nn.Conv2d(128, 32, kernel_size=(1, 1)),\r\n        nn.Conv2d(32, 32, kernel_size=(3, 1), padding=(1, 0)),\r\n        nn.Conv2d(32, 32, kernel_size=(1, 3), padding=(0, 1)),\r\n        nn.Conv2d(32, 256, kernel_size=(1, 1)),\r\n    ),\r\n)\r\n\r\niters = 10\r\n\r\nt1 = time.time()\r\nfor i in range(iters):\r\n    y=model1(x)\r\nt2 = time.time()\r\nm1t = t2-t1\r\n\r\nt1 = time.time()\r\nfor i in range(iters):\r\n    y=model2(x)\r\nt2 = time.time()\r\nm2t = t2-t1\r\n\r\nprint(m1t, m2t)\r\n', '\r\nmodel1 = Sequential([\r\n    Conv2D(128,3,input_shape=(128,128,64)),\r\n    Conv2D(256,3),\r\n])\r\n\r\n\r\nmodel2 = Sequential([\r\n    Sequential([\r\n        Conv2D(16,1,input_shape=(128,128,64)),\r\n        Conv2D(16,(3,1)),\r\n        Conv2D(16,(1,3)),\r\n        Conv2D(128,(1,1)),\r\n    ]),\r\n    Sequential([\r\n        Conv2D(32,1,input_shape=(100,100,128)),\r\n        Conv2D(32,(3,1)),\r\n        Conv2D(32,(1,3)),\r\n        Conv2D(256,1)\r\n    ]),\r\n])\r\n']"
174,27954,0,"[quantization] Dynamic LSTM doesn't serialize properly when traced. Repro



Output



cc @suo @jerryzh168 @jianyuh @dzhulgakov @raghuramank100. [""python\r\nimport torch\r\nimport copy\r\nimport io\r\nfrom torch.quantization import default_qconfig, quantize_dynamic\r\n\r\nclass LSTMDynamicModel(torch.nn.Module):\r\n    def __init__(self):\r\n        super(LSTMDynamicModel, self).__init__()\r\n        self.qconfig = default_qconfig\r\n        self.lstm = torch.nn.LSTM(2, 2).to(dtype=torch.float)\r\n\r\n    def forward(self, x):\r\n        x = self.lstm(x)\r\n        return x\r\n\r\nd_in, d_hid = 2, 2\r\nmodel = LSTMDynamicModel().eval()\r\ncell = model.lstm\r\n\r\n# Replace parameter values s.t. the range of values is exactly\r\n# 255, thus we will have 0 quantization error in the quantized\r\n# GEMM call. This i s for testing purposes.\r\n#\r\n# Note that the current implementation does not support\r\n# accumulation values outside of the range representable by a\r\n# 16 bit integer, instead resulting in a saturated value. We\r\n# must take care that in our test we do not end up with a dot\r\n# product that overflows the int16 range, e.g.\r\n# (255*127+255*127) = 64770. So, we hardcode the test values\r\n# here and ensure a mix of signedness.\r\nvals = [[100, -155],\r\n        [100, -155],\r\n        [-155, 100],\r\n        [-155, 100],\r\n        [100, -155],\r\n        [-155, 100],\r\n        [-155, 100],\r\n        [100, -155]]\r\nif isinstance(cell, torch.nn.LSTM):\r\n    num_chunks = 4\r\nvals = vals[:d_hid * num_chunks]\r\ncell.weight_ih_l0 = torch.nn.Parameter(\r\n    torch.tensor(vals, dtype=torch.float),\r\n    requires_grad=False)\r\ncell.weight_hh_l0 = torch.nn.Parameter(\r\n    torch.tensor(vals, dtype=torch.float),\r\n    requires_grad=False)\r\n\r\nref = copy.deepcopy(cell)\r\n\r\nmodel_int8 = quantize_dynamic(model=model, dtype=torch.qint8)\r\nmodel_fp16 = quantize_dynamic(model=model, dtype=torch.float16)\r\n\r\n# Smoke test extra reprs\r\ncell_int8 = model_int8.lstm\r\ncell_fp16 = model_fp16.lstm\r\n\r\nassert type(cell_int8) == torch.nn.quantized.dynamic.LSTM, \\\r\n    'torch.nn.LSTM should be converted to torch.nn.quantized.dynamic.LSTM after quantize_dynamic'\r\nassert type(cell_fp16) == torch.nn.quantized.dynamic.LSTM, \\\r\n    'torch.nn.LSTM should be converted to torch.nn.quantized.dynamic.LSTM after quantize_dynamic'\r\n\r\nniter = 10\r\nx = torch.tensor([[100, -155],\r\n                  [-155, 100],\r\n                  [100, -155]], dtype=torch.float).unsqueeze(0).repeat(niter, 1, 1)\r\n\r\nh0_vals = [[-155, 100],\r\n           [-155, 155],\r\n           [100, -155]]\r\n\r\nhx = torch.tensor(h0_vals, dtype=torch.float).unsqueeze(0)\r\ncx = torch.tensor(h0_vals, dtype=torch.float).unsqueeze(0)\r\n\r\nif isinstance(ref, torch.nn.LSTM):\r\n    hiddens = (hx, cx)\r\n\r\nref_out, ref_hid = ref(x, hiddens)\r\n\r\n# Compare int8 quantized to unquantized\r\noutput_int8, final_hiddens_int8 = cell_int8(x, hiddens)\r\n\r\ntorch.testing.assert_allclose(output_int8, ref_out)\r\n\r\nfor out_val, ref_val in zip(final_hiddens_int8, ref_hid):\r\n    torch.testing.assert_allclose(out_val, ref_val)\r\n\r\nclass ScriptWrapper(torch.nn.Module):\r\n    def __init__(self, cell):\r\n        super(ScriptWrapper, self).__init__()\r\n        self.cell = cell\r\n\r\n    def forward(self, x, hiddens):\r\n        # type: (torch.Tensor, Tuple[torch.Tensor, torch.Tensor]) -> Tuple[torch.Tensor, Tuple[torch.Tensor, torch.Tensor]]\r\n        return self.cell(x, hiddens)\r\n\r\n# TODO: TorchScript overloads don't work without this wrapper\r\ncell_script = torch.jit.trace(ScriptWrapper(cell_int8), (x, (hx, cx)))\r\n# cell_script = torch.jit.script(ScriptWrapper(cell_int8))\r\nout_script, hid_script = cell_script(x, hiddens)\r\nfor out_val, ref_val in zip(out_script, ref_out):\r\n    torch.testing.assert_allclose(out_val, ref_val)\r\n\r\n# Test save/load\r\nb = io.BytesIO()\r\n# torch.jit.save(cell_script, b)\r\ntorch.jit.save(cell_script, 'foo.zip')\r\n\r\nloaded = torch.jit.load('foo.zip')\r\nloaded(x, (hx, cx))\r\n"", '\r\n../aten/src/ATen/native/QuantizedLinear.cpp:328: UserWarning: FOUND weight out of range \r\n../aten/src/ATen/native/QuantizedLinear.cpp:328: UserWarning: FOUND weight out of range \r\nTraceback (most recent call last):\r\n  File ""export_test.py"", line 110, in <module>\r\n    loaded(x, (hx, cx))\r\n  File ""/data/users/jamesreed/pytorch/torch/nn/modules/module.py"", line 541, in __call__\r\n    result = self.forward(*input, **kwargs)\r\nRuntimeError: Expected temporary cpp type wrapper of type PackedLinearWeight\r\nThe above operation failed in interpreter, with the following stack trace:\r\nat code/__torch__/torch/nn/modules/module.py:11:17\r\n    argument_2: Tuple[Tensor, Tensor]) -> Tuple[Tensor, Tuple[Tensor, Tensor]]:\r\n    hx, hx0, = argument_2\r\n    _0, _1, _2 = torch.quantized_lstm(input, [hx, hx0], [CONSTANTS.c0, CONSTANTS.c1], True, 1, 0., True, False, False, dtype=12, use_dynamic=True)\r\n                 ~~~~~~~~~~~~~~~~~~~~ <--- HERE\r\n    return (_0, (_1, _2))\r\nCompiled from code /data/users/jamesreed/pytorch/torch/nn/quantized/dynamic/modules/rnn.py(332): forward_impl\r\n/data/users/jamesreed/pytorch/torch/nn/quantized/dynamic/modules/rnn.py(347): forward_tensor\r\n/data/users/jamesreed/pytorch/torch/nn/quantized/dynamic/modules/rnn.py(386): forward\r\n/data/users/jamesreed/pytorch/torch/nn/modules/module.py(525): _slow_forward\r\n/data/users/jamesreed/pytorch/torch/nn/modules/module.py(539): __call__\r\nexport_test.py(95): forward\r\n/data/users/jamesreed/pytorch/torch/nn/modules/module.py(525): _slow_forward\r\n/data/users/jamesreed/pytorch/torch/nn/modules/module.py(539): __call__\r\n/data/users/jamesreed/pytorch/torch/jit/__init__.py(1013): trace_module\r\n/data/users/jamesreed/pytorch/torch/jit/__init__.py(874): trace\r\nexport_test.py(98): <module>\r\n\r\n']"
643,5553,0,"NCCL Error 1 when using torch.nn.DataParallel. I have ran into this error on the parameter broadcast step of .
It sounds like this, to be precise: .
#2332 is possibly related.
. []"
679,24304,0,"MinMax Observer should return tensor of scale and tensor of zero_point?. ## üêõ Bug
Right now it returns a tensor of [scale, zero_point], I think maybe we should just return the values directly, or two Tensors?
https://github.com/pytorch/pytorch/blob/master/torch/quantization/observer.py#L65. []"
390,8981,0,"Intermittent failure of TestCollectEnv.test_expect. The failing diff usually looks something like:



I thought this was some weird buffering problem, but then I looked more carefully at the test, and one of the regexes looks VERY suspicious:



If the size of the short version hash varies, this regex will gobble more or less. It really shouldn't be hardcoded as wildcard periods.

CC @zou3519 . ['\r\n06:19:31   Versions of relevant libraries:\r\n06:19:31   [pip] numpy (1.14.X)\r\n06:19:31 - [pip] torch (0.5.0a0\r\n06:19:31 + [pip] torch (0.5.0a0)\r\n06:19:31 ?                     +\r\n', ""\r\n        version_hash_regex = re.compile(r'(a\\d+)\\+.......')\r\n        result = re.sub(version_hash_regex, r'\\1', info_output).strip()\r\n""]"
403,26081,0,"RNN fails to compile due to USE_FBGEMM=OFF. ## üêõ Bug

Compiling libtorch without FBGEMM causes a compile error in RNN.

> /d/dev/pytorch/aten/src/ATen/native/RNN.cpp:286:57: error: ‚ÄòPackedLinearWeight‚Äô was not declared in this scope

The struct exists in aten/src/ATen/native/quantized/cpu/fbgemm_utils.h

Workaround was to #ifdef certain sections of code. See diff:


## To Reproduce

Steps to reproduce the behavior:

1. cmake -DUSE_FBGEMM=OFF ..
2. Compile error

## Expected behavior

Compiles

## Environment

 - PyTorch Version (e.g., 1.0): master
 - OS (e.g., Linux): Linux x64
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): cmake -DUSE_FBGEMM=OFF ..
 - Python version: 3.6
 - CUDA/cuDNN version: N/A
 - GPU models and configuration: N/A
 - Any other relevant information: N/A

cc @jerryzh168 @jianyuh @dzhulgakov @zou3519. ['Diff\r\ndiff --git a/aten/src/ATen/native/RNN.cpp b/aten/src/ATen/native/RNN.cpp\r\nindex b9913888ed..774b6fcc74 100644\r\n--- a/aten/src/ATen/native/RNN.cpp\r\n+++ b/aten/src/ATen/native/RNN.cpp\r\n@@ -275,6 +275,7 @@ static std::vector<QuantizedCellParams> gather_quantized_params(TensorList param\r\n   return result;\r\n }\r\n \r\n+#ifdef USE_FBGEMM\r\n static std::vector<QuantizedCellParamsDynamic> gather_quantized_params_dynamic(\r\n     TensorList params) {\r\n   static at::Tensor undefined;\r\n@@ -291,6 +292,7 @@ static std::vector<QuantizedCellParamsDynamic> gather_quantized_params_dynamic(\r\n   }\r\n   return result;\r\n }\r\n+#endif\r\n \r\n static std::vector<QuantizedCellParamsFP16> gather_quantized_params_fp16(\r\n     TensorList params) {\r\n@@ -1043,6 +1045,7 @@ Tensor rnn_relu_cell(\r\n   return SimpleCell<relu_f, CellParams>{}(input, hx, CellParams{w_ih, w_hh, b_ih, b_hh});\r\n }\r\n \r\n+#ifdef USE_FBGEMM\r\n // Quantized implementations\r\n //\r\n // These implementations use FBGEMM to do the i2h and h2h linear layers with\r\n@@ -1094,6 +1097,7 @@ std::tuple<Tensor, Tensor, Tensor> quantized_lstm(\r\n   return results;\r\n \r\n }\r\n+#endif\r\n \r\n #define DEFINE_QUANTIZED_RNN_CELL(name, hx_type, cell_type, return_type, prepare_hx_fn) \\\r\n return_type name( \\\r\n\r\n']"
38,13045,1,"dataparallel not working on nvidia gpus and amd cpus. ## üêõ Bug

We have a number of machines with Threadripper CPUs, and 2 NVIDIA GPUs, some have 1070ti cards some 1080 some 1080ti and one with titanXp, they all displayed this behavior, when switching to using data parallel, training would fail, i.e. accuracy would not go up. We first saw this in our code base, but it also happens on the imagnet example from the pytorch examples repo

## To Reproduce

Steps to reproduce the behavior:

1. run the imagnet example for the examples repo in pytorch with dataparallel

these error messages were found in the dmesg log:


[1118468.873266] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000ea13a000 flags=0x0020]
[1118468.942145] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000ea139068 flags=0x0020]
[1118468.942189] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d0000040 flags=0x0020]
[1118468.942227] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d00007c0 flags=0x0020]
[1118468.942265] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d0001040 flags=0x0020]
[1118468.942303] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d0000f40 flags=0x0020]
[1118468.942340] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d00016c0 flags=0x0020]
[1118468.942377] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d0002040 flags=0x0020]
[1118468.942414] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d0001e40 flags=0x0020]
[1118468.942452] nvidia 0000:0a:00.0: AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000f address=0x00000000d00025c0 flags=0x0020]
[1118468.942489] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0003040 flags=0x0020]
[1118468.942525] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0002d40 flags=0x0020]
[1118468.942560] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d00034c0 flags=0x0020]
[1118468.942596] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0004040 flags=0x0020]
[1118468.942632] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0003c40 flags=0x0020]
[1118468.942667] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d00043c0 flags=0x0020]
[1118468.942703] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0005040 flags=0x0020]
[1118468.942739] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d0004b40 flags=0x0020]
[1118468.942774] AMD-Vi: Event logged [IO_PAGE_FAULT device=0a:00.0 domain=0x000f address=0x00000000d00052c0 flags=0x0020]

## Expected behavior

accuracy would not pick up in most cases, it never picked up for the validation set. We managed to work around this problem by turning off IOMMU in the bios.

## Environment

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 2.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration:
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti

Nvidia driver version: 384.130
cuDNN version: Probably one of the following:
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn.so.7.0.5
/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudnn_static.a

. []"
99,25150,0,"Problems with install python from source. ## üêõ Bug

For Pytorch 1.3.0 a from source installation is necessary, if one only have cuda 9.0. I cant update the version, because I do not have root access.

## To Reproduce
I have done everything what they say in the tutorial. The result is the following output of CMakerError:
main':
CheckSymbolExists.c:(.text+0x1b): undefined reference to 

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

PyTorch version: From Source
Is debug build: N/A
CUDA used to build PyTorch: 9.0

OS: Debian GNU/Linux 9.9 (stretch)
GCC version: (Debian 6.3.0-18+deb9u1) 6.3.0 20170516
CMake version: version 3.14.0

Python version: 3.7
Is CUDA available: yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: GeForce GTX 1080
GPU 1: NVS 310

Nvidia driver version: 384.111
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.17.0
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0
[conda] blas                      1.0                         mkl  
[conda] magma-cuda90              2.5.0                         1    pytorch
[conda] mkl                       2019.4                      243  
[conda] mkl-include               2019.4                      243  
[conda] mkl-service               2.0.2            py37h7b6447c_0  
[conda] mkl_fft                   1.0.14           py37ha843d7b_0  
[conda] mkl_random                1.0.2            py37hd81dba3_0

## Additional context

<!-- Add any other context about the problem here. -->
. []"
20,4211,1,"Initial .cuda() slow occur again at the latest cuda9 version PyTorch . Similar to #537. the first call of .cuda() take a very long time. It take even more on a model.cuda().





PyTorch install with conda: . 
GPU: GTX 1080 and CUDA9.0.. ['python\r\nimport torch\r\nfrom datetime import datetime\r\n\r\nfor i in range(10):\r\n    x = torch.randn(10, 10, 10, 10) # similar timings regardless of the tensor size\r\n    t1 = datetime.now()\r\n    x.cuda()\r\n    print(i, datetime.now() - t1)\r\n', '\r\n0 0:03:03.546126\r\n1 0:00:00.000111\r\n2 0:00:00.000065\r\n3 0:00:00.000057\r\n4 0:00:00.000052\r\n5 0:00:00.000051\r\n6 0:00:00.000050\r\n7 0:00:00.000047\r\n8 0:00:00.000046\r\n9 0:00:00.000046\r\n']"
298,19160,0,"Suggest model.eval() in torch.no_grad (and vice versa). ## üìö Documentation

  and  are both commonly used in evaluating a model.

[Confusion exists about whether setting  also sets ](https://discuss.pytorch.org/t/does-model-eval-with-torch-set-grad-enabled-is-train-have-the-same-effect-for-grad-history/17183/5?u=ataraxy)

Would you accept a PR which suggests usage of the other, with words like:

* If evaluating a model's performance, using Module.eval() may also be useful.
* If evaluating a model's performance, using autograd.no_grad may also be useful.. []"
19,8818,1,"MPI causing job to hang --- unresponsive to external (termination) signals. ## Issue description
When running  with the MPI backend in a cluster, the job fails to exit and hangs unresponsively --- essentially any node in the cluster that the runs the script becomes unresponsive when you try to terminate the job. This varies from run to run, but it happens often enough that it is problematic.

Here is a minimal reproduction script. High level steps:

1.  initialize multiple DataLoader workers
2. communicate model parameters
3. update model parameters
4. run forward-backward pass

## Code example

For a single machine with  GPUs, run



issues.py:



## System Info

PyTorch (built from source) version: 0.5.0a0+f8c18e0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.4 LTS
GCC version: (Ubuntu 5.5.0-12ubuntu1~16.04) 5.5.0 20171010
CMake version: version 3.11.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration:
GPU[0-8]: V100 (NVIDIA voltas)

Nvidia driver version: 384.81
cuDNN version: cudnn/v7.0-cuda.9.0

Versions of relevant libraries:

openmpi/3.0.0/gcc.5.4.0
NCCL/2.2.12-1-cuda.9.0

[pip] numpy (1.14.3)
[pip] torch (0.5.0a0+f8c18e0)
[pip] torchvision (0.2.1)
[conda] magma-cuda90   2.3.0       1         pytorch
[conda] torch                     0.5.0   <pip>
[conda] torchvision            0.2.1   <pip>

cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @osalpekar @jiayisuse @agolynski @SciPioneer @H-Huang @mrzzd. ['\r\nimport os\r\nimport signal\r\n\r\nimport torch\r\nimport torch.backends.cudnn as cudnn\r\nimport torch.distributed as dist\r\nimport torch.utils.data\r\nimport torch.utils.data.distributed\r\nimport torch.multiprocessing as mp\r\nimport torchvision.datasets as datasets\r\nimport torchvision.models as models\r\nimport torchvision.transforms as transforms\r\n\r\n# path to dataset (REPLACE WITH YOUR OWN LOCAL PATH TO DATASET)\r\nTRAIN_DIRECTORY = \'/datasets/imagenet_full_size/train\'\r\n\r\n\r\ndef main():\r\n\r\n    signal.signal(signal.SIGTERM, SIGTERMHandler)\r\n\r\n    # initialize torch distributed mpi backend\r\n    os.environ[\'MASTER_ADDR\'] = \'localhost\'\r\n    os.environ[\'MASTER_PORT\'] = \'40101\'\r\n    dist.init_process_group(backend=\'mpi\')\r\n\r\n    # run each task on a single GPU\r\n    torch.cuda.set_device(dist.get_rank())\r\n\r\n    # seed for reproducibility\r\n    torch.manual_seed(37)\r\n    torch.cuda.manual_seed(37)\r\n    torch.backends.cudnn.deterministic = True\r\n\r\n    model = models.resnet50()\r\n    model.cuda()\r\n    model.train()\r\n    criterion = torch.nn.CrossEntropyLoss().cuda()\r\n    optimizer = torch.optim.SGD(model.parameters(), lr=0.1, momentum=0.9,\r\n                                weight_decay=0.0001, nesterov=True)\r\n\r\n    cudnn.benchmark = True\r\n\r\n    # initialize a dataloader with 4 worker processes\r\n    loader, sampler = make_dataloader(TRAIN_DIRECTORY)\r\n\r\n    for i, (input, target) in enumerate(loader):\r\n\r\n        print(\'itr {}\'.format(i))\r\n\r\n        input = input.cuda(non_blocking=True)\r\n        target = target.cuda(non_blocking=True)\r\n\r\n        # communicate model parameters\r\n        comm_buffer = _flatten_tensors(list(model.parameters())).detach_()\r\n        send_recieve(comm_buffer)\r\n        comm_buffer = _unflatten_tensors(comm_buffer, list(model.parameters()))\r\n        with torch.no_grad():\r\n            for p, e in zip(model.parameters(), comm_buffer):\r\n                p.data.copy_(e)\r\n\r\n        # forward/backward pass\r\n        output = model(input)\r\n        loss = criterion(output, target)\r\n        optimizer.zero_grad()\r\n        loss.backward()\r\n        optimizer.step()\r\n\r\n        prec1, prec5 = accuracy(output, target, topk=(1, 5))\r\n        print(\'* @Prec1 {prec1:.3f}\\t@Prec5 {prec5:.3f}\'\r\n              .format(prec1=prec1.item(), prec5=prec5.item()))\r\n\r\n\r\ndef send_recieve(buffer):\r\n\r\n    buffer.mul_(0.5)\r\n\r\n    # ring communication\r\n    destination = (dist.get_rank() + 1) % dist.get_world_size()\r\n    source = dist.get_rank() - 1 if dist.get_rank() != 0 else dist.get_world_size() - 1\r\n\r\n    # non-blocking send message\r\n    send_buffer = buffer.clone()\r\n    req = dist.isend(tensor=send_buffer, dst=destination)\r\n    out_msg = (req, send_buffer)  # keep in scope\r\n\r\n    # blocking receive\r\n    receive = buffer.clone()\r\n    dist.recv(receive, src=source)\r\n\r\n    # update buffer\r\n    buffer.add_(receive)\r\n\r\n    # wait for neighbours to receive message\r\n    out_msg[0].wait()\r\n\r\n\r\ndef make_dataloader(train_directory):\r\n"""""" Create distributed dataloader """"""\r\n    normalize = transforms.Normalize(mean=[0.485, 0.456, 0.406],\r\n                                     std=[0.229, 0.224, 0.225])\r\n\r\n    train_dataset = datasets.ImageFolder(train_directory, transforms.Compose([\r\n                        transforms.RandomResizedCrop(224),\r\n                        transforms.RandomHorizontalFlip(),\r\n                        transforms.ToTensor(),\r\n                        normalize]))\r\n\r\n    # sampler produces indices used to assign data samples to each agent\r\n    train_sampler = torch.utils.data.distributed.DistributedSampler(\r\n                        dataset=train_dataset,\r\n                        num_replicas=dist.get_world_size(),\r\n                        rank=dist.get_rank())\r\n\r\n    train_loader = torch.utils.data.DataLoader(\r\n        train_dataset, batch_size=32,\r\n        shuffle=False,\r\n        num_workers=4,\r\n        pin_memory=True, sampler=train_sampler)\r\n\r\n    return train_loader, train_sampler\r\n\r\n\r\ndef accuracy(output, target, topk=(1,)):\r\n    """""" Computes the precision@k for the specified values of k """"""\r\n    with torch.no_grad():\r\n        maxk = max(topk)\r\n        batch_size = target.size(0)\r\n\r\n        _, pred = output.topk(maxk, 1, True, True)\r\n        pred = pred.t()\r\n        correct = pred.eq(target.view(1, -1).expand_as(pred))\r\n\r\n        res = []\r\n        for k in topk:\r\n            correct_k = correct[:k].view(-1).float().sum(0, keepdim=True)\r\n            res.append(correct_k.mul_(100.0 / batch_size))\r\n        return res\r\n\r\n\r\ndef _flatten_tensors(tensors):\r\n    if len(tensors) == 1:\r\n        return tensors[0].view(-1)\r\n    flat = torch.cat([t.view(-1) for t in tensors], dim=0)\r\n    return flat\r\n\r\n\r\ndef _unflatten_tensors(flat, tensors):\r\n    outputs = []\r\n    offset = 0\r\n    for tensor in tensors:\r\n        numel = tensor.numel()\r\n        outputs.append(flat.narrow(0, offset, numel).view_as(tensor))\r\n        offset += numel\r\n    return tuple(outputs)\r\n\r\n\r\ndef SIGTERMHandler(signum, frame):\r\n    """"""\r\n    Ignore SIGTERM preemption signal (doesn\'t stop preemption);\r\n    instead SIGUSR1 will be moved up and handled accordingly\r\n    """"""\r\n    print(\'Received SIGTERM\')\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    mp.set_start_method(\'forkserver\')\r\n    main()\r\n\r\n']"
397,12365,0,"[JIT] mytuple[0], mytuple[i] does not work in JIT. Current, the following code gives an error:

With error message:
. ['python\r\n@torch.jit.script\r\ndef f(x):\r\n    return torch.sort(x)[0]\r\n', '\r\nTraceback (most recent call last):\r\n  File ""quicktest.py"", line 3, in <module>\r\n    @torch.jit.script\r\n  File ""/Users/gaoxiang/anaconda3/lib/python3.6/site-packages/torch/jit/__init__.py"", line 589, in script\r\n    graph = _jit_script_compile(ast, rcb)\r\nRuntimeError: gatherable->type()->isSubtypeOf(DynamicType::get()) ASSERT FAILED at /Users/administrator/nightlies/2018_09_28/wheel_build_dirs/conda_3.6/conda/conda-bld/pytorch-nightly_1538131714608/work/torch/csrc/jit/script/compiler.cpp:1819, please report a bug to PyTorch. (emitBasicGather at /Users/administrator/nightlies/2018_09_28/wheel_build_dirs/conda_3.6/conda/conda-bld/pytorch-nightly_1538131714608/work/torch/csrc/jit/script/compiler.cpp:1819)\r\nframe #0: torch::jit::script::to_ir::emitSimpleExpr(std::__1::shared_ptr<torch::jit::script::Tree> const&) + 2371 (0x10c3e5e53 in libtorch.dylib)\r\nframe #1: torch::jit::script::to_ir::emitSugaredExpr(torch::jit::script::Expr, unsigned long) + 1446 (0x10c3dd326 in libtorch.dylib)\r\nframe #2: torch::jit::script::to_ir::emitExpr(torch::jit::script::Expr) + 69 (0x10c3dddd5 in libtorch.dylib)\r\nframe #3: torch::jit::script::to_ir::getNamedValues(std::__1::vector<std::__1::shared_ptr<torch::jit::script::Tree>, std::__1::allocator<std::__1::shared_ptr<torch::jit::script::Tree> > >, bool) + 1216 (0x10c3e6a40 in libtorch.dylib)\r\nframe #4: torch::jit::script::to_ir::getValues(std::__1::vector<std::__1::shared_ptr<torch::jit::script::Tree>, std::__1::allocator<std::__1::shared_ptr<torch::jit::script::Tree> > >, bool) + 64 (0x10c3eec30 in libtorch.dylib)\r\nframe #5: torch::jit::script::to_ir::getValues(torch::jit::script::List<torch::jit::script::Expr>, bool) + 86 (0x10c3d8156 in libtorch.dylib)\r\nframe #6: torch::jit::script::to_ir::to_ir(torch::jit::script::Def, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, torch::jit::script::Method&, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, torch::jit::script::Method&> > >&, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>, torch::jit::script::Method&) + 2754 (0x10c3d5082 in libtorch.dylib)\r\nframe #7: std::__1::__function::__func<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_5, std::__1::allocator<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_5>, void (torch::jit::script::Method&)>::operator()(torch::jit::script::Method&) + 111 (0x10c3d452f in libtorch.dylib)\r\nframe #8: torch::jit::script::Method::ensure_defined() + 175 (0x10c3f7fbf in libtorch.dylib)\r\nframe #9: torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>) + 2520 (0x10c3bfa28 in libtorch.dylib)\r\nframe #10: torch::jit::script::compileFunction(torch::jit::script::Def, std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> const&) + 620 (0x10c3c405c in libtorch.dylib)\r\nframe #11: void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::name, pybind11::scope, pybind11::sibling>(torch::jit::script::initJitScriptBindings(_object*)::$_21&&, std::__1::shared_ptr<torch::jit::Graph> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::\'lambda\'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) + 408 (0x10937fe58 in _C.cpython-36m-darwin.so)\r\nframe #12: pybind11::cpp_function::dispatcher(_object*, _object*, _object*) + 3308 (0x108fc570c in _C.cpython-36m-darwin.so)\r\n<omitting python frames>\r\nframe #25: start + 1 (0x7fff67c8f085 in libdyld.dylib)\r\n']"
464,3822,0,"Building from source on master is broken. Related to https://github.com/pytorch/pytorch/pull/3817.

When building from source on Ubuntu 16.04, I get the following.


Reverting the offending PR solves the problem.. [""\r\nScanning dependencies of target THD\r\n[  4%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelTCP.cpp.o\r\n[  8%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodEnv.cpp.o\r\n[ 16%] Building CXX object CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o\r\n[ 16%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelMPI.cpp.o\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòat::Tensor thd::DataChannelMPI::_newLikeFlat(std::vector<at::Tensor>&) const‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:157:57: warning: narrowing conversion of ‚Äò((& t)->at::Tensor::is_cuda() ? (& t)->at::Tensor::get_device() : -1l)‚Äô from ‚Äòlong int‚Äô to ‚Äòint‚Äô inside { } [-Wnarrowing]\r\n   AutoGPU gpu_guard { t.is_cuda() ? t.get_device() : -1 };\r\n                                                         ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:158:45: warning: narrowing conversion of ‚Äò(& tensors)->std::vector<_Tp, _Alloc>::size<at::Tensor, std::allocator<at::Tensor> >()‚Äô from ‚Äòstd::vector<at::Tensor>::size_type {aka long unsigned int}‚Äô to ‚Äòlong int‚Äô inside { } [-Wnarrowing]\r\n   std::vector<int64_t> sizes { tensors.size() };  // sizes = [output.size()] + input.sizes()\r\n                                             ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:158:45: warning: narrowing conversion of ‚Äò(& tensors)->std::vector<_Tp, _Alloc>::size<at::Tensor, std::allocator<at::Tensor> >()‚Äô from ‚Äòstd::vector<at::Tensor>::size_type {aka long unsigned int}‚Äô to ‚Äòlong int‚Äô inside { } [-Wnarrowing]\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:160:10: error: ‚Äòinput‚Äô was not declared in this scope\r\n   return input.type().tensor(sizes);\r\n          ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::scatter(std::vector<at::Tensor>&, at::Tensor&, thd::rank_type, THDGroup)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:233:7: error: no match for ‚Äòoperator!‚Äô (operand type is ‚Äòat::Tensor‚Äô)\r\n   if (!output.contiguous())\r\n       ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:233:7: note: candidate is:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:233:7: note: operator!(bool) <built-in>\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:233:7: note:   no known conversion for argument 1 from ‚Äòat::Tensor‚Äô to ‚Äòbool‚Äô\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::reduce(at::Tensor&, THDReduceOp, thd::rank_type, THDGroup)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:281:7: error: no match for ‚Äòoperator!‚Äô (operand type is ‚Äòat::Tensor‚Äô)\r\n   if (!data.contiguous())\r\n       ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:281:7: note: candidate is:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:281:7: note: operator!(bool) <built-in>\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:281:7: note:   no known conversion for argument 1 from ‚Äòat::Tensor‚Äô to ‚Äòbool‚Äô\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::broadcast(at::Tensor&, thd::rank_type, THDGroup)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:299:7: error: no match for ‚Äòoperator!‚Äô (operand type is ‚Äòat::Tensor‚Äô)\r\n   if (!data.contiguous())\r\n       ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:299:7: note: candidate is:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:299:7: note: operator!(bool) <built-in>\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:299:7: note:   no known conversion for argument 1 from ‚Äòat::Tensor‚Äô to ‚Äòbool‚Äô\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::send(thd::Scalar&, thd::rank_type)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:309:56: error: request for member ‚ÄòscalarType‚Äô in ‚Äò(& data)->thd::Scalar::type()‚Äô, which is of non-class type ‚Äòthd::RPCType‚Äô\r\n   MPI_Send(data.data(), 1, mpi_datatype.at(data.type().scalarType()),\r\n                                                        ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::receive(thd::Scalar&, thd::rank_type)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:324:17: error: ‚Äòstruct thd::Scalar‚Äô has no member named ‚Äòdata_ptr‚Äô\r\n   MPI_Recv(data.data_ptr(), 1, mpi_datatype.at(data.type().scalarType()),\r\n                 ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:324:60: error: request for member ‚ÄòscalarType‚Äô in ‚Äò(& data)->thd::Scalar::type()‚Äô, which is of non-class type ‚Äòthd::RPCType‚Äô\r\n   MPI_Recv(data.data_ptr(), 1, mpi_datatype.at(data.type().scalarType()),\r\n                                                            ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual void thd::DataChannelMPI::receive(at::Tensor&, thd::rank_type)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:346:10: error: ‚Äòstatus‚Äô was not declared in this scope\r\n   return status.MPI_SOURCE;\r\n          ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:346:17: error: return-statement with a value, in function returning 'void' [-fpermissive]\r\n   return status.MPI_SOURCE;\r\n                 ^\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp: In member function ‚Äòvirtual thd::DataChannelMPI::RequestMPI* thd::DataChannelMPI::ireceive(at::Tensor&, thd::rank_type)‚Äô:\r\n/home/michael/pytorch/torch/lib/THD/base/data_channels/DataChannelMPI.cpp:384:10: error: cannot convert ‚Äòstd::unique_ptr<thd::DataChannelMPI::RequestMPI>‚Äô to ‚Äòthd::DataChannelMPI::RequestMPI*‚Äô in return\r\n   return request;\r\n          ^\r\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodUtils.cpp.o\r\n[ 24%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodFile.cpp.o\r\nCMakeFiles/THD.dir/build.make:62: recipe for target 'CMakeFiles/THD.dir/base/data_channels/DataChannelMPI.cpp.o' failed\r\nmake[2]: *** [CMakeFiles/THD.dir/base/data_channels/DataChannelMPI.cpp.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/THD.dir/all' failed\r\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\r\nMakefile:127: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\n""]"
146,31560,0,"What should I do if my model has multiple inputs and multiple outputs?. Here are the functions to export the model using onnx:
torch.onnx.export(model, dummy_input, ""alexnet.onnx"", verbose=True, input_names=input_names,
output_names=output_names)
What should I do if my model has multiple inputs and multiple outputs? How can I export a model?
My model interface is roughly as follows:
 model = YOLO_SEGONE()
 model_initial(model, model_name)
 if is_cuda == True:
        model.cuda()
 model.eval()
 mask_out1Ôºåmask_out2 = model.seg_sub_net3D(conv9_roiA, conv7_roiA, conv5_roiA, conv3_roiA)
        . []"
10,11333,1,"MultivariateNormal and potrf is slow on gpu and seems to have some memory leak. ## Issue description

When I initialize a [MultivariateNormal](https://github.com/pytorch/pytorch/blob/bb7d1837bc164b06e1d0826a20a8f7e8338a44e3/torch/distributions/multivariate_normal.py#L76) object with a covariance matrix provided with batch dimension too, it is very slow on GPU, and it is always slower on GPU then on CPU. 
It even seems to leak the memory with or without the batch dimension and both on CPU and GPU, but with different intensity (check n parameter in code example).
One more strange thing: It uses more CPU RAM when running on GPU.

Digging a bit deeper, I experienced the same with the Tensor's potrf function, so probably this is the root cause.

## Code example


## Outputs

Testing MultivariateNormal









Testing potrf









## System Info
Collecting environment information...
PyTorch version: 0.5.0a0+e9ad743
Is debug build: No
CUDA used to build PyTorch: 9.2.88

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-16ubuntu3) 7.3.0
CMake version: version 3.12.0

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.2.148
GPU models and configuration: 
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti
GPU 2: GeForce GTX 1080 Ti

Nvidia driver version: 396.54
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.2.1
/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a

Versions of relevant libraries:
[pip] Could not collect
[conda] magma-cuda91              2.3.0                         1    pytorch
[conda] torch                     0.5.0a0+e9ad743           <pip>
[conda] torchfile                 0.1.0                     <pip>
[conda] torchnet                  0.0.4                     <pip>
[conda] torchvision               0.2.1                     <pip>

Pytorch is used in docker container
pip version:
pip 18.0 from /opt/conda/lib/python3.6/site-packages/pip (python 3.6)
. ['\r\nimport resource\r\nimport torch\r\nfrom torch.distributions.multivariate_normal import MultivariateNormal\r\nimport gc\r\nimport time\r\n\r\ndef gpu(item, use_GPU=True):\r\n    if use_GPU:\r\n        return item.cuda()\r\n    else:\r\n        return item\r\n\r\ndef test_multivariate(loc_mat, cov_mat):\r\n    standard_normal_dist = MultivariateNormal(loc=loc_mat,\r\n                                              covariance_matrix=cov_mat)\r\n\r\ndef test_potrf(loc_mat, cov_mat):\r\n    n = cov_mat.size(-1)\r\n    [m.potrf(upper=False) for m in cov_mat.reshape(-1, n, n)]\r\n\r\ndef loop(fn_ref, n=10, size=10000, use_GPU=True, covariance_with_batch_dim=True, print_n=1):\r\n    cov_mat = gpu(torch.zeros((2, 2)) + torch.eye(2), use_GPU)\r\n    if covariance_with_batch_dim:\r\n        cov_mat = cov_mat.unsqueeze(0).repeat(size, 1, 1)\r\n    loc_mat = gpu(torch.zeros((size, 2)), use_GPU)\r\n\r\n    for i in range(n):\r\n        gc.collect()\r\n        fn_ref(loc_mat, cov_mat)\r\n        if i % print_n == 0:\r\n            print(resource.getrusage(resource.RUSAGE_SELF).ru_maxrss)\r\n\r\n\r\nif __name__ == \'__main__\':\r\n\r\n    n = 10\r\n    fn_ref = test_multivariate\r\n    use_GPU = True\r\n    covariance_with_batch_dim = True\r\n    print_n = n / 10\r\n\r\n    print(""test_fn: "", fn_ref.__name__)\r\n    print(""n: "", n)\r\n    print(""use_GPU: "", use_GPU)\r\n    print(""covariance_with_batch_dim: "", covariance_with_batch_dim, ""\\n"")\r\n\r\n    start = time.time()\r\n\r\n    loop(fn_ref=fn_ref, use_GPU=use_GPU, covariance_with_batch_dim=covariance_with_batch_dim, n=n, print_n=print_n)\r\n\r\n    print(""\\ntime: "", (time.time() - start) / n)\r\n', '\r\ntest_fn:  test_multivariate\r\nn:  5\r\nuse_GPU:  False\r\ncovariance_with_batch_dim:  True \r\n\r\n118808\r\n119200\r\n119552\r\n119908\r\n120268\r\n\r\ntime:  0.08764233589172363\r\n', '\r\ntest_fn:  test_multivariate\r\nn:  5\r\nuse_GPU:  True\r\ncovariance_with_batch_dim:  True \r\n\r\n1477808\r\n1479680\r\n1479996\r\n1480312\r\n1480684\r\n\r\ntime:  27.707138347625733\r\n', '\r\ntest_fn:  test_multivariate\r\nn:  5000\r\nuse_GPU:  False\r\ncovariance_with_batch_dim:  False \r\n\r\n107904\r\n107904\r\n109436\r\n109436\r\n109700\r\n\r\ntime:  0.008288921689987183\r\n', '\r\ntest_fn:  test_multivariate\r\nn:  50\r\nuse_GPU:  True\r\ncovariance_with_batch_dim:  False \r\n\r\n1467364\r\n1468676\r\n1468676\r\n1468680\r\n1468680\r\n\r\ntime:  0.037353959083557126\r\n', '\r\ntest_fn:  test_potrf\r\nn:  5\r\nuse_GPU:  False\r\ncovariance_with_batch_dim:  True \r\n\r\n116984\r\n117300\r\n117672\r\n118032\r\n118380\r\n\r\ntime:  0.06480374336242675\r\n', '\r\ntest_fn:  test_potrf\r\nn:  5\r\nuse_GPU:  True\r\ncovariance_with_batch_dim:  True \r\n\r\n1476688\r\n1477008\r\n1477320\r\n1477916\r\n1478168\r\n\r\ntime:  26.757283926010132\r\n', '\r\ntest_fn:  test_potrf\r\nn:  50000\r\nuse_GPU:  False\r\ncovariance_with_batch_dim:  False \r\n\r\n108420\r\n109720\r\n109984\r\n110248\r\n110512\r\n\r\ntime:  0.008067794122695923\r\n', '\r\ntest_fn:  test_potrf\r\nn:  5\r\nuse_GPU:  True\r\ncovariance_with_batch_dim:  False \r\n\r\n1468760\r\n1469664\r\n1469680\r\n1469680\r\n1469680\r\n\r\ntime:  0.2711141109466553\r\n']"
546,27123,0,"RuntimeError: CUDA error: device-side assert triggered. Hello, I implemented DNC codes with PyTorch Version 1.2.
but I got runtime errors when I trained my DNC model. 
I attach a file which contains error messages, because it is too long to write here. 
----------------------
I solve this problem.

. []"
577,4053,0,"grad_fn() crashed in pytorch 0.3.0. @soumith 
Environment:
unbuntu 16.04+torch-0.3.0.post4-cp35-cp35m-linux_x86_64.whl (from pytorch.org)
windows 10 + pytorch(master) compiled with msvc


According to internal logicÔºåit should be a failure but not a crash. when I tested the code  in pytorch (0.2.0), it did not crash.. ['python\r\nimport torch\r\nfrom torch.autograd import Variable\r\nx = Variable(torch.ones(2, 2), requires_grad=True)\r\ny = x + 2\r\n#print(x.grad_fn()) #succeed to catch errors\r\nprint(y.grad_fn()) # crashed here!\r\n']"
178,7721,0,"Error compiling from source (OS X 10.12, CUDA 9.0, CUDNN 7.0.4). Installed clean OS 10.12.6 on MacBook Pro late 2013 with GT 750M video card. Been trying to get this to work for weeks, tried every tip I can find. Following error message:

running install
running build_deps
+ WITH_CUDA=0
+ [[ --with-cuda == \-\-\w\i\t\h\-\c\u\d\a ]]
+ WITH_CUDA=1
+ shift
+ WITH_ROCM=0
+ [[ --with-nnpack == \-\-\w\i\t\h\-\r\o\c\m ]]
+ WITH_NNPACK=0
+ [[ --with-nnpack == \-\-\w\i\t\h\-\n\n\p\a\c\k ]]
+ WITH_NNPACK=1
+ shift
+ WITH_MKLDNN=0
+ [[ ATen == \-\-\w\i\t\h\-\m\k\l\d\n\n ]]
+ WITH_GLOO_IBVERBS=0
+ [[ ATen == \-\-\w\i\t\h\-\g\l\o\o\-\i\b\v\e\r\b\s ]]
+ WITH_DISTRIBUTED_MW=0
+ [[ ATen == \-\-\w\i\t\h\-\d\i\s\t\r\i\b\u\t\e\d\-\m\w ]]
+ CMAKE_INSTALL='make install'
+ USER_CFLAGS=
+ USER_LDFLAGS=
+ [[ -n '' ]]
+ [[ -n '' ]]
+ [[ -n '' ]]
++ dirname tools/build_pytorch_libs.sh
+ cd tools/..
+++ pwd
++ printf '%q\n' /Users/hsr/pytorch
+ PWD=/Users/hsr/pytorch
+ BASE_DIR=/Users/hsr/pytorch
+ TORCH_LIB_DIR=/Users/hsr/pytorch/torch/lib
+ INSTALL_DIR=/Users/hsr/pytorch/torch/lib/tmp_install
+ THIRD_PARTY_DIR=/Users/hsr/pytorch/third_party
+ CMAKE_VERSION=cmake
+ C_FLAGS=' -DTH_INDEX_BASE=0 -I""/Users/hsr/pytorch/torch/lib/tmp_install/include""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/TH"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THC""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THS"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCS""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THNN"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCUNN""'
+ C_FLAGS=' -DTH_INDEX_BASE=0 -I""/Users/hsr/pytorch/torch/lib/tmp_install/include""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/TH"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THC""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THS"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCS""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THNN"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCUNN"" -DOMPI_SKIP_MPICXX=1'
+ LDFLAGS='-L""/Users/hsr/pytorch/torch/lib/tmp_install/lib"" '
+ LD_POSTFIX=.so.1
+ LD_POSTFIX_UNVERSIONED=.so
++ uname
+ [[ Darwin == \D\a\r\w\i\n ]]
+ LDFLAGS='-L""/Users/hsr/pytorch/torch/lib/tmp_install/lib""  -Wl,-rpath,@loader_path'
+ LD_POSTFIX=.1.dylib
+ LD_POSTFIX_UNVERSIONED=.dylib
+ CPP_FLAGS=' -std=c++11 '
+ GLOO_FLAGS=
+ THD_FLAGS=
+ NCCL_ROOT_DIR=/Users/hsr/pytorch/torch/lib/tmp_install
+ [[ 1 -eq 1 ]]
+ GLOO_FLAGS='-DUSE_CUDA=1 -DNCCL_ROOT_DIR=/Users/hsr/pytorch/torch/lib/tmp_install'
+ [[ 0 -eq 1 ]]
+ [[ 0 -eq 1 ]]
+ CWRAP_FILES='/Users/hsr/pytorch/torch/lib/ATen/Declarations.cwrap;/Users/hsr/pytorch/torch/lib/THNN/generic/THNN.h;/Users/hsr/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/Users/hsr/pytorch/torch/lib/ATen/nn.yaml'
+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0 -I""/Users/hsr/pytorch/torch/lib/tmp_install/include""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/TH"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THC""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THS"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCS""   -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THNN"" -I""/Users/hsr/pytorch/torch/lib/tmp_install/include/THCUNN"" -DOMPI_SKIP_MPICXX=1'
+ [[ '' -eq 1 ]]
+ '[' -z 8 ']'
+ BUILD_TYPE=Release
+ [[ -n '' ]]
+ [[ -n '' ]]
+ echo 'Building in Release mode'
Building in Release mode
+ mkdir -p torch/lib/tmp_install
+ for arg in '""$@""'
+ [[ ATen == \n\c\c\l ]]
+ [[ ATen == \g\l\o\o ]]
+ [[ ATen == \A\T\e\n ]]
+ pushd /Users/hsr/pytorch/aten
~/pytorch/aten ~/pytorch
+ build_aten
+ mkdir -p build
+ pushd build
~/pytorch/aten/build ~/pytorch/aten ~/pytorch
+ cmake .. -DCMAKE_BUILD_TYPE=Release -DNO_CUDA=0 -DNO_NNPACK=0 -DCUDNN_INCLUDE_DIR=/usr/local/cuda/include -DCUDNN_LIB_DIR=/usr/local/cuda/lib -DCUDNN_LIBRARY=/usr/local/cuda/lib/libcudnn.7.dylib -DNO_MKLDNN=1 -DMKLDNN_INCLUDE_DIR= -DMKLDNN_LIB_DIR= -DMKLDNN_LIBRARY= -DATEN_NO_CONTRIB=1 -DCMAKE_INSTALL_PREFIX=/Users/hsr/pytorch/torch/lib/tmp_install -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_C_FLAGS= -DCMAKE_CXX_FLAGS= -DCMAKE_EXE_LINKER_FLAGS= -DCMAKE_SHARED_LINKER_FLAGS= -DWITH_ROCM=0
-- Autodetected CUDA architecture(s): 3.0 
-- Found CUDA with FP16 support, compiling with torch.CudaHalfTensor
-- Removing -DNDEBUG from compile flags
-- MAGMA not found. Compiling without MAGMA support
-- Could not find hardware support for NEON on this machine.
-- No OMAP3 processor on this machine.
-- No OMAP4 processor on this machine.
-- SSE2 Found
-- SSE3 Found
-- AVX Found
-- AVX2 Found
-- Atomics: using GCC intrinsics
-- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m]
--   Library mkl_intel_lp64: /Users/hsr/anaconda3/envs/kate/lib/libmkl_intel_lp64.dylib
--   Library mkl_intel_thread: /Users/hsr/anaconda3/envs/kate/lib/libmkl_intel_thread.dylib
--   Library mkl_core: /Users/hsr/anaconda3/envs/kate/lib/libmkl_core.dylib
--   Library iomp5: /Users/hsr/anaconda3/envs/kate/lib/libiomp5.dylib
--   Library pthread: /usr/lib/libpthread.dylib
--   Library m: /usr/lib/libm.dylib
-- MKL library found
-- Found a library with BLAS API (mkl).
-- Found a library with LAPACK API. (mkl)
-- Found cuDNN: v7.0.4  (include: /usr/local/cuda/include, library: /usr/local/cuda/lib/libcudnn.7.dylib)
disabling MKLDNN because NO_MKLDNN is set
CMake Deprecation Warning at src/ATen/CMakeLists.txt:25 (CMAKE_POLICY):
  The OLD behavior for policy CMP0026 will be removed from a future version
  of CMake.

  The cmake-policies(7) manual explains that the OLD behaviors of all
  policies are deprecated and that a policy should be set to OLD only under
  specific short-term circumstances.  Projects should be ported to the NEW
  behavior and not rely on setting a policy to OLD.


-- Using python found in /Users/hsr/anaconda3/envs/kate/bin/python
-- TBB: using libc++.
-- Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES) 
-- Could NOT find OpenMP_CXX (missing: OpenMP_CXX_FLAGS OpenMP_CXX_LIB_NAMES) 
-- Could NOT find OpenMP (missing: OpenMP_C_FOUND OpenMP_CXX_FOUND) 
-- Configuring build for SLEEF-v3.2
   Target system: Darwin-16.7.0
   Target processor: x86_64
   Host system: Darwin-16.7.0
   Host processor: x86_64
   Detected C compiler: AppleClang @ /Library/Developer/CommandLineTools/usr/bin/clang
-- Using option  to compile libsleef
-- Building shared libs : OFF
-- MPFR : LIB_MPFR-NOTFOUND
-- GMP : LIBGMP-NOTFOUND
-- RUNNING_ON_TRAVIS : 0
-- COMPILER_SUPPORTS_OPENMP : 
disable contrib because ATEN_NO_CONTRIB is set
-- Configuring done
-- Generating done
-- Build files have been written to: /Users/hsr/pytorch/aten/build
+ make install -j8
[  0%] Built target mkdisp
[  0%] Built target common
[  2%] Built target mkalias
[  2%] Built target mkrename
[  6%] Built target cpuinfo
[  6%] Built target cuda_aten_files_are_generated
[  6%] Built target aten_files_are_generated
Scanning dependencies of target tbb_static
[  6%] Built target mkmasked_gnuabi
[  6%] Built target arraymap
[  6%] Built target mkrename_gnuabi
[  6%] Built target renamedsp256.h_generated
[  7%] Built target dispavx.c_generated
[  8%] Built target headers
[  9%] Built target renameSSE2.h_generated
[  9%] Built target renameAVX.h_generated
[  9%] Built target renameFMA4.h_generated
[  9%] Built target renameSSE4.h_generated
[  9%] Built target renameAVX2.h_generated
[ 10%] Built target dispsse.c_generated
[ 10%] Built target renameAVX2128.h_generated
[ 10%] Built target renamedsp128.h_generated
Scanning dependencies of target sleefavx2
Scanning dependencies of target sleefavx2128
[ 11%] Built target sleefsse2
[ 11%] Built target dispavx_obj
[ 11%] Built target sleefavx
[ 11%] Built target sleeffma4
[ 11%] Built target sleefsse4
[ 11%] Building C object sleef/src/libm/CMakeFiles/sleefavx2.dir/sleefsimdsp.c.o
[ 11%] Building C object sleef/src/libm/CMakeFiles/sleefavx2.dir/sleefsimddp.c.o
Scanning dependencies of target dispsse_obj
[ 11%] Building C object sleef/src/libm/CMakeFiles/sleefavx2128.dir/sleefsimdsp.c.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/sleefavx2128.dir/sleefsimddp.c.o
[ 12%] Building C object sleef/src/libm/CMakeFiles/dispsse_obj.dir/dispsse.c.o
[ 12%] Building CXX object src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp.o
[ 12%] Building CXX object src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp.o
[ 13%] Building CXX object src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/condition_variable.cpp.o
In file included from /Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp:23:
In file included from /Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:26:
/Users/hsr/pytorch/third_party/tbb/src/tbb/mailbox.h:102:52: error: unknown type
      name 'isolation_tag'
    task_proxy* internal_pop( __TBB_ISOLATION_EXPR(isolation_tag isolation) ) {
                                                   ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/mailbox.h:108:27: error: use of
      undeclared identifier 'no_isolation'; did you mean 'isolation'?
        if ( isolation != no_isolation ) {
                          ^~~~~~~~~~~~
                          isolation
/Users/hsr/pytorch/third_party/tbb/src/tbb/mailbox.h:102:66: note: 'isolation'
      declared here
    task_proxy* internal_pop( __TBB_ISOLATION_EXPR(isolation_tag isolation) ) {
                                                                 ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/mailbox.h:109:36: error: no member
      named 'isolation' in 'tbb::internal::task_prefix'
            while ( curr->prefix().isolation != isolation ) {
                    ~~~~~~~~~~~~~~ ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/mailbox.h:206:44: error: unknown type
      name 'isolation_tag'
    task_proxy* pop( __TBB_ISOLATION_EXPR( isolation_tag isolation ) ) {
                                           ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:123:9: error: 
      use of undeclared identifier 'enforce_segment_allocated'
        enforce_segment_allocated(s.load<relaxed>()); //it's hard to rec...
        ^
In file included from /Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp:23:
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:237:43: error: unknown
      type name 'isolation_tag'
    task* get_task( __TBB_ISOLATION_EXPR( isolation_tag isolation ) );
                                          ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:188:13: error: 
      use of undeclared identifier 'enforce_segment_allocated'
            enforce_segment_allocated(s.load<relaxed>());
            ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:246:31: error: unknown
      type name 'isolation_tag'
    task* get_task( size_t T, isolation_tag isolation, bool& tasks_omitted );
                              ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:257:51: error: unknown
      type name 'isolation_tag'
    task* get_mailbox_task( __TBB_ISOLATION_EXPR( isolation_tag isolation ) );
                                                  ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:265:75: error: unknown
      type name 'isolation_tag'
  ...steal_task( __TBB_ISOLATION_ARG( arena_slot& victim_arena_slot, isolatio...
                                                                     ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:273:9: error: 
      use of undeclared identifier 'enforce_segment_allocated'
        enforce_segment_allocated(array0); // initial segment should be ...
        ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:366:115: error: unknown
      type name 'isolation_tag'
  ...__TBB_atomic reference_count& completion_ref_count, isolation_tag isolat...
                                                         ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:424:47: error: unknown
      type name 'isolation_tag'
    task* reload_tasks( __TBB_ISOLATION_EXPR( isolation_tag isolation ) );
                                              ^
[ 13%] Building CXX object src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/critical_section.cpp.o
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:426:127: error: unknown
      type name 'isolation_tag'
  ...__TBB_ISOLATION_ARG( intptr_t top_priority, isolation_tag isolation ) );
                                                 ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:391:9: error: 
      use of undeclared identifier 'enforce_segment_allocated'
        enforce_segment_allocated(my_segment[k].load<relaxed>()); //if v...
        ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:430:52: error: unknown
      type name 'isolation_tag'
    task* winnow_task_pool ( __TBB_ISOLATION_EXPR( isolation_tag isolation ) );
                                                   ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/scheduler.h:434:88: error: unknown
      type name 'isolation_tag'
  ...size_t H0 , __TBB_ISOLATION_ARG( size_t T0, isolation_tag isolation ) );
                                                 ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:409:13: error: 
      use of undeclared identifier 'enforce_segment_allocated'
            enforce_segment_allocated(my_segment[k].load<relaxed>());
            ^
/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp:466:9: error: 
      use of undeclared identifier 'enforce_segment_allocated'
        enforce_segment_allocated(my_segment[i].load<relaxed>());
        ^
6 errors generated.
make[2]: *** [src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/concurrent_vector.cpp.o] Error 1
make[2]: *** Waiting for unfinished jobs....
In file included from /Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp:28:
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:25:2: error: 
      Do not #include this internal file directly; use public TBB headers
      instead.
#error Do not #include this internal file directly; use public TBB heade...
 ^
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:102:31: error: 
      use of undeclared identifier 'continue_msg'
    class function_body_leaf< continue_msg, continue_msg, B> : public fu...
                              ^
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:125:38: error: 
      use of undeclared identifier 'continue_msg'
    class function_body_leaf< Input, continue_msg, B> : public function_...
                                     ^
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:148:31: error: 
      use of undeclared identifier 'continue_msg'
    class function_body_leaf< continue_msg, Output, B > : public functio...
                              ^
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:208:40: error: 
      unknown class name 'task'; did you mean 'tbb::task'?
    class forward_task_bypass : public task {
                                       ^~~~
                                       tbb::task
/Users/hsr/anaconda3/envs/kate/include/tbb/task.h:542:7: note: 'tbb::task'
      declared here
class task: __TBB_TASK_BASE_ACCESS interface5::internal::task_base {
      ^
In file included from /Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp:28:
/Users/hsr/anaconda3/envs/kate/include/tbb/internal/_flow_graph_impl.h:218:29: error: 
      use of undeclared identifier 'SUCCESSFULLY_ENQUEUED'
            if (new_task == SUCCESSFULLY_ENQUEUED) new_task = NULL;
                            ^
fatal error: too many errors emitted, stopping now [-ferror-limit=]
[ 13%] Built target sleefavx2128
[ 14%] Built target sleefavx2
20 errors generated.
make[2]: *** [src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/Users/hsr/pytorch/third_party/tbb/src/tbb/arena.cpp.o] Error 1
[ 14%] Built target dispsse_obj
Scanning dependencies of target sleef
[ 15%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefdp.c.o
[ 15%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefsp.c.o
[ 15%] Building C object sleef/src/libm/CMakeFiles/sleef.dir/sleefld.c.o
make[1]: *** [src/ATen/cpu/tbb/CMakeFiles/tbb_static.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
[ 15%] Linking C static library ../../lib/libsleef.a
[ 15%] Built target sleef
make: *** [all] Error 2

Any help appreciated, thanks for your time. . []"
269,12855,0,"Model with Caffe2 runs much slower than it with pytorch in GPU mode !!!!. Firstly, I run my model(CRNN model) on Pytorch GPU. With code:

**Result:  cost time: 0.002339872884750366**

Secondly, I convert my pytorch model to onnx and then convert onnx to pb in caffe2. With code:


and 


Thirdly,I run model in Caffe2 on GPU.  With code:

**Run time per RunNet: 0.005980247449874878**

**But, the speed is slower than that in Pytorch !  How weird!** 

Any one konws what happens!
. [""\r\ndirectory = os.path.dirname(os.path.realpath(__file__))\r\nmodel_file = os.path.join(directory, './pth/netCRNN_epoch17_idx78105_step2733675.pth')\r\nkeys = new_key.KEY_4498\r\nmodel = Resnet18(False, num_classes=len(keys) + 2)\r\n\r\nstate_dict = torch.load(model_file)\r\nmodel.load_state_dict(state_dict)\r\nmodel.cuda()\r\nmodel.train(False)\r\n\r\nbegin = time.time()\r\ntol_time = 0\r\nfor i in range(5000):\r\n    x = torch.randn(1, 3, 32, 512, requires_grad=False).cuda()\r\n    begin = time.time()\r\n    out = model(x)\r\n    end = time.time()\r\n    tol_time += (end - begin)\r\n\r\nprint('cost time:', tol_time / 5000)\r\n"", '\r\ndirectory = os.path.dirname(os.path.realpath(__file__))\r\nmodel_file = os.path.join(directory, \'./pth/netCRNN_epoch17_idx78105_step2733675.pth\')\r\nkeys = new_key.KEY_4498\r\nmodel = Resnet18(False, num_classes=len(keys) + 2)\r\n\r\nstate_dict = torch.load(model_file)\r\nmodel.load_state_dict(state_dict)\r\nmodel.cuda()\r\nmodel.train(False)\r\n\r\nx = torch.randn(1, 3, 32, 512, requires_grad=False).cuda()\r\n\r\n# Export the model\r\ntorch_out = torch.onnx._export(model,  # model being run\r\n                               x,  # model input (or a tuple for multiple inputs)\r\n                               ""ocr_api.onnx"",  # where to save the model (can be a file or file-like object)\r\n                               export_params=True)\r\n', '\r\nconvert-onnx-to-caffe2 ocr_api.onnx --output predict_net.pb --init-net-output init_net.pb\r\n', ""\r\nworkspace.ResetWorkspace()\r\ndevice_opts = core.DeviceOption(caffe2_pb2.CUDA, 0)\r\n\r\ninput_data = np.random.rand(1, 3, 32, 128).astype(np.float32)  # NCHW\r\n\r\ninit_def = caffe2_pb2.NetDef()\r\nwith open('init_net.pb', 'rb') as f:\r\n    init_def.ParseFromString(f.read())\r\n    init_def.device_option.CopyFrom(device_opts)\r\n    workspace.RunNetOnce(init_def)\r\n    # workspace.RunNetOnce(init_def.SerializeToString())\r\n\r\nnet_def = caffe2_pb2.NetDef()\r\nwith open('predict_net.pb', 'rb') as f:\r\n    net_def.ParseFromString(f.read())\r\n    net_def.device_option.CopyFrom(device_opts)\r\n\r\n    input_name = net_def.external_input[0]\r\n    workspace.FeedBlob(input_name, input_data,device_opts)\r\n    workspace.CreateNet(net_def)\r\n    # workspace.CreateNet(net_def.SerializeToString())\r\n\r\nname = net_def.name\r\noutput_name = net_def.external_output[-1]\r\ninput_name = net_def.external_input[0]\r\nprint(name, input_name, output_name)\r\n\r\nnum_iters = 5000\r\n\r\ntol_time = 0\r\nfor i in range(num_iters):\r\n    input_data = np.random.rand(1, 3, 32, 512).astype(np.float32)  # NCHW\r\n    start = time.time()\r\n    workspace.FeedBlob(input_name, input_data,device_opts)\r\n    workspace.RunNet(name, 1)\r\n    results = workspace.FetchBlob(output_name)\r\n    end = time.time()\r\n    tol_time += (end - start)\r\n\r\nprint('Run time per RunNet: {}'.format(tol_time / num_iters))\r\n""]"
297,8430,0,"batchnorm2d  track_running_stats. when I load a pretrained model, Runtime error occurred:  Missing key(s) in state_dict: bn.num_batches_tracked in every BatchNorm2d layer. []"
279,4689,0,"switch CUDA svd and qr to using cuSolver. Currently we use MAGMA for these solvers, which uses a mix of CPU and GPU. Wonder if cuSolver will be faster, and we can avoid the CPU path entirely.

cc: @ngimel just want to confirm, cuSolver (dense) wont use the CPU right?

cc @ngimel @vincentqb @vishwakftw @SsnL @jianyuh. []"
303,18434,0,"improve jit error message for legacy constructor. Reported by @jph00

> new_tensor is a legacy constructor and is not supported in the JIT

It'd be helpful to know in the error message what the non-legacy alternative is.. []"
183,23466,0,"import failure (macOS). ## üêõ Bug
I was using pytorch without any issue, but I just found out today that when importing torch, it threw me an error. Possibly regarding MKL library. I could not figure out why.

## To Reproduce

Steps to reproduce the behavior:

1. 
1.
1.
Below are the error message:


## Expected behavior

Clearly, it should not be happening.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:



 - PyTorch Version (e.g., 1.0): 1.1.0 (although not shown above, this is the version I installed from conda)
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

I have no idea what happened but probably because I was using julia and trying to install ubuntu on my Mac. Maybe somehow I messed up with my environment?
. ['\r\nPython 3.7.3 | packaged by conda-forge | (default, Mar 27 2019, 15:43:19) \r\n[Clang 4.0.1 (tags/RELEASE_401/final)] :: Anaconda, Inc. on darwin\r\nType ""help"", ""copyright"", ""credits"" or ""license"" for more information.\r\n>>> import torch\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/anaconda3/lib/python3.7/site-packages/torch/__init__.py"", line 79, in <module>\r\n    from torch._C import *\r\nImportError: dlopen(/anaconda3/lib/python3.7/site-packages/torch/_C.cpython-37m-darwin.so, 9): Symbol not found: _mkl_serv_inspector_loaded\r\n  Referenced from: /anaconda3/lib/python3.7/site-packages/torch/lib/../../../../libmkl_intel_thread.dylib\r\n  Expected in: flat namespace\r\n in /anaconda3/lib/python3.7/site-packages/torch/lib/../../../../libmkl_intel_thread.dylib\r\n>>> \r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n', '\r\nCollecting environment information...\r\nPyTorch version: N/A\r\nIs debug build: N/A\r\nCUDA used to build PyTorch: N/A\r\n\r\nOS: Mac OSX 10.14.5\r\nGCC version: Could not collect\r\nCMake version: version 3.14.5\r\n\r\nPython version: 3.7\r\nIs CUDA available: N/A\r\nCUDA runtime version: Could not collect\r\nGPU models and configuration: Could not collect\r\nNvidia driver version: Could not collect\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.15.4\r\n[conda] mkl                       2019.4                      233  \r\n[conda] pytorch                   1.1.0                   py3.7_0    pytorch\r\n[conda] torchvision               0.3.0             py37_cuNone_1    pytorch\r\n']"
365,3025,0,"Function request: np.isin. I believe that should be useful to have a function similar to https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.in1d.html, that compares a tensor element-wise with a list of possible values. (I'm using it to filter labels/classes in some classifiers).

Expected behavior:



Now it's possible to implement it by iterating over the filter, and storing the results in a tensor with the OR operator. But a faster implementation is possible with TH/THC

My current implementation:

(N, S)(S)batch X samplessamples

cc @mruberry @rgommers @heitorschueroff. ['\r\n>>> a = torch.LongTensor([[1,2,3],[1,1,2],[3,5,1]])\r\n>>> a\r\n 1  2  3\r\n 1  1  2\r\n 3  5  1\r\n[torch.LongTensor of size 3x3]\r\n>>> a.in(torch.LongTensor([1, 2, 5]))\r\n 1 1 0\r\n 1 1 1\r\n 0 1 1\r\n']"
168,21249,0,"The code is incomplete and the data set is missing.  Hello, have you ever encountered the pytorch official website fine-tuning Maskrcnn, less code, and the data set mask in pedestrian detection is all blackÔºåIn references/detection/, we have a number of helper functions to simplify training and evaluating detection models. Here, we will use references/detection/engine.py, references/detection/utils.py and references/detection/transforms.py. Just copy them to your folder and use them here.there is less code. []"
465,19742,0,"Serialization of tensors with pickle.dumps seems to be inconsistent, leading to inconsistent redis cache hit/miss. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

Scenario: 

Redis cache set up 
call set pickle.dumps(tensor) some_value
call get pickle.dumps(tensor)
call get pickle.dumps(tensor) (different call)

hit on call 1,
potential miss on call 2 

These inconsistent hits/misses occur over O(1000) calls to the the same tensors in objects repeated ~9 times


## To Reproduce

Steps to reproduce the behavior: (skeleton)
0. import redis
0. import time
0. value = torch.tensor(...) 
0. start = time.time()
1. redis_cache = redis.StrictRedis(host=""localhost"", port=6379, db=0)  # redis_cache
2. redis_cache.set(pickle.dumps(value), pickle.dumps((hidden, cell)))
3. cache_return = redis_cache.get(pickle.dumps(value))
            if cache_return is not None:
                logger.info(""Cache hit for {} took {} ms"".format(value, time.time()-start))
                return pickle.loads(cache_return)
4. cache_return = redis_cache.get(pickle.dumps(value))
            if cache_return is not None:
                logger.info(""Cache hit for {} took {} ms"".format(value, time.time()-start))
                return pickle.loads(cache_return)

(Cache miss logging would happen after .set() is called)

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

Example Log

2019-04-25 14:04:00,344 ID_1 [INFO] cache_encoder: Cache hit for tensor([[ 2, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,  3]]) took 0.00019598007202148438 ms
2019-04-25 14:04:00,347 ID_1 [INFO] cache_encoder: Cache miss for tensor([[ 2, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,  3]]) took 0.001859426498413086 ms

The weird thing is the hit happened before the miss, so it looks like something is unreliable with the serialisation

2019-04-25 14:04:00,303 ID_1 [INFO] cache_encoder: Cache hit for tensor([[ 2, 12,  3]]) took 0.0001957416534423828 ms
2019-04-25 14:04:00,312 ID_1 [INFO] cache_encoder: Cache miss for tensor([[ 2, 12,  3]]) took 0.0018868446350097656 ms

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

Consistent cache hits for the same tensor after: set pickle.dumps() cache_return

## Environment

 - PyTorch Version (e.g., 1.0): 1.01
 - OS (e.g., Linux): Ubuntu 16.04
 - How you installed PyTorch (, , source): pip install
 - Build command you used (if compiling from source):
 - Python version: 3.6
 - CUDA/cuDNN version: 8
 - GPU models and configuration: GeForce GTX 1050
 - Any other relevant information: 

## Additional context

<!-- Add any other context about the problem here. -->

When using str(value) instead of pickle.dumps(value), the cache hits are consistent (however, for large tensors ... get injected into the str() output, so this ultimately fails). This makes me think the problem is in how pickle.dumps() serializes the tensors. I saw a similar issue: https://github.com/pytorch/pytorch/issues/9168 for changes (improving speed) along these lines (moving to byteIO).

Because of the related issue I thought I would post the issue here.
. []"
39,30968,1,"Categorical.sample too slow. ## üêõ Bug

Categorical.sample(shape) calls _shape_ times .
This is slow when we want to get many samples from a large number of classes.

## To Reproduce

Steps to reproduce the behavior:


Outputs : 

## Expected behavior
Shouldn't be slower than a single call to torch.multinomial

which outputs : 

## Environment
PyTorch version: 1.3.1
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: version 3.10.2

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration:
GPU 0: Quadro GP100
GPU 1: Quadro GP100

Nvidia driver version: 410.79
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.16.4
[pip] numpysane==0.17
[pip] torch==1.3.1
[conda] blas                      1.0                         mkl
[conda] faiss-gpu                 1.6.0            py37h1a5d453_0    pytorch
[conda] mkl                       2019.4                intel_243    intel
[conda] mkl_fft                   1.0.12           py37ha843d7b_0
[conda] mkl_random                1.0.2            py37hd81dba3_0
[conda] pytorch                   1.3.1           py3.7_cuda10.0.130_cudnn7.6.3_0    pytorch

cc @vincentqb @fritzo @neerajprad @alicanb @vishwakftw. ['torch.multinomial(probas, 1, True)', 'py\r\nimport torch\r\nsampling = torch.distributions.categorical.Categorical(probs=torch.rand((10_000_000)))\r\n%timeit sampling.sample((100,))\r\n', '3.16 s ¬± 117 ms per loop (mean ¬± std. dev. of 7 runs, 1 loop each)', 'py\r\nprobas = torch.rand(10_000_000)\r\n%timeit torch.multinomial(probas, 100, True)\r\n', '51.7 ms ¬± 1.31 ms per loop (mean ¬± std. dev. of 7 runs, 10 loops each)']"
622,7528,0,"[caffe2] C2 ONNX build is flaky due to lack of ordering dep. When it fails it looks like this:



This indicates we're trying to run the proto compiler before the proto file is created. This probably means there should be some dep declared which we didn't. It's intermittent because sometimes we're lucky and the build gets ordered the right way.

Maybe this should get reported to onnx repo.

CC @houseroad @bddppq @anderspapitto 

Cases of this failing:
- https://github.com/pytorch/pytorch/pull/7465
- https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-build/4286//console. ['\r\n02:41:21 [ 53%] Running C++ protocol buffer compiler on /var/lib/jenkins/workspace/build/third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto\r\n02:41:21 onnx_ONNX_NAMESPACE_FOR_C2_CI.proto: File not found.\r\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto: Import ""onnx_ONNX_NAMESPACE_FOR_C2_CI.proto"" was not found or had errors.\r\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto:64:12: ""NodeProto"" is not defined.\r\n02:41:21 third_party/onnx/CMakeFiles/onnx_proto.dir/build.make:68: recipe for target \'third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.pb.cc\' failed\r\n']"
423,26189,0,"[ONNX] bool comparison with 0,1 should export False,True constants. ## üêõ Bug

Should be able to compare boolean to 0,1 and exporter maybe should then use Fale,True as constants. But [comparing bool to 0 results in error](https://github.com/pytorch/pytorch/issues/25805)

## To Reproduce



## Expected behavior

export 0 as False constant to be valid ONNX

## Environment

PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.6 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: version 3.14.0

Python version: 2.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: GeForce GTX 1070
Nvidia driver version: 418.40.04
cuDNN version: /usr/local/lib/libcudnn.so.5.1.10

Versions of relevant libraries:
[pip] mictorch==0.0.1
[pip] numpy==1.16.4
[pip] torch==1.2.0
[pip] torchvision==0.4.0
[conda] Could not collect

## Additional context

Work around is:

. ['python\r\na = b > c\r\nna = a == 0\r\n', 'python\r\na = b > c\r\nna = a == torch.as_tensor(False)\r\n']"
696,7373,0,"help delete issue. If you have a question or would like help and support, please ask at our
[forums](https://discuss.pytorch.org/).

If you are submitting a feature request, please preface the title with [feature request].
If you are submitting a bug report, please fill in the following details.

## Issue description

Provide a short description.

## Code example

Please try to provide a minimal example to repro the bug.
Error messages and stack traces are also helpful.

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


- PyTorch or Caffe2:
- How you installed PyTorch (conda, pip, source):
- Build command you used (if compiling from source):
- OS:
- PyTorch version:
- Python version:
- CUDA/cuDNN version:
- GPU models and configuration:
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
548,15287,0,"Please make Slerp function available for generative model sampling. ## üöÄ Feature
I see that [](https://pytorch.org/docs/stable/torch.html?highlight=lerp#torch.lerp) function is available but  does not exist in PyTorch 1.0.

## Motivation
This feature request is motivated from the current research requirements and the way generative models are being developed (GANs specifically) i.e. the manipulation of output samples is made from latent input space. 
The paper [DCGAN](https://arxiv.org/abs/1511.06434) performed latent interpolation linearly ([](https://pytorch.org/docs/stable/torch.html?highlight=lerp#torch.lerp) would suffice) but [Sampling Generative Networks](https://arxiv.org/abs/1609.04468) paper suggests to use [Slerp function](https://en.wikipedia.org/wiki/Slerp) for interpolation. Moreover the following recent works go for Slerp too, for instance recently introduced [GAN 2.0](https://arxiv.org/abs/1812.04948), etc.

## Pitch
Please make [Slerp](https://en.wikipedia.org/wiki/Slerp) function available so that we can sample generative networks more effectively. 

## Alternatives
As an alternative please provide a PyTorch -based code snippet to compute [Slerp function](https://en.wikipedia.org/wiki/Slerp) effectively and easily.

## Additional context

Here is a Wikipedia's article showing example of [C++ and Python-NumPy code snippet](https://en.wikipedia.org/wiki/Slerp#Source_code) for [Slerp](https://en.wikipedia.org/wiki/Slerp). . []"
742,24690,0,"Migrate `digamma` and `digamma_` from the TH to Aten (CPU). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
574,19057,0,"building blocked when executing `python setup.py build` during COMPILER_SUPPORTS_LONG_DOUBLE. ## building blocked when executing python setup.py build

### Here is my environment info:

- OS: Ubuntu 16.04
- GCC: 5.3.0
- CUDA: 9.0
- GPU: GeForce GTX 1080 * 2
- PyTorch to be installed: 1.0.0

### I try to build PyTorch=1.0.0 from source but it seems to be blocked here (). I had waited for a long time but it didn't go on. Why did this happen?




. ['\r\n-- ******** Summary ********\r\n--   CMake version         : 3.11.0\r\n--   CMake command         : /mnt/lustre/share/cmake-3.11.0-Linux-x86_64/bin/cmake\r\n--   System                : Linux\r\n--   C++ compiler          : /mnt/lustre/share/gcc/gcc-5.3.0/bin/c++\r\n--   C++ compiler version  : 5.3.0\r\n--   CXX flags             :  -Wno-deprecated -fvisibility-inlines-hidden -Wnon-virtual-dtor\r\n--   Build type            : Release\r\n--   Compile definitions   : \r\n--   CMAKE_PREFIX_PATH     : /mnt/lustre/chenxiaokang/anaconda3/envs/pytorch1.0/lib/python3.7/site-packages\r\n--   CMAKE_INSTALL_PREFIX  : /mnt/lustre/chenxiaokang/pytorch-git/torch/lib/tmp_install\r\n--   CMAKE_MODULE_PATH     : /mnt/lustre/chenxiaokang/pytorch-git/cmake/Modules;/mnt/lustre/chenxiaokang/pytorch-git/cmake/public/../Modules_CUDA_fix\r\n-- \r\n--   ONNX version          : 1.4.1\r\n--   ONNX NAMESPACE        : onnx_torch\r\n--   ONNX_BUILD_TESTS      : OFF\r\n--   ONNX_BUILD_BENCHMARKS : OFF\r\n--   ONNX_USE_LITE_PROTO   : OFF\r\n--   ONNXIFI_DUMMY_BACKEND : OFF\r\n--   ONNXIFI_ENABLE_EXT    : OFF\r\n-- \r\n--   Protobuf compiler     : \r\n--   Protobuf includes     : \r\n--   Protobuf libraries    : \r\n--   BUILD_ONNX_PYTHON     : OFF\r\n-- Found CUDA with FP16 support, compiling with torch.cuda.HalfTensor\r\n-- Removing -DNDEBUG from compile flags\r\n-- MAGMA not found. Compiling without MAGMA support\r\n-- Could not find hardware support for NEON on this machine.\r\n-- No OMAP3 processor on this machine.\r\n-- No OMAP4 processor on this machine.\r\n-- Looking for cpuid.h\r\n-- Looking for cpuid.h - found\r\n-- Performing Test HAVE_GCC_GET_CPUID\r\n-- Performing Test HAVE_GCC_GET_CPUID - Success\r\n-- Performing Test NO_GCC_EBX_FPIC_BUG\r\n-- Performing Test NO_GCC_EBX_FPIC_BUG - Success\r\n-- Performing Test C_HAS_AVX_1\r\n-- Performing Test C_HAS_AVX_1 - Failed\r\n-- Performing Test C_HAS_AVX_2\r\n-- Performing Test C_HAS_AVX_2 - Success\r\n-- Performing Test C_HAS_AVX2_1\r\n-- Performing Test C_HAS_AVX2_1 - Failed\r\n-- Performing Test C_HAS_AVX2_2\r\n-- Performing Test C_HAS_AVX2_2 - Success\r\n-- Performing Test CXX_HAS_AVX_1\r\n-- Performing Test CXX_HAS_AVX_1 - Failed\r\n-- Performing Test CXX_HAS_AVX_2\r\n-- Performing Test CXX_HAS_AVX_2 - Success\r\n-- Performing Test CXX_HAS_AVX2_1\r\n-- Performing Test CXX_HAS_AVX2_1 - Failed\r\n-- Performing Test CXX_HAS_AVX2_2\r\n-- Performing Test CXX_HAS_AVX2_2 - Success\r\n-- AVX compiler support found\r\n-- AVX2 compiler support found\r\n-- Performing Test HAS_C11_ATOMICS\r\n-- Performing Test HAS_C11_ATOMICS - Success\r\n-- Atomics: using C11 intrinsics\r\n-- Looking for cheev_\r\n-- Looking for cheev_ - found\r\n-- Found a library with LAPACK API. (open)\r\n-- Found CUDA: /mnt/lustre/share/cuda-9.0 (found suitable version ""9.0"", minimum required is ""5.5"") \r\ndisabling ROCM because NOT USE_ROCM is set\r\n-- MIOpen not found. Compiling without MIOpen support\r\n-- Could NOT find MKLDNN (missing: MKLDNN_LIBRARIES) \r\n-- MKLDNN source files not found!\r\n-- MKLDNN source files not found!\r\nCMake Warning at cmake/Dependencies.cmake:1318 (MESSAGE):\r\n  MKLDNN could not be found.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:201 (include)\r\n\r\n\r\n-- Looking for clock_gettime in rt\r\n-- Looking for clock_gettime in rt - found\r\n-- Looking for mmap\r\n-- Looking for mmap - found\r\n-- Looking for shm_open\r\n-- Looking for shm_open - found\r\n-- Looking for shm_unlink\r\n-- Looking for shm_unlink - found\r\n-- Looking for malloc_usable_size\r\n-- Looking for malloc_usable_size - found\r\n-- Performing Test C_HAS_THREAD\r\n-- Performing Test C_HAS_THREAD - Success\r\n-- GCC 5.3.0: Adding gcc and gcc_s libs to link line\r\n-- Using python found in /mnt/lustre/chenxiaokang/anaconda3/envs/pytorch1.0/bin/python\r\n-- Check size of long double\r\n-- Check size of long double - done\r\n-- Performing Test COMPILER_SUPPORTS_LONG_DOUBLE\r\n']"
595,16693,0,"[build error] Build caffe error. ## ‚ùìError while building latest pytorch



I did the installing steps presented in the official website. This is on macOS.

UI.:
Interesting that there is string.h in the anaconda directory:
. ['\r\n[ 70%] Building CXX object caffe2/torch/lib/libshm/CMakeFiles/torch_shm_manager.dir/manager.cpp.o\r\nIn file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.h:In file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.hIn file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.h:120:\r\nIn file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.hIn file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.h:120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\nIn file included from :120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\n120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\n:120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\n<built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.h:120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\n[ 70%] Built target caffe2_pybind11_state\r\n[ 70%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCTensorCopy.cu.o\r\nIn file included from <built-in>:1:\r\nIn file included from /usr/local/cuda/include/cuda_runtime.h:120:\r\nIn file included from /usr/local/cuda/include/crt/common_functions.h:77:\r\n/anaconda2/bin/../include/c++/v1/string.h:61:15: fatal error: \'string.h\' file not found\r\n#include_next <string.h>\r\n              ^~~~~~~~~~\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCSleep.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCSleep.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCSleep.cu.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCBlas.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCBlas.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCBlas.cu.o] Error 1\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCReduceApplyUtils.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCReduceApplyUtils.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCReduceApplyUtils.cu.o] Error 1\r\n1 error generated.\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCTensor.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCTensor.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCTensor.cu.o] Error 1\r\nCMake Error at caffe2_gpu_generated_THCStorageCopy.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCStorageCopy.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.o] Error 1\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCTensorCopy.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCTensorCopy.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCTensorCopy.cu.o] Error 1\r\n1 error generated.\r\nCMake Error at caffe2_gpu_generated_THCStorage.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /Users/Dani/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/./caffe2_gpu_generated_THCStorage.cu.o\r\n\r\n\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorage.cu.o] Error 1\r\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n[ 70%] Linking CXX executable ../../../../bin/torch_shm_manager\r\n[ 70%] Built target torch_shm_manager\r\nmake: *** [all] Error 2\r\nTraceback (most recent call last):\r\n  File ""setup.py"", line 720, in <module>\r\n    build_deps()\r\n  File ""setup.py"", line 279, in build_deps\r\n    build_dir=\'build\')\r\n  File ""/Users/Dani/pytorch/tools/build_pytorch_libs.py"", line 248, in build_caffe2\r\n    check_call([\'make\', \'-j\', str(max_jobs), \'install\'], cwd=build_dir, env=my_env)\r\n  File ""/anaconda2/envs/pytorch/lib/python3.7/subprocess.py"", line 347, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command \'[\'make\', \'-j\', \'8\', \'install\']\' returned non-zero exit status 2.\r\n', '\r\nls /anaconda2/bin/../include/c++/v1/\r\n__bit_reference\t\t\tcfenv\t\t\t\tfloat.h\t\t\t\tset\r\n__bsd_locale_defaults.h\t\tcfloat\t\t\t\tforward_list\t\t\tsetjmp.h\r\n__bsd_locale_fallbacks.h\tchrono\t\t\t\tfstream\t\t\t\tshared_mutex\r\n__config\t\t\tcinttypes\t\t\tfunctional\t\t\tsstream\r\n__cxxabi_config.h\t\tciso646\t\t\t\tfuture\t\t\t\tstack\r\n__debug\t\t\t\tclimits\t\t\t\tinitializer_list\t\tstdbool.h\r\n__functional_03\t\t\tclocale\t\t\t\tinttypes.h\t\t\tstddef.h\r\n__functional_base\t\tcmath\t\t\t\tiomanip\t\t\t\tstdexcept\r\n__functional_base_03\t\tcodecvt\t\t\t\tios\t\t\t\tstdint.h\r\n__hash_table\t\t\tcomplex\t\t\t\tiosfwd\t\t\t\tstdio.h\r\n__libcpp_version\t\tcomplex.h\t\t\tiostream\t\t\tstdlib.h\r\n__locale\t\t\tcondition_variable\t\tistream\t\t\t\tstreambuf\r\n__mutex_base\t\t\tcsetjmp\t\t\t\titerator\t\t\tstring\r\n__nullptr\t\t\tcsignal\t\t\t\tlimits\t\t\t\tstring.h\r\n__refstring\t\t\tcstdarg\t\t\t\tlimits.h\t\t\tstring_view\r\n__split_buffer\t\t\tcstdbool\t\t\tlist\t\t\t\tstrstream\r\n__sso_allocator\t\t\tcstddef\t\t\t\tlocale\t\t\t\tsupport\r\n__std_stream\t\t\tcstdint\t\t\t\tlocale.h\t\t\tsystem_error\r\n__string\t\t\tcstdio\t\t\t\tmap\t\t\t\ttgmath.h\r\n__threading_support\t\tcstdlib\t\t\t\tmath.h\t\t\t\tthread\r\n__tree\t\t\t\tcstring\t\t\t\tmemory\t\t\t\ttuple\r\n__tuple\t\t\t\tctgmath\t\t\t\tmodule.modulemap\t\ttype_traits\r\n__undef_min_max\t\t\tctime\t\t\t\tmutex\t\t\t\ttypeindex\r\nalgorithm\t\t\tctype.h\t\t\t\tnew\t\t\t\ttypeinfo\r\nany\t\t\t\tcwchar\t\t\t\tnumeric\t\t\t\tunordered_map\r\narray\t\t\t\tcwctype\t\t\t\toptional\t\t\tunordered_set\r\natomic\t\t\t\tcxxabi.h\t\t\tostream\t\t\t\tutility\r\nbitset\t\t\t\tdeque\t\t\t\tqueue\t\t\t\tvalarray\r\ncassert\t\t\t\terrno.h\t\t\t\trandom\t\t\t\tvariant\r\nccomplex\t\t\texception\t\t\tratio\t\t\t\tvector\r\ncctype\t\t\t\texperimental\t\t\tregex\t\t\t\twchar.h\r\ncerrno\t\t\t\text\t\t\t\tscoped_allocator\t\twctype.h\r\n\r\n']"
460,7498,0,Production. How to deploy the pYtorch trained model to production ? . []
362,25045,0,"[Distance functions] F.pdist backward CUDA invalid configuration. ## üêõ Bug

After passing the input through a  function, the gradient *w.r.t.* to the input can not be correctly calculated on a cuda device.

## To Reproduce

Steps to reproduce the behavior:

3. When increasing the tensor size and running

the error message is:


<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version: **1.2.0**
 - OS (e.g., Linux): **CentOS 7.6.1810 (Core)**
 - How you installed PyTorch (, , source): **conda**
 - Build command you used (if compiling from source): N/A
 - Python version: **3.6.7**
 - CUDA/cuDNN version: **V10.0.130**
 - GPU models and configuration: **GeForce GTX 1080**
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->

cc @ngimel. ['python\r\nimport torch\r\nimport torch.nn.functional as F\r\n\r\ndef test(device, dim=1024):\r\n    x = torch.rand(dim, 4, requires_grad=True).to(device)\r\n    y = torch.ones(dim, 1).to(device)\r\n    vdist = F.pdist(x, 2)\r\n    tdist = F.pdist(y, 1)\r\n\r\n    vdist = 1/(1+vdist**2)\r\n    loss = F.binary_cross_entropy(vdist, tdist)\r\n    loss.backward()\r\n    print(x.grad.data)\r\n', ""python\r\ntest(torch.device('cuda'), dim=4096)\r\n"", '\r\nTraceback (most recent call last):\r\n  File ""test_pdist.py"", line 16, in <module>\r\n    test(torch.device(\'cuda\'), 4096)\r\n  File ""test_pdist.py"", line 12, in test\r\n    loss.backward()\r\n  File ""/n/home/user/app/anaconda3/envs/myenv/lib/python3.6/site-packages/torch/tensor.py"", line 118, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph)\r\n  File ""/n/home/user/app/anaconda3/envs/myenv/lib/python3.6/site-packages/torch/autograd/__init__.py"", line 93, in backward\r\n    allow_unreachable=True)  # allow_unreachable flag\r\nRuntimeError: CUDA error: invalid configuration argument\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
56,5436,1,"Slower performance of eq and fill_ compared to numpy. 




. [""shell\r\npython -m timeit -n 1000 'import torch; torch.ByteTensor(500, 500, 3).fill_(1) == torch.ByteTensor([1, 2, 3])'\r\npython -m timeit -n 1000 'import numpy; numpy.ones((500, 500, 3), dtype = numpy.uint8) == numpy.array([1, 2, 3], dtype = numpy.uint8)'\r\n"", '\r\n1000 loops, best of 3: 4.81 msec per loop\r\n1000 loops, best of 3: 1.45 msec per loop\r\n']"
561,24639,0,"Migrate `std` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
337,22687,0,"DispatchStub should report what operator it failed to find kernel for. In #22681 we get an unhelpful error message because it just says that CUDA kernels is missing, it doesn't say what is missing. It would be good of dispatch stub gave more information. Maybe we can pass in a string constant to the template parameter and update the macro to stringify the struct name to pass in.

cc @cpuhrsch @VitalyFedyunin @colesbury . []"
642,8109,0,"Sometimes the torch.save method does not work properly.. ## Issue description
When indexing a part of the tensor, the entire original tensor is saved.

## Code example



I expect that divided tensors will be stored. (It will be about 100KB)
However, it is actually stored in the original matrix size. (Approximately 12MB)

## System Info

PyTorch
conda
Windows 10
0.4.0
Python 3.6
CUDA 9.0
Nvidia Geforce 1070. [""\r\nimport torch\r\norigin = torch.FloatTensor(128, 512, 7, 7) # original tensor (shape: [128, 512, 7, 7])\r\nindexed = origin[0] # part of tensor (shape: [512, 7, 7])\r\ntorch.save(indexed, 'tensor.pth') # save tensor\r\n""]"
70,11647,1,"Performance (speed) regression from 0.4.0 to 0.4.1. ## Issue description

I have a fairly optimized cnn-blstm-crf tagger [here](https://github.com/dpressel/baseline/blob/master/python/baseline/pytorch/tagger/model.py) with the crf defined [here](https://github.com/dpressel/baseline/blob/f0204432076c166ce3d6672705826f33aec95dbe/python/baseline/pytorch/torchy.py#L669).

On pytorch  using cuda  and cudnn  I can run a single epoch of the conll 2003 NER task in 21.41 +/- 0.28

When the only thing I change is the version of pytorch to  (the current conda install) a single epoch now takes  27.99 +/-  0.26

These models are run on gpu.

From the pytorch forums I was told to post here https://discuss.pytorch.org/t/large-preformance-regression-on-0-4-1/25037

## Code example

Please try to provide a minimal example to repro the bug.

Assuming pytorch is installed



## System Info

### 0.4.0

Collecting environment information...
PyTorch version: 0.4.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: GPU 0: GeForce GTX 1070 with Max-Q Design
Nvidia driver version: 384.130
cuDNN version: Probably one of the following:
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7.1.2
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn_static.a
/usr/local/cuda-9.0/lib64/libcudnn.so
/usr/local/cuda-9.0/lib64/libcudnn.so.7
/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0/lib64/libcudnn.so.7.1.2
/usr/local/cuda-9.0/lib64/libcudnn.so.7.2.1
/usr/local/cuda-9.0/lib64/libcudnn_static.a

Versions of relevant libraries:
[pip] numpy (1.14.3)
[pip] torch (0.4.0)
[pip] torchfile (0.1.0)
[pip] torchvision (0.2.1)
[conda] cuda90                    1.0                  h6433d27_0    pytorch
[conda] pytorch                   0.4.0            py36hdf912b8_0  
[conda] torchfile                 0.1.0                     <pip>
[conda] torchvision               0.2.1                    py36_1    pytorch


### 0.4.1
Collecting environment information...
PyTorch version: 0.4.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: GPU 0: GeForce GTX 1070 with Max-Q Design
Nvidia driver version: 384.130
cuDNN version: Probably one of the following:
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn.so.7.1.2
/usr/local/cuda-9.0-cudnn-7/lib64/libcudnn_static.a
/usr/local/cuda-9.0/lib64/libcudnn.so
/usr/local/cuda-9.0/lib64/libcudnn.so.7
/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0/lib64/libcudnn.so.7.1.2
/usr/local/cuda-9.0/lib64/libcudnn.so.7.2.1
/usr/local/cuda-9.0/lib64/libcudnn_static.a

Versions of relevant libraries:
[pip] numpy (1.14.3)
[pip] torch (0.4.1.post2)
[pip] torchfile (0.1.0)
[pip] torchvision (0.2.1)
[conda] cuda90                    1.0                  h6433d27_0    pytorch
[conda] pytorch                   0.4.1           py36_py35_py27__9.0.176_7.1.2_2    pytorch
[conda] torchfile                 0.1.0                     <pip>
[conda] torchvision               0.2.1                    py36_1    pytorch. ['\r\ngit clone https://github.com/blester125/baseline.git\r\ncd baseline\r\ngit checkout speed-test\r\ncd python\r\n./install_dev.sh baseline no-test\r\necho ""{}"" > mead/config/mead-settings.json\r\nmead-train --config config/conll-bio.json\r\n']"
64,14687,1,"Advanced indexing slower than numpy. ## üêõ Bug

Advanced indexing is slower than numpy.

## To Reproduce

Steps to reproduce the behavior:



## Expected behavior

PyTorch should be as fast as numpy when doing advanced indexing of tensors that do not require grad.

## Environment

 - PyTorch Version (e.g., 1.0): 1.0.0.dev20181202
 - OS (e.g., Linux): Ubuntu 18.04.1 LTS
 - How you installed PyTorch (, , source): conda install pytorch-nightly -c pytorch
 - Python version: 3.7.0


cc @mruberry @rgommers @heitorschueroff @VitalyFedyunin @ngimel. [""python\r\nPython 3.7.0 (default, Oct  9 2018, 10:31:47) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.0.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import torch                                                                                                                                            \r\n\r\nIn [2]: torch.__version__                                                                                                                                       \r\nOut[2]: '1.0.0.dev20181202'\r\n\r\nIn [3]: x = torch.randn(1024)                                                                                                                                   \r\n\r\nIn [4]: idx = torch.rand(1024) > 0.5                                                                                                                            \r\n\r\nIn [5]: %%timeit \r\n   ...: x[idx] \r\n   ...:                                                                                                                                                   \r\n35 ¬µs ¬± 63.3 ns per loop (mean ¬± std. dev. of 7 runs, 10000 loops each)\r\n\r\nIn [6]: x_np, idx_np = x.numpy(), idx.numpy()                                                                                                                   \r\n\r\nIn [7]: %%timeit \r\n   ...: x_np[idx_np] \r\n   ...:                                                                                                                                                 \r\n2.36 ¬µs ¬± 8.62 ns per loop (mean ¬± std. dev. of 7 runs, 100000 loops each)\r\n""]"
739,422,0,"get rid of requiring to do super.__init__ in nn.Container subclasses. This seems like its something that users'll forget to do, and we might get a lot of subtle bug reports because of this. Seems like a good usability fix early on.. []"
434,2620,0,"nn.Embedding error when using max_norm. 
. ['\r\n>>> torch.__version__\r\n\'0.2.0_3\'\r\n>>> embedding = nn.Embedding(10, 3, max_norm=3, norm_type=2)\r\n>>> input = Variable(torch.LongTensor([[1,2,4,5],[4,3,2,9]]))\r\n>>> embedding(input)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""AAA/venv/lib/python3.6/site-packages/torch/nn/modules/module.py"", line 224, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""AAA/venv/lib/python3.6/site-packages/torch/nn/modules/sparse.py"", line 94, in forward\r\n    self.scale_grad_by_freq, self.sparse\r\n  File ""AAA/venv/lib/python3.6/site-packages/torch/nn/_functions/thnn/sparse.py"", line 48, in forward\r\n    cls._renorm(indices, weight, max_norm, norm_type)\r\nTypeError: _renorm() missing 1 required positional argument: \'norm_type\'\r\n']"
242,5790,0,"Add hookable weights. It would be nice to have hookable weights, where per-layer parameters can be operated upon and determined dynamically during each forward pass. The following is a short list of techniques that could benefit from this functionality:

- Quantization[[1]](https://arxiv.org/abs/1609.07061)
- Pruning[[2]](https://arxiv.org/abs/1510.00149)[[3]](https://arxiv.org/abs/1707.06168)[[4]](https://arxiv.org/abs/1802.00124)
- Stochastic gradient estimation[[5]](https://arxiv.org/abs/1711.00123)[[6]](https://arxiv.org/abs/1703.07370)
- DropConnect[[7]](https://cs.nyu.edu/~wanli/dropc/)
- Regularization[[8]](https://openreview.net/forum?id=H1Y8hhg0b)
- Manifold Tangent Classifier[[9]](https://papers.nips.cc/paper/4409-the-manifold-tangent-classifier.pdf)

I've begun work on [such a framework](https://github.com/castorini/candle), but the code is research-oriented and not production ready. I think the community would benefit from having official support for hookable weights.

I think it would also be interesting to have a more extensible backprop framework, in the sense of allowing for computation of different user-defined quantities across the computation graph. For example, the Hessian diagonals can be computed efficiently[[10]](http://yann.lecun.com/exdb/publis/pdf/lecun-90b.pdf) using a backprop-like approach.

Thanks for reading.


cc @albanD @mruberry @jbschlosser @jerryzh168 @jianyuh @dzhulgakov @raghuramank100 @jamesr66a @vkuzo. []"
529,19104,0,"Is there 0.5.0version of pytorch?. when I tried to use Dataparallel, I came across the problem"" Arguments are located on different GPUs"",
I found that I should use the 0.5.0 version to solve the problem on the forum.
However ,I have been trying to find the correct version for a long time with no result.Can anyone help me ?
(ps, I tried to run the code on pytorch1.0, but error came in the dataloader part ‚ÄúRandomSampler‚Äô object has no attribute 'replacement‚Äù.and I found no solution.
Thank you !!. []"
563,6140,0,"[jit][script] Support `dim` wrapping. The following does not compile:

The expected behavior should be that the dim wraps around (to match torch semantics).

cc @zdevito . ['\r\nimport torch\r\n@torch.jit.script\r\ndef unsqueezel(x):\r\n    return x.unsqueeze(dim=-1)\r\nx = torch.randn((2, 2), requires_grad=True)\r\nunsqueezel(x)\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-8-6b2f4059fc46> in <module>()\r\n      1 import torch\r\n----> 2 @torch.jit.script\r\n      3 def unsqueezel(x):\r\n      4     return x.unsqueeze(dim=-1)\r\n      5 x = torch.randn((2, 2), requires_grad=True)\r\n\r\n~/pytorch/pytorch/torch/jit/__init__.py in script(fn)\r\n    528     rcb = createResolutionCallback()\r\n    529     ast = get_jit_ast(fn)\r\n--> 530     graph = _jit_script_compile(ast, rcb)\r\n    531     return torch._C.GraphExecutor(graph, True)\r\n    532\r\n\r\nRuntimeError:\r\nUnexpected kind of attribute value: 45:\r\n@torch.jit.script\r\ndef unsqueezel(x):\r\n    return x.unsqueeze(dim=-1)\r\n                           ~~ <--- HERE\r\n']"
476,19305,0,"libtorch gpu efficiency. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce
here is my code

auto out = faceDetect->forward({ tensor_image }).toTuple();
c10::cuda::CUDACachingAllocator::emptyCache();
...some tensor ops on gpu
boundingBoxesOfOne = torch::masked_select(boundingBoxesOfOne, mask);

faceDetect is a sfd net,after forward(),if i call emptyCache(),it will cost 170ms time to emptyCache;if i don't call emptyCache(),masked_select will cost 170ms;so i don't know how to optimize this situationÔºåthksÔºÅ


## Environment

libtorch Version 1.0 :
OS windows10:
CUDA/cuDNN version: 9.0
GPU models and configuration: GTX 1060

## Additional context

<!-- Add any other context about the problem here. -->
. []"
76,13716,1,"depthwise convolution are slow on cpu . I try to use depthwise convolution to reduce parameters of my model. However I found depthwise convolutions are slow on cpu, just 4x~5x than normal 3x3 convolution, while input_channel and output channel are 256. Is there any way to speed up the process? My version is pytorch 0.4.1.



cc @VitalyFedyunin @ngimel. []"
157,2126,0,when i changed thetorchvision.utils source code long to int. how do i do this. []
53,5426,1,"torch.from_numpy is slow for mmap'ped numpy arrays. I'm looking at feasibility of using Ray as parameter server combined with single-machine NN implementation. 

The bottleneck for using it with PyTorch is that result of Ray calls come as numpy array created on top of [mmaped memory](https://groups.google.com/forum/#!msg/ray-dev/pNsxWI-iSyI/vhWnjgAfAwAJ), and PyTorch  on these arrays is slow, working at about 2.5 GB/sec, which is the speed of single-threaded memcpy.

Regular numpy array can be turned into PyTorch GPU tensors at 8-11 GB/sec, depending on whether memory has been page locked.

Is this memcpy necessary? Can it be done in multi-threaded way?
Related issue¬†on Ray side: https://github.com/ray-project/ray/issues/1614

https://github.com/diux-dev/cluster/blob/master/yuxin_numpy/tf_numpy_benchmark.py

Pytorch 0.3.0.post4
Repro instructions like in https://github.com/pytorch/pytorch/issues/5412#issuecomment-368658892
. ['\r\n# torch.from_numpy(ray.get(f.remote()))\r\npython tf_numpy_benchmark.py --benchmark=pytorch_from_numpy_noclone --allocator=ray --num-iters=51\r\npytorch_from_numpy            :   2.5 GB/sec, min: 39.86, median: 41.38, mean: 63.55\r\n\r\n# torch.from_numpy(page_locked_numpy).cuda()\r\npython tf_numpy_benchmark.py --benchmark=pytorchgpu_from_numpy --allocator=tfgpu --num-iters=51\r\npytorchgpu_from_numpy         :  11.0 GB/sec, min:  9.05, median:  9.07, mean:  9.07\r\n\r\n# torch.from_numpy(regular_numpy).cuda()\r\npython tf_numpy_benchmark.py --benchmark=pytorchgpu_from_numpy --allocator=numpy --num-iters=51\r\npytorchgpu_from_numpy         :   8.2 GB/sec, min: 12.24, median: 12.42, mean: 12.45\r\n']"
703,4281,0,"Implementation of Bipolar Activation Functions. We're looking to make a pull request for [bipolar activation functions](https://arxiv.org/abs/1709.04054). Hope to get some feedback.

This is a trick to make activation functions self centering. In short: Because the ReLU keeps only positive numbers, it shifts the post-activation mean in a positive direction. However, if we for every other neuron we instead keep the negative numbers, we cancel this effect. 

So for half the neurons we do , and other half we do . For an i.i.d. input vector, the effect of this is to halve the mean of the vector, post-activation, .

In our paper we find empirically that this can help learning in RNNs and ConvNets. Our empirical results are with ReLUs and ELUs, but I would expect it to hold for anything ReLU like.

One way to implement it would be to put something like the following in nn/functional.py:



This also includes bipolar max-pooling functions (i.e. min-pooling for half the inputs).


1) Would there be interest in a pull request for this?
2) Any comments on the implementation? Of course, we'll have to add doc strings, and also put something similar into nn/modules/activation.py. ['python\r\ndef _make_bipolar(fn):\r\n    def _fn(x, *args, **kwargs):\r\n        dim = 0 if x.dim() == 1 else 1\r\n        x0, x1 = torch.chunk(x, chunks=2, dim=dim)\r\n        y0 = fn(x0, *args, **kwargs)\r\n        y1 = -fn(-x1, *args, **kwargs)\r\n        return torch.cat((y0, y1), dim=dim)\r\n\r\n    return _fn\r\n    \r\nbrelu = _make_bipolar(relu)\r\nbelu = _make_bipolar(elu)\r\nbselu = _make_bipolar(selu)\r\nleaky_brelu = _make_bipolar(leaky_relu)\r\nbprelu = _make_bipolar(prelu)\r\nbrrelu = _make_bipolar(rrelu)\r\nbsoftplus = _make_bipolar(softplus)\r\nbsigmoid = _make_bipolar(sigmoid)\r\nbipolar_max_pool1d = _make_bipolar(max_pool1d)\r\nbipolar_max_pool2d = _make_bipolar(max_pool2d)\r\nbipolar_max_pool3d = _make_bipolar(max_pool3d)\r\n']"
462,19024,0,"Loss explosion with DataParallel on WGAN models . See https://discuss.pytorch.org/t/huge-loss-with-dataparallel/40749 for the original report.

This seems to have regressed between 0.4.1 and 1.0 and needs to be debugged.

cc @mrshenli . []"
559,16428,0,"'swap' type in torch.nn.TripletMarginLoss. ## üìö Documentation

is it  instead of ?

https://pytorch.org/docs/stable/nn.html?highlight=tripletmarginloss#torch.nn.TripletMarginLoss


<!-- A clear and concise description of what content in https://pytorch.org/docs is an issue. If this has to do with the general https://pytorch.org website, please file an issue at https://github.com/pytorch/pytorch.github.io/issues/new/choose instead. If this has to do with https://pytorch.org/tutorials, please file an issue at https://github.com/pytorch/tutorials/issues/new -->
. []"
285,14839,0,"Test OpenCV4 in CI. It's not tested, evidence https://github.com/pytorch/pytorch/pull/14356

cc @ezyang @seemethere @malfet @walterddr @pytorch/pytorch-dev-infra. []"
289,21135,0,"[cmake build] can't build pytorch with install mkl library . ### pytorch can't be built with  installed mkl library 
 - PyTorch version : master branch 
 - OS : CentOS-7.5

I had installed intel . So when I built  from the scratch, the build system couldn't find the installed  libraries.

I found  the mkl-related module, which was  . -related enviroments  were set to default path as the following:

In this way, I couldn't build  through  with the installed  libraries. Is there any effective method to build  with installed . 
### What I did to build with installed 
In order to build  with installed  and accept environments from the command line, I did modify the  as the following: 

And to accept the environments from the command line, the file  was modified as the following: 
`
--- a/tools/build_pytorch_libs.py
+++ b/tools/build_pytorch_libs.py
@@ -228,6 +228,18 @@ def run_cmake(version,
     if os.getenv('MKL_TBB'):
         cmake_defines(cmake_args, INTEL_MKL_TBB=check_env_flag('MKL_TBB'))

+    if os.getenv('INTEL_COMPILER_DIR'):
+        cmake_defines(cmake_args, INTEL_COMPILER_DIR=os.getenv('INTEL_COMPILER_DIR'))
+
+    if os.getenv('INTEL_MKL_DIR'):
+        cmake_defines(cmake_args, INTEL_MKL_DIR=os.getenv('INTEL_MKL_DIR'))
+
+    if os.getenv('INTEL_MKL_SEQUENTIAL'):
+        cmake_defines(cmake_args, INTEL_MKL_SEQUENTIAL=check_env_flag('INTEL_MKL_SEQUENTIAL'))
+
+    if os.getenv('INTEL_MKL_TBB'):
+        cmake_defines(cmake_args, INTEL_MKL_TBB=check_env_flag('INTEL_MKL_TBB'))
+
     mkldnn_threading = os.getenv('MKLDNN_THREADING')
     if mkldnn_threading:
         cmake_defines(cmake_args, MKLDNN_THREADING=mkldnn_threading). [' cmake\r\n 32 # Intel Compiler Suite\r\n 33 SET(INTEL_COMPILER_DIR ""/opt/intel"" CACHE STRING\r\n 34   ""Root directory of the Intel Compiler Suite (contains ipp, mkl, etc.)"")\r\n 35 SET(INTEL_MKL_DIR ""/opt/intel/mkl"" CACHE STRING\r\n 36   ""Root directory of the Intel MKL (standalone)"")\r\n 37 SET(INTEL_MKL_SEQUENTIAL OFF CACHE BOOL\r\n 38   ""Force using the sequential (non threaded) libraries"")\r\n 39 SET(INTEL_MKL_TBB OFF CACHE BOOL\r\n 40   ""Force using TBB library"")\r\n', ' cmake\r\n--- a/cmake/Modules/FindMKL.cmake\r\n+++ b/cmake/Modules/FindMKL.cmake\r\n@@ -30,13 +30,13 @@ INCLUDE(CheckTypeSize)\r\n INCLUDE(CheckFunctionExists)\r\n\r\n # Intel Compiler Suite\r\n-SET(INTEL_COMPILER_DIR ""/opt/intel"" CACHE STRING\r\n+SET(INTEL_COMPILER_DIR ${INTEL_COMPILER_DIR} CACHE STRING\r\n   ""Root directory of the Intel Compiler Suite (contains ipp, mkl, etc.)"")\r\n-SET(INTEL_MKL_DIR ""/opt/intel/mkl"" CACHE STRING\r\n+SET(INTEL_MKL_DIR ${INTEL_MKL_DIR} CACHE STRING\r\n   ""Root directory of the Intel MKL (standalone)"")\r\n-SET(INTEL_MKL_SEQUENTIAL OFF CACHE BOOL\r\n+SET(INTEL_MKL_SEQUENTIAL ${INTEL_MKL_SEQUENTIAL} CACHE BOOL\r\n   ""Force using the sequential (non threaded) libraries"")\r\n-SET(INTEL_MKL_TBB OFF CACHE BOOL\r\n+SET(INTEL_MKL_TBB ${INTEL_MKL_TBB} CACHE BOOL\r\n   ""Force using TBB library"")\r\n']"
748,2527,0,"Pytorch giving a cuda runtime error (30). I have made small changes in the  example code. Changed [these lines](https://github.com/pytorch/examples/blob/86bc3e516dde92fee0ce00668a3714c03155dd44/imagenet/main.py#L80-L88) to:


And, when I run the script, it throws a cuda runtime error which is as follows:


My cuda version is as follows:


A much more detailed post is also available here: https://stackoverflow.com/q/45861767/4993513. [""\r\n\r\n   if not args.distributed:\r\n        if args.arch.startswith('alexnet') or args.arch.startswith('vgg'):\r\n            #model.features = torch.nn.DataParallel(model.features)\r\n            model.cuda()\r\n        #else:\r\n            #model = torch.nn.DataParallel(model).cuda()\r\n    else:\r\n        model.cuda()\r\n        #model = torch.nn.parallel.DistributedDataParallel(model)\r\n\r\n    # define loss function (criterion) and optimizer\r\n    criterion = nn.CrossEntropyLoss().cuda()\r\n"", '\r\n\r\nubuntu@ip-x-y-z-a:~$ time CUDA_VISIBLE_DEVICES=0 python imagenet2.py --world-size 1 --arch \'alexnet\' ImageNet2\r\n=> creating model \'alexnet\'\r\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/THCGeneral.c line=70 error=30 : unknown error\r\nTraceback (most recent call last):\r\n  File ""imagenet2.py"", line 319, in <module>\r\n    main()\r\n  File ""imagenet2.py"", line 87, in main\r\n    model.cuda()\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py"", line 147, in cuda\r\n    return self._apply(lambda t: t.cuda(device_id))\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py"", line 118, in _apply\r\n    module._apply(fn)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py"", line 118, in _apply\r\n    module._apply(fn)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py"", line 124, in _apply\r\n    param.data = fn(param.data)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py"", line 147, in <lambda>\r\n    return self._apply(lambda t: t.cuda(device_id))\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/_utils.py"", line 66, in _cuda\r\n    return new_type(self.size()).copy_(self, async)\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py"", line 266, in _lazy_new\r\n    _lazy_init()\r\n  File ""/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py"", line 85, in _lazy_init\r\n    torch._C._cuda_init()\r\nRuntimeError: cuda runtime error (30) : unknown error at /pytorch/torch/lib/THC/THCGeneral.c:70\r\n', '\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2016 NVIDIA Corporation\r\nBuilt on Tue_Jan_10_13:22:03_CST_2017\r\nCuda compilation tools, release 8.0, V8.0.61\r\n']"
92,6126,1,"Inf and nan loss . Here is my network:

Then, I created the network and the training loops as :


The initial output was very large, then it became Inf and finally Nan. Why is this happening?. ['\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\n\r\nclass RNN(nn.Module):\r\n    def __init__(self, input_size, hidden_size, output_size):\r\n        super().__init__()\r\n        self.hidden_size = hidden_size\r\n        self.i2h = nn.Linear(input_size , hidden_size)\r\n        self.h2o = nn.Linear(hidden_size, output_size)\r\n        self.h2h = nn.Linear(hidden_size, hidden_size)\r\n        self.softmax = nn.LogSoftmax(dim = 1)\r\n\r\n    def forward(self, input, hidden):\r\n        h = self.softmax(self.h2h(hidden)+  self.i2h(input))\r\n        o = self.softmax(self.h2o(h))\r\n        return o, h\r\n\r\n    def init_hidden(self):\r\n        return Variable(torch.zeros(1, self.hidden_size))\r\n\r\n', ""\r\n\r\nrnn = RNN(n_chars, 90, n_chars)\r\ncriterion = nn.KLDivLoss()\r\nlearning_rate = 0.05\r\noptimizer = torch.optim.Adam(rnn.parameters(), lr = learning_rate)\r\nhidden = rnn.init_hidden()\r\nepochs = 5\r\n\r\nfor epoch in range(epochs):\r\n    for i in range(len(X)):\r\n        for ele in X[i]:\r\n            output, hidden = rnn(Variable(ele.t()), hidden)\r\n        loss = criterion(output, Y[i])\r\n        \r\n        loss.backward(retain_graph=True)\r\n        optimizer.zero_grad()\r\n        optimizer.step()\r\n        print('Current loss is: ', loss)\r\n""]"
493,12981,0,"torchvision install error. Sorry to trouble you, but I get some error when I start pytorch
I set 
- PyTorch Build ‚Äî‚Äî Stable
- Your OS‚Äî‚ÄîWindows
- Package‚Äî‚ÄîConda
- Language‚Äî‚ÄîPython 3.6
- CUDA‚Äî‚Äî8.0

It shows 
Run this Command:
pytorchpip3

The first command is alright, shows  # All requested packages already installed. And I can import torch.
But the second command shows:

I have tried use , and shows the same message. 
I find 
 
 in the error message,But




. ['\r\nRequirement already satisfied: torchvision in c:\\program files (x86)\\python36-32\\lib\\site-packages (0.2.1)\r\nRequirement already satisfied: numpy in c:\\program files (x86)\\python36-32\\lib\\site-packages (from torchvision) (1.13.3)\r\nCollecting torch (from torchvision)\r\n  Using cached https://files.pythonhosted.org/packages/5f/e9/bac4204fe9cb1a002ec6140b47f51affda1655379fe302a1caef421f9846/torch-0.1.2.post1.tar.gz\r\n    Complete output from command python setup.py egg_info:\r\n    Traceback (most recent call last):\r\n      File ""<string>"", line 1, in <module>\r\n      File ""C:\\Users\\qiucy\\AppData\\Local\\Temp\\pip-install-xstv3999\\torch\\setup.py"", line 11, in <module>\r\n        raise RuntimeError(README)\r\n    RuntimeError: PyTorch does not currently provide packages for PyPI (see status at https://github.com/pytorch/pytorch/issues/566).\r\n\r\n    Please follow the instructions at http://pytorch.org/ to install with miniconda instead.\r\n\r\n\r\n    ----------------------------------------\r\nCommand ""python setup.py egg_info"" failed with error code 1 in C:\\Users\\qiucy\\AppData\\Local\\Temp\\pip-install-xstv3999\\torch\\\r\n', '\r\nimport torchvision\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\nModuleNotFoundError: No module named \'torchvision\'\r\n']"
523,10807,0,"[caffe2] libcaffe2.soÔºöonnx_c2::GetEmptyStringAlreadyInited[abi:cxx11]  undefined reference. I build caffe2 with origin caffe2 + ubuntu16.04 + anaconda3, the cmake summary is : 

-- ******** Summary ********
-- General:
--   CMake version         : 3.6.3
--   CMake command         : /home/hengshan/.conda/envs/caffe2_py2/bin/cmake
--   Git version           : v0.8.1-1502-g3c9081d-dirty
--   System                : Linux
--   C++ compiler          : /usr/bin/c++
--   C++ compiler version  : 5.4.0
--   BLAS                  : Eigen
--   CXX flags             :  -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_c2 -O2 -fPIC -Wno-narrowing -Wno-invalid-partial-specialization
--   Build type            : Release
--   Compile definitions   : 
--   BUILD_BINARY          : ON
--   BUILD_CUSTOM_PROTOBUF : OFF
--     Protobuf compiler   : 
--     Protobuf includes   : 
--     Protobuf libraries  : 
--   BUILD_DOCS            : OFF
--   BUILD_PYTHON          : ON
--     Python version      : 2.7.13
--     Python includes     : /home/hengshan/.conda/envs/caffe2_py2/include/python2.7
--   BUILD_SHARED_LIBS     : ON
--   BUILD_TEST            : ON
--   USE_ATEN              : OFF
--   USE_ASAN              : OFF
--   USE_CUDA              : ON
--     CUDA version        : 8.0
--     CuDNN version       : 6.0.21
--     CUDA root directory : /usr/local/cuda-8.0
--     CUDA library        : /usr/lib/x86_64-linux-gnu/libcuda.so
--     CUDA NVRTC library  : /usr/local/lib/libnvrtc.so
--     CUDA runtime library: /usr/local/cuda-8.0/lib64/libcudart.so
--     CUDA include path   : /usr/local/cuda-8.0/include
--     NVCC executable     : /usr/local/cuda-8.0/bin/nvcc
--     CUDA host compiler  : /usr/bin/cc
--   USE_EIGEN_FOR_BLAS    : 1
--   USE_FFMPEG            : ON
--   USE_GFLAGS            : ON
--   USE_GLOG              : ON
--   USE_GLOO              : ON
--   USE_LEVELDB           : ON
--     LevelDB version     : 1.18
--     Snappy version      : 1.1.3
--   USE_LITE_PROTO        : OFF
--   USE_LMDB              : ON
--     LMDB version        : 0.9.17
--   USE_METAL             : OFF
--   USE_MKL               : 
--   USE_MOBILE_OPENGL     : OFF
--   USE_MPI               : ON
--   USE_NCCL              : ON
--   USE_NERVANA_GPU       : OFF
--   USE_NNPACK            : ON
--   USE_OBSERVERS         : ON
--   USE_OPENCV            : ON
--     OpenCV version      : 3.3.0
--   USE_OPENMP            : OFF
--   USE_PROF              : OFF
--   USE_REDIS             : OFF
--   USE_ROCKSDB           : OFF
--   USE_ZMQ               : OFF
-- Configuring done
-- Generating done

the error is : 
../lib/libcaffe2.soÔºöÂØπ‚Äòonnx_c2::GetEmptyStringAlreadyInited[abi:cxx11]()‚ÄôÊú™ÂÆö‰πâÁöÑÂºïÁî®
collect2: error: ld returned 1 exit status
caffe2/CMakeFiles/logging_test.dir/build.make:117: recipe for target 'bin/logging_test' failed
make[2]: *** [bin/logging_test] Error 1
CMakeFiles/Makefile2:1346: recipe for target 'caffe2/CMakeFiles/logging_test.dir/all' failed
make[1]: *** [caffe2/CMakeFiles/logging_test.dir/all] Error 2
../lib/libcaffe2.soÔºöÂØπ‚Äòonnx_c2::GetEmptyStringAlreadyInited[abi:cxx11]()‚ÄôÊú™ÂÆö‰πâÁöÑÂºïÁî®
collect2: error: ld returned 1 exit status

. []"
58,21828,1,"torch::zeros is slow for small tensors (C++). ## üêõ Bug

For small 1d tensors (smaller than about 4000), setting each element to zero with an accessor is faster than using make_zeros.

Benchmarking code (uses https://github.com/google/benchmark):



And here are the results:


As you can see, for small 1d tensors make_zero is sometime almost 3x slower than using an accessor. For 2d tensors, make_zeros is still slower for very small tensors.

## Environment
PyTorch version: 1.1.0a0+de582e2
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.2 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: version 3.14.0

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 10.0.130
GPU models and configuration: GPU 0: GeForce GTX TITAN X
Nvidia driver version: 418.56
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.21
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.5.1

Versions of relevant libraries:
[pip3] numpy==1.13.3
[conda] _tflow_select             2.3.0                       mkl  
[conda] blas                      1.0                         mkl  
[conda] magma-cuda10              2.4.0                         1    cpbotha
[conda] mkl                       2019.3                      199  
[conda] mkl-include               2019.3                      199  
[conda] mkl_fft                   1.0.12           py37ha843d7b_0  
[conda] mkl_random                1.0.2            py37hd81dba3_0  
[conda] mkldnn                    0.16.1                        0    mingfeima
[conda] tensorflow                1.13.1          mkl_py37h54b294f_0  
[conda] tensorflow-base           1.13.1          mkl_py37h7ce6ba3_0  
[conda] torch                     1.1.0a0+de582e2          pypi_0    pypi
. ['\r\n#pragma clang diagnostic push\r\n#pragma ide diagnostic ignored ""cert-err58-cpp""\r\n\r\n#include <benchmark/benchmark.h>\r\n#include <torch/torch.h>\r\n\r\nstatic void BM_AccessorZero2d(benchmark::State& state) {\r\n  auto options = torch::TensorOptions().dtype(torch::kFloat32);\r\n\r\n  for(auto _ : state) {\r\n    auto empty = torch::empty({state.range(0), state.range(0)}, options);\r\n    auto accessor = empty.accessor<float, 2>();\r\n    for(int i = 0; i < state.range(0); ++i) {\r\n      for(int j = 0; j < state.range(0); ++j) {\r\n        accessor[i][j] = 0;\r\n      }\r\n    }\r\n  }\r\n}\r\nBENCHMARK(BM_AccessorZero2d)->Range(1, 50000);\r\n\r\nstatic void BM_MakeZeros2d(benchmark::State& state) {\r\n  auto options = torch::TensorOptions().dtype(torch::kFloat32);\r\n\r\n  for (auto _ : state) {\r\n    torch::zeros({state.range(0), state.range(0)}, options);\r\n  }\r\n}\r\nBENCHMARK(BM_MakeZeros2d)->Range(1, 50000);\r\n\r\nstatic void BM_AccessorZero(benchmark::State& state) {\r\n  auto options = torch::TensorOptions().dtype(torch::kFloat32);\r\n\r\n  for (auto _ : state) {\r\n    auto empty = torch::empty({state.range(0)}, options);\r\n    auto accessor = empty.accessor<float, 1>();\r\n    for(int i=0; i<state.range(0); ++i) {\r\n      accessor[i] = 0;\r\n    }\r\n  }\r\n}\r\nBENCHMARK(BM_AccessorZero)->Range(1, 50000);\r\n\r\nstatic void BM_MakeZeros(benchmark::State& state) {\r\n  auto options = torch::TensorOptions().dtype(torch::kFloat32);\r\n\r\n  for (auto _ : state) {\r\n    torch::zeros({state.range(0)}, options);\r\n  }\r\n}\r\nBENCHMARK(BM_MakeZeros)->Range(1, 50000);\r\n\r\nBENCHMARK_MAIN();\r\n#pragma clang diagnostic pop\r\n', '\r\nResults:\r\nRun on (12 X 3600 MHz CPU s)\r\nCPU Caches:\r\n  L1 Data 32K (x6)\r\n  L1 Instruction 32K (x6)\r\n  L2 Unified 256K (x6)\r\n  L3 Unified 15360K (x1)\r\nLoad Average: 1.03, 1.64, 2.00\r\n------------------------------------------------------------------\r\nBenchmark                        Time             CPU   Iterations\r\n------------------------------------------------------------------\r\nBM_AccessorZero2d/1            559 ns          559 ns      1221153\r\nBM_AccessorZero2d/8            614 ns          614 ns      1154875\r\nBM_AccessorZero2d/64          2404 ns         2404 ns       290513\r\nBM_AccessorZero2d/512        88699 ns        88698 ns         7957\r\nBM_AccessorZero2d/4096    27946856 ns     27947340 ns           25\r\nBM_AccessorZero2d/32768 1799065774 ns   1799064893 ns            1\r\nBM_AccessorZero2d/50000 4031161980 ns   4031154712 ns            1\r\nBM_MakeZeros2d/1              1503 ns         1503 ns       466054\r\nBM_MakeZeros2d/8              1492 ns         1492 ns       459766\r\nBM_MakeZeros2d/64             1936 ns         1936 ns       358106\r\nBM_MakeZeros2d/512           11142 ns        10945 ns        71892\r\nBM_MakeZeros2d/4096        7404616 ns      7116580 ns           99\r\nBM_MakeZeros2d/32768     388659886 ns    374048021 ns            2\r\nBM_MakeZeros2d/50000     839755289 ns    818242038 ns            1\r\nBM_AccessorZero/1              578 ns          578 ns      1220794\r\nBM_AccessorZero/8              575 ns          575 ns      1186077\r\nBM_AccessorZero/64             620 ns          620 ns      1113125\r\nBM_AccessorZero/512            781 ns          781 ns       914935\r\nBM_AccessorZero/4096          1853 ns         1853 ns       386530\r\nBM_AccessorZero/32768        10718 ns        10719 ns        66042\r\nBM_AccessorZero/50000        16424 ns        16424 ns        42340\r\nBM_MakeZeros/1                1491 ns         1491 ns       451186\r\nBM_MakeZeros/8                1458 ns         1458 ns       479606\r\nBM_MakeZeros/64               1465 ns         1465 ns       473993\r\nBM_MakeZeros/512              1539 ns         1539 ns       455206\r\nBM_MakeZeros/4096             1933 ns         1933 ns       358675\r\nBM_MakeZeros/32768            5305 ns         5305 ns       134382\r\nBM_MakeZeros/50000            7662 ns         7662 ns        90926\r\n']"
333,10714,0,"[feature request][caffe2] extend FC/FCTranspose op to handle 2d bias.. Currently, FC/FCTranspose only accepts 1d bias. The FC's implementation will do the broadcast to create the 2d bias from 1d bias, but we could just provide the whole 2d bias. Then, we can do the better optimization for onnx Gemm op with caffe2 backend.

I will try to implement this idea and create a pull request later.

@houseroad @bddppq 
. []"
549,6194,0,"Import order matters: segmentation fault if torch is imported first. I have a couple of packages that I import in my project. Obviously, one of them is . I noticed that if I import  after only one of my other packages things are fine. However, if I import  first I get a segmentation fault. I'm not picky about importing the other module first and then do  but for some reason, I need to import torch first in my work and this has made things a bit complicated for me. I wonder, is this a Python issue or could it be  issue or maybe the other package (bpy) issue? Does anyone know how I can figure out what is causing the segmentation fault?. []"
585,17465,0,"The source code for conv2d. Hi, I wanna to do some work about the conv2d, but the release did not make the source code of con2d available.  What should I do to approach the conv2d?

## ‚ùì Questions and Help

### Please note that this issue tracker is not a help form and this issue will be closed.

We have a set of [listed resources available on the website](https://pytorch.org/resources). Our primary means of support is our discussion forum:

- [Discussion Forum](https://discuss.pytorch.org/)
. []"
126,4115,0,"Feature Request : Alias Multinomial. Would you be interested in extending the alias multinomial sampling to pytorch. The C and the CUDA version are already present in [](https://github.com/torch/torch7/blob/aed31711c6b8846b8337a263a7f9f998697994e7/doc/maths.md#res-torchmultinomialaliasoutput-state) (linked)
I believe it could be very useful for people who want to use multinomial sampling from a static distribution.. []"
511,27690,0,"Multi-GPU Gather is much slower than Scatter. ## üêõ Bug

Multi-GPU gathering is much slower than scattering

## To Reproduce
Can run the following script on a Multi-GPU machine which should replicate the issue. It creates a large tensor on the CPU and scatters it to multiple GPUs, then also creates large I have tested with both pytorch 1.1.0 and pytorch 1.2.0.


Output: 
Note that when batch size (args.sz) = 128, the tensor to be scattered/gathered is 1GiB.

| NGpus        | batch size           | Scatter Time (s)  |  Gather Time (s) |
| ------------- |:-------------:| -----:|---:|
| 2 | 64 |  0.07 | 0.35 |
| 2 | 128 | 0.14 | 0.7 |
| 2 | 256 | 0.27 | 1.4 |
| 4     | 64   | 0.12 | 0.35 |
| 4 | 128   |  0.16 | 0.7 |
| 4 | 256 | 0.29 | 1.6 |

## Expected behavior

I would expect the scatter and gather timings to be a lot closer than this, not a factor of 5 out.

## Environment

. ['python\r\n# coding: utf-8\r\nimport time\r\n# import py3nvml\r\nimport torch\r\nfrom torch.nn.parallel._functions import Scatter, Gather\r\nimport argparse\r\n\r\n\r\nN = 3\r\n\r\nparser = argparse.ArgumentParser(description=\'Test scatter gather\')\r\nparser.add_argument(\'--sz\', type=int, default=128, help=\'Batch size\')\r\nparser.add_argument(\'--Ngpus\', type=int, default=4, help=\'Batch size\')\r\n\r\nargs = parser.parse_args()\r\n# Set CUDA_VISIBLE_DEVICES \r\n# py3nvml.grab_gpus(args.Ngpus)\r\n\r\n# Create data so all gpus have been used once\r\ncpu = -1\r\ndevs = [torch.device(\'cuda:{}\'.format(i)) for i in range(args.Ngpus)]\r\nx_cpu = torch.randn(args.sz, 128, 128, 128)\r\nfor i in range(args.Ngpus):\r\n    y_gpu = torch.randn(args.sz, 128, 128, 128, device=devs[i])\r\n\r\ncpu_to_gpu = 0\r\nfor i in range(N):\r\n    x_cpu = torch.randn(args.sz, 128, 128, 128)\r\n\r\n    start = time.time()\r\n    out_list = Scatter.apply(devs, None, 0, x_cpu)\r\n    for i in range(args.Ngpus):\r\n        torch.cuda.synchronize(device=devs[i])\r\n    end = time.time()\r\n\r\n    cpu_to_gpu += (end-start)\r\n\r\nprint(""Scattering CPU to GPU takes {:.2f}s"".format(cpu_to_gpu/N))\r\ngpu_to_cpu = 0\r\nfor i in range(N):\r\n    y = [torch.randn(args.sz//args.Ngpus, 128, 128, 128, device=dev) for dev in devs]\r\n\r\n    start = time.time()\r\n    Gather.apply(cpu, 0, *y)\r\n    for i in range(args.Ngpus):\r\n        torch.cuda.synchronize(device=devs[i])\r\n    end = time.time()\r\n\r\n    gpu_to_cpu += (end-start)\r\n\r\nprint(""Gathering GPU to CPU takes {:.2f}s"".format(gpu_to_cpu/N))\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.2.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 16.04.6 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: \r\nGPU 0: GeForce GTX 1080\r\nGPU 1: GeForce GTX 1080\r\nGPU 2: GeForce GTX 1080\r\nGPU 3: GeForce GTX 1080\r\nGPU 4: GeForce GTX 1080\r\nGPU 5: GeForce GTX 1080\r\nGPU 6: GeForce GTX 1080\r\nGPU 7: GeForce GTX 1080\r\n\r\nNvidia driver version: 418.67\r\ncuDNN version: Probably one of the following:\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.5.1.10\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.1\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.17.2\r\n[pip3] torch==1.2.0\r\n[conda] Could not collect\r\n']"
479,24093,0,"pytorch forced to use cuda 10 after new update. ## üêõ Bug
When installing pytorch with conda in a new environment, it always installs compiled with the cuda version 10 and cudatoolkit=10.0. Whether I conda install pytorch 1.2, 1.1, 1.0.1, or 1.0 with cuda90 it always tries to install the cuda 10 version of the package as well as cudatoolkit=10.0. This is via the pytorch conda channel. My machine has an older driver version that can't easily be upgraded. I also tried pip installing from https://download.pytorch.org/whl/cu90/stable and it still insists on using cuda 10.

## To Reproduce
conda create --name test_env python=3.6
conda activate test_env
conda install pytorch=1.1 cuda90 -c pytorch
conda list

In python when you run torch.version.cuda it also lists cuda 10.

The following NEW packages will be INSTALLED:

    blas:           1.0-mkl
    cffi:           1.12.3-py36h2e261b9_0
    cuda90:         1.0-h6433d27_0                        pytorch
    cudatoolkit:    10.0.130-0
    intel-openmp:   2019.4-243
    libgfortran-ng: 7.3.0-hdf63c60_0
    mkl:            2019.4-243
    mkl_fft:        1.0.12-py36ha843d7b_0
    mkl_random:     1.0.2-py36hd81dba3_0
    ninja:          1.9.0-py36hfd86e86_0
    numpy:          1.16.4-py36h7e9f1db_0
    numpy-base:     1.16.4-py36hde5b4d6_0
    pycparser:      2.19-py36_0
    pytorch:        1.1.0-py3.6_cuda10.0.130_cudnn7.5.1_0 pytorch

Proceed ([y]/n)? n

## Expected behavior

Should be able to select the cuda version.

## Environment

Collecting environment information...
PyTorch version: N/A
Is debug build: N/A
CUDA used to build PyTorch: N/A

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: N/A
CUDA runtime version: Could not collect
GPU models and configuration:
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN Xp

Nvidia driver version: 390.67
cuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.3

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect

. []"
664,6131,0,"Build picks up wrong copy of mkl when multiple available. @aosokin reports from https://github.com/pytorch/pytorch/issues/6068#issuecomment-377226963

There might be another related issue with dependencies.
When doing import torch from an anaconda env pytorch uses mkl (libmkl_gf_lp64.so) installed in anaconda root.
Consequently, if the root and the env have different versions (in my case the root had 2018.0.1 and the env had 2018.0.2-1) I was getting this error:



Updating mkl in anaconda root to 2018.0.2-1 solved the problem.. ['\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""/home/aosokin/local/software/anaconda3/envs/pytorch-master/lib/python3.6/site-packages/torch/__init__.py"", line 78, in <module>\r\n    from torch._C import *\r\nImportError: /home/aosokin/local/software/anaconda3/lib/libmkl_gf_lp64.so: undefined symbol: mkl_lapack_ao_zgetrf\r\n']"
422,22298,0,"[c++] Can't use Sequential inside Sequential . Hi. I was implementing MNASNet for C++ side in torchvision and I ran into this problem. apparently using  inside  is not possible. Here is the minimal code:



@yf225 Can you have a look?. ['nn::Sequential', 'nn::Sequential', '\r\ntorch::nn::Sequential layers;\r\nauto S = torch::nn::Sequential();\r\nlayers->push_back(S);\r\n']"
209,15676,0,"Tests for Vec256 classes. ## üöÄ Feature
We should have tests in C++ for the Vec256 classes.

## Motivation
Currently, the Vec256 code is only tested indirectly through operators that use it. This has led to insufficient test coverage and a number of recent bugs in Vec256 and the operators that use it. We should add sufficient test infrastructure so that we can easily add test cases for new functions on Vec256. It's important that the tests cover the different data types (float, double, int32, int64, etc.) and instruction sets (generic, avx, avx2).

This will require changes to CMake since the current test cases don't enable the AVX/AVX2 instruction sets.

cc @VitalyFedyunin. []"
166,4673,0,"GPU memory consumption with cudnn.enabled = False. 
According to this code, difference in used GPU memory  before and after convolution is  4809 MB - 1345 MB = 3.5 GB . This is too much since *inp* is just 536MB and *embed0* is 134 MB. From my experiments this issue is fixed if i delete nn.BatchNorm2d block.

What can be the reason for this strange behavior? 

PS: I turned off CUDNN to avoid another bug with ConvTranspose3d  [#4344]

Pyton2.7, PyTorch 0.3 (pip),  CUDA 8, CUDNN 7
. [""\r\nimport torch as th \r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\nimport subprocess\r\nimport torch.backends.cudnn as cudnn\r\ncudnn.enabled = False\r\n\r\ndef get_gpu_memory_map():\r\n    \r\n    result = subprocess.check_output(\r\n        [\r\n            'nvidia-smi', '--query-gpu=memory.used',\r\n            '--format=csv,nounits,noheader'\r\n        ])\r\n\r\n    gpu_memory = [int(x) for x in result.strip().split('\\n')]\r\n    gpu_memory_map = dict(zip(range(len(gpu_memory)), gpu_memory))\r\n    \r\n    return gpu_memory_map\r\n\r\ndef conv2D_block(in_channels, out_channels, kernel_size=3, stride=1):\r\n    padding = kernel_size//2\r\n    return nn.Sequential(nn.Conv2d(in_channels, out_channels, kernel_size=kernel_size, stride=stride, padding=padding),\r\n                         nn.LeakyReLU(negative_slope=0.1, inplace=True),\r\n                         nn.BatchNorm2d(out_channels))\r\n\r\ndownsample0 = conv2D_block(in_channels=64, out_channels=64, kernel_size=5, stride=2)\r\ndownsample0.float().cuda()\r\ndownsample0.eval()\r\n\r\ninp = Variable(th.rand(1, 64, 3000/2, 3000/2).float().cuda(), volatile=True)\r\nprint 'before', get_gpu_memory_map()\r\nembed0 = downsample0(inp);  th.cuda.empty_cache() \r\nprint 'after downsample0', get_gpu_memory_map()   \r\n""]"
5,28198,1,"DLRM performance regression on #26963. ## üêõ DLRM performance regression

<!-- A clear and concise description of what the bug is. -->
This check-in cause a little regression on the [DLRM](https://github.com/facebookresearch/dlrm) benchmark.

Without this check-in the DLRM benchmark result is like:

with this check-in , the result is like:


The profiling data show that there are some time increased in the 
 ,  and  operations

|                 | This      | Before    |
|-----------------|----------:|----------:|
|   | 1559.31ms | 1503.48ms |
|             | 27.14ms   |   14.58ms |
|          | 22.38ms   | 9.79966ms |


## To Reproduce

Steps to reproduce the behavior:

1. Download the DLRM from https://github.com/facebookresearch/dlrm
1. Modify the bench/dlrm_s_benchmark.sh to just run pytorch on cpu version, as
     build=0
     cpu=1
     gpu=0
     pt=1
     c2=0
   And export two KMP variables as
    export KMP_BLOCKTIME=1
    export KMP_AFFINITY=""granularity=fine,compact,1,0""
1. Run bench/dlrm_s_benchmark.sh on SKX8180 machine. performance profiling data is stored at file model1_CPU_PT_28.prof
     'This' is got from commit-id: d0a4b2f586e0901c3c65f1f0e0bae15364e28821
     'Before' is got from commit-id: 42e7eb0426190e07339f03d4e6afb61b7ff5ae9c
<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->
The DLRM performance has no impacted, Thanks 

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): commit-id: d0a4b2f586e0901c3c65f1f0e0bae15364e28821
 - OS (e.g., Linux): Ubuntu 16.04.5 LTS
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source): python setup.py install
 - Python version: 3.7
 - CUDA/cuDNN version: N/A
 - GPU models and configuration: N/A
 - Any other relevant information:
   GCC version: (Ubuntu 8.3.0-16ubuntu3~16.04) 8.3.0
   CMake version: version 3.14.4

    [pip3] numpy==1.16.2
    [pip3] numpydoc==0.8.0
    [conda] blas                      1.0                         mkl
    [conda] mkl                       2019.0                   pypi_0    pypi
    [conda] mkl-devel                 2019.3                      200
    [conda] mkl-include               2019.0                   pypi_0    pypi
    [conda] mkl-service               1.1.2            py37he904b0f_5
    [conda] mkl_fft                   1.0.10           py37ha843d7b_0
    [conda] mkl_random                1.0.2            py37hd81dba3_0

## Additional context

<!-- Add any other context about the problem here. -->


cc @ezyang @gchanan @zou3519 @jerryzh168. ['\r\nnumactl --physcpubind=0-27 -m 0 python dlrm_s_pytorch.py --mini-batch-size=2048 --num-batches=100 --data-generation=random --arch-mlp-bot=512-512-64 --arch-mlp-top=1024-1024-1024-1 --arch-sparse-feature-size=64 --arch-embedding-size=1000000-1000000-1000000-1000000-1000000-1000000-1000000-1000000 --num-indices-per-lookup=100 --arch-interaction-op=dot --numpy-rand-seed=727 --print-freq=100 --print-time --enable-profiling > model1_CPU_PT_28.log\r\nMin time per iteration = 3591.85\r\n', '\r\nnumactl --physcpubind=0-27 -m 0 python dlrm_s_pytorch.py --mini-batch-size=2048 --num-batches=100 --data-generation=random --arch-mlp-bot=512-512-64 --arch-mlp-top=1024-1024-1024-1 --arch-sparse-feature-size=64 --arch-embedding-size=1000000-1000000-1000000-1000000-1000000-1000000-1000000-1000000 --num-indices-per-lookup=100 --arch-interaction-op=dot --numpy-rand-seed=727 --print-freq=100 --print-time --enable-profiling > model1_CPU_PT_28.log\r\nMin time per iteration = 3649.57\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
506,5066,0,"Import Error after updating to 0.3. I tried to update pytorch from 0.2 to 0.3.

The update itself is fine, but when I run the codes, it raises this exception:

CXXABI_1.3.8' not found (required by /home/sliu426/anaconda2/lib/python2.7/site-packages/rdkit/Chem/../../../../././libicui18n.so.58)

import torch
from rdkit import Chem
pip install pytorch`, I guess the installation changes some paths. So I simply switch these two lines of codes and it works well for now:


The solution is a little tricky, and I'm wondering if there's a better one?. ['\r\n\r\nAnd here is my code:\r\n', '\r\nfrom rdkit import Chem\r\nimport torch\r\n']"
51,27946,1,"torch.mean() is imprecise for very large Tensors. ## üêõ Bug

. [""\r\n>>> torch.__version__\r\n'1.3.0'\r\n>>> torch.rand(6000000000).mean()\r\ntensor(0.5000)\r\n>>> torch.rand(6500000000).mean()\r\ntensor(0.4956)\r\n>>> torch.rand(8000000000).mean()\r\ntensor(0.4027)\r\n""]"
208,2470,0,"var(dim) and std(dim) are broken for FloatTensor. It seems like  and  are broken on version 0.2.0.1. Please note that you need to pass in the  argument to reproduce this bug. The parameterless  and  are working correctly.

For example:
. ['python\r\nimport torch\r\ntensor = torch.FloatTensor([2281.5, 2281.25])\r\ntensor.var(0) # => 0\r\ntensor.var()  # => 0.03125\r\n']"
740,6655,0,"cannot load forum. cannot load forum,  the error code is ERR_TIMED_OUT
I get 300ms when ping discuss.pytorch.org
I use Chrome on Win10-64
. []"
405,11989,0,"RuntimeError: CUDA error: unknown error. ## Issue description
I upgrade CUDA from 8.0 to 9.0, and reinstall cudnn and pytorch.
Then following error happen:
RuntimeError: CUDA error: unknown error

## Code example


Traceback (most recent call last):
  File ""example.py"", line 3, in <module>
    x = torch.tensor([1., 2.], device=device)
RuntimeError: CUDA error: unknown error

## System Info
Collecting environment information...
PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: GPU 0: TITAN Xp
Nvidia driver version: 384.130
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.0
/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect
. [""\r\nimport torch\r\ndevice = torch.device('cuda')\r\nx = torch.tensor([1., 2.], device=device)\r\n""]"
268,7214,0,"Do not put system paths in RPATH. This is what I'm seeing today:


Paths  and  were taken from the build environment, but they do not belong in RPATH since those paths are not shipped with the application. Those paths may contain versions of DT_NEEDED libraries that you do not want to use with pytorch, however RPATH has precedence over everything else, so those libraries will get picked, and there is no way around that.

For example, let's say libcublas provided in   is not the version I want since it's too old, I have a newest version in , but I have no way to point to it since  will be ignored.

Caused by: https://github.com/pytorch/pytorch/pull/3255 (for )



cc @malfet @seemethere @walterddr. ['\r\n$ readelf -d /opt/conda/envs/pytorch-py3.6/lib/python3.6/site-packages/torch/_nvrtc.cpython-36m-x86_64-linux-gnu.so | grep RPATH\r\n 0x000000000000000f (RPATH)              Library rpath: [/opt/conda/envs/pytorch-py3.6/lib:/usr/lib/x86_64-linux-gnu/:/usr/local/cuda/lib64:$ORIGIN/lib]\r\n']"
152,6111,0,"Report bug script. In our issue submission checklist, we collect a lot of information that can be gotten mechanically. We should have a simple way of collecting this info as a script and uploading it to GitHub.. []"
218,20029,0,"RuntimeError:CUDA Error:out of memory. ## üêõ Bug
 With a CUDA 10.1 and RTX GPU. 
When I try even the most simpliest code like
nums = torch.randn(2,2).cuda(), it show the above error
And torch.cuda.is_available() is True.
Any idea?. []"
553,15066,0,[docs] Delete ffi documentation. there's still a page on it: https://pytorch.org/docs/master/ffi.html?highlight=ffi. []
364,26646,0,"[RFC] Drop Windows CUDA 9.2 support. @peterjc123 and I propose that we drop CUDA 9.2 binary build support for Windows, meaning that we only provide CUDA 10.1 binaries for Windows. Here is our reasoning:

* We strongly prefer to have a single CI provider on which we build all binaries. At the moment, CircleCI is that provider; however, it only supports a single Visual Studio version, that is too new for CUDA 9.2. To run CUDA 9.2 builds on CircleCI, we would have to install both CUDA 9.2 (they provide CUDA 10.1) but also an older version of MSVC which is compatible with CUDA 9.2.
* To workaround this for CUDA 9.2 builds today, we currently do these builds on Azure. However, the agents provided by Microsoft to build nightlies are facing problems, and the release of GitHub Actions has tied up most of the resources available to resolve these problems.

We will not drop from-source support for CUDA 9.2; users are always welcome to build from source if they need this configuration. However, building from source on Windows is quite painful, and @peterjc123 is concerned for LibTorch users, where we rely on the user's environment (as opposed to packaging CUDA for them).

If you are a Windows CUDA 9.2 user that would be unduly affected by this change, please comment on this issue. Thank you!

cc @ezyang @peterjc123. []"
718,3064,0,"double backward for Conv2d failing with CUDNN_STATUS_NOT_SUPPORTED. Reported at https://discuss.pytorch.org/t/cudnn-status-not-supported-error-occurs-when-apply-autograd-grad-to-compute-high-order-differentiation/8256

. [""python\r\nimport torch\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable, grad\r\nimport torch.utils.data as Data\r\nimport torchvision\r\n\r\ntrain_data = torchvision.datasets.MNIST(\r\n    root='./mnist/',\r\n    train=True,\r\n    transform=torchvision.transforms.ToTensor(),\r\n    download=True,\r\n)\r\n\r\ntrain_loader = Data.DataLoader(\r\n    dataset=train_data, batch_size=50, shuffle=True, num_workers=2)\r\n\r\n\r\nclass CNN(nn.Module):\r\n    def __init__(self):\r\n        super(CNN, self).__init__()\r\n        self.conv1 = nn.Sequential(nn.Conv2d(1, 16, 5, 1, 2))\r\n        self.out = nn.Linear(16 * 28 * 28, 10)\r\n\r\n    def forward(self, x):\r\n        x = self.conv1(x)\r\n        x = x.view(x.size(0), -1)\r\n        output = self.out(x)\r\n        return output, x\r\n\r\n\r\ncnn = CNN()\r\ncnn.cuda()\r\n\r\nloss_func = nn.CrossEntropyLoss()\r\n\r\nfor step, (data, label) in enumerate(train_loader):\r\n    input = Variable(data).cuda()\r\n    target = Variable(label).cuda()\r\n\r\n    output = cnn(input)[0]\r\n    loss = loss_func(output, target)\r\n\r\n    params = cnn.parameters()\r\n    g = grad(loss, params, create_graph=True)\r\n\r\n    g_sum = 0\r\n    for g_para in g:\r\n        g_sum += g_para.sum()\r\n\r\n    params = cnn.parameters()\r\n    hv = grad(g_sum, params, create_graph=True)\r\n\r\n    break\r\n""]"
684,5285,0,"[Bug] Memory leak on Convnet on CPU. - OS: Ubuntu 16.04
- PyTorch version: 0.3.1b0+2b47480
- How you installed PyTorch (conda, pip, source): source
- Python version: 3.6.4
- CUDA/cuDNN version: CUDA 9.0/CuDnn 7
- GPU models and configuration: GTX 1080Ti (as well as GTX 1070)
- GCC version (if compiling from source): gcc (Ubuntu 5.4.0-6ubuntu1~16.04.6) 5.4.0 20160609

Hello,
While implementing the [SRGan paper](https://arxiv.org/abs/1609.04802) I ran into a memory leak issue while doing the inference on my CPU.
This issue should be easily reproductible from your side as my implementation is [here](https://github.com/EKami/Torchlight/tree/showcase/memory-leak). All you have to do is to clone the repository with , cd into the  folder then run the script with  to run the inference on the cpu. Then you should get a memory leak with the following message:

If you run the same script but with  (defaults on cuda) then the memory leak vanishes. The exact line which cause the memory leak is [this one](https://github.com/EKami/Torchlight/blob/showcase/memory-leak/torchlight/nn/models/srgan.py#L42). Remove that line to get:

and execute the script on the cpu again with  and poof the memory leak vanishes.
I tried on 2 different computer each with the same software installed but for the hardware one has:
 - AMD FX 8350
 - GTX 1070
The second:
 - Intel i7 7700k
 - GTX 1080Ti

And I get the same memory leak on both machines.. ['\r\nRuntimeError: $ Torch: not enough memory: you tried to allocate 116GB. Buy new RAM!\r\n', '\r\n        block_x2 = self.block_x2(block1 + block_x1)  # ElementWise sum\r\n\r\n        # TODO causes a memory leak on CPU\r\n        # block_x3 = self.block_x3(block_x2)\r\n\r\n        return (F.tanh(block_x2) + 1) / 2\r\n']"
61,17745,1,"distributed data parallel, gloo backend works, but nccl deadlock. I have run into the same problem as #14870 .  Because I cannot reopen the issue, I opened a new issue. But the GPUs are all empty, except that 11MB memory is used (no process running). 

The code is easy to reproduce:
Nmax_utilizationmax_utilizationmax_memory_usageN_per_processmax_utilizationmax_memory_usage
it hangs.

But it works fine with .. ['\r\n\r\nAfter printing \r\n']"
137,14954,0,"undefined reference to `vmdLog2'  . 

## Issue description

/data1/bryanleoliu/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp: In member function ‚Äòc10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&)‚Äô:
/data1/bryanleoliu/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp:445:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   if (vec.size() != cacheNumAlgorithmEntries_) {
                     ^
[ 42%] Linking CXX static library libc10d.a
[ 42%] Built target c10d
[ 47%] Building NVCC (Device) object test/CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o
Scanning dependencies of target ProcessGroupMPITest
Scanning dependencies of target TCPStoreTest
Scanning dependencies of target FileStoreTest
[ 52%] Building CXX object test/CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o
[ 57%] Building CXX object test/CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o
[ 61%] Building CXX object test/CMakeFiles/ProcessGroupMPITest.dir/ProcessGroupMPITest.cpp.o
[ 66%] Linking CXX executable FileStoreTest
/data1/bryanleoliu/pytorch/torch/lib/c10d/test/ProcessGroupMPITest.cpp: In function ‚Äòvoid testAllreduce(int)‚Äô:
/data1/bryanleoliu/pytorch/torch/lib/c10d/test/ProcessGroupMPITest.cpp:19:57: warning: ‚Äòat::Tensor at::ones(const at::Type&, at::IntList)‚Äô is deprecated (declared at /data1/bryanleoliu/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:3936) [-Wdeprecated-declarations]
     auto tensor = at::ones(at::CPU(at::kFloat), {16, 16}) * i;
                                                         ^
/data1/bryanleoliu/pytorch/torch/lib/c10d/test/ProcessGroupMPITest.cpp: In function ‚Äòvoid testBroadcast(int)‚Äô:
/data1/bryanleoliu/pytorch/torch/lib/c10d/test/ProcessGroupMPITest.cpp:61:59: warning: ‚Äòat::Tensor at::ones(const at::Type&, at::IntList)‚Äô is deprecated (declared at /data1/bryanleoliu/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:3936) [-Wdeprecated-declarations]
       auto tensor = at::ones(at::CPU(at::kFloat), {16, 16}) * i;
                                                           ^
/data1/bryanleoliu/pytorch/torch/lib/c10d/test/ProcessGroupMPITest.cpp:64:60: warning: ‚Äòat::Tensor at::zeros(const at::Type&, at::IntList)‚Äô is deprecated (declared at /data1/bryanleoliu/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:4374) [-Wdeprecated-declarations]
       auto tensor = at::zeros(at::CPU(at::kFloat), {16, 16});
                                                            ^
/data1/bryanleoliu/pytorch/torch/lib/tmp_install/lib/libcaffe2.so: undefined reference to vmsLog2'
collect2: error: ld returned 1 exit status
make[2]: *** [test/FileStoreTest] Error 1
make[1]: *** [test/CMakeFiles/FileStoreTest.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
[ 71%] Linking CXX executable TCPStoreTest
[ 76%] Linking CXX executable ProcessGroupMPITest
/data1/bryanleoliu/pytorch/torch/lib/tmp_install/lib/libcaffe2.so: undefined reference to vmsLog2'
collect2: error: ld returned 1 exit status
make[2]: *** [test/TCPStoreTest] Error 1
make[1]: *** [test/CMakeFiles/TCPStoreTest.dir/all] Error 2
/data1/bryanleoliu/pytorch/torch/lib/tmp_install/lib/libcaffe2.so: undefined reference to vmsLog2'
collect2: error: ld returned 1 exit status
make[2]: *** [test/ProcessGroupMPITest] Error 1
make[1]: *** [test/CMakeFiles/ProcessGroupMPITest.dir/all] Error 2
Scanning dependencies of target c10d_cuda_test
[ 80%] Linking CXX static library libc10d_cuda_test.a
[ 80%] Built target c10d_cuda_test
make: *** [all] Error 2
Failed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'




## System Info

`

- PyTorch or Caffe2:Pytorch
- How you installed PyTorch (conda, pip, source): source 
- Build command you used (if compiling from source):python setup.py install
- OS: centos 7
- PyTorch version:0.4.1
- Python version:3.6
- CUDA/cuDNN version: 9.0/7.3
- GPU models and configuration: 8 nvidia p40
- GCC version (if compiling from source):4.8.5
- CMake version:3.12.0
- Versions of any other relevant libraries: 


cc @malfet. []"
345,20165,0,"torch.nn.threshold cannot accept tensor as a threshold. ## üöÄ Feature
I think it will be useful if we can pass threshold as a tensor to the threshold function. in this way we can compute the backprop of the threshold tensor and use it in training process.

right now the threshold function just takes non-tensor threshold. []"
579,17048,0,"Can not subclass `subclass torch.multiprocessing.Pool()`. ## üêõ Bug

Trying to subclass:

Ends up with:


This does makes sense, as it is not possible to subclass python's  as well - but only .  
 is **not** a type, but rather a context method:


The main problem is that  doesn't expose the  module - so it impossible to subclass  


This might be related to #16954 - but I don't think it's a dupe, as the main problem here is exposing the  module.

## To Reproduce

Steps to reproduce the behavior:

1. 

## Expected behavior
It should be possible to subclass torch's multiprocessing pool.

## Environment

PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04 LTS,
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: Could not collect

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: Tesla P100-PCIE-12GB
Nvidia driver version: 390.30
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.14.3
[pip3] torch==1.0.0
[pip3] torchvision==0.2.1
[conda] Could not collect. ['python\r\nclass MyPool(torch.multiprocessing.Pool):\r\n   pass\r\n', 'bash\r\nTypeError: method expected 2 arguments, got 3\r\n', 'python\r\nprint ( torch.multiprocessing.Pool)\r\n#output:\r\n<bound method BaseContext.Pool of <multiprocessing.context.DefaultContext object at 0x10f4bd550>>\r\n', ""bash\r\nAttributeError: module 'torch.multiprocessing' has no attribute 'pool'\r\n""]"
526,28639,0,"Set CUDA device is expensive operation. ## üêõ Bug

Calling cudart::cudaApiSetDevice appears to be a very expensive operation. However, as my system has only a single GPU, it is unnecessary to call it at all.

Tested on Windows.

![image](https://user-images.githubusercontent.com/61218/67546817-99188780-f740-11e9-9566-792c5eab40e4.png)


## To Reproduce

Steps to reproduce the behavior:

1. Run models with benchmarking turned on
2. Profile the application

## Expected behavior

Set device should not even be called on a single GPU device because device 0 will always be used anyway.

## Environment

 - PyTorch Version (e.g., 1.0): 1.3.0
 - OS (e.g., Linux): Windows x64 MSVC 2019
 - How you installed PyTorch (, , source): prebuilt off website
 - Build command you used (if compiling from source): N/A
 - Python version: N/A
 - CUDA/cuDNN version: 10.1/7.6
 - GPU models and configuration: GTX 2060
 - Any other relevant information:


cc @VitalyFedyunin @ngimel @mruberry. []"
613,1528,0,"LongTensor indexing with duplication not propagating gradients. It seems like if we use LongTensor indexing to duplicate entries of a Variable, this breaks autograd. Specifically, if any entry in a vector is duplicated, backward() only maintains gradients for the last copy of the element. Simple example:



However:


This is version under version 0.1.11+fc48d2c, tested on 0.1.11+9f3119a as well.  This happens for both cuda and cpu tensors.
. ['python\r\ny = Variable(torch.ones(1), requires_grad=True)\r\ny_dup = y[torch.LongTensor([0,0])]\r\ny_dup[1].backward() # backprop on second element\r\nprint(y.grad)\r\n""""""\r\nVariable containing:\r\n 1\r\n[torch.FloatTensor of size 1]""""""\r\n', 'python\r\ny = Variable(torch.ones(1), requires_grad=True)\r\ny_dup = y[torch.LongTensor([0,0])]\r\ny_dup[0].backward()  # backprop on first element, same exact value as second\r\nprint(y.grad)\r\n""""""\r\nVariable containing:\r\n 0\r\n[torch.FloatTensor of size 1]""""""\r\n']"
537,675,0,"[build/nccl] failed to build libnccl on Debian unstable. Failed to build CUDA version of pytorch (without CUDNN) with the latest source.

OS: debian unstable/experimental
Compiler: gcc-5, g++-5
CUDA: 8.0.44 (package provided by Debian)

buildlog: http://debomatic-amd64.debian.net/distribution#experimental/pytorch-contrib/0.1.7~1/buildlog



I have no idea about this .... ['\r\n-- The C compiler identification is GNU 5.4.1\r\n-- The CXX compiler identification is GNU 5.4.1\r\n-- Check for working C compiler: /usr/bin/gcc-5\r\n-- Check for working C compiler: /usr/bin/gcc-5 -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: /usr/bin/g++-5\r\n-- Check for working CXX compiler: /usr/bin/g++-5 -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Found CUDA: /usr (found suitable version ""8.0"", minimum required is ""7.0"") \r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /<<PKGBUILDDIR>>/torch/lib/build/nccl\r\nmake[2]: Entering directory \'/<<PKGBUILDDIR>>/torch/lib/build/nccl\'\r\nmake[3]: Entering directory \'/<<PKGBUILDDIR>>/torch/lib/build/nccl\'\r\nmake[4]: Entering directory \'/<<PKGBUILDDIR>>/torch/lib/build/nccl\'\r\nScanning dependencies of target nccl\r\nmake[4]: Leaving directory \'/<<PKGBUILDDIR>>/torch/lib/build/nccl\'\r\nmake[4]: Entering directory \'/<<PKGBUILDDIR>>/torch/lib/build/nccl\'\r\n[100%] Generating lib/libnccl.so\r\nmake[5]: Entering directory \'/<<PKGBUILDDIR>>/torch/lib/nccl\'\r\nls: cannot access \'/usr/lib64/libcudart.so.*\': No such file or directory\r\nls: cannot access \'/usr/lib64/libcudart.so.*\': No such file or directory\r\nGrabbing  src/nccl.h                > /<<PKGBUILDDIR>>/torch/lib/build/nccl/include/nccl.h\r\nCompiling src/libwrap.cu            > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/libwrap.o\r\nCompiling src/core.cu               > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/core.o\r\nCompiling src/all_gather.cu         > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/all_gather.o\r\nCompiling src/all_reduce.cu         > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/all_reduce.o\r\nCompiling src/broadcast.cu          > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/broadcast.o\r\nCompiling src/reduce.cu             > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/reduce.o\r\nCompiling src/reduce_scatter.cu     > /<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/reduce_scatter.o\r\nsrc/core.cu(724): error: expected an expression\r\n\r\nsrc/core.cu(724): error: expected an expression\r\n\r\n2 errors detected in the compilation of ""/tmp/tmpxft_00002c02_00000000-13_core.compute_52.cpp1.ii"".\r\nMakefile:98: recipe for target \'/<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/core.o\' failed\r\nmake[5]: *** [/<<PKGBUILDDIR>>/torch/lib/build/nccl/obj/core.o] Error 2\r\n']"
359,14366,0,"How to use model.net.Clip?. I want to clip loss using Clip op like this model.net.Clip([input,output],  0,10)  but it dosen't work!!
the Operators Catalog of caffe2 is too simple. Does anyone can help me? Thank you very much!!!. []"
136,26142,0,"TorchScript fails to compile methods with misindented comments. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Reproducer:




cc @suo. ['python\r\nimport torch\r\n\r\nclass Bug(torch.nn.Module):\r\n    def forward(self, x):\r\n        # no bug\r\n#       bug: ""IndentationError: unexpected indent""\r\n        return x\r\n\r\nf = torch.jit.script(Bug())\r\n', 'bash\r\n$ python bug.py\r\n\r\nTraceback (most recent call last):\r\n  File ""bug.py"", line 9, in <module>\r\n    f = torch.jit.script(Bug())\r\n  File ""/home/mvz/pytorch/torch/jit/__init__.py"", line 1188, in script\r\n    return torch.jit.torch.jit._recursive.recursive_script(obj)\r\n  File ""/home/mvz/pytorch/torch/jit/_recursive.py"", line 166, in recursive_script\r\n    stubs = list(map(make_stub, filtered_methods))\r\n  File ""/home/mvz/pytorch/torch/jit/_recursive.py"", line 163, in make_stub\r\n    return torch.jit.script_method(func, _jit_internal.createResolutionCallbackFromClosure(func))\r\n  File ""/home/mvz/pytorch/torch/jit/__init__.py"", line 1265, in script_method\r\n    ast = get_jit_def(fn, self_name=""ScriptModule"")\r\n  File ""/home/mvz/pytorch/torch/jit/frontend.py"", line 164, in get_jit_def\r\n    py_ast = ast.parse(dedent_src)\r\n  File ""/home/mvz/local/anaconda3/envs/ve3/lib/python3.7/ast.py"", line 35, in parse\r\n    return compile(source, filename, mode, PyCF_ONLY_AST)\r\n  File ""<unknown>"", line 1\r\n    def forward(self, x):\r\n    ^\r\nIndentationError: unexpected indent\r\n']"
690,4651,0,"distributed pytorch in cluster. How can I launch a  distributed pytorch code in the cluster which has two nodes?

Suppose each node has only one gpu.

def init_processes(rank, size, fn, backend='gloo'):
    dist.init_process_group(backend,init_method='tcp://172.16.1.186:2222', rank=rank,world_size=size)
    fn(rank, size)

if __name__ == ""__main__"":
    size = 2
    processes = []
    for rank in range(size):
        p = Process(target=init_processes, args=(rank, size, run))
        p.start()
        processes.append(p)

   for p in processes:
        p.join()

This is part of my code.I run it.However,the result is only run in the one node when I qsub the run command in the two nodes.

The part of pbs command is nodes=gpu06:ppn=24+gpu07:ppn=24.

The run command is python train_dist.py.

Is there something wrong?Thanks for your help.. []"
484,20048,0,"Forking is not possible anymore when using any PyTorch version from about 2 months ago. I have been building PyTorch from source in the past couple of months. Since around 1 (or maybe 2) month(s) ago I am unable to do forward passing to my models when using the  package of PyTorch. If I'm not mistaken, the last version of PyTorch that I built and still allows me to use ing is [this](https://github.com/pytorch/pytorch/tree/bad4442) one; or more precisely, the version of PyTorch that I am using now and allows me to do ing is .

Not being able to do ing is pretty annoying cause I have written all of my work flow in a way that it depends on using  with ing. In one part of my work flow I start tens of processes and do forward passing on a model that is on the CPU memory. This is pretty useful and super efficient since the weights of the model are not being copied every time I start a new process. However, if I  processes the weights of the model needs to get copied and it's not gonna be efficient anymore. 

In another part of my framework, I start a process while the model is still on CPU's memory and then do  within the process and the model is then copied to the GPU memory. This is a bit inefficient but still allows me to start a 4-5 processes (depending on the GPU memory) and do forward-pass my inputs. 

Here's a pseudocode of what I do:



With the current versions of PyTorch (since 1-2 months ago) I cannot do this anymore. I'm afraid this is happening due to some indirect affects of some commits which did not intend to disable ing. So I wonder if you guys can either revert the changes that have caused this or enable this feature again.

Also, when using some of the PyTorch versions from the master branch (since 1-2 months ago) I might get the following if I do  within an started process:



This might be somewhat relevant to [lazy initialization of CUDA](https://github.com/pytorch/pytorch/pull/2811).. [""\r\nfrom torch.multiprocessing import Process\r\nmodel = loadModel() # somehow load a model (e.g. from torch vision)\r\ninputList = loadListOfInputs() # somehow get the list of input tensors\r\n\r\nprocesses = []\r\nfor i in range(100):\r\n    processes.append(Process(target=doForwardPass, kwargs={'input': inputList[i]}))\r\n    processes[-1].start()\r\n\r\nfor i in range(100):\r\n    processes[i].join()\r\n\r\ndef doForwardPass(input):\r\n    # model.cuda() # this, uncommented, used to work also\r\n    output = model(input)\r\n""]"
120,6894,0,"Maybe a bug in torch.nn.Upsample. ## Issue description

An unfriendly exception output when the input data size (the last two dims) and Upsample param 'size' have the same value

## Code example


and the output is:
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python': free(): invalid pointer: 0x00007fbea6fdfd40 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7fbed7b017e5]
/lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7fbed7b0a37a]
/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7fbed7b0e53c]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/lib/python3.6/site-packages/torch/_thnn/_THNN.cpython-36m-x86_64-linux-gnu.so(+0x2f367)[0x7fbe764f6367]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python(_PyCFunction_FastCallKeywords+0x279)[0x4aefe9]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python[0x54060e]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python(_PyEval_EvalFrameDefault+0x102d)[0x54268d]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python[0x540275]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python(PyEval_EvalCodeEx+0x3e)[0x54118e]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python[0x485828]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/bin/python(PyObject_Call+0x5c)[0x45322c]
/home/USER/.pyenv/versions/3.6.4/envs/shinerio-python3.6.4-env/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so(_Z17THPFunction_applyP7_objectS0_+0x271)[0x7fbea5ae7ac1]

... ...

7fbed899f000-7fbed89a6000 r--s 00000000 08:02 17172406                   /usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache
7fbed89a6000-7fbed89a7000 r--p 00025000 08:02 8912913                    /lib/x86_64-linux-gnu/ld-2.23.so
7fbed89a7000-7fbed89a8000 rw-p 00026000 08:02 8912913                    /lib/x86_64-linux-gnu/ld-2.23.so
7fbed89a8000-7fbed89a9000 rw-p 00000000 00:00 0 
7ffc0354d000-7ffc0356e000 rw-p 00000000 00:00 0                          [stack]
7ffc03575000-7ffc03578000 r--p 00000000 00:00 0                          [vvar]
7ffc03578000-7ffc0357a000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]

Process finished with exit code -1

`


## System Info

-   PyTorch version: 0.3.1
    Is debug build: No
    CUDA used to build PyTorch: 8.0.61
-   OS: Ubuntu 16.04.2 LTS
    GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609
    CMake version: version 3.5.1

-   Python version: 3.6
    Is CUDA available: Yes
    CUDA runtime version: Could not collect
    GPU models and configuration: GPU 0: Tesla M40 24GB
    Nvidia driver version: 384.111
    cuDNN version: Probably one of the following:
    /usr/local/cuda-9.0/lib64/libcudnn.so
    /usr/local/cuda-9.0/lib64/libcudnn.so.7
    /usr/local/cuda-9.0/lib64/libcudnn.so.7.0.5
    /usr/local/cuda-9.0/lib64/libcudnn_static.a

-   Versions of relevant libraries:
    [pip3] numpy (1.14.2)
    [conda] Could not collect
. [""python\r\nimport torch\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\n\r\nx = Variable(torch.rand(1, 1, 2, 2))\r\nm = nn.Upsample(size=(2, 2), mode='nearest') \r\nprint(x)\r\nprint(m(x))\r\n""]"
98,18053,0,"cuDNN error when using 3d convolutions. ## üêõ Bug

The following simple script: https://gist.github.com/vlasenkov/b3aa7c12570fe0056fca3421453470ca crashes with the following traceback:




## To Reproduce

Run the code above on single GPU.

## Expected behavior

The script just successfully finishes.

## Environment

. ['\r\nTraceback (most recent call last):\r\n  File ""models/unet/test.py"", line 126, in <module>\r\n    loss.backward()\r\n  File ""/opt/conda/lib/python3.6/site-packages/torch/tensor.py"", line 102, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph)\r\n  File ""/opt/conda/lib/python3.6/site-packages/torch/autograd/__init__.py"", line 90, in backward\r\n    allow_unreachable=True)  # allow_unreachable flag\r\nRuntimeError: cuDNN error: CUDNN_STATUS_EXECUTION_FAILED\r\n', '\r\nCollecting environment information...\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 10.0.130\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.0.130\r\nGPU models and configuration: \r\nGPU 0: Tesla V100-DGXS-32GB\r\nGPU 1: Tesla V100-DGXS-32GB\r\nGPU 2: Tesla V100-DGXS-32GB\r\nGPU 3: Tesla V100-DGXS-32GB\r\n\r\nNvidia driver version: 410.79\r\ncuDNN version: Probably one of the following:\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.4.1\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] blas                      1.0                         mkl  \r\n[conda] magma-cuda100             2.1.0                         5    local\r\n[conda] mkl                       2019.0                      118  \r\n[conda] mkl-include               2019.0                      118  \r\n[conda] mkl_fft                   1.0.6            py36h7dd41cf_0  \r\n[conda] mkl_random                1.0.1            py36h4414c95_1  \r\n[conda] pytorch                   1.0.1           py3.6_cuda10.0.130_cudnn7.4.2_2    pytorch\r\n[conda] torch                     1.0.0a0                  pypi_0    pypi\r\n[conda] torchtext                 0.3.0                    pypi_0    pypi\r\n[conda] torchvision               0.2.1                    pypi_0    pypi\r\n']"
205,24826,0,"Transformer Lack of Embedding Layer and Positional Encodings. The Transformer implementation docs (https://pytorch.org/docs/stable/nn.html?highlight=transformer#torch.nn.Transformer) state that they implement the original paper but fail to acknowledge that they don‚Äôt implement the following: 
* Layer Norm as the default normalization option. 
* Positional Encodings
* Embeddings before the encoding and decoding step 

It‚Äôs fine that these are all not implemented directly in the module but making it more clear that they aren‚Äôt and were in the original paper would be helpful. 

cc @ezyang @gchanan @zou3519 @bdhirsh @jbschlosser @anjali411 @brianjo @mruberry @albanD @zhangguanheng66 @jlin27. []"
69,9592,1,"nn.Conv* incostintent error depending on stride. ## Issue description

Convolutions do not raise an exception for too small input shape if .

## Code example

Suppose we have a following convolution:

This code raises a . Which is quite expected.

Now change the  to 2:

Which gives . Is this expected behavior? 

I guess this is because in the formula for the output shape there is a division by the stride and the check is performed before taking the  operation.

## System Info
- How you installed PyTorch: conda
- OS: Linux
- PyTorch version: 0.4
- Python version: 3.6

The code was run on CPU.. ['python\r\nconv = torch.nn.Conv2d(1, 1, kernel_size=3, dilation=2, stride=1)\r\ntensor = torch.empty(1, 1, 4, 4)\r\nconv(tensor).shape\r\n', 'python\r\nconv = torch.nn.Conv2d(1, 1, kernel_size=3, dilation=2, stride=2)\r\ntensor = torch.empty(1, 1, 4, 4)\r\nconv(tensor).shape\r\n']"
699,23616,0,"[jit] string.split only splits on newlines. It should split on any whitespace, right now it just splits on 


outputs



cc @suo. ['python\r\ndef fn(x):\r\n    # type: (str)\r\n    return x.split()\r\n\r\ns = ""a b\\nc\\td""\r\nprint(fn(s))\r\nprint(torch.jit.script(fn)(s))\r\n', ""\r\n['a', 'b', 'c', 'd']\r\n['a', 'b\\nc\\td']\r\n""]"
716,6486,0,Where is the Caffe2 website?. The gh-pages branch doesn't exist.. []
101,16527,0,"Delete _cudart from torch/cuda/__init__.py. _cudart is the Python ctypes binding to the libcudart.so library. It was previously used for Streams and Events but is now unused. The initialization (in _load_cudart) can sometimes fail. For example, @zou3519 ran into:

. [""\r\nRuntimeError: couldn't find libcudart. Make sure CUDA libraries are installed in a default location,\r\nor that they're in LD_LIBRARY_PATH.\r\n""]"
89,2520,1,"DistributedDataParallel doesn't exit properly; Leaves reduction threads running. 
When using the DDP module the process always hangs. I believe because the reduction threads are in a  loop.

https://github.com/pytorch/pytorch/blob/4c69697d2acbbe8e418a0921464c09aaf09da82a/torch/nn/parallel/distributed.py#L313-L315

Repro Code:

. [' python\r\nimport torch\r\nfrom torch.autograd import Variable\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nimport torch.distributed as dist\r\nimport ctypes\r\n\r\nlib = ctypes.cdll.LoadLibrary(None)\r\n\r\n\r\n\r\nclass Net(nn.Module):\r\n    def __init__(self):\r\n        super(Net, self).__init__()\r\n        self.conv1 = nn.Conv2d(3, 6, 5)\r\n        self.pool = nn.MaxPool2d(2, 2)\r\n        self.conv2 = nn.Conv2d(6, 16, 5)\r\n        self.fc1 = nn.Linear(16 * 5 * 5, 120)\r\n        self.fc2 = nn.Linear(120, 84)\r\n        self.fc3 = nn.Linear(84, 10)\r\n#        self.bn1 = torch.nn.BatchNorm2d(6)\r\n        self.bn2 = torch.nn.BatchNorm2d(16)\r\n        \r\n    def forward(self, x):\r\n        x = self.pool(F.relu((self.conv1(x))))\r\n        x = self.pool(F.relu(self.bn2(self.conv2(x))))\r\n        x = x.view(-1, 16 * 5 * 5)\r\n        x = F.relu(self.fc1(x))\r\n        x = F.relu(self.fc2(x))\r\n#        x = self.fc3(x)\r\n        return x\r\n    \r\n    \r\nnet = Net().cuda()\r\nworld_size=2\r\ndist_url = \'tcp://224.66.41.62:23456\'\r\ndist_backend = \'gloo\'\r\n\r\ndist.init_process_group(backend=dist_backend, init_method=dist_url, world_size=world_size)\r\ntorch.cuda.synchronize()\r\nprint(""initialized"")\r\nnet = torch.nn.parallel.DistributedDataParallel(net)\r\ntorch.cuda.synchronize()\r\nprint(""network created"")\r\ninp = Variable(torch.randn(64, 3, 32,32))\r\ntorch.cuda.synchronize()\r\nprint(""input created"")\r\n\r\n\r\nfor i in range(3):\r\n    out = net.forward(inp)\r\n    loss = out.sum()\r\n    loss.backward()\r\n    torch.cuda.synchronize()\r\n\r\nlib.cudaProfilerStop()\r\n']"
432,2032,0,"Possible bug in RNN module. 
...................................................................................................

Sorry, I have to reopen this because I think this is a bug within the RNN module and I could't get help from discuss.pytorch

I run a similar experiment with one linear layer neural network and the output is correct. So a reasonable explanation would be the RNN module keep different set of parameters (for optimization reason?) and didn't mix up at the end of the batch training. The following code will duplicate this problem.

........................................................................................................

I encounter this problem when I am trying to implement seq2seq to familiarize with this new framework. This issue seems related to parameters sharing in mini-batch. I setup a dummy training set with only one mini-batch. This mini-batch has 3 data entries in it. All with the same input, and different outputs:

training_data = [
[[[4,5,1,7,8],[4,5,1,7,8],[4,5,1,7,8]], (input 1)
[[0],[0],[0]], (input 2)
[[1],[3],[5]]] (target)
]

In theory, the model will never learn this data because the contradiction. However, the loss reach near 0 after only a few hundred epochs. But if I split 3 data entries into 3 mini-batch, the model will not learn the data set which should be the correct result.

So the model must be keeping different set of parameter for each position in mini-batch? And the parameters are not updated to be the same after each mini-batch forward-backward? Can someone tell me if I misunderstood something?

. ['\r\nimport torch\r\nimport torch.autograd as autograd\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\nimport torch.optim as optim\r\n\r\n\r\n\r\ntraining_data = [\r\n\t[[[4,5,1,7,8],[4,5,1,7,8],[4,5,1,7,8]], [[0],[0],[0]], [[1],[3],[5]]]\r\n\t]\r\n\r\n\r\ndef prepare_sequence(all_seq):\r\n\treturn autograd.Variable(torch.LongTensor(all_seq)).cuda()\r\n\r\nclass Seq2seqLSTM(nn.Module):\r\n\r\n\tdef __init__(self, vocab_size, target_size, embed_dim, hidden_dim, num_layers):\r\n\r\n\t\tsuper(Seq2seqLSTM, self).__init__()\r\n\t\tself.hidden_dim = hidden_dim\r\n\t\tself.embed_dim = embed_dim\r\n\t\tself.vocab_size = vocab_size\r\n\t\tself.target_size = target_size\r\n\t\tself.num_layers = num_layers\r\n\r\n\t\tself.word_embeddings = nn.Embedding(vocab_size, embed_dim)\r\n\t\tself.encoder = nn.LSTM(embed_dim, hidden_dim, num_layers)\r\n\t\tself.decoder = nn.LSTM(embed_dim, hidden_dim, num_layers)\r\n\r\n\t\tself.curr_hidden = None\r\n\t\tself.hidden2tag = nn.Linear(hidden_dim, target_size)\r\n\r\n\tdef init_hidden(self, batch_size):\r\n\t\treturn (autograd.Variable(torch.zeros(self.num_layers, batch_size, self.hidden_dim)).cuda(),\r\n\t\t\tautograd.Variable(torch.zeros(self.num_layers, batch_size, self.hidden_dim)).cuda())\r\n\r\n\tdef forward(self, enc_seq, dec_seq):\r\n\r\n\t\tbatch_size = enc_seq.size()[0]\r\n\t\tself.curr_hidden = self.init_hidden(batch_size)\r\n\r\n\t\tenc_embeds = self.word_embeddings(enc_seq)\r\n\t\tdec_embeds = self.word_embeddings(dec_seq)\r\n\r\n\t\tenc_out, self.curr_hidden = self.encoder(\r\n\t\t\tenc_embeds.view(-1, batch_size, self.embed_dim), self.curr_hidden)\r\n\t\tdec_out, self.curr_hidden = self.decoder(\r\n\t\t\tdec_embeds.view(-1, batch_size, self.embed_dim), self.curr_hidden)\r\n\r\n\t\ttag_space = self.hidden2tag(dec_out.view(batch_size * len(dec_out), -1))\r\n\t\ttag_scores = F.log_softmax(tag_space)\r\n\t\treturn tag_scores\r\n\r\nEMBED_DIM = 10\r\nHIDDEN_DIM = 10\r\nVOCAB_SIZE = 10\r\nTARGET_SIZE = 10\r\nNUM_LAYERS = 2\r\n\r\nmodel = Seq2seqLSTM(VOCAB_SIZE, TARGET_SIZE, EMBED_DIM, HIDDEN_DIM, NUM_LAYERS).cuda()\r\nloss_function = nn.NLLLoss()\r\noptimizer = optim.Adam(model.parameters())\r\nprint model\r\n\r\nfor epoch in range(1000):\r\n\r\n\tone_batch = map(lambda x:prepare_sequence(x), training_data[epoch%len(training_data)])\r\n\tenc_inp = one_batch[0]\r\n\tdec_inp = one_batch[1]\r\n\ttarget = one_batch[2]\r\n\r\n\tmodel.zero_grad()\r\n\ttag_scores = model(enc_inp, dec_inp)\r\n\r\n\tloss = loss_function(tag_scores, target.view(-1))\r\n\tloss.backward()\r\n\toptimizer.step()\r\n\r\n\tprint loss\r\n']"
336,20997,0,"ReduceLROnPlateau will fail when add new parameter group to the optimizer. ## üêõ Bug

ReduceLROnPlateau will fail when add new parameter group to the optimizer.
The  function will raise list index out of range error

## To Reproduce

Steps to reproduce the behavior:

1. initialize optimizer: 
1. initialize scheduler: 
1. add parameter group to the optimizer: 
1. raise error when the learning rate should be changed

## Expected behavior

when add a parameter group to the optimizer, the  attribute of the scheduler should be updated to avoid this error.

## Environment

 - PyTorch Version (1.1.0):. []"
344,9945,0,WERROR=1 doesn't work with FULL_CAFFE2. It seems to toggle too many warnings for Caffe2 and then  fails.. []
339,15163,0,"doc error:torch.nn.NLLLoss. if size_average=True and reduce=True,
loss(x,class)=‚àíweights[class]‚àóx[class]/N. []"
66,18277,1,"Precision loss of large tensor averaging on CPU. ## üêõ Bug

Taking  of a large CPU tensor results in severe precision loss. 
I would like to know if the following behaviour is known and normal. 

## To Reproduce


<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->
produces 




## Expected behavior

Close match between CPU and GPU versions of mean operation. 

## Environment

PyTorch version: 1.0.1.post2
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: version 3.10.2

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti

Nvidia driver version: 390.116
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.16.2
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.1                      144  
[conda] mkl-service               1.1.2            py37he904b0f_5  
[conda] mkl_fft                   1.0.6            py37hd81dba3_0  
[conda] mkl_random                1.0.2            py37hd81dba3_0  
[conda] pytorch                   1.0.1           py3.7_cuda9.0.176_cudnn7.4.2_2    pytorch
[conda] torchvision               0.2.1                      py_2    pytorch

. ['\r\nshape = (1000, 1000)\r\nfor i  in range(10000):\r\n    if i > 9990: \r\n        print(tr.ones(*shape).fill_(i).mean(), ""   \\t"",  tr.ones(*shape).fill_(i).cuda().mean())\r\n', ""\r\ntensor(9991.5693)    \t tensor(9991., device='cuda:0')\r\ntensor(9991.9990)    \t tensor(9991.9990, device='cuda:0')\r\ntensor(9992.4297)    \t tensor(9993., device='cuda:0')\r\ntensor(9993.7197)    \t tensor(9994., device='cuda:0')\r\ntensor(9995.5684)    \t tensor(9995., device='cuda:0')\r\ntensor(9996.)    \t tensor(9996., device='cuda:0')\r\ntensor(9996.4287)    \t tensor(9997.0010, device='cuda:0')\r\ntensor(9998.2793)    \t tensor(9998., device='cuda:0')\r\ntensor(9999.5693)    \t tensor(9999., device='cuda:0')\r\n""]"
2,13843,1,"Possible CPU-side memory leak even when fitting on GPU. ## üêõ Bug

A possible CPU-side memory leak even when fitting on the GPU using PyTorch 0.4.1.

## To Reproduce

I am quite new to PyTorch, having used TF/Keras extensively in the past, but am now trying to use PyTorch as a replacement. I decided to start small with a seq2seq Skip-Thought model, cobbled together using the PyTorch NLP tutorials. Everything seems to work fine when I run small scale tests, however, when I use the code to run a large scale fit on 3000 separate paragraphs (each paragraph having a variable number of sentences) I notice that my system RAM usage slowly goes up as the script runs, until eventually it hits 100% and the box becomes unresponsive and has to be force rebooted. The Linux box has 64 GB of RAM, and when the script starts, usage is 4.7% but this climbs steadily over time to 100%, at which point the box becomes unresponsive.

Since I'm new to PyTorch, I'm not sure if perhaps I'm doing something blatantly wrong in my code which would account for this behaviour?

This is my core fitting logic, which runs as a script on linux:



Here are the helper functions which create the tensors passed to the model by converting all text words into indices from a predefined gensim dictionary:



And, finally, here is the SkipThought model itself, with all its helper classes (apologies for the wall of code):



## Expected behavior

Memory usage in Linux should not linearly increase as the fitting script runs, especially not to the point at which the box dies.

## Environment

 - PyTorch Version (e.g., 1.0): 0.4.1
 - OS (e.g., Linux): Linux (Ubuntu 16.04)
 - How you installed PyTorch (, , source): pip install torch
 - Build command you used (if compiling from source): N/A
 - Python version: 3.6.6
 - CUDA/cuDNN version: CUDA 9.0.176 / CuDNN 7.4.1.5
 - GPU models and configuration: Tesla V100
 - Any other relevant information:

. [""\r\ndevice = 'cuda'\r\nmodel = SkipThought(len(text_dictionary.token2id), 128, 256, nn.NLLLoss()).to(device)\r\n\r\n// corpus_orig is a list of lists where each list-element is a text paragraph with multiple sentences\r\nn_iters=len(corpus_orig)\r\n\r\nstart = time.time()\r\nprint_loss_total = 0\r\n\r\noptimizer = optim.SGD(model.parameters(), lr=0.01)\r\n\r\nfor xi in range(1, n_iters + 1):\r\n    x = corpus_orig[xi - 1]\r\n    sents = [x for x in map(str.strip, x.split('. ')) if len(x) > 0]\r\n    for i in range(1, len(sents) - 1):\r\n        input_tensor, prev_tensor, next_tensor = tensorsFromPair( (sents[i], sents[i - 1], sents[i + 1]) )\r\n\r\n        optimizer.zero_grad()\r\n        \r\n        loss, prev_output, next_output = model(input_tensor, prev_tensor, next_tensor, use_teacher_forcing=True)\r\n        \r\n        loss.backward(retain_graph=True)    // pytorch says I need retain_graph=True, otherwise I get an error here\r\n        optimizer.step()\r\n        \r\n        print_loss_total += loss.item()\r\n\r\n    print_loss_avg = print_loss_total\r\n    print_loss_total = 0\r\n    print('%s (%d %d%%) %.4f' % (timeSince(start, xi / n_iters),\r\n                         xi, xi / n_iters * 100, print_loss_avg), flush=True)\r\n"", '\r\ndef indexesFromSentence(sentence):\r\n    return text_dictionary.doc2idx(sentence.split())\r\n\r\ndef tensorFromSentence(sentence):\r\n    indexes = indexesFromSentence(sentence)\r\n    indexes.append(EOS_token)\r\n    return torch.tensor(indexes, dtype=torch.long, device=device).view(-1, 1)\r\n\r\ndef tensorsFromPair(pair):\r\n    input_tensor = tensorFromSentence(pair[0])\r\n    prev_tensor = tensorFromSentence(pair[1])\r\n    next_tensor = tensorFromSentence(pair[2])\r\n    return (input_tensor, prev_tensor, next_tensor)\r\n', '\r\nclass EncoderRNN(nn.Module):\r\n    def __init__(self, vocab_size, embedding_size, gru_size):\r\n        super(EncoderRNN, self).__init__()\r\n        self.vocab_size = vocab_size\r\n        self.embedding_size = embedding_size\r\n        self.gru_size = gru_size\r\n\r\n        self.embedding = nn.Embedding(vocab_size, embedding_size)\r\n        self.gru = nn.GRU(embedding_size, gru_size)\r\n\r\n    def forward(self, sentence, hidden):\r\n        embeddings = self.embedding(sentence)\r\n        embeddings = F.tanh(embeddings)\r\n        output, hidden = self.gru(embeddings, hidden)\r\n        \r\n        return output, hidden\r\n\r\n    def initHidden(self):\r\n        return torch.zeros(1, 1, self.gru_size, device=device)\r\n    \r\n    def getEmbedding(self, sentence):\r\n        return F.tanh(self.embedding(sentence))\r\n\r\nclass LocalAttention(nn.Module):\r\n    def __init__(self, dim):\r\n        super(LocalAttention, self).__init__()\r\n        self.W = nn.Linear(dim, dim, bias=False)\r\n\r\n    def score(self, decoder_hidden, encoder_out):\r\n        encoder_out = self.W(encoder_out)\r\n        encoder_out = encoder_out.permute(1, 0, 2)\r\n        return encoder_out @ decoder_hidden.permute(1, 2, 0)\r\n\r\n    def forward(self, decoder_hidden, encoder_out):\r\n        energies = self.score(decoder_hidden, encoder_out)\r\n        mask = F.softmax(energies, dim=1)\r\n        context = encoder_out.permute(1, 2, 0) @ mask\r\n        context = context.permute(2, 0, 1)\r\n        mask = mask.permute(2, 0, 1)\r\n        return context, mask\r\n\r\n\r\nclass SkipThought(nn.Module):\r\n    def __init__(self, vocab_size, embedding_size, gru_size, criterion):\r\n        super(SkipThought, self).__init__()\r\n        self.vocab_size = vocab_size\r\n        self.embedding_size = embedding_size\r\n        self.gru_size = gru_size\r\n        self.criterion = criterion\r\n        \r\n        self.encoder = EncoderRNN(vocab_size, embedding_size, gru_size)\r\n        self.prev_gru = nn.GRU(embedding_size + gru_size, gru_size)\r\n        self.next_gru = nn.GRU(embedding_size + gru_size, gru_size)\r\n        self.attention = LocalAttention(gru_size)\r\n        self.worder = nn.Linear(gru_size * 2, vocab_size)\r\n        self.softmax = nn.LogSoftmax(dim=1)\r\n        \r\n        self.encoder_hidden = self.encoder.initHidden()\r\n    \r\n    def forward(self, input_tensor, prev_tensor, next_tensor, use_teacher_forcing=True):        \r\n        encoder_hidden = self.encoder_hidden\r\n        \r\n        prev_length = prev_tensor.size(0)\r\n        next_length = next_tensor.size(0)\r\n    \r\n        loss = 0\r\n        \r\n        encoder_output, encoder_hidden = self.encoder(input_tensor, encoder_hidden)\r\n    \r\n        prev_input = torch.tensor([[SOS_token]], device=device)\r\n        next_input = torch.tensor([[SOS_token]], device=device)\r\n    \r\n        prev_hidden = encoder_hidden\r\n        next_hidden = encoder_hidden\r\n        \r\n        self.encoder_hidden = encoder_hidden\r\n    \r\n        prev_output = []\r\n        next_output = []\r\n    \r\n        if use_teacher_forcing:\r\n            # Teacher forcing: Feed the target as the next input\r\n            for di in range(prev_length):\r\n                embedded = self.encoder.getEmbedding(prev_input)\r\n                context, _ = self.attention(prev_hidden, encoder_output)\r\n                decoder_output, prev_hidden = self.prev_gru(torch.cat([embedded, context], dim=2), prev_hidden)\r\n                decoder_output = self.softmax(self.worder(torch.cat([decoder_output, context], dim=2)[0]))\r\n                loss += self.criterion(decoder_output, prev_tensor[di])\r\n                prev_output.append( decoder_output.topk(1)[1].squeeze().detach().item() )\r\n                prev_input = prev_tensor[di].unsqueeze(0)  # Teacher forcing\r\n            \r\n            for di in range(next_length):\r\n                embedded = self.encoder.getEmbedding(next_input)\r\n                context, _ = self.attention(next_hidden, encoder_output)\r\n                decoder_output, next_hidden = self.next_gru(torch.cat([embedded, context], dim=2), next_hidden)\r\n                decoder_output = self.softmax(self.worder(torch.cat([decoder_output, context], dim=2)[0]))\r\n                loss += self.criterion(decoder_output, next_tensor[di])\r\n                next_output.append( decoder_output.topk(1)[1].squeeze().detach().item() )\r\n                next_input = next_tensor[di].unsqueeze(0)  # Teacher forcing\r\n    \r\n        else:\r\n            # Without teacher forcing: use its own predictions as the next input\r\n            for di in range(prev_length):\r\n                embedded = self.encoder.getEmbedding(prev_input)\r\n                context, _ = self.attention(prev_hidden, encoder_output)\r\n                decoder_output, prev_hidden = self.prev_gru(torch.cat([embedded, context], dim=2), prev_hidden)\r\n                decoder_output = self.softmax(self.worder(torch.cat([decoder_output, context], dim=2)[0]))\r\n                topv, topi = decoder_output.topk(1)\r\n                prev_input = topi.squeeze().detach()  # detach from history as input\r\n                \r\n                loss += self.criterion(decoder_output, prev_tensor[di])\r\n                prev_output.append( prev_input.item() )\r\n                if prev_input.item() == EOS_token:\r\n                    break\r\n                prev_input = prev_input.unsqueeze(0).unsqueeze(0)\r\n            \r\n            for di in range(next_length):\r\n                embedded = self.encoder.getEmbedding(next_input)\r\n                context, _ = self.attention(next_hidden, encoder_output)\r\n                decoder_output, next_hidden = self.next_gru(torch.cat([embedded, context], dim=2), next_hidden)\r\n                decoder_output = self.softmax(self.worder(torch.cat([decoder_output, context], dim=2)[0]))\r\n                topv, topi = decoder_output.topk(1)\r\n                next_input = topi.squeeze().detach()  # detach from history as input\r\n    \r\n                loss += self.criterion(decoder_output, next_tensor[di])\r\n                next_output.append( next_input.item() )\r\n                if next_input.item() == EOS_token:\r\n                    break\r\n                next_input = next_input.unsqueeze(0).unsqueeze(0)\r\n        \r\n        return loss, prev_output, next_output\r\n']"
625,987,0,"Implement nn.Module.__dir__. If I create a module class and add a layer to it, I can't see this new layer when I try to use IPython's autocomplete. For example, with the the following class:

    class Example(nn.Module):
        def __init__(self):
            super().__init__()
            self.fully_connected = nn.Linear(20, 1)

    ex = Example()

When I type , the only options are 'forward' and 'float'. And when I type , I don't get the completion option for the  attribute.

From my limited understanding, I think that this has to do with the strings that are returned with the  method:

    [attr for attr in ex.__dir__() if attr.startswith('f')]
    => ['forward', 'float']
    
So for the first issue, if I modify the class to have a method

    def __dir__(self):
        return super().__dir__() + list(self._modules)
        
then I get the  as a possible completion.
    
I'm not sure if this is because of an intentional design decision, but it would be nice if all of the relevant possible attributes were available with the auto complete, as I'm still becoming familiar with this library.

. []"
335,14112,0,"[sparse] add descriptions and examples for methods at torch.sparse doc page. - There is no descriptions / examples for the methods listed at at doc page
- It will be much easier for new comers to learn how to use sparse if we improve doc a little bit

cc @aocsa @nikitaved @pearu @mruberry @IvanYashchuk. []"
395,1981,0,"[Controversial] `pyyaml` is 6 years old, might be best to switch to `ruamel.yaml`?. Commit history from pyyaml, as far as I can tell, http://pyyaml.org/log/ 

<img width=""733"" alt=""screen shot 2017-07-05 at 10 34 54 am"" src=""https://user-images.githubusercontent.com/123560/27858562-9e33dc44-616d-11e7-9525-0cf771d24b31.png"">

Commit history from , https://bitbucket.org/ruamel/yaml/commits/all

<img width=""1355"" alt=""screen shot 2017-07-05 at 10 35 36 am"" src=""https://user-images.githubusercontent.com/123560/27858592-bd36de8e-616d-11e7-8213-548f81909bd2.png"">

ruamel.yaml supports yaml 1.2, and handles round-trip, including comments.. []"
744,6996,0,"[pytorch][0.4][bug] ""torch.min"" and ""torch.max"" ignores ""nan"" in cuda case and crash with pure ""nan"" tensor. ## Issue description

 and  ignores  in cuda case and crash with pure  tensor.

## Code example

## System Info

- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): conda
- Build command you used (if compiling from source):
- OS: Ubuntu 16.04
- PyTorch version: 0.4.0
- Python version: 3.6.3
- CUDA/cuDNN version: 8 / 5
- GPU models and configuration: GTX 1050 Ti
- GCC version (if compiling from source):
- CMake version:
- Versions of any other relevant libraries:
. ['python\r\n>>> import torch\r\n>>> a = torch.Tensor(4, 3).fill_(1)\r\n>>> a = a.cuda()\r\n>>> a[1, 2] = float(\'nan\')\r\n>>> a\r\ntensor([[  1.,   1.,   1.],\r\n        [  1.,   1., nan.],\r\n        [  1.,   1.,   1.],\r\n        [  1.,   1.,   1.]], device=\'cuda:0\')\r\n>>> torch.max(a)\r\ntensor(1., device=\'cuda:0\')\r\n>>> torch.min(a)\r\ntensor(1., device=\'cuda:0\')\r\n>>> a = torch.Tensor(4, 3).fill_(float(\'nan\'))\r\n>>> a = a.cuda()\r\n>>> torch.max(a)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/tensor.py"", line 57, in __repr__\r\n    return torch._tensor_str._str(self)\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/_tensor_str.py"", line 218, in _str\r\n    fmt, scale, sz = _number_format(self)\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/_tensor_str.py"", line 96, in _number_format\r\n    if value != math.ceil(value.item()):\r\nRuntimeError: Overflow when unpacking long\r\n>>> torch.min(a)\r\nTraceback (most recent call last):\r\n  File ""<stdin>"", line 1, in <module>\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/tensor.py"", line 57, in __repr__\r\n    return torch._tensor_str._str(self)\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/_tensor_str.py"", line 218, in _str\r\n    fmt, scale, sz = _number_format(self)\r\n  File ""anaconda3/lib/python3.6/site-packages/torch/_tensor_str.py"", line 96, in _number_format\r\n    if value != math.ceil(value.item()):\r\nRuntimeError: Overflow when unpacking long\r\n']"
385,12555,0,"add nvidia driver version to environment collection script. https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py currently misses collecting nvidia driver version.
Would be useful to have that.. []"
388,12608,0,"ONNX model export issue. Hi,

I would like to get some general ideas on exporting ONNX model when model accepts both input sequence and output labels as arguments. How would you set up Variables to traverse through the model to export ONNX?

Thanks.
. []"
12,20053,1,"RFC: accscalar_t for float on CPU. ## Issue
Currently  for  is  on the CPU:

https://github.com/pytorch/pytorch/blob/master/aten/src/ATen/AccumulateType.h#L34

I suggest to have a small discussion whether it'd be better to switch to float.

## Motivation

This is prompted by @wanchaol asking about a [](https://gist.github.com/wanchaol/aceb0a1e8d3a93c8853689730b0f709f) error, but I think there are three possible reasons to consider changing this:
- Consistency with GPU,
- support platforms on which float is faster (e.g. arm32)
- get rid of UB.

I seem to recall @apaszke preferring the current behaviour a year ago or so back (in the context of #6855, which always dispatched a double auxilliary function on CPU or so).

## Pitch

Switch to  generally.

## Alternatives

Switch to  only for specific platforms (e.g. arm32),  somehow get rid of the UB warning.

## Additional context

We (e.g. @ljk53 and me) might be interested in changing this for Android specifically if we don't generally.
. []"
419,7645,0,"Max pooling behavior for nan values. ## Issue description

max pooling functions are not consistent with max functions.
Below an example, every max pooling (be it 1d, 2d or 3d, adaptive or not) acts the same, on cpu or on cuda.

Essentially, there are two fondamental differences :
 - max pooling of all  values is  while for  it's 
 - max pooling of nan and valid values is valid values, which means s get ignored, while for , as soon as there is a  value, the result is .

More generally, choosing explicetely how to deal with  as in numpy ([e.g.](https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.nanmax.html)) could be a solution, but maybe this is related to CuDNN's max pooling ?

## Code example



## System Info

Built from latest sources (as of 05/17)
PyTorch version: 0.5.0a0+331a04d
Is debug build: No
CUDA used to build PyTorch: 9.1.85

OS: Ubuntu 16.04.4 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609
CMake version: version 3.9.4

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.1.85
GPU models and configuration: GPU 0: Quadro M1000M
Nvidia driver version: 390.30
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.3
/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a

Versions of relevant libraries:
[conda] magma-cuda91              2.3.0                         1    pytorch
[conda] torch                     0.5.0a0+331a04d           <pip>
[conda] torch                     0.3.1b0+2b47480           <pip>
[conda] torch                     0.5.0a0+4251e38           <pip>

. [""python\r\na= torch.full((1,1,2), float('nan'))\r\nprint(a.max())  # tensor(nan)\r\nprint(F.adaptive_max_pool1d(a, 1)) # tensor([[[-3.4028e+38]]])\r\n\r\na.requires_grad=True\r\na.max().backward()\r\nprint(a.grad) # tensor([[[ 0., 0.]]])\r\nF.adaptive_max_pool1d(a, 1).backward()\r\nprint(a.grad) # tensor([[[ 0., 0.]]])\r\n\r\nwith torch.no_grad():\r\n    a[0,0,0] = 0\r\n\r\na.max().backward()\r\nprint(a.grad) # tensor([[[ 0., 0.]]])\r\nF.adaptive_max_pool1d(a, 1).backward()\r\nprint(a.grad) # tensor([[[ 1., 0.]]])\r\n""]"
74,27016,1,"inconsistent of einsum and torch.mm. 
## Issue description
When comparing the outcomes of torch.mm and torch.einsum for matrix multiplication, the results is not consistent. The same result is also produced by numpy. 

## Code example
A minimal example is down here. 


[[ True  True  True  True]
 [ True  True  True  True]
 [ True  True  True  True]
 [ True  True  True  True]]
[[ True  True  True  True]
 [ True  True  True  True]
 [ True  True  True  True]
 [ True  True  True  True]]
tensor([[ True,  True,  True,  True],
        [False,  True, False,  True],
        [ True, False,  True,  True],
        [False,  True,  True,  True]])
[[ True  True  True  True]
 [False  True False  True]
 [ True False  True  True]
 [False  True  True  True]]

While of course we should expect all trues.

## System Info
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Red Hat Enterprise Linux release 8.0 (Ootpa)
GCC version: (GCC) 8.2.1 20180905 (Red Hat 8.2.1-3)
CMake version: version 3.11.4

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: 10.1.168
GPU models and configuration: GPU 0: GeForce RTX 2080 Ti
Nvidia driver version: 430.14
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.16.2
[pip] numpydoc==0.8.0
[pip] torch==1.2.0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl  
[conda] mkl                       2019.4                      243  
[conda] mkl-service               2.3.0            py37he904b0f_0  
[conda] mkl_fft                   1.0.10           py37ha843d7b_0  
[conda] mkl_random                1.0.2            py37hd81dba3_0  
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0

. []"
291,31596,0,"pytorch forward hangs in multiprocess environment. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
This a very peculiar bug I am encountering. I am using MTCNN face detector from https://github.com/TreB1eN/InsightFace_Pytorch/  on pytorch 1.3.1+cpu

The face detection works fine when API is called from __main__ thread. But if I forked a new process and initialized MTCNN as well as face detector model (MobileFaceNet), it hangs in first net forward call (in MTCNN). If load_state_dict for MobileFaceNet is commented out, again it works fine.

## To Reproduce

Steps to reproduce the behavior:

1. Clone https://github.com/TreB1eN/InsightFace_Pytorch/
2. Try following code

3. If test function is called in __main__ thread, this code works fine.
4. If  line is removed, again code works fine

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Environment
pkg | version
--- | ---
Python | 3.7.4
torch |                            1.3.1+cpu   (pip)
Pillow |                           5.4.1      
opencv-python |                    4.1.1.26   
OS | ubuntu 18.04, linux 4.15.0-72-generic
. [""\r\nfrom mtcnn import MTCNN\r\nfrom model import MobileFaceNet\r\nimport torch\r\nfrom PIL import Image\r\nfrom torch.multiprocessing import Process\r\nimport cv2\r\nimport time\r\n\r\n# mtcnn = MTCNN()\r\nmyfacenet = MobileFaceNet(512)\r\nfacenet_dict = torch.load('./model_mobilefacenet.pth', map_location = torch.device('cpu'))\r\nout = myfacenet.load_state_dict(facenet_dict)\r\n\r\ndef test():\r\n    mtcnn = MTCNN()\r\n    img = cv2.imread('29.png')\r\n    img2 = Image.fromarray(img)\r\n    print(mtcnn.align_multi(img2, 1, 100))\r\n\r\nif __name__ == '__main__':\r\n    p = Process(target=test)\r\n    p.start()\r\n    p.join()\r\n""]"
610,7660,0,"Canonicalize aten operators in IR. Currently many operators in the aten IR have multiple forms.

Any operator that takes a non-tensor argument (e.g. IntList or int64_t) will have two forms: one with the non-tensor arguments encoded as tensor inputs and one with the arguments as attributes on the graph.

This makes every pass that we write in the IR harder because it needs to handle both cases.

Proposed solution:

1. Canonicalize on the tensor input format. Graphs are optimized in this format. This format is more general because inputs are not required to be constants.

2. expose the  function in compiler for general usage. Optimizations then check for const-ness of these inputs to work.

3. Before interpretation, lower back to the attribute-only format when thing are constants.  already includes this function, it just has to be written into a pass.. []"
250,9172,0,"Kernel breaks  when doing backward pass with .permute with the -1 option. ## Issue description

Permuting the axis of a tensor using the  option breaks the kernel (tested in Jupyter) when doing the backward pass. The kernel just restart, there is no error provided.

## Code example

This code:

automatically breaks the Kernel of a Jupyter Notebook (run in JupyterLab).

Note that the following code:


worked well.

## System Info
PyTorch version: 0.3.1
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 16.04.3 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609
CMake version: version 3.5.1

Python version: 3.5
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: GPU 0: Tesla K80
Nvidia driver version: 384.111
cuDNN version: Probably one of the following:
/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21
/usr/local/cuda-8.0/lib64/libcudnn_static.a
/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.5
/usr/local/cuda-9.0/lib64/libcudnn_static.a
/usr/local/lib/python3.5/dist-packages/torch/lib/libcudnn-7b07b0f1.so.7.0.5

Versions of relevant libraries:
[pip3] msgpack-numpy (0.4.1)
[pip3] numpy (1.14.0)
[pip3] torch (0.3.1)
[pip3] torchvision (0.2.0)
[conda] Could not collect. ['\r\nimport torch\r\nfrom torch.autograd import Variable\r\na = Variable(torch.rand(2,3,2), requires_grad = True)\r\na = a.permute(1,0,-1)\r\na = a.sum()\r\na.backward()\r\n', '\r\nimport torch\r\nfrom torch.autograd import Variable\r\na = Variable(torch.rand(2,3,2), requires_grad = True)\r\na = a.permute(1,0,2)\r\na = a.sum()\r\na.backward()\r\n']"
186,27793,0,"[quantization] QNNPACK Engine for Dynamic Quantization. We should support QNNPACK for dynamic quantization.

- [ ] RNN classes
- [ ] RNNCell classes
- [ ] Linear

cc @jerryzh168 @jianyuh @dzhulgakov. []"
316,1051,0,"DataParallel does not correctly handle running variables in batch norm. Running variables accumulated on non-master GPUs are lost, and in the next step running variables accumulated on the master GPU are broadcast to non-master GPUs. Convergence-wise it does not make much difference;-), but it is still a bug. 
Also, device_ids in DataParallel should be checked to not contain the same values, otherwise stuff like this will break: 
https://github.com/pytorch/pytorch/blob/master/torch/backends/cudnn/rnn.py#L38-L43
If creating replicas on the same GPU is actually intended to be supported, then the above referenced lines that create a dictionary indexed by current_device constitute a bug. 
Both this issues ultimately are caused but not well defined behaviour of DataParallel with respect to stateful modules, of which batchnorm and recurrent nets with cudnn backend are examples. 

cc @ngimel @albanD @mruberry. []"
651,28201,0,"Optimize GroupNorm in PyTorch. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->
Improve the performance of GroupNorm operator.

## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->

Similar as https://github.com/pytorch/pytorch/issues/27633, the current GroupNorm implementation is reshaping the input and doing BatchNorm to get the moments of input, then using addcmul for affine. This implementation is inefficient for both CPU and CUDA. 

The performance benchmark for input shape = [128, 256, 28, 28], num_groups = 32 is shown below.



And the performance benchmark for input shape = [256, 512, 56, 56], num_groups = 32 is shown below.



We can see that for both CPU and GPU version of GroupNorm, using BatchNorm with addcmul make things slow especially for backward pass. Actually on CPU side, since BatchNorm for inference is a affine function and can be fused with Conv, it makes the GroupNorm very slow when using BatchNorm on CPU for inference.

## Pitch

<!-- A clear and concise description of what you want to happen. -->

To implement a optimized version of GroupNorm which fused everything together.

## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->

## Additional context

<!-- Add any other context or screenshots about the feature request here. -->
cc @dzhulgakov @ngimel @ppwwyyxx 
. ['\r\nGroupNorm forward: 210.97913278000487ms\r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nName                        Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  \r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nnative_batch_norm           68.00%           135.920s         68.00%           135.920s         135.920ms        NaN              0.000us          0.000us          1000             \r\naddcmul                     31.94%           63.841s          31.94%           63.841s          63.841ms         NaN              0.000us          0.000us          1000             \r\nview                        0.03%            69.572ms         0.03%            69.572ms         17.393us         NaN              0.000us          0.000us          4000             \r\ngroup_norm                  0.01%            29.095ms         100.00%          199.870s         199.870ms        NaN              0.000us          0.000us          1000             \r\n_batch_norm_impl_index      0.00%            5.179ms          68.01%           135.925s         135.925ms        NaN              0.000us          0.000us          1000             \r\nbatch_norm                  0.00%            4.594ms          68.01%           135.929s         135.929ms        NaN              0.000us          0.000us          1000             \r\ncontiguous                  0.00%            1.815ms          0.00%            1.815ms          1.815us          NaN              0.000us          0.000us          1000             \r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nSelf CPU time total: 199.870s\r\nCUDA time total: 0.000us\r\n\r\nGroupNorm backward: 498.55486265799846ms\r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nName                                 Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  \r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nmul                                  46.02%           224.071s         46.02%           224.071s         56.018ms         NaN              0.000us          0.000us          4000             \r\nnative_batch_norm_backward           43.86%           213.559s         43.86%           213.559s         213.559ms        NaN              0.000us          0.000us          1000             \r\nsum                                  3.91%            19.040s          3.91%            19.040s          9.520ms          NaN              0.000us          0.000us          2000             \r\nadd_                                 3.28%            15.951s          3.28%            15.951s          5.317ms          NaN              0.000us          0.000us          3000             \r\nAddcmulBackward                      1.95%            9.501s           47.97%           233.571s         233.571ms        NaN              0.000us          0.000us          1000             \r\ntorch::autograd::AccumulateGrad      0.97%            4.737s           4.25%            20.687s          6.896ms          NaN              0.000us          0.000us          3000             \r\nas_strided                           0.00%            20.049ms         0.00%            20.049ms         5.012us          NaN              0.000us          0.000us          4000             \r\nNativeBatchNormBackward              0.00%            13.951ms         43.86%           213.573s         213.573ms        NaN              0.000us          0.000us          1000             \r\nreshape                              0.00%            13.034ms         0.01%            33.083ms         8.271us          NaN              0.000us          0.000us          4000             \r\nViewBackward                         0.00%            9.419ms          0.01%            42.502ms         10.626us         NaN              0.000us          0.000us          4000             \r\ntorch::autograd::GraphRoot           0.00%            1.189ms          0.00%            1.189ms          1.189us          NaN              0.000us          0.000us          1000             \r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nSelf CPU time total: 486.916s\r\nCUDA time total: 0.000us\r\n', '\r\nGroupNorm forward: 11.333400868010358ms\r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nName                        Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  \r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\ngroup_norm                  23.06%           56.891ms         100.00%          246.741ms        246.741us        31.20%           11.369s          11.369ms         1000             \r\nbatch_norm                  8.59%            21.194ms         35.82%           88.382ms         88.382us         18.89%           6.884s           6.884ms          1000             \r\n_batch_norm_impl_index      6.50%            16.045ms         27.23%           67.189ms         67.189us         18.86%           6.872s           6.872ms          1000             \r\nnative_batch_norm           20.73%           51.143ms         20.73%           51.143ms         51.143us         18.83%           6.861s           6.861ms          1000             \r\naddcmul                     15.17%           37.434ms         15.17%           37.434ms         37.434us         12.13%           4.419s           4.419ms          1000             \r\nview                        21.76%           53.695ms         21.76%           53.695ms         13.424us         0.06%            21.595ms         5.399us          4000             \r\ncontiguous                  4.19%            10.339ms         4.19%            10.339ms         10.339us         0.03%            9.650ms          9.650us          1000             \r\n--------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nSelf CPU time total: 246.741ms\r\nCUDA time total: 36.436s\r\n\r\nGroupNorm backward: 42.1425356430118ms\r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nName                                 Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  \r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nAddcmulBackward                      10.08%           69.875ms         36.22%           251.046ms        251.046us        24.64%           19.492s          19.492ms         1000             \r\nmul                                  26.14%           181.171ms        26.14%           181.171ms        45.293us         24.60%           19.460s          4.865ms          4000             \r\nNativeBatchNormBackward              3.44%            23.832ms         9.82%            68.072ms         68.072us         14.23%           11.261s          11.261ms         1000             \r\nnative_batch_norm_backward           6.38%            44.240ms         6.38%            44.240ms         44.240us         14.23%           11.255s          11.255ms         1000             \r\ntorch::autograd::AccumulateGrad      7.14%            49.495ms         16.52%           114.485ms        38.162us         8.02%            6.343s           2.114ms          3000             \r\nadd_                                 9.38%            64.990ms         9.38%            64.990ms         21.663us         8.00%            6.326s           2.109ms          3000             \r\nsum                                  11.71%           81.163ms         11.71%           81.163ms         40.581us         6.15%            4.863s           2.431ms          2000             \r\nViewBackward                         9.72%            67.398ms         23.92%           165.801ms        41.450us         0.07%            57.930ms         14.482us         4000             \r\nreshape                              8.35%            57.903ms         14.20%           98.403ms         24.601us         0.04%            35.134ms         8.783us          4000             \r\nas_strided                           5.84%            40.500ms         5.84%            40.500ms         10.125us         0.01%            11.111ms         2.778us          4000             \r\ntorch::autograd::GraphRoot           1.81%            12.526ms         1.81%            12.526ms         12.526us         0.01%            8.698ms          8.698us          1000             \r\n-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  \r\nSelf CPU time total: 693.093ms\r\nCUDA time total: 79.113s\r\n\r\n']"
487,2011,0,"Build passing, but runtime failing (at commit ebdec9a837074a303fd5ffb6f319cd593955becc). Running import torch gives the following error on the latest master:



# git log
commit ebdec9a837074a303fd5ffb6f319cd593955becc
Author: lynic <xuanlangjian@gmail.com>
Date:   Fri Jul 7 23:06:56 2017 +0800

    Skip distributed tests if not supported (#2004)
. ['\r\nTraceback (most recent call last):\r\n  File ""classifier.py"", line 1, in <module>\r\n    import torch\r\n  File ""/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/__init__.py"", line 53, in <module>\r\n    from torch._C import *\r\nImportError: /opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/lib/libTHC.so.1: undefined symbol: THLongStorage_inferSizeN\r\n']"
514,140,0,"Index / SetValue don't work for 1D Variables. Snippet to reproduce.



The problem is in [here](https://github.com/pytorch/pytorch/blob/master/torch/autograd/functions/tensor.py#L27), [here](https://github.com/pytorch/pytorch/blob/master/torch/autograd/functions/tensor.py#L40) and [here](https://github.com/pytorch/pytorch/blob/master/torch/autograd/functions/tensor.py#L45), and is due to the fact that  return numbers when indexing a 1D tensor (which I think is the desired behaviour as we don't have broadcasting yet?).

Maybe we should check if the input is 1D (and that the index is of range 1) and to use  instead of  in this case?
Autograd  return a 1D tensor anyway if we index it with a 1D tensor in forward, but this solution could avoid the sync point with cuda tensors in  (as we don't return a number).

Or, another solution would be to have something like 0D tensors which behave almost like numbers? This seems to be what numpy does.
. [' python\nimport torch\nfrom torch.autograd import Variable\n\nx = Variable(torch.Tensor([1, 2, 3]), requires_grad=True)\ny = x[0]\n\ny.backward() # error\n\nx[1] = 5 # error\n']"
255,22277,0,Handle all IntArrayRef expansions in ATen. See #22032 and #20866 for the rationale and #22073 for an example.. []
112,24608,0,"Migrate `nll_loss2d_forward` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
678,30989,0,"Does Distributed Data Parallel Support model parallel where output of the model are in different devices?. By following the tutorial, I combine the model parallel and DDP together but the last layer(the parameter is really large) is doing some model parallel work like this code [source](https://github.com/bindog/pytorch-model-parallel/blob/8d1c0b91d4eb75c861059f4940159b06574189df/model.py#L39). However, it stuck at here



the gpu list for first DDP is [0, 1, 2, 3]
the gpu list for second DDP is [4, 5, 6, 7]
I modify the source code to make sure the chunk follow the parameter of gpu list



If it does not support output on multiple device, how can I reorganize the last layer?

cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @rohan-varma @gqchen @aazzolini @xush6528. ['python\r\nmodel.features = model.features.to(args.gpu_list[0])\r\nmodel = torch.nn.parallel.DistributedDataParallel(model)\r\n', 'python\r\nclass FullyConnected(nn.Module):\r\n    def __init__(self,\r\n                 in_dim,\r\n                 out_dim,\r\n                 gpu_list=[],\r\n                 model_parallel=False,\r\n                 class_split=None):\r\n        super(FullyConnected, self).__init__()\r\n        self.gpu_list = gpu_list\r\n        self.model_parallel = model_parallel\r\n        if model_parallel:\r\n            self.fc_chunks = nn.ModuleList()\r\n            for i in range(len(self.gpu_list)):\r\n                self.fc_chunks.append(\r\n                    nn.Linear(in_dim, class_split[i], bias=True).cuda(self.gpu_list[i])\r\n                )\r\n        else:\r\n            self.fc = nn.Linear(in_dim, out_dim, bias=True)\r\n\r\n    def forward(self, x, labels=None):\r\n        # print(x.size())\r\n        if self.model_parallel:\r\n            x_list = []\r\n            for i in range(len(self.gpu_list)):\r\n                _x = self.fc_chunks[i](x.cuda(self.gpu_list[i]))\r\n                x_list.append(_x)\r\n            return tuple(x_list)\r\n        else:\r\n            return self.fc(x)\r\n']"
71,23425,1,"Hanging on when one gpu node return zero as loss in the context of distributed data parallel training. ## üêõ Bug

Hello.
I am training a multi task network on a cluster using 8 gpu with .
On every iteration, I process one image per gpu.
Suppose I have  and  with  and  respectively.
In some case, the  could be zero on one gpu, which means that there is no loss computed.
Then I just return the zero tensor.
When this situation happens, the code just hang on.

 - PyTorch Version: 1.1.0 
 - OS (e.g., Linux): Ubuntu 
 - How you installed PyTorch (, , source): docker conda
 - Python version: 3.6
 - CUDA/cuDNN version:  CUDA 9.0
 - GPU models and configuration: 1080ti
 - Any other relevant information:

. []"
150,12210,0,"PackagesNotFoundError: unable to install torchvision in anaconda prompt on windows 10. 

returns the following:

. []"
143,26726,0,"[jit] Recursive script doesn't pick up TorchScript class attributes. 

cc @suo. [""python\r\n@torch.jit.script\r\nclass X(object)\r\n\t...\r\n\r\nclass M(nn.Module):\r\n\tdef __init__(self):\r\n\t\tsuper().__init__()\r\n\r\n\t\t# The type is not inferred correctly here, so this doesn't get added as an attribute\r\n\t\tself.x = X()\r\n""]"
571,2369,0,"Calculate the derivative of a node with respect to an input image. 
I would like to calculate the derivative of any node in respect of image input to implement visualization methods using PyTorch.

Any suggestions ? . []"
588,27507,0,"[ONNX] Export torch.meshgrid. ## üöÄ Feature
Export meshgrid to ONNX

## Motivation

Instead of an error:



Can use  and 

## Pitch

Use  and  to export meshgrid

## Alternatives

Use  and  in the code

. [""python\r\n90     global _registry\r\n---> 91     return _registry[(domain, version)][opname]\r\nKeyError: 'meshgrid'\r\n""]"
334,14672,0,"Inconsistent behavior for log_prob when values are outside of support. ## üêõ Bug

In Scipy, if you try to calculate the log probability of a value outside of the given distribution's support, scipy will return .

The Uniform Distribution for torch follows this behavior, as shown below:

However, this behavior does not extend to other distributions that have a constrained support, such as the exponential, beta, and gamma, or discrete distributions such as the geometric. 









These four are the distributions that I've tested; I'm unsure if there are more.  Is this discrepancy in behavior expected?  Please let me know if I've missed something.

### System Info
Collecting environment information...
PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.0.176

OS: Ubuntu 18.10
GCC version: (Ubuntu 8.2.0-7ubuntu1) 8.2.0
CMake version: version 3.12.1

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: GeForce GTX 960M
Nvidia driver version: 415.13
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy (1.15.4)
[pip] numpydoc (0.8.0)
[pip] torch (0.4.1)
[conda] pytorch                   0.4.1            py37ha74772b_0


cc @fritzo @neerajprad @alicanb @nikitaved. ['python\r\n> Uniform(torch.tensor(0.),torch.tensor(1.)).log_prob(torch.tensor(5.))\r\n> tensor(-Inf)\r\n', 'python \r\n> Beta(torch.tensor(1.),torch.tensor(1.)).log_prob(torch.tensor(5.))\r\n> tensor(nan)\r\n', 'python\r\n> Exponential(torch.tensor(2.)).log_prob(torch.tensor(-5.))\r\n> tensor(11.6094)\r\n', 'python\r\n> Gamma(torch.tensor(1.),torch.tensor(1.)).log_prob(torch.tensor(-1.))\r\n> tensor(nan)\r\n', 'python\r\n> Geometric(torch.tensor(5.)).log_prob(torch.tensor(-1.))\r\n> tensor(nan)\r\n']"
294,3990,0,"Raise an error when using magma built against wrong version of cuda. Previous instances of this: https://github.com/pytorch/pytorch/issues/3018

I myself was affected by this bug when a server I was working on upgraded from cuda 8 to cuda 9. I dutifully rebuilt PyTorch but forgot to uninstall magma-cuda80: instant hang on CUDA initialization.. []"
182,4655,0,"Error with cuda9 docker build. When building pytorch with docker with 


I get the following error and the build stops:


I cloned the latest master with 
Ubuntu 16.04
Docker version 17.09.1-ce, build 19e2cf6. []"
564,956,0,"load_lua yields ""object has no attribute 'running_var'"" for BatchNormalization. When I try to load OpenFace model (https://storage.cmusatyalab.org/openface-models/nn4.small2.v1.t7) as:

    model = load_lua('nn4.small2.v1.t7',unknown_classes=True),

then, to convert unknown classes. 
But, I got the errors at the line below:

torch/utils/serialization/read_lua_file.py"", line 269, in BatchNorm_reader
    obj.running_var = obj.running_var.pow(-2).add(-obj.eps)

Thank you.
. []"
331,29692,0,[FR] add generator= kwarg support for torch.randn and torch.rand. All stochastic functions should accept . These should as well.. []
670,12241,0,"torch.sum() for sparse tensor. - Add 
- Add 
- Add autograd support. []"
380,20056,0,"Creation of too big multidimensional array returns empty tensor.. ## üêõ Bug

When trying to create a tensor of too many dimensions it simply returns an empty tensor with its shape is the dimensions I passed even though it should have contained the value .

## To Reproduce

Steps to reproduce the behavior:

Number of 2's in the following example is .

Output: 



Another related issue



These are  2's. 

Output: 



When they're  2's. The output changes to:



<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

I expected to see the aforementioned dimensions filled with  if it's possible, or an exception that says a value error.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


## Additional context

I suspect that the desired behavior is not happening because tensors seem to be basing on NumPy  which accepts only  dims.

Also, I have just found this [line](https://github.com/pytorch/pytorch/blob/7ddd5d06ed07a50b94aa6b2fdffa2f667d677c4b/aten/src/TH/THGeneral.cpp#L184).



I think the integer division of those two elements results in the error. . ['Python\r\ntorch.ones((2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2),\r\ndtype=torch.uint8)\r\n', 'Python\r\ntensor([],\r\n       size=(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2),\r\n       dtype=torch.uint8)\r\n', 'Python\r\ntorch.ones((2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2),\r\ndtype=torch.uint8)\r\n', 'Python\r\nRuntimeError: $ Torch: not enough memory: you tried to allocate 0GB. Buy new RAM! at /opt/conda/conda-bld/pytorch_1549628766161/work/aten/src/TH/THGeneral.cpp:201\r\n', 'Python\r\nRuntimeError: $ Torch: invalid memory size -- maybe an overflow? at /opt/conda/conda-bld/pytorch_1549628766161/work/aten/src/TH/THGeneral.cpp:188\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n', '\r\nPyTorch version: 1.0.1.post2\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Arch Linux\r\nGCC version: (crosstool-NG 1.23.0.449-a04d0) 7.3.0\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 10.1.105\r\nGPU models and configuration: GPU 0: GeForce GTX 1050 Ti with Max-Q Design\r\nNvidia driver version: 418.56\r\ncuDNN version: /usr/lib/libcudnn.so.7.5.0\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy==1.16.2\r\n[pip3] torch==1.0.1.post2\r\n[pip3] torchvision==0.2.2.post3\r\n[conda] _tflow_select             2.3.0                       mkl  \r\n[conda] blas                      1.0                         mkl  \r\n[conda] mkl                       2019.1                      144  \r\n[conda] mkl_fft                   1.0.10           py36ha843d7b_0  \r\n[conda] mkl_random                1.0.2            py36hd81dba3_0  \r\n[conda] pytorch                   1.0.1           py3.6_cuda9.0.176_cudnn7.4.2_2    pytorch\r\n[conda] tensorflow                1.12.0          mkl_py36h69b6ba0_0  \r\n[conda] tensorflow-base           1.12.0          mkl_py36h3c3e929_0  \r\n[conda] torchvision               0.2.1                      py_2    pytorch\r\n', 'cpp\r\nTHError(""$ Torch: not enough memory: you tried to reallocate %dGB. Buy new RAM!"", size/1073741824);\r\n']"
551,17971,0,"CuDNN error: CUDNN_STATUS_EXECUTION_FAILED. ## üêõ Bug
![2019-03-13 20-11-29](https://user-images.githubusercontent.com/12708080/54278734-2d791400-45ce-11e9-8926-64ffb9c5c2ed.png)
![2019-03-13 20-12-06](https://user-images.githubusercontent.com/12708080/54278743-34078b80-45ce-11e9-90ef-f2291ef9b95e.png)


## To Reproduce

Steps to reproduce the behavior:
Implementing such a network like this (or change from https://github.com/DrSleep/light-weight-refinenet  +  https://github.com/DrSleep/multi-task-refinenet)

![2019-03-13 20-39-56](https://user-images.githubusercontent.com/12708080/54279505-310d9a80-45d0-11e9-803a-0c7b5eeffb01.png)
![2019-03-13 20-39-35](https://user-images.githubusercontent.com/12708080/54279506-310d9a80-45d0-11e9-8429-bb7dfc595c70.png)
![2019-03-13 20-38-45](https://user-images.githubusercontent.com/12708080/54279508-31a63100-45d0-11e9-9463-71bd9e3ea21b.png)
![2019-03-13 20-38-34](https://user-images.githubusercontent.com/12708080/54279509-31a63100-45d0-11e9-87ee-bdd67041d22d.png)


and replace datasets.py to:
class Pad(object):
    """"""Pad image and mask to the desired size

    Args:
      size (int) : minimum length/width
      img_val (array) : image padding value
      msk_val (int) : mask padding value

    """"""
    def __init__(self, size, img_val, msk_val, dpt_val=None):
        self.size = size
        self.img_val = img_val
        self.msk_val = msk_val
        if dpt_val is None :
            self.dpt_val = msk_val
        else:
            self.dpt_val = dpt_val

    def __call__(self, sample):
        image, mask, depth = sample['image'], sample['mask'], sample['depth']
        h, w = image.shape[:2]
        h_pad = int(np.clip(((self.size - h) + 1)// 2, 0, 1e6))
        w_pad = int(np.clip(((self.size - w) + 1)// 2, 0, 1e6))
        pad = ((h_pad, h_pad), (w_pad, w_pad))
        image = np.stack([np.pad(image[:,:,c], pad,
                         mode='constant',
                         constant_values=self.img_val[c]) for c in range(3)], axis=2)
        mask = np.pad(mask, pad, mode='constant', constant_values=self.msk_val)
        depth = np.pad(depth, pad, mode='constant', constant_values=self.dpt_val)
        return {'image': image, 'mask': mask, 'depth': depth}

class RandomCrop(object):
    """"""Crop randomly the image in a sample.

    Args:
        output_size (tuple or int): Desired output size. If int, square crop
            is made.
    """"""

    def __init__(self, crop_size):
        assert isinstance(crop_size, int)
        self.crop_size = crop_size
        if self.crop_size % 2 != 0:
            self.crop_size -= 1

    def __call__(self, sample):
        image, mask, depth = sample['image'], sample['mask'], sample['depth']
        h, w = image.shape[:2]
        new_h = min(h, self.crop_size)
        new_w = min(w, self.crop_size)
        top = np.random.randint(0, h - new_h + 1)
        left = np.random.randint(0, w - new_w + 1)
        image = image[top: top + new_h,
                        left: left + new_w]
        mask = mask[top: top + new_h,
                    left: left + new_w]
        depth = depth[top: top + new_h,
                    left: left + new_w]
        return {'image': image, 'mask': mask, 'depth': depth}

class ResizeShorterScale(object):
    """"""Resize shorter side to a given value and randomly scale.""""""

    def __init__(self, shorter_side, low_scale, high_scale):
        assert isinstance(shorter_side, int)
        self.shorter_side = shorter_side
        self.low_scale = low_scale
        self.high_scale = high_scale

    def __call__(self, sample):
        image, mask, depth = sample['image'], sample['mask'], sample['depth']
        min_side = min(image.shape[:2])
        scale = np.random.uniform(self.low_scale, self.high_scale)
        if min_side * scale < self.shorter_side:
            scale = (self.shorter_side * 1. / min_side)
        image = cv2.resize(image, None, fx=scale, fy=scale, interpolation=cv2.INTER_CUBIC)
        mask = cv2.resize(mask, None, fx=scale, fy=scale, interpolation=cv2.INTER_NEAREST)
        depth = cv2.resize(depth, None, fx=scale, fy=scale, interpolation=cv2.INTER_NEAREST)
        return {'image': image, 'mask': mask, 'depth': depth}

class RandomMirror(object):
    """"""Randomly flip the image and the mask""""""

    def __init__(self):
        pass

    def __call__(self, sample):
        image, mask, depth = sample['image'], sample['mask'], sample['depth']
        do_mirror = np.random.randint(2)
        if do_mirror:
            image = cv2.flip(image, 1)
            mask = cv2.flip(mask, 1)
            depth = cv2.flip(depth, 1)
        return {'image': image, 'mask' : mask, 'depth': depth}

class Normalise(object):
    """"""Normalise a tensor image with mean and standard deviation.
    Given mean: (R, G, B) and std: (R, G, B),
    will normalise each channel of the torch.*Tensor, i.e.
    channel = (channel - mean) / std

    Args:
        mean (sequence): Sequence of means for R, G, B channels respecitvely.
        std (sequence): Sequence of standard deviations for R, G, B channels
            respecitvely.
    """"""

    def __init__(self, scale, mean, std):
        self.scale = scale
        self.mean = mean
        self.std = std

    def __call__(self, sample):
        image = sample['image']
        return {'image': (self.scale * image - self.mean) / self.std, 'mask' : sample['mask'], 'depth': sample['depth']}

class ToTensor(object):
    """"""Convert ndarrays in sample to Tensors.""""""

    def __call__(self, sample):
        image, mask, depth = sample['image'], sample['mask'], sample['depth']
        # swap color axis because
        # numpy image: H x W x C
        # torch image: C X H X W
        image = image.transpose((2, 0, 1))
        return {'image': torch.from_numpy(image),
                'mask': torch.from_numpy(mask),
                'depth': torch.from_numpy(depth)}

class NYUDataset(Dataset):
    """"""NYUv2-40""""""

    def __init__(
        self, data_file, data_dir, transform_trn=None, transform_val=None
        ):
        """"""
        Args:
            data_file (string): Path to the data file with annotations.
            data_dir (string): Directory with all the images.
            transform_{trn, val} (callable, optional): Optional transform to be applied
                on a sample.
        """"""
        with open(data_file, 'rb') as f:
            datalist = f.readlines()
        self.datalist = [(i,l,m) for i,l,m in map(lambda x: x.decode('utf-8').strip('\n').split('\t'), datalist)]
        self.root_dir = data_dir
        self.transform_trn = transform_trn
        self.transform_val = transform_val
        self.stage = 'train'

    def set_stage(self, stage):
        self.stage = stage

    def __len__(self):
        return len(self.datalist)

    def __getitem__(self, idx):
        #img_name = os.path.join(self.root_dir, self.datalist[idx][0])
        #msk_name = os.path.join(self.root_dir, self.datalist[idx][1])
        img_name = self.datalist[idx][0]
        msk_name = self.datalist[idx][1]
        dpt_name = self.datalist[idx][2]
        def read_image(x):
            img_arr = np.array(Image.open(x))
            if len(img_arr.shape) == 2: # grayscale
                img_arr = np.tile(img_arr, [3, 1, 1]).transpose(1, 2, 0)
            return img_arr
        image = read_image(img_name)
        mask = np.array(Image.open(msk_name))
        depth = np.array(Image.open(dpt_name))
        if img_name != msk_name:
            assert len(mask.shape) == 2, 'Masks must be encoded without colourmap'
        sample = {'image': image, 'mask': mask, 'depth': depth}
        if self.stage == 'train':
            if self.transform_trn:
                sample = self.transform_trn(sample)
        elif self.stage == 'val':
            if self.transform_val:
                sample = self.transform_val(sample)
        return sample



## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

conda install --yes --file requirements.txt

# This file may be used to create an environment using:
# $ conda create --name <env> --file <this file>
# platform: linux-64
atomicwrites=1.2.1=py36_0
attrs=18.2.0=py36h28b3542_0
backcall=0.1.0=py36_0
blas=1.0=mkl
ca-certificates=2018.03.07=0
certifi=2018.10.15=py36_0
cffi=1.11.5=py36he75722e_1
cloudpickle=0.6.1=py36_0
cudatoolkit=9.0=h13b8566_0
cudnn=7.1.2=cuda9.0_0
cycler=0.10.0=py36h93f1223_0
cython=0.29=py36he6710b0_0
cytoolz=0.9.0.1=py36h14c3975_1
dask-core=0.20.0=py36_0
dbus=1.13.2=h714fa37_1
decorator=4.3.0=py36_0
expat=2.2.6=he6710b0_0
fontconfig=2.13.0=h9420a91_0
freetype=2.9.1=h8a8886c_1
glib=2.56.2=hd408876_0
gst-plugins-base=1.14.0=hbbd80ab_1
gstreamer=1.14.0=hb453b48_1
icu=58.2=h9c2bf20_1
imageio=2.4.1=py36_0
intel-openmp=2019.0=118
ipython=7.1.1=py36h39e3cac_0
ipython_genutils=0.2.0=py36hb52b0d5_0
jedi=0.13.1=py36_0
jpeg=9b=h024ee3a_2
kiwisolver=1.0.1=py36hf484d3e_0
libedit=3.1.20170329=h6b74fdf_2
libffi=3.2.1=hd88cf55_4
libgcc-ng=8.2.0=hdf63c60_1
libgfortran-ng=7.3.0=hdf63c60_0
libpng=1.6.35=hbc83047_0
libstdcxx-ng=8.2.0=hdf63c60_1
libtiff=4.0.9=he85c1e1_2
libuuid=1.0.3=h1bed415_2
libxcb=1.13=h1bed415_1
libxml2=2.9.8=h26e45fe_1
markdown=2.6.8=py36_0
matplotlib=3.0.1=py36h5429711_0
mkl=2018.0.3=1
mkl_fft=1.0.6=py36h7dd41cf_0
mkl_random=1.0.1=py36h4414c95_1
more-itertools=4.3.0=py36_0
nccl=1.3.5=cuda9.0_0
ncurses=6.1=hf484d3e_0
networkx=2.2=py36_1
ninja=1.8.2=py36h6bb024c_1
numpy=1.15.3=py36h1d66e8a_0
numpy-base=1.15.3=py36h81de0dd_0
olefile=0.46=py36_0
openssl=1.0.2p=h14c3975_0
parso=0.3.1=py36_0
pcre=8.42=h439df22_0
pexpect=4.6.0=py36_0
pickleshare=0.7.5=py36_0
pillow=5.3.0=py36h34e0f95_0
pip=10.0.1=py36_0
pluggy=0.8.0=py36_0
prompt_toolkit=2.0.7=py36_0
ptyprocess=0.6.0=py36_0
py=1.7.0=py36_0
pycparser=2.19=py36_0
pydot=1.2.4=py36_0
pygments=2.2.0=py36h0d3125c_0
pyparsing=2.2.2=py36_0
pyqt=5.9.2=py36h05f1152_2
pytest=3.9.3=py36_0
pytest-runner=4.2=py36_0
python=3.6.6=h6e4f718_2
python-dateutil=2.7.5=py36_0
pytorch=0.4.1=py36_py35_py27__9.0.176_7.1.2_2
pytz=2018.7=py36_0
pywavelets=1.0.1=py36hdd07704_0
qt=5.9.6=h8703b6f_2
readline=7.0=h7b6447c_5
scikit-image=0.14.1=py36he6710b0_0
scipy=1.1.0=py36hfa4b5c9_1
setuptools=40.4.3=py36_0
sip=4.19.8=py36hf484d3e_0
six=1.11.0=py36_1
sqlite=3.25.2=h7b6447c_0
tk=8.6.8=hbc83047_0
toolz=0.9.0=py36_0
torchvision=0.2.1=py_2
tornado=5.1.1=py36h7b6447c_0
traitlets=4.3.2=py36_0
wcwidth=0.1.7=py36_0
wheel=0.32.2=py36_0
xz=5.2.4=h14c3975_4
zlib=1.2.11=ha838bed_2

condapip`, source): conda
 - Build command you used (if compiling from source): conda install --yes --file requirements.txt 
 - Python version: 3.6
 - CUDA/cuDNN version: 9.0/7.1.2
 - GPU models and configuration: GTX1070Ti
 - Any other relevant information:
. []"
700,21680,0,"Disable nondeterministic CTCLoss from cuDNN. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:

1.I i updated pytorch version and ctcÔºåuse pytorch_nightly, but in my train ,nn.CTCloss() is still zero,so,i would like to ask if the version pytorch(nightly) has been solved this problem
1.
1.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0):
 - OS (e.g., Linux):
 - How you installed PyTorch (, , source):
 - Build command you used (if compiling from source):
 - Python version:
 - CUDA/cuDNN version:
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
372,25034,0,"make add_module accept tuples as well or change containers(ModuleList, Sequential, etc) to allow this. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->

## Motivation
The API is not consistent with the way architectures are made. That is you can do some actions using a set of methods, but cant do the same actions using a slightly different version of the same methods. To be more clear for example, currently if you want to alter/use a part of an existing architecture you may use   like this : 
1. method 1 :    

2. or a slightly different version 

However, the very time you  try to use the named version of same method (i.e ), you no longer can do the same thing and will face the error : 

in the process of using only  method in such situations, you lose the information originally placed in the architecture, meaning you no longer have access to the modules using their names. 
The source of the issue lies in  the  method which interestingly accepts a name and a module by default. 

  
## Pitch
allow for ,  and alikes that accept modules, also accept named modules. meaning these two snippets be interchangeable : 

using modules only ()

using tuple ()




cc @SsnL. ['\r\nmodel = torchvision.models.resnet18(pretrained=True)\r\nmodel_features = nn.ModuleList(model.children())[ : -1] \r\n...\r\n', '\r\nmodel = torchvision.models.resnet18(pretrained=True)\r\nmodel_features = list(model.children())[ : -1]\r\nmodel_features = nn.Sequential(*model_features) \r\n...\r\n', '\r\nmodel = torchvision.models.resnet18(pretrained=True)\r\nmodel_features = nn.ModuleList(model.children())[ : -1] \r\n', '\r\nmodel = torchvision.models.resnet18(pretrained=True)\r\nmodel_features = nn.ModuleList(model.named_children())[ : -1] \r\n']"
22,15482,1,"GPU allocated memory is not released. I create CNN to work with images. This network is of the U-Net type for segmentation, which by its architecture saves intermediate calculations. This leads to the conclusion that with a small amount of memory you need to either reduce the size of the image, the number of layers, the size of the batch.
![default](https://user-images.githubusercontent.com/37583380/50356634-ccf4b080-0563-11e9-824a-44f7ef669087.png)
If you give the network a single image of a small size, the memory becomes slightly larger, which is logical.
![default](https://user-images.githubusercontent.com/37583380/50356532-5d7ec100-0563-11e9-95d2-9c7e27bd1558.png)
When you restart with the same image, the amount of allocated memory does not change, only the occupied part of the memory cache increases.
![default](https://user-images.githubusercontent.com/37583380/50356677-ed246f80-0563-11e9-8595-8eb10b651868.png)
Error text:
RuntimeError                              Traceback (most recent call last)
<ipython-input-25-8ba8cee8f3f0> in <module>()
      1 test = np.random.sample([1, 3, 1280, 1280]) * 0.5
----> 2 out = net(torch.FloatTensor(test).to(device))
      3 out.shape

E:\Python\Anaconda\lib\site-packages\torch\nn\modules\module.py in __call__(self, *input, **kwargs)
    487             result = self._slow_forward(*input, **kwargs)
    488         else:
--> 489             result = self.forward(*input, **kwargs)
    490         for hook in self._forward_hooks.values():
    491             hook_result = hook(self, input, result)

<ipython-input-12-552150536d36> in forward(self, x)
     50         x = self.maxpool(d1)
     51 
---> 52         d2 = self.down2(x)
     53         x = self.maxpool(d2)
     54 

E:\Python\Anaconda\lib\site-packages\torch\nn\modules\module.py in __call__(self, *input, **kwargs)
    487             result = self._slow_forward(*input, **kwargs)
    488         else:
--> 489             result = self.forward(*input, **kwargs)
    490         for hook in self._forward_hooks.values():
    491             hook_result = hook(self, input, result)

E:\Python\Anaconda\lib\site-packages\torch\nn\modules\container.py in forward(self, input)
     90     def forward(self, input):
     91         for module in self._modules.values():
---> 92             input = module(input)
     93         return input
     94 

E:\Python\Anaconda\lib\site-packages\torch\nn\modules\module.py in __call__(self, *input, **kwargs)
    487             result = self._slow_forward(*input, **kwargs)
    488         else:
--> 489             result = self.forward(*input, **kwargs)
    490         for hook in self._forward_hooks.values():
    491             hook_result = hook(self, input, result)

E:\Python\Anaconda\lib\site-packages\torch\nn\modules\activation.py in forward(self, input)
     48     @weak_script_method
     49     def forward(self, input):
---> 50         return F.threshold(input, self.threshold, self.value, self.inplace)
     51 
     52     def extra_repr(self):

E:\Python\Anaconda\lib\site-packages\torch\nn\functional.py in threshold(input, threshold, value, inplace)
    838         result = _VF.threshold_(input, threshold, value)
    839     else:
--> 840         result = _VF.threshold(input, threshold, value)
    841     return result
    842 

RuntimeError: CUDA out of memory. Tried to allocate 100.00 MiB (GPU 0; 2.00 GiB total capacity; 1.34 GiB already allocated; 5.20 MiB free; 12.75 MiB cached)

After a large image again give the network image smaller and again get the same error:
![default](https://user-images.githubusercontent.com/37583380/50356722-2230c200-0564-11e9-8fba-54855c20de9f.png)
Things with memory become like this:
![default](https://user-images.githubusercontent.com/37583380/50356785-67ed8a80-0564-11e9-8a9c-895b453410ba.png)

Without restarting jupyter notebook in which I work, the memory does not clear out.

. []"
667,685,0,"detach not working properly for stochastic variables. I'm not able to reproduce a simple example for now, will try to make one later. But basically I'm facing this issue in my code:



I have a variable , and doing  does not solve the issue. However,  solves it, which seems weird to me... []"
119,13491,0,"Numerical ODE solvers. ## üöÄ Feature
It would be useful to have a library of numerical ODE solvers that are compatible with PyTorch.

## Motivation
Neural networks are increasingly being combined with ODEs. For example, when modelling ODEs that form part of a probabilistic model, or when defining a derivative with a neural network (neural ODEs).

You may want to get a speedup by using the GPU with PyTorch for this, and it's useful to be able to differentiate through these algorithms too.

## Pitch
I'm proposing to create a  module that contains half a dozen common ODE solvers. For instance, you could call  to calculate  points from  to  for the equation 
. []"
235,5331,0,"[ppc64le] FAIL: test_set_flush_denormal (__main__.TestTorch). hi,  I just saw this error in the last few days.  both for GPU and CPU only environment.
Is the test precision assertion correct ?


. ['\r\nFAIL: test_set_flush_denormal (__main__.TestTorch)\r\n\r\nTraceback (most recent call last):\r\n  File ""test_torch.py"", line 5519, in test_set_flush_denormal\r\n    self.assertEqual(float_tensor[1], 0.0, prec=0.0)  # tiny_float to zero\r\n  File ""/home/freddie/builder/jenkins/pytorch/pytorch/test/common.py"", line 256, in assertEqual\r\n    super(TestCase, self).assertLessEqual(abs(x - y), prec, message)\r\nAssertionError: 1.0005271035279194e-42 not less than or equal to 0.0 :\r\n']"
281,23512,0,"Build reconfiguration should consistently honor env variables. Per discussion here: https://github.com/pytorch/pytorch/pull/23323#issuecomment-515168182

We currently have

(plainly == no additional build options passed in to setup.py)

for clean tree:

- configuration only: 
- configuration + build: invoke setup.py plainly

For rebuild:

- reconfiguration without rebuild:  (unreliable), or edit CMakeCache.txt and run cmake directly
- rebuild without reconfiguration: invoke setup.py plainly, all build options persist
- reconfiguration + rebuild:  (unreliable), or edit CMakeCache.txt and invoke setup.py plainly

We need to make the two ""unreliable"" spots ""reliable"".. []"
715,22017,0,"mkldnn_version.h: No such file or directory. I compiled pytorch under ubuntu18.04, gcc 7.4.0, and I git checkout v1.0.0 before compiling.
After the compiling process begins, I terminated at about 34% with the error:


So what's wrong with it and how can I solve this problem? Can anyone help me with this issue?
. ['\r\n[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o\r\n[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/SpectralOps.cpp.o\r\n[ 34%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkldnn/Conv.cpp.o\r\nCompiling  all_gather.cu                       > /home/xwdu/pytorch/build/nccl/obj/collectives/device/all_gather_min_f32.o\r\nIn file included from /home/xwdu/pytorch/third_party/ideep/mkl-dnn/include/mkldnn.hpp:28:0,\r\n                 from /home/xwdu/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /home/xwdu/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/home/xwdu/pytorch/third_party/ideep/mkl-dnn/include/mkldnn.h:55:10: fatal error: mkldnn_version.h: No such file or directory\r\n #include ""mkldnn_version.h""\r\n          ^~~~~~~~~~~~~~~~~~\r\ncompilation terminated.\r\n']"
599,12946,0,"[jit][trace] non-argument tensors with requires_grad=True are traced as constants. ## üêõ Bug

non-argument tensors with requires_grad=True are traced as constants

## To Reproduce

## Expected behavior

The output should have requires_grad=True so that one can backprop through it

## Environment
PT master

Reported by @SsnL . ['\r\nimport torch\r\nx = torch.randn(3, requires_grad=True)\r\ndef f(inp):\r\n    return (x + inp).sum()\r\n\r\ntf = torch.jit.trace(f, (torch.randn(1),))\r\nf(torch.randn(1))\r\n# expected output: tensor(-1.2899, grad_fn=<SumBackward0>) result requires grad\r\n\r\ntf(torch.randn(1))\r\n# got output: tensor(-3.6019), result does not require grad!\r\n']"
262,21683,0,"Import ONNX model to Pytorch. ## üöÄ Feature

Importing ONNX models into Pytorch.
## Motivation

Almost all other frameworks already support this. Importing ONNX models into Pytorch makes Pytorch much more flexible.

## Pitch

In , a function should be created to take the ONNX model and outputs a Pytorch model. . []"
48,5406,1,"BatchNorm behaves different in train() and eval(). 

Sample output:

Also in master:
. [""python\r\nimport torch\r\nimport torch.nn as nn\r\nfrom torch.autograd import Variable\r\n\r\nprint(torch.__version__)\r\n\r\ndef get_data(cuda=False):\r\n    if cuda:\r\n        return torch.cuda.FloatTensor(32, 1, 19, 19)\r\n    else:\r\n        return torch.FloatTensor(32, 1, 19, 19)\r\n\r\nm = nn.Sequential(\r\n    nn.Conv2d(1, 3, kernel_size=3, padding=1),\r\n    nn.BatchNorm2d(3),\r\n    nn.ReLU()\r\n)\r\n\r\ncuda = True\r\nif cuda:\r\n    m.cuda()\r\n\r\nm.eval()\r\nprint(m._modules['1'].training)\r\n\r\nx = Variable(get_data(cuda))\r\ny1 = m.forward(x)\r\n\r\nm.train()\r\nprint(m._modules['1'].training)\r\ny2 = m.forward(x)\r\n\r\nerr = (y1 - y2).norm().data[0]\r\nif err > 1e-5:\r\n    print(err)\r\n"", '\r\n0.3.0.post4\r\nFalse\r\nTrue\r\n33.47104263305664\r\n', '\r\n0.4.0a0+0ef1038\r\nFalse\r\nTrue\r\n6.883443355560303\r\n']"
492,20465,0,"Second order gradient cuda error. ## üêõ Bug
Convnet training on GPU: when penalizing gradient growth (backpropagating a gradient of a gradient) the following error happens:

indexValue >= 0 && indexValue < src.sizes[dim]

## Environment
PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: version 3.6.2

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.1.85
GPU models and configuration:
GPU 0: TITAN X (Pascal)
GPU 1: TITAN X (Pascal)
GPU 2: TITAN X (Pascal)
GPU 3: TITAN X (Pascal)

Nvidia driver version: 418.56
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.1.3
/usr/local/cuda-9.0/lib64/libcudnn.so.7.2.1

Versions of relevant libraries:
[pip3] numpy==1.15.0
[pip3] torch==1.1.0
[pip3] torchfile==0.1.0
[pip3] torchvision==0.2.2
[conda] blas                      1.0                         mkl
[conda] cuda92                    1.0                           0    pytorch
[conda] mkl                       2018.0.3                      1
[conda] mkl_fft                   1.0.4            py36h4414c95_1
[conda] mkl_random                1.0.1            py36h4414c95_1
[conda] pytorch                   1.1.0           py3.6_cuda10.0.130_cudnn7.5.1_0    pytorch
[conda] torchfile                 0.1.0                      py_0    conda-forge
[conda] torchvision               0.2.2                      py_3    pytorch
## Additional context

<!-- Add any other context about the problem here. -->
If I change the coefficient in  from 0.1 to 10 the error does NOT happen (at least not before ~40 epochs), same if I reduce the learning rate from 1 to 0.001. 
. ['\r\n\r\n## To Reproduce\r\n\r\n']"
14,23642,1,"Performance Regression of Dataloader. ## üêõ Bug

Latest change to Dataloader (#19228) leads to severe performance regression for large scale training up to 30%. We finally root the cause to theses change: https://github.com/pytorch/pytorch/blob/master/torch/utils/data/dataloader.py#L889-L891. It causes the exit of each epoch has additional 5 seconds.

## To Reproduce

Steps to reproduce the behavior:

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->



## Expected behavior

The exit is basically free in pytorch 1.1, but it takes 5s in pytorch 1.2.


<!-- A clear and concise description of what you expected to happen. -->

## Environment



## Additional context

<!-- Add any other context about the problem here. -->

The suggest fix is to recover previous lines around https://github.com/pytorch/pytorch/blob/master/torch/utils/data/dataloader.py#L889-L891. For example, following code will fix the problem:


. ['python\r\n# regression.py\r\nimport torch\r\nimport time\r\n\r\nfrom torch.utils.data import TensorDataset, DataLoader\r\n\r\ndataset = TensorDataset(torch.randn(10240, 2))\r\nloader = DataLoader(dataset, batch_size=128, num_workers=2, pin_memory=True, drop_last=False)\r\n\r\nfor epoch in range(10):\r\n    for idx, data in enumerate(loader):\r\n        data = data[0].cuda()\r\n        if idx == 10240/128-1:\r\n            ts = time.time()\r\n    print(""Exit epoch {} elapsed {:.2f}s"".format(epoch, time.time()-ts))\r\n', 'console\r\n# 1.2.0a0\r\n$ python regression.py\r\nExit epoch 0 elapsed 5.01s       \r\nExit epoch 1 elapsed 5.05s       \r\nExit epoch 2 elapsed 5.05s       \r\nExit epoch 3 elapsed 5.05s       \r\nExit epoch 4 elapsed 5.05s       \r\nExit epoch 5 elapsed 5.05s       \r\nExit epoch 6 elapsed 5.05s       \r\nExit epoch 7 elapsed 5.05s       \r\nExit epoch 8 elapsed 5.05s       \r\nExit epoch 9 elapsed 5.04s\r\n\r\n# 1.1.0a0\r\n$ python regression.py\r\nExit epoch 0 elapsed 0.01s       \r\nExit epoch 1 elapsed 0.02s       \r\nExit epoch 2 elapsed 0.03s       \r\nExit epoch 3 elapsed 0.02s       \r\nExit epoch 4 elapsed 0.03s       \r\nExit epoch 5 elapsed 0.03s       \r\nExit epoch 6 elapsed 0.03s       \r\nExit epoch 7 elapsed 0.03s       \r\nExit epoch 8 elapsed 0.02s       \r\nExit epoch 9 elapsed 0.02s  \r\n', '\r\nPyTorch version: 1.2.0a0+5b0484d                                          \r\nIs debug build: No                                                        \r\nCUDA used to build PyTorch: 10.1.233                                      \r\n                                                                          \r\nOS: Ubuntu 18.04.2 LTS                                                    \r\nGCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0                        \r\nCMake version: version 3.14.0                                             \r\n                                                                          \r\nPython version: 3.6                                                       \r\nIs CUDA available: Yes                                                    \r\nCUDA runtime version: 10.1.241                                            \r\nGPU models and configuration:                                             \r\nGPU 0: Tesla V100-SXM2-16GB                                               \r\nGPU 1: Tesla V100-SXM2-16GB                                               \r\nGPU 2: Tesla V100-SXM2-16GB                                               \r\nGPU 3: Tesla V100-SXM2-16GB                                               \r\nGPU 4: Tesla V100-SXM2-16GB                                               \r\nGPU 5: Tesla V100-SXM2-16GB                                               \r\nGPU 6: Tesla V100-SXM2-16GB                                               \r\nGPU 7: Tesla V100-SXM2-16GB                                               \r\n                                                                          \r\nNvidia driver version: 418.40.04                                          \r\ncuDNN version: /usr/lib/x86_64-linux-gnu/libcudnn.so.7.6.3                \r\n                                                                          \r\nVersions of relevant libraries:                                           \r\n[pip] msgpack-numpy==0.4.3.2                                              \r\n[pip] numpy==1.16.4                                                       \r\n[pip] torch==1.2.0a0+5b0484d                                              \r\n[pip] torchtext==0.4.0                                                    \r\n[pip] torchvision==0.3.0a0                                                \r\n[conda] magma-cuda100             2.1.0                         5    local\r\n[conda] mkl                       2019.1                      144         \r\n[conda] mkl-include               2019.1                      144         \r\n[conda] nomkl                     3.0                           0         \r\n[conda] torch                     1.2.0a0+5b0484d          pypi_0    pypi \r\n[conda] torchtext                 0.4.0                    pypi_0    pypi \r\n[conda] torchvision               0.3.0a0                  pypi_0    pypi \r\n', 'python\r\nself.worker_result_queue.cancel_join_thread()\r\nself.worker_result_queue.put((0, None))      \r\nself.pin_memory_thread.join()                \r\nself.worker_result_queue.close()   \r\n']"
52,25904,1,"Python hang after using torch.exp(). ## üêõ Bug

Using function torch.exp() makes python hang. I test some other functions like torch.sum(), torch.abs(), these functions can return right results.
<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:


Python just hang, python cannot be closed by using CTRL+C under Ubuntu 16.04.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

Out[2]: Tensor([1, 2])
<!-- A clear and concise description of what you expected to happen. -->

## Environment

Collecting environment information...
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.5 LTS
GCC version: (Ubuntu 5.3.1-14ubuntu2) 5.3.1 20160413
CMake version: version 3.5.1

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.0.176
GPU models and configuration: 
GPU 0: GeForce GTX 1080 Ti
GPU 1: GeForce GTX 1080 Ti

Nvidia driver version: 410.93
cuDNN version: Could not collect

Versions of relevant libraries:
[pip] numpy==1.16.2
[pip] numpydoc==0.9.1
[pip] torch==1.2.0
[pip] torch-cluster==1.4.2
[pip] torch-geometric==1.2.1
[pip] torch-scatter==1.2.0
[pip] torch-sparse==0.4.0
[pip] torch-spline-conv==1.1.0
[pip] torchsummaryX==1.3.0
[pip] torchvision==0.4.0a0+6b959ee
[conda] blas                      1.0                         mkl  
[conda] cuda90                    1.0                  h6433d27_0    pytorch
[conda] mkl                       2018.0.3                      1  
[conda] mkl-service               1.1.2            py36h90e4bf4_5  
[conda] torch                     1.2.0                    pypi_0    pypi
[conda] torch-cluster             1.4.2                    pypi_0    pypi
[conda] torch-geometric           1.2.1                    pypi_0    pypi
[conda] torch-scatter             1.2.0                    pypi_0    pypi
[conda] torch-sparse              0.4.0                    pypi_0    pypi
[conda] torch-spline-conv         1.1.0                    pypi_0    pypi
[conda] torchsummaryx             1.3.0                    pypi_0    pypi
[conda] torchvision               0.2.2.post2              pypi_0    pypi
. ['\r\ntorch.exp(torch.Tensor([0, math.log(2)]))\r\n']"
302,12181,0,"Network surgery for transfer fails. ## Per the pytorch/caffe2 Readme I am asking here.

I would like to use an existing network definition and weights from the model zoo as the backbone for a new network. In this specific example the architecture will be squeezenet, and the new network simply has a different shape for the top parameterized layers ['conv10_w', 'conv10_b'], to accommodate a different set of classes from Imagenet. 

Unfortunately, it is not clear from the documentation, tutorials, or examples how to achieve this (to me). Some OS notes: I have built caffe2+OpenCV from source with the current master, into a python2.7.12 virtualenv, cuda 9.0, cuDNN 7.0. 

I wrote a script ( based on https://nbviewer.jupyter.org/gist/kyamagu/6cff70840c10ca374e069a3a7eb00cb4/dogs-vs-cats.ipynb )
that I think should do this: https://gist.github.com/johncorring/d735675e75add96fbdfbcc40fa00f3ba

I get the following error message:
Traceback (most recent call last):
  File ""dogsvscats.py"", line 184, in <module>
    shtyp = workspace.InferShapesAndTypes([train_model.net])
  File ""/home/john/Code/pytorch/build/caffe2/python/workspace.py"", line 258, in InferShapesAndTypes
    blobdesc_prototxt = C.infer_shapes_and_types_from_workspace(net_protos)
MemoryError: std::bad_alloc

which isn't very helpful (especially since cross referencing against caffe2 docs doesn't yield anything).

When I comment out the offending line and try to continue to training I recieve a seg fault that I have narrowed down to coming from line 204, workspace.RunNet(train_model.net). lldb returns the following stack trace:

 thread #1: tid = 9130, 0x00007fffaa112240 libcaffe2.sovoid caffe2::math::CopyMatrix<float, caffe2::CPUContext>(int, int, float const*, int, int, float*, int, int, caffe2::CPUContext*) + 208
    frame #1: 0x00007fffaa11392f libcaffe2.socaffe2::ConvOp<float, caffe2::CPUContext>::RunOnDeviceWithOrderNCHW()::{lambda(caffe2::Tensor*)#1}::operator()(caffe2::Tensor*) const + 1169
    frame #3: 0x00007fffaa3f77f8 libcaffe2.socaffe2::ConvPoolOpBase<caffe2::CPUContext>::RunOnDevice() + 301
    frame #5: 0x00007fffa9fb52e5 libcaffe2.socaffe2::SimpleNet::Run() + 460
    frame #7: 0x00007fffaa0aeb8a libcaffe2.sovoid pybind11::cpp_function::initialize<caffe2::python::addGlobalMethods(pybind11::module&)::{lambda(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, bool)#21}, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, bool, pybind11::name, pybind11::scope, pybind11::sibling>(caffe2::python::addGlobalMethods(pybind11::module&)::{lambda(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, bool)#21}&&, bool (*)(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int, bool), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call) + 311
    frame #9: 0x00007fffab160220 caffe2_pybind11_state_gpu.soPyEval_EvalFrameEx + 29342
    frame #11: 0x00000000004b9ab6 pythonPyEval_EvalFrameEx + 24639
    frame #13: 0x00000000004b9ab6 pythonPyEval_EvalFrameEx + 22711
    frame #15: 0x00000000004b9ab6 python??? + 63
    frame #17: 0x00000000004e5422 pythonPyRun_SimpleFileExFlags + 390
    frame #19: 0x0000000000493ae2 python__libc_start_main(main=(python_start + 41


. []"
543,18682,0,"Time-consuming gradient computation and backward for realizing meta network. ## ‚ùì Questions and Help
I am trying to implement the [paper](https://arxiv.org/pdf/1803.09050.pdf) for noisy label task. We found the training time is extremely time consuming, which troubled us for a long time.

The algorithm which i am tryinng to implement is the following:
![image](https://user-images.githubusercontent.com/30048368/55319105-c94bc080-54a6-11e9-923f-81b819c96154.png)

And the code is the following:
 

We find time_backward in meta-val stage takes up 99% of the meta-val training time. Moreover, the meta-val training time takes up 93% of the all training time. 

Could anyone give some suggestions on how to resolve this issue? Thank you very much!. ['\r\nmeta_train_preds = meta_model(train_images)\r\n            meta_train_loss = ((-1* torch.log(meta_train_preds + 1e-8).sum(dim=1)\r\n                ).view(config.minibatch_size, config.group + 100 - 1).mean(dim=1))\r\n\r\n            example_weights = torch.zeros(\r\n                config.minibatch_size, requires_grad=True, dtype=torch.float32\r\n            ).cuda()\r\n\r\n            meta_train_weighted_loss = (example_weights * meta_train_loss).sum()\r\n\r\n            meta_model.zero_grad()\r\n            grads = torch.autograd.grad(\r\n                meta_train_weighted_loss, (meta_model.params()), create_graph=True\r\n            )\r\n            meta_model.update_params(lr, source_params=grads)\r\n            time_meta_train = time.time() - time_proc_data - time_iter_start\r\n\r\n            time_start_val = time.time()\r\n            meta_val_preds = meta_model(val_images)\r\n            meta_val_loss = criterion(meta_val_preds, val_labels)\r\n            time_val_forward = time.time() - time_start_val\r\n\r\n            val_grad_to_examples_weight = torch.autograd.grad(\r\n                meta_val_loss, example_weights, only_inputs=True\r\n            )[0]\r\n\r\n            time_val_backward = time.time() - time_start_val - time_val_forward\r\n\r\n            clip_example_weights = torch.clamp(-val_grad_to_examples_weight, min=0)\r\n            sum_weights = torch.sum(clip_example_weights)\r\n\r\n            if sum_weights != 0:\r\n                norm_example_weights = clip_example_weights / sum_weights\r\n            else:\r\n                norm_example_weights = clip_example_weights\r\n            time_post_operation = (\r\n                time.time() - time_start_val - time_val_forward - time_val_backward\r\n            )\r\n            time_meta_val = (\r\n                time.time() - time_meta_train - time_proc_data - time_iter_start\r\n            )\r\n']"
639,17161,0,"index operation is not supported in torch.HalfTensor . ## üöÄ Feature
Currently, an indexing of torch.HalfTensor like half_tensor[indices] gives this runtime error.
RuntimeError: ""index"" not implemented for 'torch.HalfTensor'. So, requesting for an indexing method. 

## Motivation
It would be great to be able to index half tensors. My current use case for this is while doing large scale similarity metric computations on embeddings on the GPU where I figured I could use float16 to reduce memory usage.

## Pitch
Indexing method added to HalfTensor objects.

## Alternatives
For my use-case the alternative is to chunk up tensors appropriately to do similarity computations. While its works just as well, I can imagine other use cases where indexing on HalfTensor objects are needed.
. []"
447,24088,0,"RuntimeError: ""eye"" not implemented for 'Bool' when on CPU. ## üêõ Bug
torch.eye doesn't work for dtype torch.bool when the device is CPU, but it does work on GPU. 

## To Reproduce
>>> torch.eye(5, dtype=torch.bool, device=torch.device(""cpu""))
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
RuntimeError: ""eye"" not implemented for 'Bool'

>>> torch.eye(5, dtype=torch.bool, device=torch.device(""cuda""))
tensor([[ True, False, False, False, False],
        [False,  True, False, False, False],
        [False, False,  True, False, False],
        [False, False, False,  True, False],
        [False, False, False, False,  True]], device='cuda:0')

## Expected behavior
I was expecting torch.eye for bool to be implemented for both CPU and CUDA. Maybe there are other torch functions with this issue as well?

## Environment
Collecting environment information...
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 18.04.3 LTS
GCC version: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
CMake version: Could not collect

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: GeForce GTX 1060
Nvidia driver version: 430.40
cuDNN version: Could not collect

Versions of relevant libraries:
[pip3] numpy==1.17.0
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0
[conda] Could not collect

 - PyTorch Version (e.g., 1.0): 1.2
 - OS (e.g., Linux): Ubuntu 18.04
 - How you installed PyTorch (, , source): pip
 - Python version: 3.6.8
 - CUDA/cuDNN version: 10.1
 - GPU models and configuration: GTX 1060 (6GB)

## Additional context
I can workaround on CPU for now by casting to torch.bool after calling torch.eye.
. []"
16,10851,1,"`profiler.table()` too slow. ## Issue description

When processing large amount of output lines(about 100000 lines), profiler.table() can spend several minutes. I think it's because in , new lines are added to the end of a string, and this can result in a copy operation of the whole string. The best practise here may be using .. []"
78,13722,1,"Extremely high GPU memory usage for a simple architecture. ## üêõ Bug

When using a particular architecture, pytorch is throwing CUDA OOME much faster (with ""batch_size"" of 10k) than tensorflow (which runs smoothly with ""batch_size"" of 200k-500k).

## To Reproduce

Steps to reproduce the behavior:

I wrote two almost identical implementations of a problematic NN architecture in both pytorch and tensorflow.

Here is PyTorch version:


And tensorflow:

If you run both scripts on 11GB GPU you should see CUDA OOME in pytorch (on loss.backward() line), but not in tensorflow script.

## Expected behavior

I would expect adequate GPU memory usage for such a simple architecture and small input size (10k numbers), which is the case in tensorflow, but not in pytorch.

## Environment

(This is the environment of Google Colaboratory, but the same issue on two other machines)

PyTorch version: 0.4.1
Is debug build: No
CUDA used to build PyTorch: 9.2.148

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
CMake version: Could not collect

Python version: 3.6
Is CUDA available: Yes
CUDA runtime version: 9.2.148
GPU models and configuration: GPU 0: Tesla K80
Nvidia driver version: 396.44
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.1

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect. [""\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\n\r\nclass Model(nn.Module):\r\n    def __init__(self, **params):\r\n        super(Model, self).__init__()\r\n        self.windows = [1, 2, 3]\r\n\r\n        self.region_emb_layers = nn.ModuleList([nn.Conv2d(1, 150,\r\n                                                kernel_size=(window, 300), stride=1) \\\r\n                                                for window in self.windows])\r\n        self.beg_conv_layers = nn.ModuleList([nn.Conv2d(450, 450, \\\r\n                                              kernel_size=(3, 1), stride=1) \\\r\n                                              for _ in range(2)])                                   \r\n\r\n        self.pooling = nn.MaxPool2d(kernel_size=(3, 1), stride=2)\r\n        self.padding_conv = nn.ZeroPad2d((0, 0, 0, 2))\r\n        self.act_fun = nn.ReLU()\r\n        self.linear_out = nn.Linear(450, 2)\r\n\r\n    def forward(self, out, emb):\r\n        outs = [None]*len(self.windows)\r\n        out = emb(out)\r\n        out = out.unsqueeze(1)\r\n        \r\n        for i, (window, region_emb_layer) in enumerate(zip(self.windows, self.region_emb_layers)):\r\n            out_ = region_emb_layer(out)\r\n            out_ = nn.ZeroPad2d((0, 0, 0, window - 1))(out_)\r\n            outs[i] = out_\r\n\r\n        out = torch.cat(outs, dim=1)\r\n        \r\n        for beg_conv_layer in self.beg_conv_layers:\r\n            out = self.padding_conv(out)\r\n            out = beg_conv_layer(out)\r\n            out = self.act_fun(out)\r\n            \r\n        out = F.adaptive_max_pool2d(out, (1, 1))\r\n        out = out.view(out.size(0), -1)\r\n        out = self.linear_out(out)\r\n        \r\n        return out\r\n\r\nimport numpy as np\r\n\r\ndef gen(dataset_size, batch_size):\r\n    for i in range(dataset_size // batch_size):\r\n        b = np.random.choice([10, 30, 70, 200, 500, 1000])\r\n        a = batch_size // b\r\n\r\n        x = np.random.randint(0, 42000, (a, b))\r\n        y = np.random.randint(0, 2, (a,))\r\n        \r\n        yield x, y\r\n\r\n\r\ndevice = torch.device('cuda:0')\r\n\r\nmodel = Model().to(device)\r\nmodel = model.to(device)\r\n\r\nprint('Model parameters cnt: {}'.format(sum(p.numel() for p in model.parameters())))\r\n\r\nemb = nn.Embedding(42000, 300).to(device)\r\nemb.weight.requires_grad_(False)\r\n\r\noptimizer = torch.optim.Adam(model.parameters(), lr=1e-3)\r\n\r\ndataset_size = int(1e6)\r\nbatch_size = 10000\r\n\r\nfor i, (x, y) in enumerate(gen(dataset_size, batch_size)):\r\n    if i % 10 == 0:\r\n        print(i)\r\n\r\n    x = torch.from_numpy(x).to(device)\r\n    y = torch.from_numpy(y).to(device)\r\n\r\n    out = model(x, emb=emb)\r\n\r\n    crit = nn.CrossEntropyLoss()\r\n    loss = crit(out, y)\r\n    \r\n    optimizer.zero_grad()\r\n    loss.backward()\r\n    optimizer.step()\r\n"", ""\r\nimport tensorflow\r\nimport numpy as np\r\nimport keras\r\nfrom keras.models import Model\r\nfrom keras.layers import Lambda, Input, Conv2D, Dense, Flatten, \\\r\nEmbedding, Concatenate, ZeroPadding2D\r\nfrom keras.optimizers import Adam\r\nimport keras.backend as K\r\n\r\n\r\nx_in = Input((None,))\r\n\r\nx = x_in\r\n\r\nx = Embedding(42000, 300, trainable=False)(x)\r\nx = Lambda(lambda x: K.expand_dims(x, axis=3))(x)\r\n\r\nx1 = ZeroPadding2D(((0, 2), (0, 0)))(x)\r\nx1 = Conv2D(150, (3, 300), activation='relu')(x1)\r\nx2 = ZeroPadding2D(((0, 1), (0, 0)))(x)\r\nx2 = Conv2D(150, (2, 300), activation='relu')(x2)\r\nx3 = Conv2D(150, (1, 300), activation='relu')(x)\r\n\r\nx = Concatenate(axis=3)([x1, x2, x3])\r\n\r\nx = Conv2D(450, (3, 1), activation='relu', padding='same')(x)\r\nx = Conv2D(450, (3, 1), activation='relu', padding='same')(x)\r\n\r\nx = Lambda(lambda x: K.max(x, axis=1))(x)\r\n\r\nx = Flatten()(x)\r\nx = Dense(1, activation='sigmoid')(x)\r\n\r\nx_out = x\r\n\r\nmodel = Model(inputs=x_in, outputs=x_out)\r\nopt = Adam(lr=1e-3)\r\nmodel.compile(loss='binary_crossentropy', optimizer=opt)\r\n\r\nprint(model.summary())\r\n\r\ndef gen(batch_size):\r\n  while True:\r\n    b = np.random.choice([10, 30, 70, 200, 500, 1000])\r\n    a = batch_size // b\r\n    x = np.random.randint(0, 42000, (a, b))\r\n    y = np.random.randint(0, 2, (a,))\r\n    \r\n    yield x, y\r\n\r\ndataset_size = int(1e6)\r\nbatch_size = 200000\r\n\r\nmodel.fit_generator(gen(batch_size), steps_per_epoch=dataset_size//batch_size)\r\n""]"
363,15608,0,"[Caffe2] How to switch to test phase?. Hi, I just spent 1 hour looking at the documentation and some tutorials on the website, and googling ; but I cannot figure out how I can put a net in testing phase. I would like an equivalent in Caffe2 of .. []"
521,28653,0,"QAT with CUDA. Try post train with my own network and dataset but accuracy is not good enough. 
Try QAT with too slow. 
Any way to quickly run QAT on NVIDIA GPU?

cc @jerryzh168 @jianyuh @dzhulgakov @raghuramank100 @jamesr66a. []"
371,15298,0,"Momentum problem (1-momentum is correct?) in BatchNorm2d. ## üêõ Bug

In BatchNorm2d' doc, the explanation of momentum is:


where  is the newly computed batch statistics,  is the estimated statistics in history.
While in my experiments, when momentum set to 0, the batchnorm operates just use the newly computed statistics.

So I guess maybe the following explanation is correct:



## To Reproduce

 is a torch.Tensor with shape (8, 3, 299, 299), which read from an image
 is the model load from 
I have set the momentum as 0 in [Inception v3 model struct](https://github.com/pytorch/vision/blob/master/torchvision/models/inception.py):



Then I calculate the mean and var:


The result is that  while 

## Expected behavior

Expected  while 

## Environment

 - PyTorch Version 0.4.1:
 - Windows:
 - pip:
 - Python version: 3.6.5


cc @brianjo @mruberry @albanD @jbschlosser. ['python\r\nclass BasicConv2d(nn.Module):\r\n\r\n    def __init__(self, in_channels, out_channels, **kwargs):\r\n        super(BasicConv2d, self).__init__()\r\n        self.conv = nn.Conv2d(in_channels, out_channels, bias=False, **kwargs)\r\n        self.bn = nn.BatchNorm2d(out_channels, eps=0.001, momentum=0)\r\n\r\n    def forward(self, x):\r\n        x = self.conv(x)\r\n        x = self.bn(x)\r\n        return F.relu(x, inplace=True)\r\n', ' python\r\nconv = mol.Conv2d_1a_3x3.conv(b_x)\r\ndim = conv.shape\r\nm = (conv.sum(0).sum(1).sum(1)/(dim[0]*dim[2]*dim[3])).view(1, -1, 1, 1)\r\nvar = (((conv-m)**2).sum(0).sum(1).sum(1)/(dim[0]*dim[2]*dim[3]-1)).view(1, -1, 1, 1) + 0.001\r\ntmp = (conv - m) / torch.sqrt(var)\r\ntmp = tmp * mol.Conv2d_1a_3x3.bn.weight.view(1, -1, 1, 1) + mol.Conv2d_1a_3x3.bn.bias.view(1, -1, 1, 1)\r\nbn = mol.Conv2d_1a_3x3.bn(conv)\r\nprint((bn-tmp).mean(), (bn-tmp).std())\r\n']"
454,15262,0,"doc err:torch.nn.BCELoss. pytorch 1.0
-------------
DOC:This is used for measuring the error of a reconstruction in for example an auto-encoder. Note that the targets y should be numbers between 0 and 1.
--------------
import torch 
import torch.nn.functional as F
b=[[0.2,0.1]]
c=[[1.,3.]]
aa = torch.tensor(b,requires_grad=True)
target = torch.tensor(c)
output = F.binary_cross_entropy(aa,target,reduce=True,size_average=True)
z=output.sum()
z.backward()
print(output)
-----------------------
tensor(4.1532, grad_fn=<BinaryCrossEntropyBackward>)
---------------
target value is 1 and 3.,not between 0 and 1.
. []"
206,26218,0,"Default adam epsilon to 1e-7 when on fp16. ## üöÄ Feature
If you use 1e-8 as default and you use 16 bit, it will round to zero, and thus you get no stability gains.


cc @vincentqb. []"
234,28404,0,"[Quantization] (Error): No function is registered for schema aten. ## ‚ùì Questions and Help
    I tried to quantizate my own shuffle model through 'STATIC QUANTIZATION WITH EAGER MODE IN PYTORCH'.
    But when it comes to forward propagation, the time to assess model losses, I failed:

    

cc @jerryzh168 @jianyuh @dzhulgakov @raghuramank100. ['\r\nRuntimeError: No function is registered for schema aten::native_batch_norm(Tensor input, Tensor? weight, Tensor? bias, Tensor? running_mean, Tensor? running_var, bool training, float momentum, float eps) -> (Tensor, Tensor, Tensor) on tensor type QuantizedCPUTensorId; available functions are CPUTensorId, CUDATensorId, MkldnnCPUTensorId, VariableTensorId\r\nThe above operation failed in interpreter, with the following stack trace:\r\nat code/__torch__/shuff_slim/___torch_mangle_297.py:316:13\r\n']"
257,22013,0,"Mysterious Tensor Indexing Problem. ## üêõ Bug

Indexing into a tensor with a 2d list of indices seems to fail sometimes, with a critical point when the number of indices is less than 32.

## To Reproduce



 fails with:


## Expected behavior

I expected this indexing to work the same for any number of indices.  This is problematic in my actual code as the size of the data varies.

## Environment

PyTorch version: 1.1.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 16.04.6 LTS
GCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
CMake version: Could not collect

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip3] numpy==1.16.4
[pip3] pytorch-pretrained-bert==0.6.2
[pip3] torch==1.1.0
[conda] Could not collect

## Additional context

<!-- Add any other context about the problem here. -->


cc @mruberry @rgommers @heitorschueroff. ['python\r\nimport torch\r\n\r\ndef index_test(n):\r\n    M = torch.tensor([0.]*n) # Trivial example for illustrative purposes\r\n    idxes = [(a,) for a in range(n)]\r\n    return M[idxes]\r\n\r\nindex_test(31) # Note that this fails\r\nindex_test(32) # But this works\r\n', '\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-169-222ec1878948> in <module>\r\n      6     return M[idxes]\r\n      7 \r\n----> 8 index_test(31)\r\n\r\n<ipython-input-169-222ec1878948> in index_test(n)\r\n      4     M = torch.tensor([0.]*n) # Trivial example for illustrative purposes\r\n      5     idxes = [(a,) for a in range(n)]\r\n----> 6     return M[idxes]\r\n      7 \r\n      8 index_test(31)\r\n\r\nIndexError: too many indices for tensor of dimension 1\r\n']"
43,26386,1,pytorch inference fp16. The model is trained with fp32. I try to use .half() to change  layers and inputs to fp16. ActuallyÔºåit indeed accelerate the inference. But its acceleration effect is far away from twice  of fp32. My platform is nvidia tx2. Its compute capability is 6.2. It supports fp16 very well. So what I want to ask is whether fp16 cannot be twice as fast as fp32 in pytorch. Looking for your reply.Thank you.. []
689,23925,0,"'border' and 'reflection‚Äô modes of grid_sample have incorrect gradients at border. ## üêõ Bug

When  in , and a grid point falls exactly on the high boundary of the image (), the gradient should be based on the border padding scheme, which should give either the gradient from just inside the boundary, or zero from just outside the boundary (either could be valid, since it‚Äôs a non differentiable point). Instead, the gradient is currently based on zero padding the image, which gives wacky results.

Same problem occurs with  for 2D  on CPU.
Reflection modes of both the cuda version and the 3D CPU version also have this problem, but it‚Äôs arguably worse, since the incorrect gradient is also negated. Furthermore, this is an inconsistency between the behavior of CPU and CUDA kernels.

## Example:



Notice the wacky last row and last column. This is because the gradient there is currently calculated as if the image was zero-padded.

The result should ideally look like



which finds the gradient using the in-bounds neighbor.

A less ideal, but still palatable result would be



which finds the gradient using the out-of-bounds, border-padded neighbor.

Reflection mode on cpu (for instance, try using these same commands, but with ) gives the exact same problematic result.
When using reflection mode on cuda, however, (as well as for 3D grid_sample on cpu) the problematic gradients are negated!



This is also problematic, of course, but even more so because of the mismatch between the cpu and cuda behaviors.

For  mode, I think it makes sense to set the gradient in such cases to zero, since it‚Äôs sort of at the apex of a symmetric hill. But setting it to take the gradient of one side or the other might also be acceptable for most practical purposes.

For  mode, by contrast, I think it makes more sense to always take the non-zero gradient from the inner side, since the outer side gradient will be zero and so effectively stop training (see the related discussion for  at #7002 and #7049).




PyTorch Version: tested on commit https://github.com/pytorch/pytorch/commit/0539462ca2966aa29657b58aeb17a85c21524d31. [""python\r\nimage = torch.arange(0, 5, dtype=torch.float).expand((1,1,5,5)).requires_grad_()\r\n\r\nid_grid = torch.nn.functional.affine_grid(\r\n    torch.tensor([[[1,0,0],[0,1,0.]]]), (1,1,5,5), align_corners=True).requires_grad_()\r\n\r\ntorch.nn.functional.grid_sample(image, id_grid, padding_mode='border',\r\n                                align_corners=True).sum().backward()\r\n\r\nprint(id_grid.grad.permute(0,3,1,2))\r\n"", 'python\r\ntensor([[[[ 2.,  2.,  2.,  2., -8.],\r\n          [ 2.,  2.,  2.,  2., -8.],\r\n          [ 2.,  2.,  2.,  2., -8.],\r\n          [ 2.,  2.,  2.,  2., -8.],\r\n          [ 2.,  2.,  2.,  2., -8.]],\r\n\r\n         [[ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0., -2., -4., -6., -8.]]]])\r\n', 'python\r\ntensor([[[[ 2.,  2.,  2.,  2.,  2.],\r\n          [ 2.,  2.,  2.,  2.,  2.],\r\n          [ 2.,  2.,  2.,  2.,  2.],\r\n          [ 2.,  2.,  2.,  2.,  2.],\r\n          [ 2.,  2.,  2.,  2.,  2.]],\r\n\r\n         [[ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.]]]])\r\n', 'python\r\ntensor([[[[ 2.,  2.,  2.,  2.,  0.],\r\n          [ 2.,  2.,  2.,  2.,  0.],\r\n          [ 2.,  2.,  2.,  2.,  0.],\r\n          [ 2.,  2.,  2.,  2.,  0.],\r\n          [ 2.,  2.,  2.,  2.,  0.]],\r\n\r\n         [[ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.],\r\n          [ 0.,  0.,  0.,  0.,  0.]]]])\r\n', 'python\r\ntensor([[[[2., 2., 2., 2., 8.],\r\n          [2., 2., 2., 2., 8.],\r\n          [2., 2., 2., 2., 8.],\r\n          [2., 2., 2., 2., 8.],\r\n          [2., 2., 2., 2., 8.]],\r\n\r\n         [[0., 0., 0., 0., 0.],\r\n          [0., 0., 0., 0., 0.],\r\n          [0., 0., 0., 0., 0.],\r\n          [0., 0., 0., 0., 0.],\r\n          [-0., 2., 4., 6., 8.]]]])\r\n']"
313,11850,0,"[Caffe2/Bug] Cannot enable MKL-DNN. ## Solution
A solution is found for the problem, but maybe a bug in Caffe2

MKL-DNN can be enabled by first compiling the PyTorch. Then turn on MKL by

and recompile PyTorch. Then MKL-DNN is enabled.

## Issue description

Trying to accelerate caffe2 inference with MKL-DNN.

The MKL-DNN lib can be detected:

But mkl operators are not compiled

And MKL-DNN cannot be found after installation since

returns False.

Also, I try to enable MKL by changing the CMakeLists.txt:

It acutally cause an error:


## System Info
PyTorch version: 1.0.0a0+98aebed
Is debug build: No
CUDA used to build PyTorch: None

OS: Ubuntu 18.04.1 LTS
GCC version: (Ubuntu 7.3.0-16ubuntu3) 7.3.0
CMake version: version 3.10.2

Python version: 2.7
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] numpy (1.15.1)
[pip] torch (1.0.0a0+98aebed)
[conda] Could not collect

. ['bash\r\ndiff --git a/CMakeLists.txt b/CMakeLists.txt\r\nindex 827121b1f..235d00bd6 100644\r\n--- a/CMakeLists.txt\r\n+++ b/CMakeLists.txt\r\n@@ -111,6 +111,7 @@ option(USE_SYSTEM_EIGEN_INSTALL\r\n option(USE_TENSORRT ""Using Nvidia TensorRT library"" OFF)\r\n option(USE_ZMQ ""Use ZMQ"" OFF)\r\n option(USE_ZSTD ""Use ZSTD"" OFF)\r\n+option(USE_MKL ""Use MKL"" ON)\r\n option(USE_MKLDNN ""Use MKLDNN"" OFF)\r\n option(USE_IDEEP ""Use IDEEP interface in MKL BLAS"" ON)\r\n option(USE_MKLML ""Use MKLML interface in MKL BLAS"" ON)\r\n', '\r\n-- Found MKLDNN: /home/jiecaoyu/.local/include  \r\n-- Found MKLDNN      (include: /home/jiecaoyu/.local/include, library: /home/jiecaoyu/.local/lib/libmkldnn.so)\r\n', '\r\n-- Excluding mkl operators as we are not using mkl\r\n', 'python\r\nfrom caffe2.python import workspace\r\nworkspace.C.has_mkldnn\r\n', 'bash\r\ndiff --git a/CMakeLists.txt b/CMakeLists.txt\r\nindex 827121b1f..235d00bd6 100644\r\n--- a/CMakeLists.txt\r\n+++ b/CMakeLists.txt\r\n@@ -111,6 +111,7 @@ option(USE_SYSTEM_EIGEN_INSTALL\r\n option(USE_TENSORRT ""Using Nvidia TensorRT library"" OFF)\r\n option(USE_ZMQ ""Use ZMQ"" OFF)\r\n option(USE_ZSTD ""Use ZSTD"" OFF)\r\n+option(USE_MKL ""Use MKL"" ON)\r\n option(USE_MKLDNN ""Use MKLDNN"" OFF)\r\n option(USE_IDEEP ""Use IDEEP interface in MKL BLAS"" ON)\r\n option(USE_MKLML ""Use MKLML interface in MKL BLAS"" ON)\r\n', '\r\n...\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:397:1: error: prototype for ‚ÄòTHMapAllocator::THMapAllocator(WithFd, const char*, int, int)‚Äô does not match any in class ‚ÄòTHMapAllocator‚Äô\r\n THMapAllocator::THMapAllocator(WithFd, const char *filename, int fd, int flags) {\r\n ^~~~~~~~~~~~~~\r\nIn file included from /home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:1:0:\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.h:41:3: error: candidates are: THMapAllocator::THMapAllocator(THMapAllocator&&)\r\n   THMapAllocator(THMapAllocator&&) = delete;\r\n   ^~~~~~~~~~~~~~\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.h:39:3: error:                 THMapAllocator::THMapAllocator(const THMapAllocator&)\r\n   THMapAllocator(const THMapAllocator&) = delete;\r\n   ^~~~~~~~~~~~~~\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.h:38:3: error:                 THMapAllocator::THMapAllocator(WithFd, const char*, int, int, size_t)\r\n   THMapAllocator(WithFd, const char *filename, int fd, int flags, size_t size);\r\n   ^~~~~~~~~~~~~~\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:393:1: error:                 THMapAllocator::THMapAllocator(const char*, int, size_t)\r\n THMapAllocator::THMapAllocator(const char *filename, int flags, size_t size) {\r\n ^~~~~~~~~~~~~~\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:401:52: error: destructors may not have parameters\r\n THMapAllocator::~THMapAllocator(THMapAllocator* ctx) {}\r\n                                                    ^\r\n/home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:401:1: error: redefinition of ‚ÄòTHMapAllocator::~THMapAllocator()‚Äô\r\n THMapAllocator::~THMapAllocator(THMapAllocator* ctx) {}\r\n ^~~~~~~~~~~~~~\r\nIn file included from /home/jiecaoyu/LIBS/pytorch/aten/src/TH/THAllocator.cpp:1:0:\r\n...\r\n']"
216,4540,0,"Cuda out of memory but gpu memory is utilized about a half. I'm running slightly modified code of EDSR baseline network from here: https://github.com/thstkdgus35/EDSR-PyTorch
The training on first epoch goes well, but on the test stage when loading a model it raises an error:

But what is strange is that gpu memory at that moment is utilised about a half. Here's nvidia-smi output (at the moment of peak memory usage):

In test function I also use volatile=True option. What could be the problem?
OS: Win10
GPU: 1060 6G


  
  . ['\r\nTHCudaCheck FAIL file=d:\\pytorch\\pytorch\\torch\\lib\\thc\\generic/THCStorage.cu line=58 error=2 : out of memory\r\nTraceback (most recent call last):\r\n  File ""main.py"", line 17, in <module>\r\n    t.test()\r\n  File ""D:\\Projects\\SR\\EDSR-PyTorch-master\\code\\trainer.py"", line 100, in test\r\n    output = _test_forward(input)\r\n  File ""D:\\Projects\\SR\\EDSR-PyTorch-master\\code\\trainer.py"", line 91, in _test_forward\r\n    return self.model(x)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py"", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""D:\\Projects\\SR\\EDSR-PyTorch-master\\code\\model\\EDSR.py"", line 50, in forward\r\n    x = self.tail(res)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py"", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\container.py"", line 67, in forward\r\n    input = module(input)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py"", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\container.py"", line 67, in forward\r\n    input = module(input)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py"", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\conv.py"", line 277, in forward\r\n    self.padding, self.dilation, self.groups)\r\n  File ""C:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py"", line 90, in conv2d\r\n    return f(input, weight, bias)\r\nRuntimeError: cuda runtime error (2) : out of memory at d:\\pytorch\\pytorch\\torch\\lib\\thc\\generic/THCStorage.cu:58\r\n', '\r\nC:\\Program Files\\NVIDIA Corporation\\NVSMI>nvidia-smi -i 0 -q -d MEMORY\r\n\r\n==============NVSMI LOG==============\r\n\r\nTimestamp                           : Mon Jan 08 23:49:46 2018\r\nDriver Version                      : 388.13\r\n\r\nAttached GPUs                       : 1\r\nGPU 00000000:02:00.0\r\n    FB Memory Usage\r\n        Total                       : 6144 MiB\r\n        Used                        : 3657 MiB\r\n        Free                        : 2487 MiB\r\n    BAR1 Memory Usage\r\n        Total                       : 256 MiB\r\n        Used                        : 229 MiB\r\n        Free                        : 27 MiB\r\n']"
720,21701,0,Add comments on classes to `bailout_graph.cpp`. []
645,11482,0,"Error -3 while decompressing data: invalid block type. ## Issue description
I got the problem when I tried to download MNIST dataset. Tested twice: with pytorch installed using pip and pytorch compiled from source.
## Code example




## System Info

PyTorch version: 0.3.1
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.13.6
GCC version: Could not collect
CMake version: version 3.12.1

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] Could not collect
[conda] Could not collect
. [""\r\ndataset = datasets.MNIST(\r\n        './data',\r\n        train=True,\r\n        download=True,\r\n        transform=transforms.Compose([\r\n            transforms.ToTensor(),\r\n            transforms.Normalize((0.1307, ), (0.3081, ))\r\n        ]))\r\n""]"
719,16326,0,"[JIT] C++ frontend is unable to support std::vector<std::vector<Tensor>>. ## üêõ Bug
C++ frontend is unable to support std::vector<std::vector<Tensor>>

## To Reproduce
Python Code



CPP code

Error Message




## Some preliminary debugging
In particular, this is the offending function




this is the call site of the offending function. It does not seem to check generic types. Like . Instead, it goes straight to 



## Environment
Pytorch version: 4edc8273eb223785929c0017caf15c101964d480

. ['\r\nimport torch\r\nclass Model(torch.jit.ScriptModule):\r\n    def __init__(self):\r\n        super(Model, self).__init__()\r\n\r\n    @torch.jit.script_method\r\n    def forward(self, x_list_list):\r\n        # type: (List[List[Tensor]]) -> Tensor\r\n\r\n        return x_list_list[0][0]\r\n\r\n\r\nm = Model()\r\nm.save(""./model.pt"")\r\n', '\r\n    std::string path = ""./model.pt"";\r\n    std::shared_ptr<torch::jit::script::Module> module = torch::jit::load(path);\r\n\r\n    std::vector<torch::Tensor> one_frame = {\r\n            torch::rand({4, 4}),\r\n            torch::rand({4, 4}),\r\n            torch::rand({4, 4}),\r\n            torch::rand({4, 4}),\r\n\r\n    };\r\n\r\n    std::vector<torch::jit::IValue> frames;\r\n    frames.push_back(one_frame);\r\n    frames.push_back(one_frame);\r\n    std::vector<torch::jit::IValue> inputs;\r\n    inputs.push_back(frames);\r\n\r\n    auto result = module->forward(inputs);\r\n    log_info(""finished inference"")\r\n\r\n', '\r\nunknown file: Failure\r\nC++ exception with description ""Type cannot be accurately recovered from this IValue. (incompleteInferTypeFrom at aten/src/ATen/core/type.cpp:149)\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x45 (0x7fccd18b6dd5 in /home/sidney/bazel/av/bin/tests/../../lib/third_party/libc10.so)\r\nframe #1: c10::incompleteInferTypeFrom(c10::IValue const&) + 0x3b4 (0x7fccbc189ac4 in /home/sidney/bazel/av/bin/tests/../../lib/third_party/libcaffe2.so)\r\nframe #2: torch::jit::script::Method::checkInputsAgainstSchema(std::vector<c10::IValue, std::allocator<c10::IValue> >&) + 0xa8 (0x40f448 in ./bin/tests/intentnet_test)\r\n\r\n', '\r\n// why incomplete? You cannot completely recover a type from\r\n// an IValue, List[List[int]] and List[List[Tensor]] will both\r\n// become ivalue.isGenericList() and cannot be recovered.\r\n// The only appropriate place to use this is where you know that\r\n// you are only dealing with a subset of objects where you can recover\r\n// the type, like in the tracer.\r\nTypePtr incompleteInferTypeFrom(const IValue& value) {\r\n  if (value.isTensor()) {\r\n    return CompleteTensorType::create(value.toTensor());\r\n  } else if (value.isDouble()) {\r\n    return FloatType::get();\r\n  } else if (value.isInt()) {\r\n    return IntType::get();\r\n  } else if (value.isBool()) {\r\n    return BoolType::get();\r\n  } else if (value.isString()) {\r\n    return StringType::get();\r\n  } else if (value.isIntList()) {\r\n    return ListType::ofInts();\r\n  } else if (value.isTensorList()) {\r\n    return ListType::ofTensors();\r\n  } else if (value.isBoolList()) {\r\n    return ListType::ofBools();\r\n  } else if (value.isDoubleList()) {\r\n    return ListType::ofFloats();\r\n  } else if (value.isTuple()) {\r\n    return TupleType::create(fmap(value.toTuple()->elements(), incompleteInferTypeFrom));\r\n  } else if (value.isDevice()) {\r\n    return DeviceObjType::get();\r\n  }\r\n  AT_ERROR(""Type cannot be accurately recovered from this IValue."");\r\n}\r\n', '\r\n\r\n    for (size_t pos = 0; pos < schema.arguments().size(); ++pos) {\r\n      const auto& argument = schema.arguments()[pos];\r\n      if (pos < inputs.size()) {\r\n        // XXX - this fails to handle generic aggregates\r\n        // and should be replaced with a function isSubvalueOf(ivalue, type)\r\n        // That asks if the specific value is a valid instance of type.\r\n        const TypePtr inputType = incompleteInferTypeFrom(inputs[pos]);\r\n        AT_CHECK(\r\n            inputType->isSubtypeOf(argument.type()),\r\n            ""Expected value of type "",\r\n            *argument.type(),\r\n            "" for argument \'"",\r\n            argument.name(),\r\n            ""\' in position "",\r\n            pos,\r\n            "", but instead got value of type "",\r\n            *inputType,\r\n            "". Declaration: "",\r\n            schema);\r\n      } else if (argument.default_value()) {\r\n        inputs.push_back(*argument.default_value());\r\n      } else {\r\n        AT_ERROR(\r\n            schema.name(),\r\n            ""() is missing value for argument \'"",\r\n            argument.name(),\r\n            ""\'. Declaration: "",\r\n            schema);\r\n      }\r\n    }\r\n\r\n']"
436,2735,0,nk. []
23,2180,1,"Discrepancy in BCEWithLogitsLoss and ClassNLLLoss. In BCEWithLogitsLoss, weights are unnormalized and used, while in ClassNLLLoss weights are normalized and used. 

Some discussion around this can be found [here](https://github.com/pytorch/pytorch/commit/67968cb60b1d3021834594967d4140a36a8213e3#commitcomment-23155134). Is this discrepancy expected? Else if this is an issue I can send a PR to resolve this.. []"
283,17850,0,"Build fails for caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkldnn/Conv.cpp.o; possibly MKL-DNN issue. ## üêõ Bug

PyTorch fails to build with an issue related to MKL-DNN. I previously built MKL-DNN by ing from their GitHub repo.

Error trace is below:



## Build command


## Environment

 - PyTorch Version (e.g., 1.0): Master branch
 - OS (e.g., Linux): Debian:Stretch
 - How you installed PyTorch (, , source): source
 - Build command you used (if compiling from source): see above
 - Python version: 3.6.5
 - CUDA/cuDNN version: NA
 - GPU models and configuration: NA
 - Any other relevant information: NA
. [""bash\r\n[91mIn file included from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/opt/pytorch/aten/src/ATen/mkldnn/Runtime.h: In constructor ‚Äòat::native::Stream::Stream()‚Äô:\r\n/opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:42:40: error: ‚Äòmkldnn::stream::kind‚Äô has not been declared\r\n   Stream():_cpu_stream(mkldnn::stream::kind::eager) {}\r\n                                        ^~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp: In function ‚Äòat::Tensor at::native::mkldnn_convolution(const at::Tensor&, const at::Tensor&, const at::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t)‚Äô:\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:98:29: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_any = memory::format::any;\r\n                             ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:99:30: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_nchw = memory::format::nchw;\r\n                              ^~~~~~\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:100:42: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                          ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:100:66: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                                                  ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:101:27: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_x = memory::format::x;\r\n                           ^~~~~~\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:131:21: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     input.data_ptr());\r\n                     ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:133:22: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     weight.data_ptr());\r\n                      ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:135:22: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     output.data_ptr());\r\n                      ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:139:36: error: ‚Äòusing element_type = struct mkldnn::convolution_forward::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_forward::primitive_desc‚Äô} has no member named ‚Äòsrc_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto input_pd = conv_forward_pd->src_primitive_desc();\r\n                                    ^~~~~~~~~~~~~~~~~~\r\n                                    primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:140:23: error: unable to deduce ‚Äòauto‚Äô from ‚Äòinput_usr_memory‚Äô\r\n   auto input_memory = input_usr_memory;\r\n                       ^~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:141:56: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (input_usr_memory.get_primitive_desc() != memory::primitive_desc(input_pd)) {\r\n                                                        ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:146:37: error: ‚Äòusing element_type = struct mkldnn::convolution_forward::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_forward::primitive_desc‚Äô} has no member named ‚Äòweights_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto weight_pd = conv_forward_pd->weights_primitive_desc();\r\n                                     ^~~~~~~~~~~~~~~~~~~~~~\r\n                                     primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:147:24: error: unable to deduce ‚Äòauto‚Äô from ‚Äòweight_usr_memory‚Äô\r\n   auto weight_memory = weight_usr_memory;\r\n                        ^~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:148:57: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (weight_usr_memory.get_primitive_desc() != memory::primitive_desc(weight_pd)) {\r\n                                                         ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:153:37: error: ‚Äòusing element_type = struct mkldnn::convolution_forward::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_forward::primitive_desc‚Äô} has no member named ‚Äòdst_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto output_pd = conv_forward_pd->dst_primitive_desc();\r\n                                     ^~~~~~~~~~~~~~~~~~\r\n                                     primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:154:24: error: unable to deduce ‚Äòauto‚Äô from ‚Äòoutput_usr_memory‚Äô\r\n   auto output_memory = output_usr_memory;\r\n                        ^~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:155:57: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (output_usr_memory.get_primitive_desc() != memory::primitive_desc(output_pd)) {\r\n                                                         ^~~~~~~~~~~~~~\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:163:22: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n       bias.data_ptr()));\r\n                      ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:176:35: error: ‚Äòstruct mkldnn::stream‚Äô has no member named ‚Äòsubmit‚Äô\r\n   Stream::Instance().get_stream().submit(net);\r\n                                   ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp: In function ‚Äòat::Tensor at::native::mkldnn_convolution_backward_input(c10::IntArrayRef, const at::Tensor&, const at::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t, bool)‚Äô:\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:209:29: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_any = memory::format::any;\r\n                             ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:210:30: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_nchw = memory::format::nchw;\r\n                              ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:211:42: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                          ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:211:66: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                                                  ^~~~~~\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:251:27: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     grad_output.data_ptr());\r\n                           ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:253:22: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     weight.data_ptr());\r\n                      ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:255:26: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     grad_input.data_ptr());\r\n                          ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:259:48: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_data::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_data::primitive_desc‚Äô} has no member named ‚Äòdiff_dst_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto grad_output_pd = conv_backward_data_pd->diff_dst_primitive_desc();\r\n                                                ^~~~~~~~~~~~~~~~~~~~~~~\r\n                                                primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:260:29: error: unable to deduce ‚Äòauto‚Äô from ‚Äògrad_output_usr_memory‚Äô\r\n   auto grad_output_memory = grad_output_usr_memory;\r\n                             ^~~~~~~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:261:62: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (grad_output_usr_memory.get_primitive_desc() != memory::primitive_desc(grad_output_pd)) {\r\n                                                              ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:266:43: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_data::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_data::primitive_desc‚Äô} has no member named ‚Äòweights_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto weight_pd = conv_backward_data_pd->weights_primitive_desc();\r\n                                           ^~~~~~~~~~~~~~~~~~~~~~\r\n                                           primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:267:24: error: unable to deduce ‚Äòauto‚Äô from ‚Äòweight_usr_memory‚Äô\r\n   auto weight_memory = weight_usr_memory;\r\n                        ^~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:268:57: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (weight_usr_memory.get_primitive_desc() != memory::primitive_desc(weight_pd)) {\r\n                                                         ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:273:47: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_data::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_data::primitive_desc‚Äô} has no member named ‚Äòdiff_src_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto grad_input_pd = conv_backward_data_pd->diff_src_primitive_desc();\r\n                                               ^~~~~~~~~~~~~~~~~~~~~~~\r\n                                               primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:274:28: error: unable to deduce ‚Äòauto‚Äô from ‚Äògrad_input_usr_memory‚Äô\r\n   auto grad_input_memory = grad_input_usr_memory;\r\n                            ^~~~~~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:275:57: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (grad_input_memory.get_primitive_desc() != memory::primitive_desc(grad_input_pd)) {\r\n                                                         ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:288:35: error: ‚Äòstruct mkldnn::stream‚Äô has no member named ‚Äòsubmit‚Äô\r\n   Stream::Instance().get_stream().submit(net);\r\n                                   ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp: In function ‚Äòstd::tuple<at::Tensor, at::Tensor> at::native::mkldnn_convolution_backward_weights(c10::IntArrayRef, const at::Tensor&, const at::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t, bool)‚Äô:\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:326:29: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_any = memory::format::any;\r\n                             ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:327:30: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_nchw = memory::format::nchw;\r\n                              ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:328:42: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                          ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:328:66: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_weight = (g!= 1) ? memory::format::goihw : memory::format::oihw;\r\n                                                                  ^~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:329:27: error: ‚Äòmkldnn::memory::format‚Äô has not been declared\r\n   auto format_x = memory::format::x;\r\n                           ^~~~~~\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:375:21: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     input.data_ptr());\r\n                     ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:377:27: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     grad_output.data_ptr());\r\n                           ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:379:27: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n     grad_weight.data_ptr());\r\n                           ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:384:44: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_weights::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_weights::primitive_desc‚Äô} has no member named ‚Äòsrc_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto input_pd = conv_backward_weight_pd->src_primitive_desc();\r\n                                            ^~~~~~~~~~~~~~~~~~\r\n                                            primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:385:23: error: unable to deduce ‚Äòauto‚Äô from ‚Äòinput_usr_memory‚Äô\r\n   auto input_memory = input_usr_memory;\r\n                       ^~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:386:56: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (input_usr_memory.get_primitive_desc() != memory::primitive_desc(input_pd)) {\r\n                                                        ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:391:50: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_weights::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_weights::primitive_desc‚Äô} has no member named ‚Äòdiff_dst_primitive_desc‚Äô; did you mean ‚Äòprimitive_desc‚Äô?\r\n   auto grad_output_pd = conv_backward_weight_pd->diff_dst_primitive_desc();\r\n                                                  ^~~~~~~~~~~~~~~~~~~~~~~\r\n                                                  primitive_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:392:29: error: unable to deduce ‚Äòauto‚Äô from ‚Äògrad_output_usr_memory‚Äô\r\n   auto grad_output_memory = grad_output_usr_memory;\r\n                             ^~~~~~~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:393:62: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (grad_output_usr_memory.get_primitive_desc() != memory::primitive_desc(grad_output_pd)) {\r\n                                                              ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:398:50: error: ‚Äòusing element_type = struct mkldnn::convolution_backward_weights::primitive_desc‚Äô {aka ‚Äòstruct mkldnn::convolution_backward_weights::primitive_desc‚Äô} has no member named ‚Äòdiff_weights_primitive_desc‚Äô; did you mean ‚Äòdiff_weights_desc‚Äô?\r\n   auto grad_weight_pd = conv_backward_weight_pd->diff_weights_primitive_desc();\r\n                                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n                                                  diff_weights_desc\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:399:29: error: unable to deduce ‚Äòauto‚Äô from ‚Äògrad_weight_usr_memory‚Äô\r\n   auto grad_weight_memory = grad_weight_usr_memory;\r\n                             ^~~~~~~~~~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:400:62: error: ‚Äòprimitive_desc‚Äô is not a member of ‚Äòmkldnn::memory‚Äô\r\n   if (grad_weight_usr_memory.get_primitive_desc() != memory::primitive_desc(grad_weight_pd)) {\r\n                                                              ^~~~~~~~~~~~~~\r\n/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:407:27: error: no matching function for call to ‚Äòmkldnn::memory::memory(<brace-enclosed initializer list>, void*)‚Äô\r\n       grad_bias.data_ptr()));\r\n                           ^\r\nIn file included from /opt/pytorch/aten/src/ATen/mkldnn/Runtime.h:3,\r\n                 from /opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:37:\r\n/usr/local/include/mkldnn.hpp:900:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&)‚Äô\r\n     memory(const desc &md, const engine &aengine)\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:900:5: note:   no known conversion for argument 1 from ‚Äò<brace-enclosed initializer list>‚Äô to ‚Äòconst mkldnn::memory::desc&‚Äô\r\n/usr/local/include/mkldnn.hpp:889:5: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory::desc&, const mkldnn::engine&, void*)‚Äô\r\n     memory(const desc &md, const engine &aengine, void *ahandle) {\r\n     ^~~~~~\r\n/usr/local/include/mkldnn.hpp:889:5: note:   candidate expects 3 arguments, 2 provided\r\n/usr/local/include/mkldnn.hpp:577:8: note: candidate: ‚Äòmkldnn::memory::memory(const mkldnn::memory&)‚Äô\r\n struct memory: public handle<mkldnn_memory_t> {\r\n        ^~~~~~\r\n/usr/local/include/mkldnn.hpp:577:8: note:   candidate expects 1 argument, 2 provided\r\n\x1b[0m\x1b[91m/opt/pytorch/aten/src/ATen/native/mkldnn/Conv.cpp:421:35: error: ‚Äòstruct mkldnn::stream‚Äô has no member named ‚Äòsubmit‚Äô\r\n   Stream::Instance().get_stream().submit(net);\r\n                                   ^~~~~~\r\n\x1b[0m[ 64%] Building CXX object caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/CPUFloatType.cpp.o\r\ncaffe2/CMakeFiles/caffe2.dir/build.make:2841: recipe for target 'caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkldnn/Conv.cpp.o' failed\r\n\x1b[91mmake[2]: *** [caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkldnn/Conv.cpp.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\n\x1b[0m\x1b[91mmake[1]: *** [caffe2/CMakeFiles/caffe2.dir/all] Error 2\r\n\x1b[0mCMakeFiles/Makefile2:2107: recipe for target 'caffe2/CMakeFiles/caffe2.dir/all' failed\r\nMakefile:138: recipe for target 'all' failed\r\n\x1b[91mmake: *** [all] Error 2\r\n\x1b[0mBuilding wheel torch-1.1.0a0+742568e\r\n-- Building version 1.1.0a0+742568e\r\n"", 'bash \r\ncd /opt && git clone --recursive https://github.com/pytorch/pytorch && \\\r\n    cd /opt/pytorch && \\\r\n    git submodule update --init && \\\r\n    cd /opt/pytorch && ls && \\\r\n    sed -i \'s/""Use MKLDNN"" OFF/""Use MKLDNN"" ON/g\' CMakeLists.txt && \\\r\n    sed -i \'s/""Use DISTRIBUTED"" OFF/""Use DISTRIBUTED"" ON /g\' CMakeLists.txt && \\\r\n    sed -i \'s/for parallel code"" OFF/for parallel code"" ON /g\' CMakeLists.txt && \\\r\n    PYTHON_EXECUTABLE=/opt/conda/bin/python \\\r\n    PYTHON_LIBRARY=/opt/conda/lib/libpython3.6m.so \\\r\n    PYTHON_INCLUDE_DIR=/opt/conda/include/python3.6m \\\r\n    FULL_CAFFE2=1 \\\r\n    USE_OPENMP=1 \\\r\n    USE_MKL=1 \\\r\n    USE_MKLDNN=1 \\\r\n    USE_MKLML=1 \\\r\n    USE_SYSTEM_EIGEN_INSTALL=1 \\\r\n    USE_ZMQ=1 \\\r\n    USE_DISTRIBUTED=1 \\\r\n    BUILD_TEST=0 \\\r\n    MKLDNN_LIBRARY=/usr/local/lib \\\r\n    MKLDNN_INCLUDE_DIR=/usr/local/include \\\r\n    MKLDNN_LIB_DIR=/usr/local/lib \\\r\n    python setup.py install \r\n']"
72,16258,1,"Inconsistent Behavior of permute() in different calling order. ## üêõ Bug

<!-- A clear and concise description of what the bug is. -->
I am trying to convert the format between cv::Mat and torch::Tensor using c++(libtorch), one crucial step of which is to permute the shape of the Tensor. However I found that in some cases the permute() function failed to manage the memory of the image.

## To Reproduce

I provide some code to reproduce the bug:

1. Image Version


1. A Simpler Matrix Version
this code:

would output (wrong):


but change the permute line from 

to 


will output (correct):


Note that when the permute() failed to managed the memory, it always returned the ""correct"" shape of the permuted tensor.

<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

## Expected behavior

<!-- A clear and concise description of what you expected to happen. -->
The two different usage of permute() should behave consistently( both should  permute the memory not only the shape)

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 - PyTorch Version (e.g., 1.0): v1.0.0
 - OS (e.g., Linux): Linux Arm
 - How you installed PyTorch (, , source): From source, and following the step of [issue 15138](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
 - Build command you used (if compiling from source): python setup.py build
 - Python version: 3.5.2
 - CUDA/cuDNN version: libcudnn.so.7.0.5
 - GPU models and configuration:
 - Any other relevant information:

## Additional context

<!-- Add any other context about the problem here. -->
. ['c++\r\n#include <opencv2/opencv.hpp>\r\n#include <torch/script.h>\r\n#include <cstdint>\r\n#include <cstdio>\r\n#include <iostream>\r\n\r\nconst char* shape_of(torch::Tensor const & tensor) {\r\n  const int kBufferSize = 64;\r\n  static char buffer[kBufferSize];\r\n  memset(buffer, kBufferSize, 0);\r\n  int offset = 0;\r\n  offset += snprintf(buffer+offset, kBufferSize-offset, ""("");\r\n  for(int i : tensor.sizes()) {\r\n    offset += snprintf(buffer+offset, kBufferSize-offset, ""%d,"", i);\r\n  }\r\n  offset += snprintf(buffer+offset-1, kBufferSize-offset, "")"");\r\n  return buffer;\r\n}\r\n\r\nint main(){\r\n    cv::VideoCapture cap(""video.mp4"");\r\n    cv::Mat frame, show;\r\n    torch::Tensor tframe, tres;\r\n    cap >> frame;\r\n    tframe = torch::from_blob(frame.data, {1, frame.rows, frame.cols, 3}, torch::kByte);\r\n    tframe = tframe.permute({0,3,1,2}).toType(torch::kFloat).div_(255.0f).to(torch::kCUDA);\r\n    printf(""%s,\\n"", shape_of(tframe));\r\n    tres = tframe.to(torch::kCPU).mul_(255.0f).toType(torch::kByte).permute({0, 2, 3, 1}); // this would not work\r\n    //tres = tframe.permute({0, 2, 3, 1}).to(torch::kCPU).mul_(255.0f).toType(torch::kByte); // this would work!!!\r\n    printf(""%s,\\n"", shape_of(tres));\r\n    show = cv::Mat(frame.rows, frame.cols, CV_8UC3, tres.data<uint8_t>(), frame.cols);\r\n    imshow(""show"", show);\r\n    imshow(""frame"", frame);\r\n    cv::waitKey(0);\r\n    return 0;\r\n}\r\n', 'c++\r\n#include <opencv2/opencv.hpp>\r\n#include <torch/script.h>\r\n#include <cstdint>\r\n#include <cstdio>\r\n#include <iostream>\r\n\r\nconst char* shape_of(torch::Tensor const & tensor) {\r\n  const int kBufferSize = 64;\r\n  static char buffer[kBufferSize];\r\n  memset(buffer, kBufferSize, 0);\r\n  int offset = 0;\r\n  offset += snprintf(buffer+offset, kBufferSize-offset, ""("");\r\n  for(int i : tensor.sizes()) {\r\n    offset += snprintf(buffer+offset, kBufferSize-offset, ""%d,"", i);\r\n  }\r\n  offset += snprintf(buffer+offset-1, kBufferSize-offset, "")"");\r\n  return buffer;\r\n}\r\n\r\nint main(){\r\n    cv::VideoCapture cap(""video.mp4"");\r\n    cv::Mat frame, show;\r\n    torch::Tensor tframe, tres;\r\n    char data[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12};\r\n    tframe = torch::from_blob(data, {1, 2, 2, 3}, torch::kByte);     printf(""shape of tframe is %s,\\n"", shape_of(tframe));\r\n    frame = cv::Mat(2, 2, CV_8UC3, data);                            std::cout << ""cout frame(data) is "" << frame << std::endl;\r\n    frame = cv::Mat(2, 2, CV_8UC3, tframe.data<uint8_t>());          std::cout << ""cout frame(tframe.data) is "" << frame << std::endl;\r\n    tframe = tframe.toType(torch::kFloat).div_(255.0f).to(torch::kCUDA).permute({0,3,1,2}); /* this would fail */    printf(""shape of permuted tframe is %s,\\n"", shape_of(tframe));\r\n    tres = tframe.permute({0, 2, 3, 1}).to(torch::kCPU).mul_(255.0f).toType(torch::kByte);     printf(""shape of tres is %s,\\n"", shape_of(tres));\r\n    show = cv::Mat(frame.rows, frame.cols, CV_8UC3, tres.data<uint8_t>());    std::cout << ""cout show(tres.data) is "" << show << std::endl;\r\n    return 0;\r\n}\r\n', '\r\nshape of tframe is (1,2,2,3),\r\ncout frame(data) is [  1,   2,   3,   4,   5,   6;   7,   8,   9,  10,  11,  12]\r\ncout frame(tframe.data) is [  1,   2,   3,   4,   5,   6;   7,   8,   9,  10,  11,  12]\r\nshape of permuted tframe is (1,3,2,2),\r\nshape of tres is (1,2,2,3),\r\ncout show(tres.data) is [  1,   4,   7,  10,   2,   5;   8,  11,   3,   6,   9,  12]\r\n', 'c++\r\ntframe = tframe.toType(torch::kFloat).div_(255.0f).to(torch::kCUDA).permute({0,3,1,2}); /* this would fail */ \r\n', 'c++\r\ntframe = tframe.permute({0,3,1,2}).toType(torch::kFloat).div_(255.0f).to(torch::kCUDA); /* this would work */ \r\n', '\r\nshape of tframe is (1,2,2,3),\r\ncout frame(data) is [  1,   2,   3,   4,   5,   6;   7,   8,   9,  10,  11,  12]\r\ncout frame(tframe.data) is [  1,   2,   3,   4,   5,   6;   7,   8,   9,  10,  11,  12]\r\nshape of permuted tframe is (1,3,2,2),\r\nshape of tres is (1,2,2,3),\r\ncout show(tres.data) is [  1,   2,   3,   4,   5,   6;   7,   8,   9,  10,  11,  12]\r\n\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
84,3018,1,"CUDA initialization hangs on CUDA 9. I just installed pytorch HEAD from source with cuda 9 and cudnn 7 using gcc 5.4 on ubuntu 16.04. It seemed to build and install without issue, however the python process hangs if I try to move a tensor to gpu using the cuda method. The following snippet also hangs.



There are 2 Maxwell Titan X and 2 Pascal 1080 Ti cards attached to the machine.. ['python\r\nimport torch\r\n\r\ntorch._C._cuda_init()\r\n']"
299,24045,0,"torch.{save,load} data corruption when serializing a Module with __{get,set}state__. Repro:



Output



cc @ezyang @gchanan @zou3519. [""\r\nimport torch\r\nimport tempfile\r\n\r\n\r\nclass Foo(torch.nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.x = torch.rand(3, 4)\r\n\r\n    def __getstate__(self):\r\n        print('storage', self.x.storage())\r\n        print('cdata', self.x.storage()._cdata)\r\n        print('data', self.x)\r\n        return (self.x,)\r\n\r\n    def __setstate__(self, state):\r\n        x = state[0]\r\n        print('storage', x.storage())\r\n        print('cdata', x.storage()._cdata)\r\n        print('data', x)\r\n\r\nfoo = Foo()\r\nwith tempfile.NamedTemporaryFile() as f:\r\n    torch.save(foo, f)\r\n    f.seek(0)\r\n    loaded = torch.load(f)\r\n\r\n"", '\r\nstorage  0.616813063621521\r\n 0.1769922971725464\r\n 0.8948532938957214\r\n 0.48996198177337646\r\n 0.05472159385681152\r\n 0.5072327852249146\r\n 0.2782403826713562\r\n 0.28143006563186646\r\n 0.34611016511917114\r\n 0.08622455596923828\r\n 0.3336881399154663\r\n 0.06343936920166016\r\n[torch.FloatStorage of size 12]\r\ncdata 94388766643008\r\ndata tensor([[0.6168, 0.1770, 0.8949, 0.4900],\r\n        [0.0547, 0.5072, 0.2782, 0.2814],\r\n        [0.3461, 0.0862, 0.3337, 0.0634]])\r\nstorage  -6.13554555064281e-24\r\n 3.079493505200218e-41\r\n -6.0064247976762345e-24\r\n 3.079493505200218e-41\r\n 1.401298464324817e-45\r\n 0.0\r\n 4.0678076049753325e-31\r\n 6.206981819115192e-36\r\n 6.206981819115192e-36\r\n 6.206981819115192e-36\r\n 6.206981819115192e-36\r\n 2.7953761007662624e-20\r\n[torch.FloatStorage of size 12]\r\ncdata 94388766662208\r\ndata tensor([[-6.1355e-24,  3.0795e-41, -6.0064e-24,  3.0795e-41],\r\n        [ 1.4013e-45,  0.0000e+00,  4.0678e-31,  6.2070e-36],\r\n        [ 6.2070e-36,  6.2070e-36,  6.2070e-36,  2.7954e-20]])\r\n']"
525,15557,0,"main.exe ,which was made  from main.py by pyinstaller , faced on error  . ## ‚ùì Questions and Help
I made main.exe ,which is made from main.py by the pyinstaller.
But I did main.exe,then it faced  ""main.exe: error: unrecognized arguments: --multiprocessing-fork
parent_pid=7056 pipe_handle=1188"" erroe and stopped.

How do I change main.py code to operate main.exe without this error?

I'd really appreciate it if anyone will give me the advice as soon as possile

„ÉªCUDA9, Python3.6 ,Pytorch Windows for CUDA9,
„ÉªOS„ÄÄWindows10 Pro 64bit
„ÉªNvidia GTX980
        
. []"
644,10857,0,"got error ""ninja: error: loading 'build/build.global.ninja': No such file or directory"". If you have a question or would like help and support, please ask at our
[forums](https://discuss.pytorch.org/).

If you are submitting a feature request, please preface the title with [feature request].
If you are submitting a bug report, please fill in the following details.

## Issue description

## Code example

## System Info
Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


- PyTorch or Caffe2: PyTorch
- How you installed PyTorch (conda, pip, source): source
- Build command you used (if compiling from source): python setup.py build
- OS: CentOS7
- PyTorch version: master branch (ca567862)
- Python version: 3.7.0
- CUDA/cuDNN version: 9.2/7.2.1
- GPU models and configuration: NVIDIA GTX1070
- GCC version (if compiling from source): 4.8.5
- CMake version: 3.12.0
- Versions of any other relevant libraries:
. [""\r\nBuilding from source, an error reported related to ninja and stopped the building process\r\nrunning build_ext\r\n-- Building with NumPy bindings\r\n-- Detected cuDNN at /usr/local/cudnn/lib64/libcudnn.so.7, /usr/local/cudnn/include\r\n-- Not using MIOpen\r\n-- Detected CUDA at /usr/local/cuda\r\n-- Detected MKLDNN at /usr/local/lib/libmkldnn.so, /usr/local/include\r\n-- Using system provided NCCL library at /usr/local/nccl_2.2.13-1+cuda_9.2/lib/libnccl.so.2.2.13, /usr/local/nccl/include\r\n-- Building with distributed package \r\nninja: error: loading 'build/build.global.ninja': No such file or directory\r\nCommand '['/home/jbaik/.pyenv/versions/3.7.0/lib/python3.7/site-packages/ninja/data/bin/ninja', '-f', 'build/build.global.ninja']' returned non-zero exit status 1.\r\n"", '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
617,125,0,"make tests deterministic. by default the tests should be deterministic, individually.
randomized tests can be run nightly or something, but not by default.
. []"
544,3999,0,"Save big file is slow. It spent a lot of time for I to save file by torch.save().

The file size is about 3.5G, and it costs 2hr 49m totally. Is it make sense?
. []"
555,828,0,"backward() in Autograd Index Function is broken when indexing with LongTensor. In :


I think the index-copy statement doesn't work as intended.


I guess the statement should be something like
. [""python\r\n    def backward(self, grad_output):\r\n        # TODO: this won't have to be zeroed\r\n        grad_input = grad_output.new(self.input_size).zero_()\r\n        grad_input.index(self.index).copy_(grad_output)\r\n        return grad_input\r\n"", '\r\nIn [15]: a = torch.zeros((3, 5))\r\n\r\nIn [16]: a\r\nOut[16]: \r\n\r\n 0  0  0  0  0\r\n 0  0  0  0  0\r\n 0  0  0  0  0\r\n[torch.FloatTensor of size 3x5]\r\n\r\nIn [17]: b = torch.ones((2, 5))\r\n\r\nIn [18]: a.index(torch.LongTensor([0, 2])).copy_(b)\r\nOut[18]: \r\n\r\n 1  1  1  1  1\r\n 1  1  1  1  1\r\n[torch.FloatTensor of size 2x5]\r\n\r\nIn [19]: a\r\nOut[19]: \r\n\r\n 0  0  0  0  0\r\n 0  0  0  0  0\r\n 0  0  0  0  0\r\n[torch.FloatTensor of size 3x5]\r\n', 'python\r\n        grad_input.index_copy_(0, self.index, grad_output)\r\n']"
358,8386,0,"Properly release NCCL resources. Right now we're simply leaking them, because NCCL segfaults if you attempt to destroy them after the driver is unloaded.

One strategy to fix it would be to use an  handler.

See #8352 for more context.. []"
115,24625,0,"Migrate `sigmoid_backward` from the TH to Aten (CUDA). Porting TH operators is essential for code simplicity and performance reasons.

Porting guides and Q&A are available in umbrella issue: #24507

Feel free to add @VitalyFedyunin as a reviewer to get a prioritized review.. []"
485,8652,0,"Batch Sampler and Dataset indexing too restricted. I was trying to use a Dataloader with a sampler of strings to index my dataset. The default [BatchSampler](https://github.com/pytorch/pytorch/blob/master/torch/utils/data/sampler.py#L104) threw me an error that essentially str cannot be casted to int. The cast in question happens on line 139 (currently):

I copied the source for the Batch Loader from master, removed the cast, and everything worked as expected.

[torch.utils.data](https://pytorch.org/docs/stable/data.html) DataLoader doesn't suggest that samplers should return integers, and the various Samplers just say list of indices. An index set doesn't have to be integers. Now Dataset *does* say __getitem__ should support **integer** indexing, but why?

Really, the choice of sampler (including choosing by default the default sampler) drives whether a Dataset must be indexable by integers. On the other hand, sometimes it's more sensible to ""key"" the dataset. For example, the sampler could ""request"" the a filename be loaded. Or, the actual data could be organized in a dict (like I have in my examples below).

Along the way, I noticed that BatchLoader is now asserting that sampler is a Sampler. (This isn't the case in 0.4.0, just master). I don't really understand why. Why not duck type that sampler is iterable? Just a try-except around the for-loop that catches TypeError and returns whatever type of error. It breaks the example if I'm not mistaken, and excludes a very useful way to unittest.

## MWE
. ['\r\nbatch.append(int(idx))\r\n', '\r\n## M.should-be-W.E.:\r\n']"
702,6285,0,"AutoGPU header relies on WITH_CUDA. AutoGPU is compiled with WITH_CUDA. Instead, it should be in an auto_gpu.cpp file so we do not have to set this macro while compiling it...

If a third party lib includes auto_gpu.h without doing a , then they try to use it, the things in auto_gpu.h wrapped with  will not compile and it won't work. The solution I can see is to split it out into a .cpp so CUDA is baked into the pytorch .so.. []"
327,25417,0,"Add a mode to check input tensor sizes in allreduce_coalesced. @jfc4050 added CPU  in #24949. The current version flattens all input tensors into one, and then allreduce that tensor. It works, even if, say, process 0 provides a tensor of size 4 and process 1 provides two tensors of size 2 each. This is a reasonable shortcut to avoid using additional communications to check tensor sizes, but it will be good to add size checking in the default mode, and asking users to explicitly set  to they indeed want to skip that.

cc @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera. []"
318,25381,0,"regarding builtin_function_or_method. ## üöÄ Feature
<!-- A clear and concise description of the feature proposal -->
some way to see the code for builtin_function_or_method
## Motivation

<!-- Please outline the motivation for the proposal. Is your feature request related to a problem? e.g., I'm always frustrated when [...]. If this is related to another GitHub issue, please link here too -->
consider this scenario
1) I am using google colab, I want to see the implementation of nn.Dropout
2) I ctrl+click on nn.Dropout, it takes me to dropout.py, where I find Dropout class, which returns

3) so, I ctrl+click on F.dropout, it takes me to functional.py, where I see this

4) now, I am stuck, because this is a builtin, and only way for me to look at its code, is to search for this in github.
5) same thing happens when I want to see the implementation of nn.CrossMapLRN2d, it redirects to torch.group_norm, which is builtin.
6) similarly for view, permute, this way to understand what these builtins are doing becomes difficult

because of this I raised an issue in google colab, to provide a way to look at builtin_function_or_method, they told 

""
No, there's no way to get directly to the source in this case.

In particular, for a .so, it could be a cython file, or it could be another kind of C extension (built via vanilla C/C++ code, or SWIG'd in, or something else completely). All we have is the installed package -- there's no way for us to trace that back to source, and in cases like this (torch is distributed as a .whl file) the source isn't included.
""


## Pitch

<!-- A clear and concise description of what you want to happen. -->

## Alternatives

<!-- A clear and concise description of any alternative solutions or features you've considered, if any. -->

## Additional context

<!-- Add any other context or screenshots about the feature request here. -->
. []"
306,12322,0,"[Caffe2] Segmentation fault (core dumped) while import caffe2.python.core. ## üêõ Bug

When I want to import caffe2.pytho.core, I get a Segmentation fault.

I followed the install guide for ubuntu 16 with prebuilt binaries and also installed nccl, I've been browsing past issues but can't find a solution.

please help me

## To Reproduce

Steps to reproduce the behavior:

1. Install NCCL 2.3.5
2. conda install -c caffe2 caffe2-cuda9.0-cudnn7
3. import caffe2.python.core

ERROR : 



## Environment


Followed : [](https://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=prebuilt)

Cmake : I installed with anaconda I can't find the cmake output




. ['\r\nWARNING:root:This caffe2 python run does not have GPU support. Will run in CPU only mode.\r\nSegmentation fault (core dumped)\r\n', '\r\nuname -a\r\nLinux realAI 4.4.0-131-generic #157-Ubuntu SMP Thu Jul 12 15:51:36 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n', '\r\nwhich python\r\n/home/mputtnam/anaconda3/bin/python\r\n\r\nwhich pip\r\n/home/mputtnam/anaconda3/bin/pip\r\n\r\necho $PYTHONPATH\r\n<blank>\r\n', '\r\nnvidia-smi\r\nThu Oct  4 08:35:22 2018\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 396.54                 Driver Version: 396.54                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Quadro K4000        Off  | 00000000:02:00.0  On |                  N/A |\r\n| 30%   38C    P8    11W /  87W |    419MiB /  3010MiB |      3%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  Quadro K4000        Off  | 00000000:81:00.0 Off |                  N/A |\r\n| 30%   33C    P8    10W /  87W |      1MiB /  3018MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  Quadro K4000        Off  | 00000000:82:00.0 Off |                  N/A |\r\n| 30%   32C    P8    10W /  87W |      1MiB /  3018MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      1974      G   /usr/lib/xorg/Xorg                           210MiB |\r\n|    0      2955      G   compiz                                       180MiB |\r\n|    0      4925      G   /usr/bin/nvidia-settings                      24MiB |\r\n+-----------------------------------------------------------------------------+\r\n\r\n', '\r\nnvcc --version\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2015 NVIDIA Corporation\r\nBuilt on Tue_Aug_11_14:27:32_CDT_2015\r\nCuda compilation tools, release 7.5, V7.5.17\r\n\r\nls -lah /usr/local/cuda\r\nlrwxrwxrwx 1 root root 8 Oct  3 08:35 /usr/local/cuda -> cuda-9.0\r\n\r\n\r\n']"
486,9383,0,"[docs] Make clear the format of torch.eig eigenvalues. The second dimension must be for the complex imaginary part, but it is not clear in the docs.


Currently in https://pytorch.org/docs/master/torch.html?highlight=eig#torch.eig:
 without specified shapes. ['python\r\na = torch.Tensor([[1, 0], [0, 1]])\r\nprint(a.eig()[0].shape) # torch.Size([2, 2])\r\nprint(np.linalg.eig(a)[0].shape) # (2,)\r\n']"
228,12887,0,"Segmentation fault when summing uint8 tensor. Hi. I'm using PyTorch 0.5.0a0+09896d1

This code:


is returning me a ""Segmentation fault"". If instead I do , it works. Also, the problem does not occur with .

EDIT: a more efficient way to reproduce the bug:
. ['python\r\nsize = 3*1000*1000*1000\r\na = torch.LongTensor(size).random_(2)\r\n(a == a).sum()\r\n', 'python\r\nsize = 3*1000*1000*1000\r\na = torch.ByteTensor(size).random_(2)\r\n(a == 0).sum()\r\n']"
149,22780,0,"Build Pytorch/Libtorch with TBB support is failing. ## üêõ Bug

Build Pytorch/Libtorch with TBB support is failing

## To Reproduce

Steps to reproduce the behavior:

1. Set environment variables  to use TBB:

2. Build: 


## Expected behavior

It builds successfully. Building with OpenMP is working in the same environment.

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:


 Collecting environment information...
PyTorch version: N/A
Is debug build: N/A
CUDA used to build PyTorch: N/A

OS: Ubuntu 14.04.6 LTS
GCC version: (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4
CMake version: version 3.11.1

Python version: 2.7
Is CUDA available: N/A
CUDA runtime version: 10.0.130
GPU models and configuration: Could not collect
Nvidia driver version: Could not collect
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.5.1.5
/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.21

Versions of relevant libraries:
[pip] numpy==1.8.2
[conda] Could not collect
## Additional context

Attached CMakeOutput and CMakeError files.
[CMakeError.log](https://github.com/pytorch/pytorch/files/3384330/CMakeError.log)
[CMakeOutput.log](https://github.com/pytorch/pytorch/files/3384331/CMakeOutput.log)


. ['\r\nexport USE_CUDA=0\r\nexport PARALLEL_BACKEND=NATIVE\r\nexport USE_OPENMP=0 \r\nexport USE_TBB=1 \r\nexport MKL_TBB=1\r\nexport BLAS=MKL \r\nexport USE_MKLDNN=1 \r\nexport MKLDNN_THREADING=TBB \r\nexport BUILD_BINARY=1\r\nexport USE_EIGEN_THREADPOOL=1\r\n', '\r\n...\r\n-- ******** Summary ********\r\n-- General:\r\n--   CMake version         : 3.11.1\r\n--   CMake command         : /usr/local/bin/cmake\r\n--   System                : Linux\r\n--   C++ compiler          : /usr/bin/c++\r\n--   C++ compiler id       : GNU\r\n--   C++ compiler version  : 4.8.4\r\n--   BLAS                  : MKL\r\n--   CXX flags             :   -Wno-deprecated -fvisibility-inlines-hidden -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math\r\n--   Build type            : Release\r\n--   Compile definitions   : TH_BLAS_MKL;ONNX_NAMESPACE=onnx_torch;USE_GCC_ATOMICS=1;MKLDNN_THR=MKLDNN_THR_TBB;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\r\n--   CMAKE_PREFIX_PATH     : /usr/lib/python2.7/dist-packages\r\n--   CMAKE_INSTALL_PREFIX  : /torch_build/pytorch/torch\r\n-- \r\n--   TORCH_VERSION         : 1.2.0\r\n--   CAFFE2_VERSION        : 1.2.0\r\n--   BUILD_CAFFE2_MOBILE   : ON\r\n--   BUILD_ATEN_ONLY       : OFF\r\n--   BUILD_BINARY          : True\r\n--   BUILD_CUSTOM_PROTOBUF : ON\r\n--     Link local protobuf : ON\r\n--   BUILD_DOCS            : OFF\r\n--   BUILD_PYTHON          : True\r\n--     Python version      : 2.7.6\r\n--     Python executable   : /usr/bin/python\r\n--     Pythonlibs version  : 2.7.6\r\n--     Python library      : /usr/lib/libpython2.7.so.1.0\r\n--     Python includes     : /usr/include/python2.7\r\n--     Python site-packages: lib/python2.7/dist-packages\r\n--   BUILD_CAFFE2_OPS      : True\r\n--   BUILD_SHARED_LIBS     : ON\r\n--   BUILD_TEST            : True\r\n--   INTERN_BUILD_MOBILE   : \r\n--   USE_ASAN              : False\r\n--   USE_CUDA              : False\r\n--   USE_ROCM              : False\r\n--   USE_EIGEN_FOR_BLAS    : \r\n--   USE_FBGEMM            : OFF\r\n--   USE_FFMPEG            : False\r\n--   USE_GFLAGS            : OFF\r\n--   USE_GLOG              : OFF\r\n--   USE_LEVELDB           : False\r\n--   USE_LITE_PROTO        : OFF\r\n--   USE_LMDB              : False\r\n--   USE_METAL             : OFF\r\n--   USE_MKL               : ON\r\n--   USE_MKLDNN            : ON\r\n--   USE_NCCL              : False\r\n--   USE_NNPACK            : True\r\n--   USE_NUMPY             : ON\r\n--   USE_OBSERVERS         : ON\r\n--   USE_OPENCL            : OFF\r\n--   USE_OPENCV            : False\r\n--   USE_OPENMP            : False\r\n--   USE_TBB               : True\r\n--   USE_PROF              : OFF\r\n--   USE_QNNPACK           : True\r\n--   USE_REDIS             : OFF\r\n--   USE_ROCKSDB           : OFF\r\n--   USE_ZMQ               : OFF\r\n--   USE_DISTRIBUTED       : True\r\n--     USE_MPI             : OFF\r\n--     USE_GLOO            : ON\r\n--     USE_GLOO_IBVERBS    : OFF\r\n--   NAMEDTENSOR_ENABLED   : False\r\n--   Public Dependencies  : Threads::Threads;caffe2::mkl;caffe2::mkldnn\r\n--   Private Dependencies : qnnpack;nnpack;cpuinfo;fp16;gloo;aten_op_header_gen;foxi_loader;rt;gcc_s;gcc;dl\r\n-- Configuring incomplete, errors occurred!\r\nSee also ""/torch_build/pytorch/build/CMakeFiles/CMakeOutput.log"".\r\nSee also ""/torch_build/pytorch/build/CMakeFiles/CMakeError.log"".\r\nTraceback (most recent call last):\r\n  File ""setup.py"", line 752, in <module>\r\n    build_deps()\r\n  File ""setup.py"", line 320, in build_deps\r\n    build_dir=\'build\')\r\n  File ""/torch_build/pytorch/tools/build_pytorch_libs.py"", line 67, in build_caffe2\r\n    rerun_cmake)\r\n  File ""/torch_build/pytorch/tools/setup_helpers/cmake.py"", line 272, in generate\r\n    self.run(args, env=my_env)\r\n  File ""/torch_build/pytorch/tools/setup_helpers/cmake.py"", line 100, in run\r\n    check_call(command, cwd=self._build_dir, env=env)\r\n  File ""/usr/lib/python2.7/subprocess.py"", line 540, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command \'[\'cmake\', \'-GNinja\', \'-DBLAS=MKL\', \'-DBUILDING_WITH_TORCH_LIBS=ON\', \'-DBUILD_BINARY=True\', \'-DBUILD_CAFFE2_OPS=True\', \'-DBUILD_PYTHON=True\', \'-DBUILD_SHARED_LIBS=ON\', \'-DBUILD_TEST=True\', \'-DCAFFE2_STATIC_LINK_CUDA=False\', \'-DCMAKE_BUILD_TYPE=Release\', \'-DCMAKE_CXX_FLAGS= \', \'-DCMAKE_C_FLAGS= \', \'-DCMAKE_EXE_LINKER_FLAGS=\', \'-DCMAKE_INSTALL_PREFIX=/torch_build/pytorch/torch\', \'-DCMAKE_PREFIX_PATH=/usr/lib/python2.7/dist-packages\', \'-DCMAKE_SHARED_LINKER_FLAGS=\', \'-DINSTALL_TEST=True\', \'-DNAMEDTENSOR_ENABLED=False\', \'-DNCCL_EXTERNAL=False\', \'-DNUMPY_INCLUDE_DIR=/usr/lib/python2.7/dist-packages/numpy/core/include\', \'-DONNX_ML=True\', \'-DONNX_NAMESPACE=onnx_torch\', \'-DPYTHON_EXECUTABLE=/usr/bin/python\', \'-DPYTHON_INCLUDE_DIR=/usr/include/python2.7\', \'-DPYTHON_LIBRARY=/usr/lib/libpython2.7.so.1.0\', \'-DTHD_SO_VERSION=1\', \'-DTORCH_BUILD_VERSION=1.2.0a0+1ffa9d3\', \'-DUSE_ASAN=False\', \'-DUSE_CUDA=False\', \'-DUSE_DISTRIBUTED=True\', \'-DUSE_FBGEMM=True\', \'-DUSE_FFMPEG=False\', \'-DUSE_LEVELDB=False\', \'-DUSE_LMDB=False\', \'-DUSE_MKLDNN=True\', \'-DUSE_NCCL=False\', \'-DUSE_NNPACK=True\', \'-DUSE_NUMPY=True\', \'-DUSE_OPENCV=False\', \'-DUSE_QNNPACK=True\', \'-DUSE_ROCM=False\', \'-DUSE_SYSTEM_EIGEN_INSTALL=OFF\', \'-DUSE_SYSTEM_NCCL=False\', \'-DUSE_TENSORRT=False\', \'-DUSE_OPENMP=False\', \'-DUSE_TBB=True\', \'-DINTEL_MKL_TBB=True\', \'-DMKLDNN_THREADING=TBB\', \'-DPARALLEL_BACKEND=NATIVE\', \'-DMKLDNN_ENABLE_CONCURRENT_EXEC=ON\', \'/torch_build/pytorch\']\' returned non-zero exit status 1\r\n', '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
737,9527,0,"AttributeError: Method AffineChannelNd is not a registered operator. Did you mean: [AffineChannel]. Traceback (most recent call last):
File ""tools/test_net.py"", line 151, in
main(ind_range=args.range, multi_gpu_testing=False)
File ""tools/test_net.py"", line 113, in main
engine.test_net_on_dataset(multi_gpu=multi_gpu_testing)
File ""/home/chandu/workspace/tracking/DaT/lib/core/test_engine.py"", line 321, in test_net_on_dataset
all_boxes, all_segms, all_keyps = test_net()
File ""/home/chandu/workspace/tracking/DaT/lib/core/test_engine.py"", line 135, in test_net
model = initialize_model_from_cfg()
File ""/home/chandu/workspace/tracking/DaT/lib/core/test_engine.py"", line 59, in initialize_model_from_cfg
init_params=cfg.TEST.INIT_RANDOM_VARS_BEFORE_LOADING)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/model_builder.py"", line 63, in create
return get_func(model_name)(init_model(model_name, train, init_params))
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/model_builder.py"", line 156, in keypoint_rcnn
add_roi_keypoint_head_func=get_func(cfg.KRCNN.ROI_KEYPOINTS_HEAD))
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/model_builder.py"", line 307, in build_generic_fast_rcnn_model
build_data_parallel_model(model, _single_gpu_build_func)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/model_builder.py"", line 953, in build_data_parallel_model
single_gpu_build_func(model)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/model_builder.py"", line 199, in _single_gpu_build_func
blob_conv, dim_conv, spatial_scale_conv = add_conv_body_func(model)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/FPN3D.py"", line 51, in add_fpn_ResNet101_conv5_body
ResNet.stage_info_ResNet101_conv5)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/FPN3D.py"", line 98, in add_fpn_generic_onto_body
conv_body_func(model)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/ResNet3D.py"", line 389, in add_ResNet101_conv5_body
return add_ResNet_convX_body(model, (3, 4, 23, 3), freeze_at=2)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/ResNet3D.py"", line 262, in add_ResNet_convX_body
p = model.AffineChannelNd(p, 'res_conv1_bn', dim_out=feat_dims[0], inplace=True)
File ""/home/chandu/workspace/tracking/DaT/lib/modeling/detector.py"", line 94, in AffineChannelNd
if cfg.MODEL.USE_BN:
File ""/home/chandu/workspace/tracking/anaconda2/envs/gtracking/lib/python2.7/site-packages/caffe2/python/core.py"", line 2082, in getattr
"","".join(workspace.C.nearby_opnames(op_type)) + ']'
AttributeError: Method AffineChannelNd is not a registered operator. Did you mean: [AffineChannel]

**Why am I getting this error?**. []"
11,3665,1,"Slight memory leak for LSTM . Hi everyone, 
I find there is a slight memory leak during training my lstm networks. 
Here is the running environment:

> torch: 0.2.0.3
> cuda: 7.5
> OS:ubuntu 16.04LTS

This issue is similar to the discuss [here](https://discuss.pytorch.org/t/tracking-down-a-suspected-memory-leak/1130/9). 
Following with the discussion, I found to disable the cuDNN (adding ) can solve this problem but the speed is affected either. 

I am quite confused about the memory leak when using cuDNN. 



Results when cuDNN is enabled, the memory leak occurs in every epoch. Screenshot:
![cudnn_enable](https://user-images.githubusercontent.com/9111828/32723137-558d6d6a-c8a7-11e7-8934-644aeb1aa762.png)

Results when cuDNN is disabled, the memory leak is almost eleminated (although happens in first several epochs). Screenshot:
![cudnn_disable](https://user-images.githubusercontent.com/9111828/32723151-638edee4-c8a7-11e7-825b-f6f604b7aaf2.png)
. ['\r\n# -*- coding: utf-8 -*-\r\nimport torch\r\nimport torch.autograd as autograd\r\nimport torch.nn as nn\r\nimport torch.optim as optim\r\nimport torch.nn.functional as F\r\nimport os\r\ntorch.manual_seed(1)\r\n\r\ndef prepare_sequence(seq, to_ix):\r\n    idxs = [to_ix[w] for w in seq]\r\n    tensor = torch.LongTensor(idxs)\r\n    return autograd.Variable(tensor).cuda()\r\n\r\nclass BiLSTM(nn.Module):\r\n    def __init__(self, vocab_size, tag_to_ix, embedding_dim, hidden_dim):\r\n        super(BiLSTM, self).__init__()\r\n        self.embedding_dim = embedding_dim\r\n        self.hidden_dim = hidden_dim\r\n        self.vocab_size = vocab_size\r\n        self.tag_to_ix = tag_to_ix\r\n        self.tagset_size = len(tag_to_ix)\r\n        self.word_embeds = nn.Embedding(vocab_size, embedding_dim)\r\n        self.lstm = nn.LSTM(embedding_dim, hidden_dim // 2,\r\n                            num_layers=1, bidirectional=True)\r\n        self.hidden2tag = nn.Linear(hidden_dim, self.tagset_size)\r\n        self.gpu = True \r\n        if self.gpu:\r\n            self.word_embeds = self.word_embeds.cuda()\r\n            self.lstm = self.lstm.cuda()\r\n            self.hidden2tag = self.hidden2tag.cuda() \r\n        self.hidden = self.init_hidden()\r\n\r\n    def init_hidden(self):\r\n        (a,b) = (autograd.Variable(torch.randn(2, 1, self.hidden_dim // 2)),\r\n                autograd.Variable(torch.randn(2, 1, self.hidden_dim // 2)))\r\n        if self.gpu:\r\n            a = a.cuda()\r\n            b = b.cuda()\r\n        return (a,b)\r\n\r\n    def _get_lstm_features(self, sentence):\r\n        self.hidden = self.init_hidden()\r\n        embeds = self.word_embeds(sentence).view(len(sentence), 1, -1)\r\n        lstm_out, self.hidden = self.lstm(embeds, self.hidden)\r\n        lstm_out = lstm_out.view(len(sentence), self.hidden_dim)\r\n        lstm_feats = self.hidden2tag(lstm_out)\r\n        return lstm_feats\r\n\r\n    def neg_log_likelihood(self, sentence, tags):\r\n        loss_function = nn.NLLLoss()\r\n        feats = self._get_lstm_features(sentence)\r\n        score = F.log_softmax(feats)\r\n        loss = loss_function(score, tags)\r\n        return loss\r\n\r\n    def forward(self, sentence):  \r\n        lstm_feats = self._get_lstm_features(sentence)\r\n        score = F.log_softmax(lstm_feats)\r\n        if self.gpu:\r\n            score = score.cpu()\r\n        tag_seq = score.data.numpy().argmax(axis=1).tolist()\r\n        return score, tag_seq\r\n#####################################################################\r\n# Run training\r\n## disable cudnn fixed the mem leak problem\r\n#torch.backends.cudnn.enabled = False\r\nEMBEDDING_DIM = 5\r\nHIDDEN_DIM = 4\r\n# Make up some training data\r\ntraining_data = [(\r\n    ""the wall street journal reported today that apple corporation made money"".split(),\r\n    ""B I I I O O O B I O O"".split()\r\n)] * 500 + [(\r\n    ""georgia tech is a university in georgia"".split(),\r\n    ""B I O O O O B"".split()\r\n)]*500\r\n\r\nword_to_ix = {}\r\nfor sentence, tags in training_data:\r\n    for word in sentence:\r\n        if word not in word_to_ix:\r\n            word_to_ix[word] = len(word_to_ix)\r\ntag_to_ix = {""B"": 0, ""I"": 1, ""O"": 2}\r\nmodel = BiLSTM(len(word_to_ix), tag_to_ix, EMBEDDING_DIM, HIDDEN_DIM)\r\noptimizer = optim.SGD(model.parameters(), lr=0.01, weight_decay=1e-4)\r\n## get process id\r\npid = os.getpid()\r\nprev_mem = 0\r\n# Make sure prepare_sequence from earlier in the LSTM section is loaded\r\nfor epoch in range(300):\r\n    print ""Epoch: %s""%epoch\r\n    inst_id = 0\r\n    for sentence, tags in training_data:\r\n        inst_id += 1\r\n        model.zero_grad()\r\n        sentence_in = prepare_sequence(sentence, word_to_ix)\r\n        targets = prepare_sequence(tags, tag_to_ix)\r\n        neg_log_likelihood = model.neg_log_likelihood(sentence_in, targets)\r\n        neg_log_likelihood.backward()\r\n        optimizer.step()\r\n        if inst_id%100 == 0:\r\n            cur_mem = (int(open(\'/proc/%s/statm\'%pid, \'r\').read().split()[1])+0.0)/256\r\n            add_mem = cur_mem - prev_mem\r\n            prev_mem = cur_mem\r\n            print ""     train instances: %s, added mem: %sM""%(inst_id, add_mem)\r\n\r\n# Check predictions after training\r\nprecheck_sent = prepare_sequence(training_data[0][0], word_to_ix)\r\nprint(model(precheck_sent))\r\n']"
578,1623,0,"incompatibility between Pytorch 0.1.12 and cuda 8.0.61/cudnn 5.1.10 ?. Hi,

I have two linux servers. My code works in one machine but not the other. In the one that it doesn't work, the error message is:  occured during batch normalization( convolution is fine). Also, the same code works in CPU but not in GPU. 

I guess this problem is mainly related to GPU libraries like cuda or cudnn. *The one that doesn't work has the following configurations*:
- Nvidia driver 375.26
- cuda 8.0.61
- cudnn 5.1.10

*While in the one it does work*, I have the following configurations:
- Nvidia driver 367.48
- cuda 8.0.44
- cudnn 5.1.5

TensorFlow can run in the above environment flawless though. So I am wondering if this is caused by the incompatibility between PyTorch 0.1.12 and cuda 8.0.61/cudnn 5.1.10 ?
. []"
581,9226,0,warn if batchsize < #gpu in data parallel. []
176,9054,0,"UBSAN error: call to function THDRequest_free through pointer to incorrect function type 'void (*)(void *)'. Both  and  in  throws error with UBSAN (error line: https://github.com/pytorch/pytorch/blob/master/torch/csrc/PtrWrapper.cpp#L49):

. [""\r\ntest_irecv (__main__.TestDistBackend) ... torch/csrc/PtrWrapper.cpp:50:3: runtime error: call to function THDRequest_free through pointer to incorrect function type 'void (*)(void *)'\r\n/var/lib/jenkins/pytorch/torch/lib/THD/base/DataChannelRequest.cpp:4: note: THDRequest_free defined here\r\n    #0 0x7fef1eacff05 in THPWrapper_dealloc(THPWrapper*) /var/lib/jenkins/pytorch/torch/csrc/PtrWrapper.cpp:50:3\r\n    #1 0x5623c8179e96 in dict_dealloc (/opt/conda/bin/python3.6+0xeee96)\r\n    #2 0x5623c822a60d in subtype_dealloc (/opt/conda/bin/python3.6+0x19f60d)\r\n    #3 0x5623c8179b1e in list_dealloc (/opt/conda/bin/python3.6+0xeeb1e)\r\n    #4 0x5623c8179916 in frame_dealloc (/opt/conda/bin/python3.6+0xee916)\r\n    #5 0x5623c8222dcf in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197dcf)\r\n    #6 0x5623c8223940 in fast_function (/opt/conda/bin/python3.6+0x198940)\r\n    #7 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #8 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #9 0x5623c8222c25 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197c25)\r\n    #10 0x5623c8223940 in fast_function (/opt/conda/bin/python3.6+0x198940)\r\n    #11 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #12 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #13 0x5623c8223d7a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198d7a)\r\n    #14 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #15 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #16 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #17 0x5623c824d46f in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c246f)\r\n    #18 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #19 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #20 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #21 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #22 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #23 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #24 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #25 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #26 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #27 0x5623c8223d7a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198d7a)\r\n    #28 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #29 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #30 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #31 0x5623c81f602a in slot_tp_init (/opt/conda/bin/python3.6+0x16b02a)\r\n    #32 0x5623c82299b6 in type_call (/opt/conda/bin/python3.6+0x19e9b6)\r\n    #33 0x5623c8199d7a in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ed7a)\r\n    #34 0x5623c82297cd in call_function (/opt/conda/bin/python3.6+0x19e7cd)\r\n    #35 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #36 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #37 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #38 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #39 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #40 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #41 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #42 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #43 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #44 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #45 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #46 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #47 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #48 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #49 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #50 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #51 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #52 0x5623c822403a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x19903a)\r\n    #53 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #54 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #55 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #56 0x5623c824d46f in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c246f)\r\n    #57 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #58 0x5623c8223e1a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198e1a)\r\n    #59 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #60 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #61 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #62 0x5623c81f69b6 in slot_tp_call (/opt/conda/bin/python3.6+0x16b9b6)\r\n    #63 0x5623c8199d7a in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ed7a)\r\n    #64 0x5623c82297cd in call_function (/opt/conda/bin/python3.6+0x19e7cd)\r\n    #65 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #66 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #67 0x5623c822403a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x19903a)\r\n    #68 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #69 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #70 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #71 0x5623c824d46f in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c246f)\r\n    #72 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #73 0x5623c8223e1a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198e1a)\r\n    #74 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #75 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #76 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #77 0x5623c81f69b6 in slot_tp_call (/opt/conda/bin/python3.6+0x16b9b6)\r\n    #78 0x5623c8199d7a in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ed7a)\r\n    #79 0x5623c82297cd in call_function (/opt/conda/bin/python3.6+0x19e7cd)\r\n    #80 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #81 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #82 0x5623c822403a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x19903a)\r\n    #83 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #84 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #85 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #86 0x5623c824d46f in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c246f)\r\n    #87 0x5623c8222a93 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197a93)\r\n    #88 0x5623c8223e1a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198e1a)\r\n    #89 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #90 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #91 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #92 0x5623c81f69b6 in slot_tp_call (/opt/conda/bin/python3.6+0x16b9b6)\r\n    #93 0x5623c8199d7a in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ed7a)\r\n    #94 0x5623c82297cd in call_function (/opt/conda/bin/python3.6+0x19e7cd)\r\n    #95 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #96 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #97 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #98 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #99 0x5623c822370a in fast_function (/opt/conda/bin/python3.6+0x19870a)\r\n    #100 0x5623c8229754 in call_function (/opt/conda/bin/python3.6+0x19e754)\r\n    #101 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #102 0x5623c8222f20 in _PyEval_EvalCodeWithName (/opt/conda/bin/python3.6+0x197f20)\r\n    #103 0x5623c8223e1a in _PyFunction_FastCallDict (/opt/conda/bin/python3.6+0x198e1a)\r\n    #104 0x5623c8199f5e in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ef5e)\r\n    #105 0x5623c819ea02 in _PyObject_Call_Prepend (/opt/conda/bin/python3.6+0x113a02)\r\n    #106 0x5623c819999d in PyObject_Call (/opt/conda/bin/python3.6+0x10e99d)\r\n    #107 0x5623c81f602a in slot_tp_init (/opt/conda/bin/python3.6+0x16b02a)\r\n    #108 0x5623c82299b6 in type_call (/opt/conda/bin/python3.6+0x19e9b6)\r\n    #109 0x5623c8199d7a in _PyObject_FastCallDict (/opt/conda/bin/python3.6+0x10ed7a)\r\n    #110 0x5623c82297cd in call_function (/opt/conda/bin/python3.6+0x19e7cd)\r\n    #111 0x5623c824bcb9 in _PyEval_EvalFrameDefault (/opt/conda/bin/python3.6+0x1c0cb9)\r\n    #112 0x5623c8224458 in PyEval_EvalCodeEx (/opt/conda/bin/python3.6+0x199458)\r\n    #113 0x5623c82251eb in PyEval_EvalCode (/opt/conda/bin/python3.6+0x19a1eb)\r\n    #114 0x5623c829f9a3 in run_mod (/opt/conda/bin/python3.6+0x2149a3)\r\n    #115 0x5623c829fda0 in PyRun_FileExFlags (/opt/conda/bin/python3.6+0x214da0)\r\n    #116 0x5623c829ffa3 in PyRun_SimpleFileExFlags (/opt/conda/bin/python3.6+0x214fa3)\r\n    #117 0x5623c82a3a9d in Py_Main (/opt/conda/bin/python3.6+0x218a9d)\r\n    #118 0x5623c816b4bd in main (/opt/conda/bin/python3.6+0xe04bd)\r\n    #119 0x7fef3a2b482f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291\r\n    #120 0x5623c8252772 in _start (/opt/conda/bin/python3.6+0x1c7772)\r\n""]"
648,10435,0,"[Caffe2 Bug] Error ISO C++ forbids declaration of DISABLE_COPY_AND_ASSIGN with no type. ## Issue description

Compile error when using 

https://github.com/pytorch/pytorch/blob/ab6afc2b238deb9e3b731399a367385518b788e5/modules/rocksdb/rocksdb.cc#L70

## System Info

- PyTorch or Caffe2: Caffe2
- How you installed PyTorch (conda, pip, source): source
- Build command you used (if compiling from source): cmake+ninja
- OS: CentOS
- PyTorch version: master
- GCC version (if compiling from source): 6.3.1
- CMake version: 3.12
. []"
629,14563,0,"Address multiple process groups from torch.distributed. In  you can initialize a global process group using the  function. This function takes a backend argument and will initialize **either** the Gloo, NCCL, or MPI backend. You're at a loss if you want to use both Gloo and NCCL through the  frontend. The only way to do this today is by manually creating ProcessGroup instances and using them directly.

For the case where you're dealing with both CPU and CUDA tensors and want to use Gloo for the CPU ones and NCCL2 for the CUDA ones, we should consider supporting a mode where we don't initialize a single backend, but multiple at the same time. We then use a process group dispatcher class that forwards the calls to the appropriate process group depending on the device type of the tensor arguments. This class should be a subclass of the ProcessGroup base class in C++ such that we can use it both from the Python side as well as from the C++ side.

Have to figure out what is the right way to expose this to the  function.

cc @teng-li . []"
528,31419,0,"[android] initHybrid missing/broken in pytorch 1.4.0 nightly. ## üêõ Bug

Trying to load a tensor from a blob leads to an error:
    java.lang.UnsatisfiedLinkError: No implementation found for com.facebook.jni.HybridData org.pytorch.Tensor.initHybrid() (tried Java_org_pytorch_Tensor_initHybrid and Java_org_pytorch_Tensor_initHybrid__)
        at org.pytorch.Tensor.initHybrid(Native Method)
        at org.pytorch.Tensor.initHybrid(Tensor.java:337)
        at org.pytorch.Tensor.fromBlob(Tensor.java:289)

This is a very recently introduced bug, as the nightly snapshot last week worked fine.

## To Reproduce

Steps to reproduce the behavior:
1. Create Android Project and add pytorch 1.4.0 nighly snapshot support (e.g. as shown here https://github.com/pytorch/pytorch/issues/29806) 
2. add following lines
        val inputHeight = 299
        val inputWidth = 299
        val inputTensorBuffer = Tensor.allocateFloatBuffer(3 * inputWidth * inputHeight)
        val inputTensor = Tensor.fromBlob( inputTensorBuffer, longArrayOf( 1, 3, inputHeight.toLong(), inputWidth.toLong()))
3. build & run app
4. App crashes with error above

## Expected behavior

Loading a tensor into memory without error (worked with nightly build last week)

## Environment

 - PyTorch Version (e.g., 1.0): 1.4.0 nightly snapshot (18 Dec 2019)
 - OS (e.g., Linux): Windows 10
 - Android studio 3.5.3, OpenJDK JRE 1.8.0_202
 - CUDA/cuDNN version: None (CPU-only)
 - GPU models and configuration: None 

## Additional context

Using a stable version is not an option, as 1.3.0 has a breaking bug in loading the inception v3 model (https://github.com/pytorch/pytorch/issues/29806) . []"
217,15436,0,"Type Conversions. ## üêõ Bug

I'm quite new to pytorch so I'm not exactly sure if this is a bug or just an error on my end.

I'm attempting to build a simple LogisticRegression Module on the  dataset in sklearn but for some reason, I keep getting this.

> RuntimeError: Expected object of scalar type Double but got scalar type Float for argument #2 'mat2'

I've tried to convert the both my X and y variables to  but it still seems to think it's float for some reason.

<!-- A clear and concise description of what the bug is. -->

## To Reproduce

Steps to reproduce the behavior:








<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->

The error generated is:

> ---------------------------------------------------------------------------
> RuntimeError                              Traceback (most recent call last)
> <ipython-input-122-c1edd1a76c76> in <module>
>      10         optimizer.zero_grad()
>      11 
> ---> 12         outputs = model(train)
>      13         loss = criterion(outputs, test)
>      14 
> 
> ~/miniconda3/envs/mlbook/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)
>     487             result = self._slow_forward(*input, **kwargs)
>     488         else:
> --> 489             result = self.forward(*input, **kwargs)
>     490         for hook in self._forward_hooks.values():
>     491             hook_result = hook(self, input, result)
> 
> <ipython-input-117-fca446c51ad3> in forward(self, x)
>       5 
>       6     def forward(self, x):
> ----> 7         out = self.layer(x)
>       8         return out
> 
> ~/miniconda3/envs/mlbook/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)
>     487             result = self._slow_forward(*input, **kwargs)
>     488         else:
> --> 489             result = self.forward(*input, **kwargs)
>     490         for hook in self._forward_hooks.values():
>     491             hook_result = hook(self, input, result)
> 
> ~/miniconda3/envs/mlbook/lib/python3.6/site-packages/torch/nn/modules/linear.py in forward(self, input)
>      65     @weak_script_method
>      66     def forward(self, input):
> ---> 67         return F.linear(input, self.weight, self.bias)
>      68 
>      69     def extra_repr(self):
> 
> ~/miniconda3/envs/mlbook/lib/python3.6/site-packages/torch/nn/functional.py in linear(input, weight, bias)
>    1352         ret = torch.addmm(torch.jit._unwrap_optional(bias), input, weight.t())
>    1353     else:
> -> 1354         output = input.matmul(weight.t())
>    1355         if bias is not None:
>    1356             output += torch.jit._unwrap_optional(bias)
> 
> RuntimeError: Expected object of scalar type Double but got scalar type Float for argument #2 'mat2'

## Expected behavior
Train and test the data on the network
<!-- A clear and concise description of what you expected to happen. -->

## Environment

Please copy and paste the output from our
[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)
(or fill out the checklist below manually).

You can get the script and run it with:

PyTorch version: 1.0.0
Is debug build: No
CUDA used to build PyTorch: None

OS: Mac OSX 10.14.3
GCC version: Could not collect
CMake version: version 3.13.2

Python version: 3.6
Is CUDA available: No
CUDA runtime version: No CUDA
GPU models and configuration: No CUDA
Nvidia driver version: No CUDA
cuDNN version: No CUDA

Versions of relevant libraries:
[pip] numpy (1.14.0)
[pip] numpydoc (0.7.0)
[pip] torch (1.0.0)
[pip] torchvision (0.2.1)
[conda] blas                      1.0                         mkl
[conda] mkl                       2018.0.1             hfbd8650_4
[conda] mkl-service               1.1.2            py36h7ea6df4_4
[conda] pytorch                   1.0.0                   py3.6_1    pytorch
[conda] torchvision               0.2.1                      py_2    pytorch

## Additional context

<!-- Add any other context about the problem here. -->
When I attempt to check the datatype at each point, I get  and 
 respectively.. ['\r\nX, y = make_classification(n_samples=60000,n_features=10, n_redundant=0, n_informative=2)\r\n', '\r\nX_train,y_train, X_test, y_test = train_test_split(X, y, stratify=y, random_state=42)\r\nX_train = Variable(torch.from_numpy(X_train)).double()\r\ny_train = Variable(torch.from_numpy(y_train)).double()\r\nX_test = Variable(torch.from_numpy(X_test)).double()\r\ny_test = Variable(torch.from_numpy(y_test)).double()\r\n', ""\r\ninput_dim = 40000\r\noutput_dim = 2\r\ncriterion = nn.CrossEntropyLoss()\r\nlearning_rate = 0.001\r\nbatch_size = 100\r\nn_iters = 3000\r\nnum_epochs = int(n_iters / (len(X_train) / batch_size))\r\n\r\nmodel = SingleLayeredNetwork(input_dim, output_dim)\r\noptimizer = torch.optim.SGD(model.parameters(), lr=learning_rate)\r\n\r\nclass SingleLayeredNetwork(nn.Module):\r\n    def __init__(self, input_dimension, output_dimension):\r\n        super(SingleLayeredNetwork, self).__init__()\r\n        self.layer = nn.Linear(input_dimension, output_dimension)\r\n\r\n    def forward(self, x):\r\n        out = self.layer(x)\r\n        return out\r\n\r\n\r\niter = 0\r\nfor epoch in range(num_epochs):\r\n    for train, test in zip(X_train, y_train):\r\n        print(train.dtype)\r\n        print(torch.typename(train))\r\n        optimizer.zero_grad()\r\n        \r\n        outputs = model(train)\r\n        loss = criterion(outputs, test)\r\n        \r\n        loss.backward()\r\n\r\n        # Updating parameters\r\n        optimizer.step()\r\n\r\n        iter += 1\r\n\r\n        if iter % 500 == 0:\r\n            # Calculate Accuracy         \r\n            correct = 0\r\n            total = 0\r\n            # Iterate through test dataset\r\n            for tra, tes in zip(X_test, y_test):\r\n                # Load images to a Torch Variable\r\n                tra = tra\r\n\r\n                # Forward pass only to get logits/output\r\n                outputs = model(train)\r\n\r\n                # Get predictions from the maximum value\r\n                # 100 x 1\r\n                _, predicted = torch.max(train, 1)\r\n\r\n                # Total number of labels\r\n                total += labels.size(0)\r\n\r\n                # Total correct predictions\r\n                correct += (predicted == test).sum()\r\n\r\n            accuracy = 100 * correct.item() / total\r\n\r\n            # Print Loss\r\n            print('Iteration: {}. Loss: {}. Accuracy: {}'.format(iter, loss.item(), accuracy))\r\n\r\n\r\n"", '\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n']"
415,23232,0,"Add collective communication APIs for Python objects. . ## üöÄ Feature

Support , , , and  general python objects. Instead of overloading existing API, it might be clearer to make them explicit, e.g.: , , , and .


## Motivation

Sharing objects across processes is a very common use case. People actually started building their own solutions by serializing meta and object into tensors and then using tensor collective comm APIs to share them (see,  in #22490,  in #23228). 

## Pitch

Python object on different processes might not be of the same size. So this needs to be done in multiple steps:

1. Pickle local python object into byte tensors. 
2. Communicate the tensor sizes across processes. Then, each process allocates local buffer tensors using the max size.
3. Copy local tensor to the buffer tensor and communicate. 
4. Extract results from the buffer tensors and unpickle them back into Python objects.

cc @pietern @zhaojuanmao @pritamdamania87 
. []"
475,23002,0,"Wrong input to Categorical makes Python quit unexpectedly. I pass a zero tensor to Categorical, which I expect torch should throw me some exception. Instead, Python quits unexpectedly



. ['\r\n(base) czxttkl-mbp:Horizon czxttkl$ python3\r\nPython 3.7.1 (v3.7.1:260ec2c36a, Oct 20 2018, 00:48:40) \r\n[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin\r\nType ""help"", ""copyright"", ""credits"" or ""license"" for more information.\r\n>>> import torch\r\n>>> torch.__version__\r\n\'1.1.0.post2\'\r\n>>> from torch.distributions.categorical import Categorical\r\n>>> Categorical(torch.tensor([0]))\r\nFloating point exception: 8\r\n\r\n# Python completely quits\r\n']"
225,14864,0,"[discussion] Recommend a different file extension for models (.PTH is a special extension for Python). *.pth files are used by Python to list additional package search paths: https://docs.python.org/3/library/site.html

The pth files will be loaded as text files by Python interpreter. At some point when I had some PyTorch model pth file placed along with the sources, it caused a hang of Python at startup (it was trying to parse the big binary file as a list of paths).

Maybe just *.pt?. []"
712,24991,0,"[Feature request] Add support for selu activation to calculate_gain function.. ## üöÄ Feature

Add support for selu activation to calculate_gain function.

https://pytorch.org/docs/stable/_modules/torch/nn/init.html#calculate_gain

cc @albanD @mruberry @SsnL. []"
481,14653,0,"[JIT] Error reporting on imported modules highlights serialization code. Repro:



Output:



This has the potential to be super confusing to end users. We should probably preserve the original source for highlighting. [""\r\nimport torch\r\n\r\ndef baz(x):\r\n    return torch.neg(x) + 3.14159\r\n\r\nbaz_traced = torch.jit.trace(baz, (torch.rand(5, 4, 3),))\r\n\r\n@torch.jit.script\r\ndef foo(x):\r\n    bar = torch.neg(torch.mm(x, torch.zeros(3, 4, 5)))\r\n    return baz_traced(bar)\r\n\r\nfoo.save('test.out')\r\n\r\nimported = torch.jit.load('test.out')\r\nimported(torch.rand(3, 4))\r\n"", '\r\nTraceback (most recent call last):\r\n  File ""error_report.py"", line 16, in <module>\r\n    imported(torch.rand(3, 4))\r\n  File ""/Users/jamesreed/onnx-fairseq/pytorch/torch/nn/modules/module.py"", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\nRuntimeError:\r\nmatrices expected, got 2D, 3D tensors at ../aten/src/TH/generic/THTensorMath.cpp:935:\r\noperation failed in interpreter:\r\nop_version_set = 0\r\ndef forward(self,\r\n    x: Tensor) -> Tensor:\r\n  _0 = torch.zeros([3, 4, 5], dtype=6, layout=0, device=[0, -1])\r\n  bar = torch.neg(torch.mm(x, _0))\r\n                  ~~~~~~~~ <--- HERE\r\n  _1 = torch.add(torch.neg(bar), CONSTANTS.c0, alpha=1)\r\n  return _1\r\n']"
348,19969,0,"libtorch Segmentation Fault: RHEL 7 - easy to reproduce. ## üêõ Bug

tl; dr; I traced a (non-pretrained) resnet18 model in python and saved this to a .pt. I successfully loaded this .pt in a C++ program. Model inference seems to work. When the C++ program exits, I encounter a segmentation fault.

## To Reproduce

Here are code snippets to minimally reproduce the issue:

(1) First, generate the model by running the following python script. If successful, you should see a 0 print out. I'm able to run this code with no problems.



(2) Here is the C++ program I run that generates a segmentation fault. To run, do 



When I run the C++ program, here's the output I receive:



## Things I've tried
- I've tried running the above C++ code on the CPU (so, replacing  with ). This doesn't result in a segmentation fault.

- I've tried running the above Python/C++ code on both CPU, GPU for a simple feedforward net (30 inputs -> 20 hiddens -> ReLU -> 2 outputs -> Sigmoid); this doesn't result in a segmentation fault. Running with  on CPU, I don't see any issues. On GPU, however here's what I get:



## Expected behavior

In running with hard.pt, I expect the code to run without any segfaults.

## Environment

 - PyTorch Version (e.g., 1.0): 1.1.0.dev20190425
 - OS (e.g., Linux): Red Hat Enterprise Linux Server 7.4 (Maipo)
 - How you installed PyTorch (, , source): 
 - Build command you used (if compiling from source): 
 - Python version: 
 - CUDA/cuDNN version: 8.0.44/7
 - GPU models and configuration: 

Versions of relevant libraries:
[pip] numpy==1.15.4
[pip] numpydoc==0.8.0
[pip] torch==1.0.1.post2
[pip] torchvision==0.2.2
[conda] blas                      1.0                         mkl
[conda] mkl                       2019.1                      144
[conda] mkl-service               1.1.2            py37he904b0f_5
[conda] mkl_fft                   1.0.6            py37hd81dba3_0
[conda] mkl_random                1.0.2            py37hd81dba3_0
[conda] pytorch                   1.0.1           py3.7_cuda8.0.61_cudnn7.1.2_2    pytorch
[conda] torchvision               0.2.2                      py_3    pytorch

## Additional context

I've tried following the instructions to resolve this issue here: https://github.com/pytorch/pytorch/issues/12705 but haven't seen success; I've tried building pytorch from source + linking my C++ code to the generated libs, but this doesn't work either.

cc @ezyang @gchanan @zou3519 @ngimel. ['import torch\r\nimport torchvision\r\n\r\n# An instance of your model.\r\nmodel = torchvision.models.resnet18()\r\n\r\n# An example input you would normally provide to your model\'s forward() method.\r\nexample = torch.rand(1, 3, 224, 224).cuda()\r\n\r\n# Use torch.jit.trace to generate a torch.jit.ScriptModule via tracing.\r\nmodel.cuda()\r\n\r\nbefore = model(example)\r\nprint(before.shape)\r\n\r\ntraced_script_module = torch.jit.trace(model, example)\r\ntraced_script_module.save(\'hard.pt\')\r\n\r\nload_module = torch.jit.load(""hard.pt"")\r\nafter = load_module(example)\r\n\r\nprint(torch.sum(before - after))\r\n', '\r\n#define _GLIBCXX_USE_CXX11_ABI 0\r\n#include <torch/script.h> // One-stop header.\r\n\r\n#include <iostream>\r\n#include <memory>\r\n#include <vector>\r\n\r\nint main(int argc, const char* argv[]) {\r\n  if (argc != 2) {\r\n    std::cerr << ""usage: example-app <path-to-exported-script-module>\\n"";\r\n    return -1;\r\n  }\r\n\r\n  torch::Tensor tensor = torch::rand({1, 3, 224, 224}, torch::dtype(torch::kFloat32).device(torch::kCUDA));\r\n\r\n  // run\r\n  auto module = torch::jit::load(argv[1], torch::kCUDA);\r\n  assert(module != nullptr);\r\n  std::cout << ""ok"" << std::endl;\r\n\r\n  std::vector<torch::jit::IValue> inputs;\r\n  inputs.push_back(tensor);\r\n\r\n  auto out = module->forward(inputs).toTensor();\r\n  std::cout << out << std::endl;\r\n  std::cout << ""done"" << std::endl;\r\n}\r\n', '\r\n(base) [build]$ rm -rf *; cmake -DCMAKE_PREFIX_PATH=/home/ec2-user/libtorch/ ..; make -j; ./example-app ../hard.pt\r\n-- The C compiler identification is GNU 5.3.1\r\n-- The CXX compiler identification is GNU 5.3.1\r\n-- Check for working C compiler: /opt/rh/devtoolset-4/root/usr/bin/cc\r\n-- Check for working C compiler: /opt/rh/devtoolset-4/root/usr/bin/cc -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: /opt/rh/devtoolset-4/root/usr/bin/c++\r\n-- Check for working CXX compiler: /opt/rh/devtoolset-4/root/usr/bin/c++ -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - found\r\n-- Looking for pthread_create\r\n-- Looking for pthread_create - not found\r\n-- Looking for pthread_create in pthreads\r\n-- Looking for pthread_create in pthreads - not found\r\n-- Looking for pthread_create in pthread\r\n-- Looking for pthread_create in pthread - found\r\n-- Found Threads: TRUE\r\n-- Found CUDA: /usr/local/cuda (found version ""8.0"")\r\n-- Caffe2: CUDA detected: 8.0\r\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\r\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda\r\n-- Caffe2: Header version is: 8.0\r\n-- Found CUDNN: /usr/local/cuda/include\r\n-- Found cuDNN: v7.1.3  (include: /usr/local/cuda/include, library: /usr/local/cuda/lib64/libcudnn.so)\r\n-- Autodetected CUDA architecture(s):  3.7 3.7 3.7 3.7 3.7 3.7 3.7 3.7\r\n-- Added CUDA NVCC flags for: -gencode;arch=compute_37,code=sm_37\r\n-- Found torch: /home/ec2-user/libtorch/lib/libtorch.so\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /home/ec2-user/example-app/build\r\nScanning dependencies of target example-app\r\n[ 50%] Building CXX object CMakeFiles/example-app.dir/example-app.cpp.o\r\n[100%] Linking CXX executable example-app\r\n[100%] Built target example-app\r\nok\r\nColumns 1 to 10-0.1336 -0.7583 -0.0227  0.0581  0.0842 -0.2745  0.5487  1.0180  0.0602  0.0120\r\n...\r\n...\r\n...\r\nColumns 991 to 1000-0.6911  1.0201  0.2691  0.2674 -0.4418  0.1372  0.3234  0.1259 -0.3892  0.1433\r\n[ Variable[CUDAType]{1,1000} ]\r\ndone\r\nSegmentation fault\r\n', ""==60061== Memcheck, a memory error detector\r\n==60061== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\r\n==60061== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\r\n==60061== Command: ./example-app ../simple.pt\r\n==60061==\r\n==60061== Warning: set address range perms: large range [0x395de000, 0x66b46000) (defined)\r\n==60061== Warning: noted but unhandled ioctl 0x30000001 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x27 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x7ff with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x25 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x17 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: set address range perms: large range [0x1000000000, 0x8a00000000) (noaccess)\r\n==60061== Warning: set address range perms: large range [0x8a00000000, 0xa200000000) (noaccess)\r\n==60061== Warning: noted but unhandled ioctl 0x19 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x21 with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\n==60061== Warning: noted but unhandled ioctl 0x1b with no size/direction hints.\r\n==60061==    This could cause spurious value errors to appear.\r\n==60061==    See README_MISSING_SYSCALL_OR_IOCTL for guidance on writing a proper wrapper.\r\nok\r\n 0.4127  0.4883\r\n[ Variable[CUDAType]{1,2} ]\r\ndone\r\n==60061==\r\n==60061== HEAP SUMMARY:\r\n==60061==     in use at exit: 1,247,853,758 bytes in 1,312,577 blocks\r\n==60061==   total heap usage: 2,763,800 allocs, 1,451,223 frees, 1,808,988,116 bytes allocated\r\n==60061==\r\n==60061== LEAK SUMMARY:\r\n==60061==    definitely lost: 440 bytes in 7 blocks\r\n==60061==    indirectly lost: 2,344 bytes in 24 blocks\r\n==60061==      possibly lost: 403,300,908 bytes in 155,594 blocks\r\n==60061==    still reachable: 844,550,066 bytes in 1,156,952 blocks\r\n==60061==                       of which reachable via heuristic:\r\n==60061==                         stdstring          : 438,097 bytes in 6,137 blocks\r\n==60061==         suppressed: 0 bytes in 0 blocks\r\n==60061== Rerun with --leak-check=full to see details of leaked memory\r\n==60061==\r\n==60061== For counts of detected and suppressed errors, rerun with: -v\r\n==60061== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)"", 'GPU models and configuration:\r\nGPU 0: Tesla K80\r\nGPU 1: Tesla K80\r\nGPU 2: Tesla K80\r\nGPU 3: Tesla K80\r\nGPU 4: Tesla K80\r\nGPU 5: Tesla K80\r\nGPU 6: Tesla K80\r\nGPU 7: Tesla K80\r\n']"
448,29117,0,"[tracking issue] RPC tests are flaky. 

cc @ezyang @gchanan @zou3519 @jerryzh168 @pietern @mrshenli @pritamdamania87 @zhaojuanmao @satgera @gqchen @aazzolini @rohan-varma @xush6528. ['\r\n======================================================================\r\nNov 01 22:11:17 ERROR: test_call_method_on_rref (__main__.RpcTestWithFork)\r\nNov 01 22:11:17 ----------------------------------------------------------------------\r\nNov 01 22:11:17 Traceback (most recent call last):\r\nNov 01 22:11:17   File ""/var/lib/jenkins/workspace/test/common_distributed.py"", line 130, in wrapper\r\nNov 01 22:11:17     self._join_processes(fn)\r\nNov 01 22:11:17   File ""/var/lib/jenkins/workspace/test/common_distributed.py"", line 211, in _join_processes\r\nNov 01 22:11:17     self._check_return_codes(elapsed_time)\r\nNov 01 22:11:17   File ""/var/lib/jenkins/workspace/test/common_distributed.py"", line 230, in _check_return_codes\r\nNov 01 22:11:17     raise RuntimeError(\'Process {} terminated or timed out after {} seconds\'.format(i, elapsed_time))\r\nNov 01 22:11:17 RuntimeError: Process 0 terminated or timed out after 400.1577408313751 seconds\r\nNov 01 22:11:17 \r\nNov 01 22:11:17 ----------------------------------------------------------------------\r\n']"
